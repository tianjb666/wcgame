window.__require=function e(t,a,r){function i(n,s){if(!a[n]){if(!t[n]){var c=n.split("/");if(c=c[c.length-1],!t[c]){var l="function"==typeof __require&&__require;if(!s&&l)return l(c,!0);if(o)return o(c,!0);throw new Error("Cannot find module '"+n+"'")}}var d=a[n]={exports:{}};t[n][0].call(d.exports,function(e){return i(t[n][1][e]||e)},d,d.exports,e,t,a,r)}return a[n].exports}for(var o="function"==typeof __require&&__require,n=0;n<r.length;n++)i(r[n]);return i}({AccountAPI:[function(e,t,a){"use strict";cc._RF.push(t,"f66d7OW2gpHu67y+g6TzVAR","AccountAPI");var r=t.exports={};r.login=function(e,t,a,r,i){var o={account:e,password:t,loginPlatform:a};Global.NetworkLogic.gameServerHttpRequest("/login","POST",o,r,i)},r.register=function(e,t,a,r,i,o){var n={account:e,password:t,loginPlatform:a,smsCode:r};Global.NetworkLogic.gameServerHttpRequest("/register","POST",n,i,o)},r.resetPasswordByPhoneRequest=function(e,t,a,r,i){var o={account:e,newPassword:t,smsCode:a,imgCodeInfo:r};Global.NetworkManager.send("account.accountHandler.resetPasswordByPhone",o,i||"ResetPasswordByPhoneResponse")},cc._RF.pop()},{}],AgentProfit:[function(e,t,a){"use strict";cc._RF.push(t,"d7a72wb8zpKM7dzESAbmMBb","AgentProfit");var r=t.exports={};r.init=function(e){this.data=e},r.getProportionByNum=function(e){for(var t=this.data[0],a=0;a<this.data.length;a++){var r=this.data[a];if(t.min>r.min&&(t=r),-1===r.max&&e>=r.min)return r;if(e>=r.min&&e<r.max)return r}return t},cc._RF.pop()},{}],Animation:[function(e,t,a){"use strict";cc._RF.push(t,"7b389mo9DZPzYyU4aKBpkwp","Animation");var r=t.exports={};r.getEmotionAnimalNode=function(e,t){var a=new cc.Node,r=function(t,r,i){for(var o=[],n=0;n<t;++n){var s=new cc.Node;s.active=!1,s.parent=a,o.push(s)}return cc.loader.loadRes("Emotion/"+e,cc.SpriteFrame,function(e,a){for(var n=0;n<t;++n){var s=new cc.Rect(n*r,0,r,i),c=a.clone();c.setRect(s),o[n].addComponent(cc.Sprite).spriteFrame=c}}),o},i=t;return cc.loader.load(cc.url.raw("resources/Emotion/"+e+".json"),function(e,t){if(!e){var o=r(t.count,t.width,t.height),n=0;i.schedule(function e(){var r=(n+t.count-1)%t.count;o[r].active=!1;var s=n%t.count;o[s].active=!0,++n>=t.turn*t.count&&(i.unschedule(e),a.removeFromParent())},.04*t.time)}}),a},r.createFrameAnimationNode=function(e,t){cc.loader.loadRes(e+"_config",cc.JsonAsset,function(a,r){if(a)cc.log("createFrameAnimation err: load file fail url="+e+".json"),t("load file fail");else{var i=(r=r.json).width||0,o=r.height||0,n=r.count||0,s=r.intervalTime||0;if(i<=0||o<=0||n<=0||s<=0)return cc.log("animation data err"),void t("animation data err");cc.loader.loadRes(e,cc.Texture2D,function(a,n){if(a)cc.log("createFrameAnimation err: load file fail url="+e+".png"),t("load file fail");else{var c=Math.floor(n.width/i)||1,l=Math.floor(n.height/o)||1,d=new cc.Node,h=d.addComponent(cc.Sprite);h.spriteFrame=new cc.SpriteFrame(n,new cc.Rect(0,64,i,o)),d.startAnimation=function(e,t,a){(!t||t<=0)&&(t=1),s/=t,d.stopAllActions();var u=0;function g(){var e=u++%r.count,t=new cc.Rect(e%c*i,Math.floor(e/l)*o,i,o);h.spriteFrame=new cc.SpriteFrame(n,t),a&&e===r.count-1&&a()}e?d.runAction(cc.repeatForever(cc.sequence([cc.delayTime(s),cc.callFunc(g)]))):d.runAction(cc.repeat(cc.sequence([cc.delayTime(s),cc.callFunc(g)]),r.count))},d.stopAnimation=function(){d.stopAllActions()},t(null,d)}})}})},cc._RF.pop()},{}],Api:[function(e,t,a){"use strict";cc._RF.push(t,"da2ddj7bzFBQ4UO1zeixbgm","Api");var r=t.exports={};r.hall=e("../API/HallAPI"),r.account=e("../API/AccountAPI"),r.room=e("../API/RoomAPI"),r.http=e("../API/HttpAPI"),r.roomProto=e("../API/RoomProto"),cc._RF.pop()},{"../API/AccountAPI":"AccountAPI","../API/HallAPI":"HallAPI","../API/HttpAPI":"HttpAPI","../API/RoomAPI":"RoomAPI","../API/RoomProto":"RoomProto"}],AudioManager:[function(e,t,a){"use strict";cc._RF.push(t,"6a82ecbNLhFrJJfx6RJEMam","AudioManager");var r=e("./Constant"),i=t.exports={};i.currentBgMusic=-1,i.isMusicEnabled=!0,i.isSoundEnabled=!0,i.musicVolume=1,i.soundVolume=1,i.commonSoundPath={clickButtonSound:"Hall/Sound/button"},i.commonSound={clickButton:null},i.init=function(){this.setSoundOn(),this.setMusicOn(),0==cc.sys.localStorage.getItem("Music")?this.isMusicEnabled=!1:cc.sys.localStorage.setItem("Music",1),0==cc.sys.localStorage.getItem("Sound")?this.isSoundEnabled=!1:cc.sys.localStorage.setItem("Sound",1),null===cc.sys.localStorage.getItem("MusicVolume")?(cc.sys.localStorage.setItem("MusicVolume",this.musicVolume),cc.sys.localStorage.setItem("SoundVolume",this.soundVolume)):(this.musicVolume=parseFloat(cc.sys.localStorage.getItem("MusicVolume")),this.soundVolume=parseFloat(cc.sys.localStorage.getItem("SoundVolume")))},i.startPlayBgMusic=function(e,t){e||(e=r.DEFUALT_BG_MUSIC_PATH),i.stopBgMusic(),cc.loader.loadRes(e,function(e,a){e?cc.log("startPlayBgMusic failed"):(i.currentBgMusic=cc.audioEngine.play(a,!0,i.isMusicEnabled?i.musicVolume:0),i.isMusicEnabled||cc.audioEngine.pause(i.currentBgMusic)),t&&t(e)})},i.stopBgMusic=function(){null===this.currentBgMusic||this.currentBgMusic<0||(cc.audioEngine.stop(this.currentBgMusic),this.currentBgMusic=-1)},i.playSound=function(e,t){e&&i.isSoundEnabled&&(!0!==t&&(t=!1),cc.loader.loadRes(e,function(a,r){a?console.error("playSound failed:"+e):cc.audioEngine.play(r,t,i.soundVolume)}))},i.playCommonSoundClickButton=function(){i.isSoundEnabled&&(null!==i.commonSound.clickButton?cc.audioEngine.play(i.commonSound.clickButton,!1,i.soundVolume):cc.loader.loadRes(i.commonSoundPath.clickButtonSound,function(e,t){e?cc.log("playCommonSoundClickButton failed"):(i.commonSound.clickButton=t,cc.audioEngine.play(i.commonSound.clickButton,!1,i.soundVolume))}))},i.setMusicOn=function(){cc.sys.localStorage.setItem("Music",1),cc.audioEngine.setVolume(this.currentBgMusic,1),cc.audioEngine.resume(this.currentBgMusic),this.isMusicEnabled=!0},i.setMusicOff=function(){cc.sys.localStorage.setItem("Music",0),cc.audioEngine.setVolume(this.currentBgMusic,0),this.isMusicEnabled=!1},i.getMusicEnabled=function(){return this.isMusicEnabled},i.setSoundOn=function(){cc.sys.localStorage.setItem("Sound",1),this.isSoundEnabled=!0},i.setSoundOff=function(){cc.sys.localStorage.setItem("Sound",0),this.isSoundEnabled=!1},i.getSoundEnabled=function(){return this.isSoundEnabled},i.setMusicVolume=function(e){this.musicVolume=parseFloat(e.toFixed(1)),this.musicVolume===parseFloat(cc.sys.localStorage.getItem("MusicVolume"))||cc.sys.localStorage.setItem("MusicVolume",this.musicVolume),i.currentBgMusic>=0&&cc.audioEngine.setVolume(i.currentBgMusic,this.musicVolume)},i.getMusicVolume=function(){return this.musicVolume},i.setSoundVolume=function(e){this.soundVolume=parseFloat(e.toFixed(1)),this.soundVolume===parseFloat(cc.sys.localStorage.getItem("SoundVolume"))||cc.sys.localStorage.setItem("SoundVolume",this.soundVolume)},i.getSoundVolume=function(){return this.soundVolume},cc._RF.pop()},{"./Constant":"Constant"}],AvatarItem:[function(e,t,a){"use strict";cc._RF.push(t,"8ec4a8bI1xBNLnx6lWqEEZf","AvatarItem"),cc.Class({extends:cc.Component,properties:{headIcon:cc.Sprite,select:cc.Node},showSelect:function(){this.select.active=!0},hideSelect:function(){this.select.active=!1},start:function(){},updateUI:function(e,t){this.data=e,this.index=t,this.node.active=!1,Global.CCHelper.updateSpriteFrame(e.icon,this.headIcon,function(){this.node.active=!0}.bind(this))},onBtnClk:function(e,t){this.data.callback&&this.data.callback(this.index)}}),cc._RF.pop()},{}],BJBetWidgetCtrl:[function(e,t,a){"use strict";cc._RF.push(t,"d3b03wZC/hI7ZR2ZFQLoRsS","BJBetWidgetCtrl");var r=e("./BJProto").chipAmount;cc.Class({extends:cc.Component,properties:{selectChipButtonArr:[cc.Button]},onLoad:function(){},onBtnClick:function(e,t){Global.AudioManager.playCommonSoundClickButton(),"bet"===t?this.callback("bet",this.betCount):"cleanBet"===t?(this.callback("clean"),this.betCount=0,this.updateChipButtonState(this.goldCount-this.betCount)):this.chipNumberArr.hasOwnProperty(t)&&(this.betCount+=this.chipNumberArr[t],this.callback("add",this.chipNumberArr[t]),this.updateChipButtonState(this.goldCount-this.betCount))},initWidget:function(){this.chipNumberArr=r;for(var e=0;e<this.selectChipButtonArr.length;++e){this.selectChipButtonArr[e].enabled=!1,this.selectChipButtonArr[e].node.opacity=150;var t=this.selectChipButtonArr[e].node.getComponent(cc.Sprite);Global.CCHelper.updateSpriteFrame("GameCommon/chip_"+this.chipNumberArr[e],t)}this.selectedChipArr=[];for(var a=0;a<this.chipNumberArr.length;++a){var i=Global.CCHelper.createSpriteNode("GameCommon/selected_chip_"+this.chipNumberArr[a]);i.active=!1,i.parent=this.selectChipButtonArr[a].node,this.selectedChipArr.push(i)}},startBet:function(e,t){this.callback=t,this.node.active=!0,this.chipNumberArr=r,this.curSelectedChipIndex=0,this.goldCount=e,this.betCount=0,this.updateChipButtonState(e)},stopBet:function(){this.node.active=!1,this.goldCount=0,this.betCount=0},getMinBetCount:function(){return this.chipNumberArr[0]},getCurBetCount:function(){return this.betCount},updateChipButtonState:function(e){for(var t=0;t<this.selectChipButtonArr.length;++t){var a=this.selectChipButtonArr[t],r=this.chipNumberArr[t]<e;a.enabled=r,a.node.opacity=r?255:150}}}),cc._RF.pop()},{"./BJProto":"BJProto"}],BJCardsWidgetCtrl:[function(e,t,a){"use strict";cc._RF.push(t,"8d23cfgYMlBnIHqL71J88NR","BJCardsWidgetCtrl");var r=e("./BJGameLogic");cc.Class({extends:cc.Component,properties:{pointRootNode:cc.Node,pointsLabel:cc.Label,showOperationNode:cc.Node,cardNode:cc.Node},onLoad:function(){},initWidget:function(e,t,a){if(this.cardArr=[],this.cardNodeArr=[],e)if(1===e.length&&e.push(0),t){for(var r=function(e,t){o.push(cc.callFunc(function(){i.addCard(e,t)}))},i=this,o=[],n=0;n<e.length;++n)n===e.length-1?r(e[n],a):(r(e[n]),o.push(cc.delayTime(1)));1===o.length?this.node.runAction(o[0]):this.node.runAction(cc.sequence(o))}else{for(var s=0;s<e.length;++s){var c=Global.CCHelper.createSpriteNode("GameCommon/Card/"+(e[s]?e[s]:"card_back"));this.cardNodeArr.push(c),this.cardArr.push(e[s]),c.x=50*(s-e.length/2),c.parent=this.cardNode}this.updatePoints()}},addCard:function(e,t){this.adjustCardPos(),this.cardArr.push(e),this.scheduleOnce(function(){var a=Global.CCHelper.createSpriteNode("GameCommon/Card/card_back");a.x=50*(this.cardNodeArr.length-this.cardNodeArr.length/2),a.parent=this.cardNode,this.cardNodeArr.push(a),0!==e&&this.cardAnimation(a.getComponent(cc.Sprite),e,0,t)}.bind(this),.3)},adjustCardPos:function(){for(var e=0;e<this.cardNodeArr.length;++e){var t=50*(e-this.cardNodeArr.length/2);this.cardNodeArr[e].runAction(cc.moveTo(.25,cc.v2(t,0)))}},stopCard:function(){var e=r.getCardPoint(this.cardArr);this.pointsLabel.string=e.toString(),e>21?(this.pointRootNode.getChildByName("red").active=!0,this.pointRootNode.getChildByName("blue").active=!1,this.pointRootNode.getChildByName("green").active=!1):(this.pointRootNode.getChildByName("red").active=!1,this.pointRootNode.getChildByName("blue").active=!1,this.pointRootNode.getChildByName("green").active=!0)},popCardNode:function(){return this.cardArr.pop(),this.cardNodeArr.pop()},addCardNode:function(e,t){e.parent=this.cardNode,this.cardNodeArr.push(e),this.cardArr.push(t)},showOperation:function(e){},updatePoints:function(){this.pointsLabel.node.parent.active=!0;var e=r.getShowCardPoint(this.cardArr);1===e.length?this.pointsLabel.string=e[0].toString():this.pointsLabel.string=e[1]+"/"+e[0],e[0]>21?(this.pointRootNode.getChildByName("red").active=!0,this.pointRootNode.getChildByName("blue").active=!1,this.pointRootNode.getChildByName("green").active=!1):21===e[0]&&(this.pointsLabel.string=e[0].toString(),this.pointRootNode.getChildByName("red").active=!1,this.pointRootNode.getChildByName("blue").active=!1,this.pointRootNode.getChildByName("green").active=!0)},hidePoints:function(){this.pointsLabel.node.parent.active=!1},cardAnimation:function(e,t,a,r){var i=[],o={x:e.node.x,y:e.node.y},n={x:e.node.scaleX,y:e.node.scaleY};i.push(cc.delayTime(a)),i.push(cc.callFunc(function(){Global.AudioManager.playSound("GameCommon/Sound/flipcard")})),i.push(cc.moveBy(.2,10,o.y)),i.push(cc.spawn([cc.scaleTo(.1,.1,n.y),cc.moveBy(.1,-10,o.y+10)])),i.push(cc.callFunc(function(){Global.CCHelper.updateSpriteFrame("GameCommon/Card/"+t,e)})),i.push(cc.spawn([cc.scaleTo(.1,n.x,n.y),cc.moveTo(.1,o.x,o.y)]));var s=cc.moveTo(.3,o.x,o.y);s.easing(cc.easeBackOut()),i.push(s),i.push(cc.callFunc(function(){this.updatePoints(),Global.Utils.invokeCallback(r)}.bind(this))),e.node.runAction(cc.sequence(i))},showBankerCardArr:function(e,t){this.cardArr.length===e.length&&this.cardArr[this.cardArr.length-1]?Global.Utils.invokeCallback(t):(2===this.cardArr.length&&2===this.cardNodeArr.length||(this.clearWidget(),this.initWidget([e[0]],!1)),this.cardArr[this.cardArr.length-1]=e[this.cardArr.length-1],this.cardAnimation(this.cardNodeArr[this.cardNodeArr.length-1].getComponent(cc.Sprite),this.cardArr[this.cardArr.length-1],0,function(){if(this.cardArr.length===e.length)return this.stopCard(),void Global.Utils.invokeCallback(t);var a=this,r=[];function i(e,t){r.push(cc.callFunc(function(){a.addCard(e,t)}))}for(var o=this.cardArr.length;o<e.length;++o)o===e.length-1?i(e[o],function(){this.stopCard(),Global.Utils.invokeCallback(t)}.bind(this)):(i(e[o]),r.push(cc.delayTime(1)));1===r.length?this.node.runAction(r[0]):this.node.runAction(cc.sequence(r))}.bind(this)))},clearWidget:function(){this.node.stopAllActions(),this.unscheduleAllCallbacks(),this.cardNode.removeAllChildren(),this.cardArr=[],this.cardNodeArr=[],this.pointsLabel.node.parent.active=!1}}),cc._RF.pop()},{"./BJGameLogic":"BJGameLogic"}],BJClockWidgetCtrl:[function(e,t,a){"use strict";cc._RF.push(t,"b0eb0/zzEtBIolbmH6/mlFi","BJClockWidgetCtrl");cc.Class({extends:cc.Component,properties:{timeLabel:cc.Label},onLoad:function(){},startClock:function(e,t,a){this.node.active=!0,this.curIndex=e,this.timeLabel.string=e.toString(),this.schedule(function(){this.curIndex--,this.curIndex<0?(this.unscheduleAllCallbacks(),a(t)):this.timeLabel.string=this.curIndex.toString()}.bind(this),1)},stopClock:function(){this.unscheduleAllCallbacks(),this.node.active=!1}}),cc._RF.pop()},{}],BJGameLogic:[function(e,t,a){"use strict";cc._RF.push(t,"842c9vJ4C9DkaF41aTa5qIR","BJGameLogic");var r=t.exports;r.getCardValue=function(e){var t=15&e;return t>=10&&(t=10),1===t&&(t=11),t},r.getCardPoint=function(e){for(var t=0,a=0,i=0;i<e.length;++i){var o=r.getCardValue(e[i]);11===o&&1==(15&e[i])&&(a+=1),t+=o}return t>21&&(t-=10*a),t},r.getShowCardPoint=function(e){for(var t=0,a=0,i=0;i<e.length;++i){var o=r.getCardValue(e[i]);11===o&&1==(15&e[i])&&(a+=1),t+=o}return t>21&&a?[t-=10*a]:a?[t,t-10*a]:[t]},r.isBurst=function(e){return r.getCardPoint(e)>21},r.isCanCutCard=function(e){return 2===e.length&&r.getCardValue(e[0])===r.getCardValue(e[1])},cc._RF.pop()},{}],BJHandCardWidgetCtrl:[function(e,t,a){"use strict";cc._RF.push(t,"7065ezTr8JMsJJqxiNiQkkI","BJHandCardWidgetCtrl");cc.Class({extends:cc.Component,properties:{cardsWidget:cc.Prefab},onLoad:function(){},initWidget:function(e){if(this.cardsWidgetCtrlArr)for(var t=0;t<this.cardsWidgetCtrlArr.length;++t)this.cardsWidgetCtrlArr[t].node.destroy();if(this.cardsWidgetCtrlArr=[],this.cardDataArr=e||[],this.operationIndex=-1,e){var a=(e[0]?1:0)+(e[1]?1:0);if(e[0]){var r=cc.instantiate(this.cardsWidget),i=r.getComponent("BJCardsWidgetCtrl");this.cardsWidgetCtrlArr.push(i),i.initWidget(e[0],!1),2===a&&(r.x=-80),r.parent=this.node}if(e[1]){var o=cc.instantiate(this.cardsWidget),n=o.getComponent("BJCardsWidgetCtrl");this.cardsWidgetCtrlArr.push(n),n.initWidget(e[1],!1),2===a&&(o.x=80),o.parent=this.node}}},getCardDataArr:function(){return this.cardDataArr},sendCard:function(e,t){this.cardDataArr=e;var a=cc.instantiate(this.cardsWidget),r=a.getComponent("BJCardsWidgetCtrl");this.cardsWidgetCtrlArr.push(r),r.initWidget(e[0],!0,t),a.parent=this.node},addCard:function(e,t,a){this.cardDataArr=t;var r=t[e];this.cardsWidgetCtrlArr[e].addCard(r[r.length-1],a)},cutCard:function(e,t){this.cardDataArr=e;var a=this.cardsWidgetCtrlArr[0].popCardNode(),r=cc.instantiate(this.cardsWidget),i=r.getComponent("BJCardsWidgetCtrl");this.cardsWidgetCtrlArr.push(i),i.initWidget(),r.parent=this.node,i.addCardNode(a,e[1][0]),this.cardsWidgetCtrlArr[0].hidePoints(),this.cardsWidgetCtrlArr[0].node.runAction(cc.sequence([cc.moveTo(.3,cc.v2(-80,0)),cc.delayTime(.2),cc.callFunc(function(){this.cardsWidgetCtrlArr[0].addCard(e[0][1],t)}.bind(this))])),this.cardsWidgetCtrlArr[0].hidePoints(),this.cardsWidgetCtrlArr[1].adjustCardPos(),this.cardsWidgetCtrlArr[1].node.runAction(cc.sequence([cc.moveTo(.3,cc.v2(80,0)),cc.delayTime(.2),cc.callFunc(function(){this.cardsWidgetCtrlArr[1].addCard(e[1][1])}.bind(this))])),a.runAction(cc.moveTo(.3,cc.v2(0,0)))},stopCard:function(e){this.operationIndex=-1,this.cardsWidgetCtrlArr[e].stopCard()},getCurOperationIndex:function(){return this.operationIndex},showOperation:function(e){this.operationIndex=e,this.cardsWidgetCtrlArr[e].showOperation(!0);var t=this.cardsWidgetCtrlArr[(e+1)%2];t&&t.showOperation(!1)},showBankerHandCard:function(e,t){this.cardsWidgetCtrlArr[0].showBankerCardArr(e,t)}}),cc._RF.pop()},{}],BJLEnterGameDialog:[function(e,t,a){"use strict";cc._RF.push(t,"56418in3FdAurgIwEnPMGGF","BJLEnterGameDialog"),cc.Class({extends:cc.Component,properties:{goldLabel:cc.Label,content:cc.Node,item:cc.Prefab},onLoad:function(){var e,t,a;for(this.content.width<300*this.dialogParameters.length&&(this.content.x=(300*this.dialogParameters.length-this.content.width)/2,this.content.width=300*this.dialogParameters.length),e=0;e<this.dialogParameters.length;++e)t=this.dialogParameters[e].gameData,(a=cc.instantiate(this.item)).parent=this.content,a.setPosition(cc.p(-this.content.width/2+300*(e+.5),0)),a.getComponent("BJLGameItem").setData(t,!0);this.goldLabel.string=Global.Player.getPy("gold"),Global.MessageCallback.addListener("SelfEntryRoomPush",this)},onDestroy:function(){Global.MessageCallback.removeListener("SelfEntryRoomPush",this)},messageCallbackHandler:function(t,a){if("SelfEntryRoomPush"===t&&a.kindId===Global.Enum.gameType.BJL){e("./BJLModel").setEntryRoomData(a);Global.CCHelper.loadRes(["BaiJiaLe"],function(){Global.DialogManager.createDialog("BaiJiaLe/BJLMainDialog",null,function(){Global.DialogManager.removeLoadingCircle(),Global.DialogManager.destroyDialog("BaiJiaLe/BJLEnterGameDialog")})})}},onButtonClick:function(e,t){"exit"===t?Global.DialogManager.createDialog("Hall/HallDialog",null,function(){Global.DialogManager.destroyDialog(this)}.bind(this)):"addGold"===t?Global.DialogManager.createDialog("Recharge/RechargeDialog"):"detail"===t&&Global.DialogManager.createDialog("GameCommon/GameRule/GameRuleDialog",{kind:Global.Enum.gameType.BJL})}}),cc._RF.pop()},{"./BJLModel":"BJLModel"}],BJLGameItem:[function(e,t,a){"use strict";cc._RF.push(t,"e24d8U2DqhBpaZhH6XCgU1o","BJLGameItem");var r=e("Lu"),i=e("./BJLLogic"),o=e("./BJLProto"),n=e("../../API/HallAPI");cc.Class({extends:cc.Component,properties:{zhupanContent:cc.Node,daluContent:cc.Node,dayanContent:cc.Node,tanglangContent:cc.Node,xiaoluContent:cc.Node,xianLabel:cc.Label,zhuangLabel:cc.Label,heLabel:cc.Label,stateSprite:cc.Sprite,tickLabel:cc.Label,miLabel:cc.Label,progressbar:cc.ProgressBar,zhupanZhuangNode:cc.Node,zhupanXianNode:cc.Node,zhupanHeNode:cc.Node,daluHongNode:cc.Node,daluLanNode:cc.Node,xiaoluHongNode:cc.Node,xiaoluLanNode:cc.Node,dayanHongNode:cc.Node,dayanLanNode:cc.Node,tanglangHongNode:cc.Node,tanglangLanNode:cc.Node},onLoad:function(){},setData:function(e,t){var a;this.roomId=e.roomId,this.initScene(e.winTypeArr,e.gameStatus,t),e.gameStatus===o.STATUS_POUR?(a="BaiJiaLe/xiazhuzhong",this.tickLabel.node.active=!0):(a="BaiJiaLe/jiesuanzhong",this.tickLabel.node.active=!1),this.progressTick=e.tickTm,this.gameStatus=e.gameStatus;var r=this;if(cc.loader.loadRes(a,cc.SpriteFrame,function(e,t){e?console.log(e):r.stateSprite.spriteFrame=t}),e.gameStatus===o.STATUS_POUR){this.tickTm=e.tickTm,this.tickLabel.string=this.tickTm;this.schedule(function e(){--r.tickTm,r.tickLabel.string=r.tickTm,r.tickTm<=0&&(r.tickLabel.node.active=!1,r.unschedule(e),cc.loader.loadRes("BaiJiaLe/jiesuanzhong",cc.SpriteFrame,function(e,t){e?console.log(e):r.stateSprite.spriteFrame=t}))},1)}this.scheduleOnce(function(){n.getRoomGameDataByRoomID(this.roomId,function(e){r.setData(e.msg.gameData.gameData,!1)})},e.tickTm+.1)},initScene:function(e,t,a){var n,s=[],c=0,l=0,d=0,h=0,u=0;for(n=0;n<e.length;++n)(e[n]&i.WIN_XIANDUI)>0?(s.push(r.TYPE_XIAN|r.TYPE_DUI),++d):(e[n]&i.WIN_XIAN)>0?(s.push(r.TYPE_XIAN),++c):(e[n]&i.WIN_ZHUANGDUI)>0?(s.push(r.TYPE_ZHUANG|r.TYPE_DUI),++h):(e[n]&i.WIN_ZHUANG)>0?(s.push(r.TYPE_ZHUANG),++l):(e[n]&i.WIN_HE)>0&&(s.push(r.TYPE_HU),++u);this.xianLabel.string="\u95f2"+(c+d),this.zhuangLabel.string="\u5e84"+(l+h),this.heLabel.string="\u548c"+u,s.length>0&&(a||t===o.STATUS_RESOUT)&&this.scheduleOnce(function(){this.writeAllRoad(r.getZhupanArr(s))}.bind(this),.1)},writeAllRoad:function(e){var t=r.getDaluArr(e),a=r.getDayanArr(t),i=r.getXiaoluArr(t),o=r.getTanglangArr(t);this.writeZhuPan(e),this.writeDalu(r.getFormatArr(t)),this.writeDayan(r.getFormatArr(a)),this.writeTanglang(r.getFormatArr(o)),this.writeXiaolu(r.getFormatArr(i))},writeZhuPan:function(e){this.zhupanContent.removeAllChildren();var t,a,i,o;e.length>8?(this.zhupanContent.width=33.75*e.length,this.zhupanContent.x=33.75*(8-e.length)/2):(this.zhupanContent.width=270,this.zhupanContent.x=0);var n=-this.zhupanContent.width/2,s=this.zhupanContent.height/2;for(t=0;t<e.length;++t)for(a=0;a<e[t].length;++a)(e[t][a]&r.TYPE_ZHUANG)>0?(i=cc.instantiate(this.zhupanZhuangNode),(e[t][a]&r.TYPE_DUI)>0&&((o=cc.instantiate(this.dayanHongNode)).parent=i,o.setPosition(cc.p(-10,10)))):(e[t][a]&r.TYPE_XIAN)>0?(i=cc.instantiate(this.zhupanXianNode),(e[t][a]&r.TYPE_DUI)>0&&((o=cc.instantiate(this.dayanLanNode)).parent=i,o.setPosition(cc.p(10,-10)))):i=cc.instantiate(this.zhupanHeNode),i.parent=this.zhupanContent,i.x=n+33.75*(t+.5),i.y=s-206/6*(a+.5)},writeDalu:function(e){this.daluContent.removeAllChildren();var t,a,i;e.length>16?(this.daluContent.width=16.875*e.length,this.daluContent.x=16.875*(16-e.length)/2):(this.daluContent.width=270,this.daluContent.x=0);var o=-this.daluContent.width/2,n=this.daluContent.height/2;for(t=0;t<e.length;++t)for(a=0;a<e[t].length;++a)e[t][a]&&(i=(e[t][a]&r.TYPE_ZHUANG)>0?cc.instantiate(this.daluHongNode):cc.instantiate(this.daluLanNode),Math.floor(e[t][a]/r.TYPE_HU)>0&&(i.getChildByName("Label").getComponent(cc.Label).string=Math.floor(e[t][a]/r.TYPE_HU)),i.parent=this.daluContent,i.x=o+16.875*(t+.5),i.y=n-103/6*(a+.5))},writeDayan:function(e){this.dayanContent.removeAllChildren();var t,a,i;e.length>16?(this.dayanContent.width=8.4375*e.length,this.dayanContent.x=8.4375*(16-e.length)/2):(this.dayanContent.width=135,this.dayanContent.x=0);var o=-this.dayanContent.width/2,n=this.dayanContent.height/2;for(t=0;t<e.length;++t)for(a=0;a<e[t].length;++a)e[t][a]&&((i=e[t][a]===r.HONG?cc.instantiate(this.dayanHongNode):cc.instantiate(this.dayanLanNode)).parent=this.dayanContent,i.x=o+8.4375*(t+.5),i.y=n-8.5*(a+.5))},writeXiaolu:function(e){this.xiaoluContent.removeAllChildren();var t,a,i;e.length>16?(this.xiaoluContent.width=8.4375*e.length,this.xiaoluContent.x=8.4375*(16-e.length)/2):(this.xiaoluContent.width=135,this.xiaoluContent.x=0);var o=-this.xiaoluContent.width/2,n=this.xiaoluContent.height/2;for(t=0;t<e.length;++t)for(a=0;a<e[t].length;++a)e[t][a]&&((i=e[t][a]===r.HONG?cc.instantiate(this.xiaoluHongNode):cc.instantiate(this.xiaoluLanNode)).parent=this.xiaoluContent,i.x=o+8.4375*(t+.5),i.y=n-8.5*(a+.5))},writeTanglang:function(e){this.tanglangContent.removeAllChildren();var t,a,i;e.length>16?(this.tanglangContent.width=8.4375*e.length,this.tanglangContent.x=8.4375*(16-e.length)/2):(this.tanglangContent.width=135,this.tanglangContent.x=0);var o=-this.tanglangContent.width/2,n=this.tanglangContent.height/2;for(t=0;t<e.length;++t)for(a=0;a<e[t].length;++a)e[t][a]&&((i=e[t][a]===r.HONG?cc.instantiate(this.tanglangHongNode):cc.instantiate(this.tanglangLanNode)).parent=this.tanglangContent,i.x=o+8.4375*(t+.5),i.y=n-8.5*(a+.5))},onButtonClick:function(e,t){"enter_game"===t&&Global.API.hall.joinRoomRequest(this.roomId)},update:function(e){if(this.gameStatus===o.STATUS_POUR){var t=this.progressTick/o.POUR_TM;this.progressbar.progress=t<=0?0:t,this.progressTick-=e}}}),cc._RF.pop()},{"../../API/HallAPI":"HallAPI","./BJLLogic":"BJLLogic","./BJLProto":"BJLProto",Lu:"Lu"}],BJLLogic:[function(e,t,a){"use strict";cc._RF.push(t,"5affevQLSRAxYtvmhqJm3Jj","BJLLogic");var r=t.exports;r.COLOR_FANGKUAI=0,r.COLOR_CAOHUA=1,r.COLOR_HONGTAO=2,r.COLOR_HEITAO=3,r.RATE_HE=8,r.RATE_ZHUANG=1,r.RATE_XIAN=1,r.RATE_ZHUANGDUI=11,r.RATE_XIANDUI=11,r.WIN_HE=1,r.WIN_ZHUANG=2,r.WIN_XIAN=4,r.WIN_ZHUANGDUI=8,r.WIN_XIANDUI=16,r.getCards=function(){for(var e,t=[];t.length<6;)e=Math.floor(52*Math.random()),t.indexOf(e)<0&&t.push(e);var a=[[],[]];a[0].push(t.pop()),a[0].push(t.pop()),a[1].push(t.pop()),a[1].push(t.pop());var r=(this.getCardCount(a[0][0])+this.getCardCount(a[0][1]))%10,i=(this.getCardCount(a[1][0])+this.getCardCount(a[1][1]))%10;if(r<=5&&a[0].push(t.pop()),r<=6&&i<=6){var o=this.getCardCount(a[0][1]);i<=2?a[1].push(t.pop()):3===i&&8!==o?a[1].push(t.pop()):4===i&&8!==o&&9!==o&&0!==o?a[1].push(t.pop()):(5!==i||4!==o&&5!==o&&6!==o&&7!==o)&&(6!==i||6!==o&&7!==o)||a[1].push(t.pop())}return a},r.getCardCount=function(e){return(e=e%13+1)>=10?0:e},r.getCardArrCount=function(e){var t,a=0;for(t=0;t<e.length;++t)a+=this.getCardCount(e[t]);return a%10},r.getResout=function(e,t){var a,i,o,n={},s=this.getResoutType(e),c={};for(i in t)if(t.hasOwnProperty(i))if(o=this.getRateByType(parseInt(i,10)),(s&r.WIN_HE)>0&&(parseInt(i,10)===this.WIN_XIAN||parseInt(i,10)===this.WIN_ZHUANG));else if((parseInt(i,10)&s)>0)for(a in t[i])t[i].hasOwnProperty(a)&&(c[a]?c[a]+=t[i][a]*o:c[a]=t[i][a]*o);else for(a in t[i])t[i].hasOwnProperty(a)&&(c[a]?c[a]-=t[i][a]:c[a]=-t[i][a]);return n.type=s,n.userWinObj=c,n.cardsArr=e,n},r.getWinLoseGold=function(e,t){var a,i,o,n=this.getResoutType(e),s=0,c=0;for(i in t)if(t.hasOwnProperty(i))if(o=this.getRateByType(parseInt(i,10)),(n&r.WIN_HE)>0&&(parseInt(i,10)===this.WIN_XIAN||parseInt(i,10)===this.WIN_ZHUANG));else if((parseInt(i,10)&n)>0)for(a in t[i])t[i].hasOwnProperty(a)&&(s+=t[i][a]*o);else for(a in t[i])t[i].hasOwnProperty(a)&&(c+=t[i][a]);return{win:s,lose:c}},r.getResoutType=function(e){var t=this.getCardArrCount(e[0]),a=this.getCardArrCount(e[1]),r=0;return t>a?(r|=this.WIN_XIAN,e[0][0]%13==e[0][1]%13&&(r|=this.WIN_XIANDUI)):t<a?(r|=this.WIN_ZHUANG,e[1][0]%13==e[1][1]%13&&(r|=this.WIN_ZHUANGDUI)):r|=this.WIN_HE,r},r.getRateByType=function(e){return e===r.WIN_HE?r.RATE_HE:e===r.WIN_ZHUANG?r.RATE_ZHUANG:e===r.WIN_XIAN?r.RATE_XIAN:e===r.WIN_ZHUANGDUI?r.RATE_ZHUANGDUI:e===r.WIN_XIANDUI?r.RATE_XIANDUI:void 0},cc._RF.pop()},{}],BJLMainDialog:[function(e,t,a){"use strict";cc._RF.push(t,"477f8pYcnFHs7Vz4ateL5bK","BJLMainDialog");var r=e("./BJLLogic"),i=e("./BJLProto"),o=e("../../API/RoomProto"),n=e("../../API/RoomAPI"),s=e("./BJLModel");cc.Class({extends:cc.Component,properties:{gameCommonCtrl:e("GameCommonController"),heLabel:cc.Label,xianLabel:cc.Label,xianDuiLabel:cc.Label,zhuangLabel:cc.Label,zhuangDuiLabel:cc.Label,myHeLabel:cc.Label,myXianLabel:cc.Label,myXianDuiLabel:cc.Label,myZhuangLabel:cc.Label,myZhuangDuiLabel:cc.Label,xianBetRectNode:cc.Node,xianDuiBetRectNode:cc.Node,zhuangBetRectNode:cc.Node,zhuangDuiBetRectNode:cc.Node,heBetRectNode:cc.Node,resoutNode:cc.Node,roadNode:cc.Node,gameCommonRoot:cc.Node},start:function(){this.enableBet=!1,this.gameResultData=null,this.gameInited=!1,n.roomMessageNotify(o.getRoomSceneInfoNotify()),Global.MessageCallback.addListener("RoomMessagePush",this),Global.MessageCallback.addListener("GameMessagePush",this),Global.MessageCallback.addListener("ReConnectSuccess",this)},onDestroy:function(){Global.MessageCallback.removeListener("RoomMessagePush",this),Global.MessageCallback.removeListener("GameMessagePush",this),Global.MessageCallback.removeListener("ReConnectSuccess",this)},messageCallbackHandler:function(e,t){if("RoomMessagePush"===e)t.type===o.USER_LEAVE_ROOM_PUSH?t.data.roomUserInfo.userInfo.uid===s.selfUid&&this.exitGame():t.type===o.GET_ROOM_SCENE_INFO_PUSH&&this.gameInit(t.data.gameData);else if("GameMessagePush"===e){if(!this.gameInited)return;t.type===i.POUR_GOLD_PUSH?(this.userBet(t.data,!0),this.updateBetCount(this.pourGoldObj)):t.type===i.STATUS_PUSH?t.data.gameStatus===i.STATUS_POUR?this.onGameStart():(t.data.gameStatus,i.STATUS_RESOUT):t.type===i.RESOUT_PUSH&&this.onGameEnd(t.data)}else"ReConnectSuccess"===e&&Global.API.hall.joinRoomRequest(s.roomID,function(){this.onReconnection()}.bind(this))},onReconnection:function(){this.enableBet=!1,this.gameResultData=null,this.gameInited=!1,this.node.stopAllActions(),this.updateBetCount(this.pourGoldObj),this.gameCommonCtrl.onReconnection(),n.roomMessageNotify(o.getRoomSceneInfoNotify())},onGameStart:function(){this.pourGoldObj={},this.updateBetCount(null),this.node.stopAllActions(),this.gameCommonCtrl.onGameStart(),this.node.runAction(cc.sequence(cc.delayTime(1),cc.callFunc(this.onBetStart.bind(this)),cc.delayTime(i.POUR_TM),cc.callFunc(this.onBetStop.bind(this)))),this.resoutNode.zIndex=1,this.roadNode.zIndex=2},onBetStart:function(){this.enableBet=!0,this.gameCommonCtrl.onGameBetStart()},onBetStop:function(){this.enableBet=!1,this.gameCommonCtrl.onGameBetEnd(),this.node.stopAllActions()},onGameEnd:function(e){this.gameResultData=e.resout,this.enableBet&&this.onBetStop(),this.node.stopAllActions();var t=e.resout.cardsArr[0].length+e.resout.cardsArr[1].length;this.scheduleOnce(function(){this.onShowResult()}.bind(this),3*t),this.resoutNode.zIndex=2,this.roadNode.zIndex=1},onShowResult:function(){var e=[];for(var t in this.gameResultData.userWinObj)this.gameResultData.userWinObj.hasOwnProperty(t)&&e.push({uid:t,score:this.gameResultData.userWinObj[t]});this.gameCommonCtrl.onGameResult(e)},userBet:function(e,t){var a=cc.rect(0,0,0,0);if(e.direction==r.WIN_XIAN)a=this.xianBetRectNode.getBoundingBox();else if(e.direction==r.WIN_XIANDUI)a=this.xianDuiBetRectNode.getBoundingBox();else if(e.direction==r.WIN_ZHUANG)a=this.zhuangBetRectNode.getBoundingBox();else if(e.direction==r.WIN_ZHUANGDUI)a=this.zhuangDuiBetRectNode.getBoundingBox();else{if(e.direction!=r.WIN_HE)return;a=this.heBetRectNode.getBoundingBox()}this.pourGoldObj[e.direction]||(this.pourGoldObj[e.direction]={}),this.pourGoldObj[e.direction][e.uid]?this.pourGoldObj[e.direction][e.uid]+=e.gold:this.pourGoldObj[e.direction][e.uid]=e.gold,this.gameCommonCtrl.userBet(e.uid,e.gold,a,t)},updateBetCount:function(e){if(!e)return this.xianLabel.string="0",this.xianDuiLabel.string="0",this.zhuangLabel.string="0",this.zhuangDuiLabel.string="0",this.heLabel.string="0",this.myXianLabel.string="\u4e0b\u6ce8:0",this.myXianDuiLabel.string="\u4e0b\u6ce8:0",this.myZhuangLabel.string="\u4e0b\u6ce8:0",this.myZhuangDuiLabel.string="\u4e0b\u6ce8:0",void(this.myHeLabel.string="\u4e0b\u6ce8:0");var t,a,i,o,n=Global.Player.getPy("uid");for(t in e)if(e.hasOwnProperty(t)){for(a in i=0,o=0,e[t])e[t].hasOwnProperty(a)&&(i+=e[t][a]),a===n&&(o+=e[t][a]);t==r.WIN_XIAN?(this.xianLabel.string=i.toString(),this.myXianLabel.string="\u4e0b\u6ce8:"+o.toString()):t==r.WIN_XIANDUI?(this.xianDuiLabel.string=i.toString(),this.myXianDuiLabel.string="\u4e0b\u6ce8:"+o.toString()):t==r.WIN_ZHUANG?(this.zhuangLabel.string=i.toString(),this.myZhuangLabel.string="\u4e0b\u6ce8:"+o.toString()):t==r.WIN_ZHUANGDUI?(this.zhuangDuiLabel.string=i.toString(),this.myZhuangDuiLabel.string="\u4e0b\u6ce8:"+o.toString()):t==r.WIN_HE&&(this.heLabel.string=i.toString(),this.myHeLabel.string="\u4e0b\u6ce8:"+o.toString())}},gameInit:function(e){var t,a;if(this.gameInited=!0,this.gameCommonCtrl.onGameInit(s.profitPercentage,s.kindId),this.pourGoldObj=e.pourGoldObj,this.scheduleOnce(function(){}.bind(this),.5),e.pourGoldObj)for(t in e.pourGoldObj)if(e.pourGoldObj.hasOwnProperty(t))for(a in e.pourGoldObj[t])e.pourGoldObj[t].hasOwnProperty(a)&&this.userBet({uid:a,direction:t,gold:e.pourGoldObj[t][a]},!1);this.updateBetCount(this.pourGoldObj),e.gameStatus===i.STATUS_POUR?this.onGameStart():e.gameStatus===i.STATUS_RESOUT&&(this.resoutNode.zIndex=2,this.roadNode.zIndex=1,this.gameResultData=e.resultData,e.tickTm>2?this.scheduleOnce(function(){this.onShowResult()},e.tickTm-2):this.onShowResult())},betEvent:function(e,t){this.enableBet&&("zhuang"===t?n.gameMessageNotify(i.getPourGoldNotifyData(r.WIN_ZHUANG,this.gameCommonCtrl.getCurChipNumber())):"xian"===t?n.gameMessageNotify(i.getPourGoldNotifyData(r.WIN_XIAN,this.gameCommonCtrl.getCurChipNumber())):"zhuangdui"===t?n.gameMessageNotify(i.getPourGoldNotifyData(r.WIN_ZHUANGDUI,this.gameCommonCtrl.getCurChipNumber())):"xiandui"===t?n.gameMessageNotify(i.getPourGoldNotifyData(r.WIN_XIANDUI,this.gameCommonCtrl.getCurChipNumber())):"hu"===t&&n.gameMessageNotify(i.getPourGoldNotifyData(r.WIN_HE,this.gameCommonCtrl.getCurChipNumber())))},exitGame:function(){Global.DialogManager.createDialog("Hall/HallDialog",null,function(){Global.DialogManager.destroyDialog(this,!0),Global.CCHelper.releaseRes(["BaiJiaLe"])}.bind(this))}}),cc._RF.pop()},{"../../API/RoomAPI":"RoomAPI","../../API/RoomProto":"RoomProto","./BJLLogic":"BJLLogic","./BJLModel":"BJLModel","./BJLProto":"BJLProto",GameCommonController:"GameCommonController"}],BJLModel:[function(e,t,a){"use strict";cc._RF.push(t,"7b494XTT8hCJL5YQlmmL75J","BJLModel");var r=t.exports,i=(e("./BJLProto"),e("./BJLLogic"),e("../../API/RoomProto"),e("../../Shared/enumeration"));r.setEntryRoomData=function(e){this.onLoad(e)},r.onLoad=function(e){var t=e.gameData;this.profitPercentage=t.profitPercentage,this.roomID=t.roomId,this.selfUid=Global.Player.getPy("uid"),this.kindId=i.gameType.BJL},r.onDestroy=function(){},cc._RF.pop()},{"../../API/RoomProto":"RoomProto","../../Shared/enumeration":"enumeration","./BJLLogic":"BJLLogic","./BJLProto":"BJLProto"}],BJLProto:[function(e,t,a){"use strict";cc._RF.push(t,"c89a6Ahg75InbQxg8plc6yy","BJLProto");var r=t.exports;r.POUR_GOLD_NOTIFY=301,r.POUR_GOLD_PUSH=401,r.RESOUT_PUSH=402,r.STATUS_PUSH=403,r.STATUS_NONE=0,r.STATUS_POUR=1,r.STATUS_RESOUT=2,r.POUR_TM=20,r.RESOUT_TM=20,r.getPourGoldNotifyData=function(e,t){return{type:this.POUR_GOLD_NOTIFY,data:{direction:e,gold:t}}},r.getPourGoldPushData=function(e,t,a){return{type:this.POUR_GOLD_PUSH,data:{direction:e,gold:t,uid:a}}},r.getResoutPushData=function(e){return{type:this.RESOUT_PUSH,data:{resout:e}}},r.getStatusPushData=function(e){return{type:this.STATUS_PUSH,data:{gameStatus:e}}},cc._RF.pop()},{}],BJLResoutItem:[function(e,t,a){"use strict";cc._RF.push(t,"70c5anVX15Kna5hlJi6Elbh","BJLResoutItem");var r=e("./BJLLogic"),i=e("./BJLProto"),o=e("../../API/RoomProto");cc.Class({extends:cc.Component,properties:{xianNode:cc.Node,zhuangNode:cc.Node,winSprite:cc.Sprite},onLoad:function(){Global.MessageCallback.addListener("GameMessagePush",this),Global.MessageCallback.addListener("RoomMessagePush",this),this.node.active=!1},onDestroy:function(){Global.MessageCallback.removeListener("GameMessagePush",this),Global.MessageCallback.removeListener("RoomMessagePush",this)},messageCallbackHandler:function(e,t){if("RoomMessagePush"===e)t.type===o.GET_ROOM_SCENE_INFO_PUSH&&(t.data.gameData.gameStatus===i.STATUS_POUR?this.node.active=!1:(this.node.active=!0,this.reconectResout(t.data.gameData.resultData.cardsArr,t.data.gameData.resultData.type)));else if("GameMessagePush"===e)if(t.type===i.RESOUT_PUSH){this.node.active=!0;var a=Global.Player.getPy("uid");this.isWin=!1,t.data.resout.userWinObj[a]&&t.data.resout.userWinObj[a]>0&&(this.isWin=!0),this.showResout(t.data.resout.cardsArr,t.data.resout.type)}else t.type===i.STATUS_PUSH&&t.data.gameStatus===i.STATUS_POUR&&(this.node.active=!1)},showResout:function(e,t){var a=this.xianNode.getChildByName("XianLabel"),i=this.zhuangNode.getChildByName("ZhuangLabel");this.winSprite.node.active=!1,a.active=!1,i.active=!1,this.xianNode.getChildByName("XianSprite").active=!1,this.zhuangNode.getChildByName("ZhuangSprite").active=!1;var o,n=e[0],s=e[1],c=[this.xianNode.getChildByName("Card1"),this.zhuangNode.getChildByName("Card1"),this.xianNode.getChildByName("Card2"),this.zhuangNode.getChildByName("Card2")],l=[n[0],s[0],n[1],s[1]];for(n[2]&&(c.push(this.xianNode.getChildByName("Card3")),l.push(n[2])),s[2]&&(c.push(this.zhuangNode.getChildByName("Card3")),l.push(s[2])),o=1;o<=3;++o)this.xianNode.getChildByName("Card"+o).active=!1,this.zhuangNode.getChildByName("Card"+o).active=!1;for(o=0;o<c.length;++o)Global.CCHelper.updateSpriteFrame("GameCommon/Card/card_back",c[o].getComponent(cc.Sprite));var d=0,h=0,u=-1,g=this;this.schedule(function o(){if(++u>=c.length)return g.unschedule(o),void g.showDotAnimal(t,e);c[u].active=!0,c[u].parent===g.xianNode?u<4?Global.AudioManager.playSound("BaiJiaLe/Audio/player"):8===r.getCardCount(l[u])?Global.AudioManager.playSound("BaiJiaLe/Audio/player_8"):9===r.getCardCount(l[u])?Global.AudioManager.playSound("BaiJiaLe/Audio/player_9"):Global.AudioManager.playSound("BaiJiaLe/Audio/player_add"):u<4?Global.AudioManager.playSound("BaiJiaLe/Audio/banker"):8===r.getCardCount(l[u])?Global.AudioManager.playSound("BaiJiaLe/Audio/banker_8"):8===r.getCardCount(l[u])?Global.AudioManager.playSound("BaiJiaLe/Audio/banker_9"):Global.AudioManager.playSound("BaiJiaLe/Audio/banker_add"),c[u].runAction(cc.sequence(cc.scaleTo(.1,0,1),cc.callFunc(function(){Global.CCHelper.updateSpriteFrame(g.getCardUrl(l[u]),c[u].getComponent(cc.Sprite)),Global.AudioManager.playSound("BaiJiaLe/Audio/flipcard"),c[u].parent==g.xianNode?(d+=r.getCardCount(l[u]),a.active=!0,g.xianNode.getChildByName("XianSprite").active=!0,a.getComponent(cc.Label).string=d%10):(h+=r.getCardCount(l[u]),i.active=!0,g.zhuangNode.getChildByName("ZhuangSprite").active=!0,i.getComponent(cc.Label).string=h%10)}),cc.scaleTo(.1,1,1)))},1.2)},showDotAnimal:function(e,t){var a=0;this.scheduleOnce(function(){Global.AudioManager.playSound("BaiJiaLe/Audio/player")},1),this.scheduleOnce(function(){Global.AudioManager.playSound("BaiJiaLe/Audio/point_"+r.getCardArrCount(t[0]))},2),a=2,this.scheduleOnce(function(){Global.AudioManager.playSound("BaiJiaLe/Audio/banker")},1+a),this.scheduleOnce(function(){Global.AudioManager.playSound("BaiJiaLe/Audio/point_"+r.getCardArrCount(t[1]))},2+a),a+=2,this.scheduleOnce(function(){this.showWinSprite(e)}.bind(this),.5+a),a+=.5},showWinSprite:function(e){this.winSprite.node.active=!0,(e&r.WIN_ZHUANG)>0?Global.CCHelper.updateSpriteFrame("BaiJiaLe/zhuangying",this.winSprite):(e&r.WIN_XIAN)>0?Global.CCHelper.updateSpriteFrame("BaiJiaLe/xianying",this.winSprite):Global.CCHelper.updateSpriteFrame("BaiJiaLe/he",this.winSprite);var t=this;this.winSprite.node.setScale(1.3),this.winSprite.node.runAction(cc.sequence(cc.scaleTo(.2,1,1),cc.callFunc(function(){Global.AudioManager.playSound("BaiJiaLe/Audio/papa")}),cc.delayTime(.5),cc.callFunc(function(){(e&r.WIN_ZHUANG)>0?Global.AudioManager.playSound("BaiJiaLe/Audio/banker_win"):(e&r.WIN_XIAN)>0?Global.AudioManager.playSound("BaiJiaLe/Audio/player_win"):Global.AudioManager.playSound("BaiJiaLe/Audio/tie"),t.isWin&&Global.AudioManager.playSound("BaiJiaLe/Audio/win_game")})))},reconectResout:function(e,t){var a=this.xianNode.getChildByName("XianLabel"),i=this.zhuangNode.getChildByName("ZhuangLabel");this.winSprite.node.active=!0,a.active=!0,i.active=!0,this.xianNode.getChildByName("XianSprite").active=!0,this.zhuangNode.getChildByName("ZhuangSprite").active=!0;var o,n,s=e[0],c=e[1];for(o=0;o<3;++o)n=this.xianNode.getChildByName("Card"+(o+1)),o<s.length?(n.active=!0,Global.CCHelper.updateSpriteFrame(this.getCardUrl(s[o]),n.getComponent(cc.Sprite))):n.active=!1,n=this.zhuangNode.getChildByName("Card"+(o+1)),o<c.length?(n.active=!0,Global.CCHelper.updateSpriteFrame(this.getCardUrl(c[o]),n.getComponent(cc.Sprite))):n.active=!1;var l=0,d=0;for(o=0;o<s.length;++o)l+=r.getCardCount(s[o]);for(o=0;o<c.length;++o)d+=r.getCardCount(c[o]);a.getComponent(cc.Label).string=l,i.getComponent(cc.Label).string=d,(t&r.WIN_ZHUANG)>0?Global.CCHelper.updateSpriteFrame("BaiJiaLe/zhuangying",this.winSprite):(t&r.WIN_XIAN)>0?Global.CCHelper.updateSpriteFrame("BaiJiaLe/xianying",this.winSprite):Global.CCHelper.updateSpriteFrame("BaiJiaLe/he",this.winSprite)},getCardUrl:function(e){var t=e%13+1,a=Math.floor(e/13),r="GameCommon/Card/";return 0===a?r+=t:1===a?r+=16+t:2===a?r+=32+t:3===a&&(r+=48+t),r}}),cc._RF.pop()},{"../../API/RoomProto":"RoomProto","./BJLLogic":"BJLLogic","./BJLProto":"BJLProto"}],BJLRoadItem:[function(e,t,a){"use strict";cc._RF.push(t,"bfba8umCj1FZbGfZYPtUZXa","BJLRoadItem");var r=e("Lu"),i=e("./BJLLogic"),o=e("./BJLProto"),n=e("../../API/RoomProto");cc.Class({extends:cc.Component,properties:{zhupanContent:cc.Node,daluContent:cc.Node,dayanContent:cc.Node,tanglangContent:cc.Node,xiaoluContent:cc.Node,xianLabel:cc.Label,zhuangLabel:cc.Label,xianduiLabel:cc.Label,zhuangduiLabel:cc.Label,heLabel:cc.Label,bajiuLabel:cc.Label,bureauLabel:cc.Label,maskNode:cc.Node,zhupanZhuangNode:cc.Node,zhupanXianNode:cc.Node,zhupanHeNode:cc.Node,daluHongNode:cc.Node,daluLanNode:cc.Node,xiaoluHongNode:cc.Node,xiaoluLanNode:cc.Node,dayanHongNode:cc.Node,dayanLanNode:cc.Node,tanglangHongNode:cc.Node,tanglangLanNode:cc.Node},onLoad:function(){Global.MessageCallback.addListener("RoomMessagePush",this),Global.MessageCallback.addListener("GameMessagePush",this)},onDestroy:function(){Global.MessageCallback.removeListener("RoomMessagePush",this),Global.MessageCallback.removeListener("GameMessagePush",this)},messageCallbackHandler:function(e,t){"RoomMessagePush"===e?t.type===n.GET_ROOM_SCENE_INFO_PUSH&&(this.initScene(t.data.gameData.bajiuCount,t.data.gameData.winTypeArr),this.setRoadMask(t.data.gameData.gameStatus)):"GameMessagePush"===e&&(t.type===o.RESOUT_PUSH?this.scheduleOnce(function(){this.initScene(t.data.resout.bajiuCount,t.data.resout.winTypeArr)}.bind(this),o.RESOUT_TM-2):t.type===o.STATUS_PUSH&&this.setRoadMask(t.data.gameStatus))},setRoadMask:function(e){e===o.STATUS_POUR?this.maskNode.active=!1:e===o.STATUS_RESOUT&&(this.maskNode.active=!0)},initScene:function(e,t){this.bajiuLabel.string=e,this.bureauLabel.string=t.length;var a,o=[],n=0,s=0,c=0,l=0,d=0;for(a=0;a<t.length;++a)(t[a]&i.WIN_XIANDUI)>0?(o.push(r.TYPE_XIAN|r.TYPE_DUI),++c):(t[a]&i.WIN_XIAN)>0?(o.push(r.TYPE_XIAN),++n):(t[a]&i.WIN_ZHUANGDUI)>0?(o.push(r.TYPE_ZHUANG|r.TYPE_DUI),++l):(t[a]&i.WIN_ZHUANG)>0?(o.push(r.TYPE_ZHUANG),++s):(t[a]&i.WIN_HE)>0&&(o.push(r.TYPE_HU),++d);this.xianLabel.string="\u95f2"+n,this.zhuangLabel.string="\u5e84"+s,this.xianduiLabel.string="\u95f2\u5bf9"+c,this.zhuangduiLabel.string="\u5e84\u5bf9"+l,this.heLabel.string="\u548c"+d,o.length>0&&this.writeAllRoad(r.getZhupanArr(o))},writeAllRoad:function(e){var t=r.getDaluArr(e),a=r.getDayanArr(t),i=r.getXiaoluArr(t),o=r.getTanglangArr(t);this.writeZhuPan(e),this.writeDalu(r.getFormatArr(t)),this.writeDayan(r.getFormatArr(a)),this.writeTanglang(r.getFormatArr(o)),this.writeXiaolu(r.getFormatArr(i))},writeZhuPan:function(e){this.zhupanContent.removeAllChildren();var t,a,i,o,n=-this.zhupanContent.width/2,s=this.zhupanContent.height/2;for(e.length>8?(this.zhupanContent.width=33.75*e.length,this.zhupanContent.x=33.75*(8-e.length)/2):(this.zhupanContent.width=270,this.zhupanContent.x=0),t=0;t<e.length;++t)for(a=0;a<e[t].length;++a)(e[t][a]&r.TYPE_ZHUANG)>0?(i=cc.instantiate(this.zhupanZhuangNode),(e[t][a]&r.TYPE_DUI)>0&&((o=cc.instantiate(this.dayanHongNode)).parent=i,o.setPosition(cc.p(-10,10)))):(e[t][a]&r.TYPE_XIAN)>0?(i=cc.instantiate(this.zhupanXianNode),(e[t][a]&r.TYPE_DUI)>0&&((o=cc.instantiate(this.dayanLanNode)).parent=i,o.setPosition(cc.p(10,-10)))):i=cc.instantiate(this.zhupanHeNode),i.parent=this.zhupanContent,i.x=n+33.75*(t+.5),i.y=s-206/6*(a+.5)},writeDalu:function(e){this.daluContent.removeAllChildren();var t,a,i;e.length>16?(this.daluContent.width=16.875*e.length,this.daluContent.x=16.875*(16-e.length)/2):(this.daluContent.width=270,this.daluContent.x=0);var o=-this.daluContent.width/2,n=this.daluContent.height/2;for(t=0;t<e.length;++t)for(a=0;a<e[t].length;++a)e[t][a]&&(i=(e[t][a]&r.TYPE_ZHUANG)>0?cc.instantiate(this.daluHongNode):cc.instantiate(this.daluLanNode),Math.floor(e[t][a]/r.TYPE_HU)>0&&(i.getChildByName("Label").getComponent(cc.Label).string=Math.floor(e[t][a]/r.TYPE_HU)),i.parent=this.daluContent,i.x=o+16.875*(t+.5),i.y=n-103/6*(a+.5))},writeDayan:function(e){this.dayanContent.removeAllChildren();var t,a,i;e.length>16?(this.dayanContent.width=8.4375*e.length,this.dayanContent.x=8.4375*(16-e.length)/2):(this.dayanContent.width=135,this.dayanContent.x=0);var o=-this.dayanContent.width/2,n=this.dayanContent.height/2;for(t=0;t<e.length;++t)for(a=0;a<e[t].length;++a)e[t][a]&&((i=e[t][a]===r.HONG?cc.instantiate(this.dayanHongNode):cc.instantiate(this.dayanLanNode)).parent=this.dayanContent,i.x=o+8.4375*(t+.5),i.y=n-8.5*(a+.5))},writeXiaolu:function(e){this.xiaoluContent.removeAllChildren();var t,a,i;e.length>16?(this.xiaoluContent.width=8.4375*e.length,this.xiaoluContent.x=8.4375*(16-e.length)/2):(this.xiaoluContent.width=135,this.xiaoluContent.x=0);var o=-this.xiaoluContent.width/2,n=this.xiaoluContent.height/2;for(t=0;t<e.length;++t)for(a=0;a<e[t].length;++a)e[t][a]&&((i=e[t][a]===r.HONG?cc.instantiate(this.xiaoluHongNode):cc.instantiate(this.xiaoluLanNode)).parent=this.xiaoluContent,i.x=o+8.4375*(t+.5),i.y=n-8.5*(a+.5))},writeTanglang:function(e){this.tanglangContent.removeAllChildren();var t,a,i;e.length>16?(this.tanglangContent.width=8.4375*e.length,this.tanglangContent.x=8.4375*(16-e.length)/2):(this.tanglangContent.width=135,this.tanglangContent.x=0);var o=-this.tanglangContent.width/2,n=this.tanglangContent.height/2;for(t=0;t<e.length;++t)for(a=0;a<e[t].length;++a)e[t][a]&&((i=e[t][a]===r.HONG?cc.instantiate(this.tanglangHongNode):cc.instantiate(this.tanglangLanNode)).parent=this.tanglangContent,i.x=o+8.4375*(t+.5),i.y=n-8.5*(a+.5))}}),cc._RF.pop()},{"../../API/RoomProto":"RoomProto","./BJLLogic":"BJLLogic","./BJLProto":"BJLProto",Lu:"Lu"}],BJLTickItem:[function(e,t,a){"use strict";cc._RF.push(t,"05292KHBSpIcawECT3WWsFa","BJLTickItem");var r=e("./BJLProto"),i=e("../../API/RoomProto");cc.Class({extends:cc.Component,properties:{tickLabel:cc.Label,stateSprite:cc.Sprite},onLoad:function(){Global.MessageCallback.addListener("GameMessagePush",this),Global.MessageCallback.addListener("RoomMessagePush",this)},onDestroy:function(){Global.MessageCallback.removeListener("GameMessagePush",this),Global.MessageCallback.removeListener("RoomMessagePush",this)},messageCallbackHandler:function(e,t){"RoomMessagePush"===e?t.type===i.GET_ROOM_SCENE_INFO_PUSH&&(t.data.gameData.gameStatus===r.STATUS_POUR?this.startPour(t.data.gameData.tickTm):t.data.gameData.gameStatus===r.STATUS_RESOUT&&this.startResout()):"GameMessagePush"===e&&t.type===r.STATUS_PUSH&&(t.data.gameStatus===r.STATUS_POUR?this.startPour():t.data.gameStatus===r.STATUS_RESOUT&&this.startResout())},startPour:function(e){this.unscheduleAllCallbacks(),this.node.active=!0;var t=e||r.POUR_TM;this.tickLabel.string=t;var a=this;this.schedule(function e(){if(--t<=0)return a.node.active=!1,void a.unschedule(e);a.tickLabel.string=t,t<=3&&Global.AudioManager.playSound("BaiJiaLe/Audio/countdown")},1)},startResout:function(){this.node.active=!1}}),cc._RF.pop()},{"../../API/RoomProto":"RoomProto","./BJLProto":"BJLProto"}],BJMainDialog:[function(e,t,a){"use strict";cc._RF.push(t,"45250aYKDJEmbfzUoJcG9mQ","BJMainDialog");var r=e("../../API/RoomProto"),i=e("./BJProto"),o=e("../../API/RoomAPI"),n=e("./BJGameLogic");cc.Class({extends:cc.Component,properties:{userHeadCtrlArr:[e("GameHeadController")],readyBtnNode:cc.Node,clockWidgetCtrl:e("BJClockWidgetCtrl"),betWidgetCtrl:e("BJBetWidgetCtrl"),handCardWidgetCtrlArr:[e("BJHandCardWidgetCtrl")],bankerHandCardCtrl:e("BJHandCardWidgetCtrl"),operationWidgetCtrl:e("BJOperationWidgetCtrl"),userStatusNodeArr:[cc.Node],showBetWidgetCtrlArr:[e("BJShowBetWidgetCtrl")]},onLoad:function(){this.gameInited=!1,this.myChairID=-1,this.roomID="",this.betCountArr=[0,0,0,0],this.playingStatusArr=[],this.roomUserInfoArr=[],this.betWidgetCtrl.initWidget(),Global.MessageCallback.addListener("RoomMessagePush",this),Global.MessageCallback.addListener("GameMessagePush",this),Global.MessageCallback.addListener("ReConnectSuccess",this),this.scheduleOnce(function(){o.roomMessageNotify(r.getRoomSceneInfoNotify())},.2)},onDestroy:function(){Global.MessageCallback.removeListener("RoomMessagePush",this),Global.MessageCallback.removeListener("GameMessagePush",this),Global.MessageCallback.removeListener("ReConnectSuccess",this)},messageCallbackHandler:function(e,t){if("RoomMessagePush"===e){if(t.type===r.USER_LEAVE_ROOM_RESPONSE)t.data.chairId===this.myChairID&&Global.DialogManager.removeLoadingCircle();else if(t.type===r.OTHER_USER_ENTRY_ROOM_PUSH){if(!this.gameInited)return;this.onUserEntryRoom(t.data.roomUserInfo)}else if(t.type===r.USER_LEAVE_ROOM_PUSH){if(!this.gameInited)return;this.onUserLeaveRoom(t.data.roomUserInfo)}else if(t.type===r.USER_READY_PUSH){if(!this.gameInited)return;this.onUserReady(t.data.chairId)}else if(t.type===r.GET_ROOM_SCENE_INFO_PUSH)this.gameInit(t.data.roomUserInfoArr,t.data.gameData);else if(t.type===r.ROOM_USER_INFO_CHANGE_PUSH){if(!this.gameInited)return;for(var a=0;a<this.roomUserInfoArr.length;++a)if(this.roomUserInfoArr[a].userInfo.uid===t.data.changeInfo.uid){this.roomUserInfoArr[a].userInfo=t.data.changeInfo;break}}}else if("GameMessagePush"===e){if(!this.gameInited)return;t.type===i.GAME_START_PUSH?this.onGameStart(t.data.playingStatusArr):t.type===i.GAME_SEND_CARD_PUSH?this.onGameSendCard(t.data.bankerCardArr,t.data.userCardArr):t.type===i.GAME_USER_BET_PUSH?this.onUserBet(t.data.chairID,t.data.count):t.type===i.GAME_USER_ADD_CARD_PUSH?this.onUserAddCard(t.data.chairID,t.data.index,t.data.userCardArr):t.type===i.GAME_USER_DOUBLE_BET_PUSH?this.onUserDouble(t.data.chairID,t.data.index,t.data.userCardArr):t.type===i.GAME_USER_CUT_CARD_PUSH?this.onUserCutCard(t.data.chairID,t.data.userCardArr):t.type===i.GAME_USER_STOP_CARD_PUSH?this.onUserStopCard(t.data.chairID,t.data.index):t.type===i.GAME_END_PUSH?this.onGameResult(t.data):t.type===i.GAME_USER_BUY_INSURANCE_PUSH?this.onUserBuyInsurance(t.data.chairID,t.data.isBuy):t.type===i.GAME_INSURANCE_RESULT_PUSH&&this.onGameInsuranceResult()}else"ReConnectSuccess"===e&&(Global.Player.isInRoom()?Global.API.hall.joinRoomRequest(this.roomID,function(){o.roomMessageNotify(r.getRoomSceneInfoNotify())},function(){this.exitGame()}.bind(this)):this.exitGame())},onBtnClick:function(e,t){if(this.gameInited)if(Global.AudioManager.playCommonSoundClickButton(),"ready"===t)this.clockWidgetCtrl.stopClock(),this.readyBtnNode.active=!1,this.resetGame(),o.roomMessageNotify(r.userReadyNotify(!0));else if("exit"===t){if(!this.gameInited)return;Global.DialogManager.addPopDialog("\u786e\u8ba4\u9000\u51fa\u6e38\u620f?",function(){Global.Player.getPy("roomID")?(o.roomMessageNotify(r.userLeaveRoomNotify()),Global.DialogManager.addLoadingCircle()):this.exitGame()}.bind(this),function(){})}else"settings"===t?Global.DialogManager.createDialog("Setting/SettingDialog"):"help"===t&&Global.DialogManager.createDialog("GameCommon/GameRule/GameRuleDialog",{kind:this.gameTypeInfo.kind})},gameInit:function(e,t){this.gameInited=!0,this.gameTypeInfo=t.gameTypeInfo;for(var a=0;a<e.length;++a){var r=e[a];if(r.userInfo.uid===Global.Player.getPy("uid")){this.myChairID=r.chairId;break}}for(var o=0;o<e.length;++o)this.onUserEntryRoom(e[o]);if(this.profitPercentage=t.profitPercentage,t.gameStatus===i.gameStatus.NONE)this.readyBtnNode.active=!0,this.clockWidgetCtrl.startClock(i.OPERATION_TIME,"ready",this.autoOperation.bind(this));else if(t.gameStatus===i.gameStatus.WAIT_BET){var n=t.betCountArr;this.betCountArr=n,this.playingStatusArr=t.playingStatusArr;for(var s=0;s<n.length;++s)if(this.playingStatusArr[s]){var c=this.getUserChairIndex(s),l=this.userHeadCtrlArr[c];this.showBetWidgetCtrlArr[c].initWidget(l.getHeadPos(),n[s]),n[s]?(this.updateUserStatus(this.myChairID,null),l.goldChange(-n[s],!1)):(this.updateUserStatus(this.myChairID,"bet"),s===this.myChairID&&(this.betWidgetCtrl.startBet(l.getUserInfo().gold,this.selfBet.bind(this)),this.clockWidgetCtrl.startClock(i.OPERATION_TIME,"bet",this.autoOperation.bind(this))))}}else if(t.gameStatus===i.gameStatus.WAIT_BUY_INSURANCE){this.betCountArr=t.betCountArr,this.playingStatusArr=t.playingStatusArr;var d=t.allUserCardArr;this.bankerHandCardCtrl.initWidget([t.bankerCardArr,null]);for(var h=0;h<this.playingStatusArr.length;++h)if(this.playingStatusArr[h]){var u=this.getUserChairIndex(h);this.handCardWidgetCtrlArr[u].initWidget(d[h]);var g=this.userHeadCtrlArr[u].getHeadPos();this.showBetWidgetCtrlArr[u].initWidget(g,t.betCountArr[h]);var C=0;C+=this.betCountArr[h],t.buyInsuranceStatus[h]&&(C+=.5*this.betCountArr[h]),this.userHeadCtrlArr[u].goldChange(-C,!1)}null===t.buyInsuranceStatus[this.myChairID]&&this.playingStatusArr[this.myChairID]&&(Global.DialogManager.addPopDialog("\u5e84\u5bb6\u53ef\u80fd\u4f1a\u62ff\u5230\u9ed1\u6770\u514b\uff0c\u662f\u5426\u8d2d\u4e70\u4fdd\u9669\uff1f",function(){this.selfBuyInsurance(!0)}.bind(this),function(){this.selfBuyInsurance(!1)}.bind(this)),this.clockWidgetCtrl.startClock(i.OPERATION_TIME,"insurance",this.autoOperation.bind(this)))}else if(t.gameStatus===i.gameStatus.PLAYING){var p=t.allUserCardArr,f=t.stopCardStatusArr;this.betCountArr=t.betCountArr,this.playingStatusArr=t.playingStatusArr,this.bankerHandCardCtrl.initWidget([t.bankerCardArr,null]);for(var m=0;m<this.playingStatusArr.length;++m)if(this.playingStatusArr[m]){var A=this.getUserChairIndex(m);this.handCardWidgetCtrlArr[A].initWidget(p[m]);var b=this.userHeadCtrlArr[A].getHeadPos(),y=p[m][0]?1:0+!!p[m][1]?1:0;this.showBetWidgetCtrlArr[A].initWidget(b,t.betCountArr[m],t.doubleBetStatusArr[m][0],y>1);var T=0;T+=this.betCountArr[m],t.doubleBetStatusArr[m][0]&&(T+=this.betCountArr[m]),p[m][1]&&(T+=this.betCountArr[m]),t.buyInsuranceStatus[m]&&(T+=.5*this.betCountArr[m]),this.userHeadCtrlArr[A].goldChange(-T,!1),!1===f[m][0]||!1===f[m][1]?(this.updateUserStatus(m,"addCard"),this.startNext(m,f[m][0]?1:0)):this.updateUserStatus(m,"stopCard"),f[m][0]&&this.handCardWidgetCtrlArr[A].stopCard(0),f[m][1]&&this.handCardWidgetCtrlArr[A].stopCard(1)}}},resetGame:function(){this.bankerHandCardCtrl.initWidget();for(var e=0;e<this.handCardWidgetCtrlArr.length;++e)this.handCardWidgetCtrlArr[e].initWidget(),this.showBetWidgetCtrlArr[e].initWidget()},onReconnection:function(){this.resetGame(),o.roomMessageNotify(r.getRoomSceneInfoNotify())},onUserEntryRoom:function(e){var t=this.getUserChairIndex(e.chairId);this.userHeadCtrlArr[t].updateInfo(e.userInfo),0!=(e.userStatus&r.userStatusEnum.READY)&&0==(e.userStatus&r.userStatusEnum.PLAYING)&&this.onUserReady(e.chairId),this.roomUserInfoArr[e.chairId]=e},onUserLeaveRoom:function(e){if(e.chairId===this.myChairID)this.exitGame();else{var t=this.getUserChairIndex(e.chairId);this.userHeadCtrlArr[t].updateInfo(null),this.updateUserStatus(e.chairId,null),this.roomUserInfoArr[e.chairId]=null}},updateUserInfo:function(){for(var e=0;e<4;++e){var t=this.roomUserInfoArr[e];if(t){var a=this.getUserChairIndex(e);this.userHeadCtrlArr[a].updateInfo(t.userInfo)}}},onUserReady:function(e){this.updateUserStatus(e,"ready")},onGameStart:function(e){this.clearState(),this.playingStatusArr=e,this.clockWidgetCtrl.startClock(i.OPERATION_TIME,"bet",this.autoOperation.bind(this));var t=this.getUserChairIndex(this.myChairID),a=this.userHeadCtrlArr[t];this.betWidgetCtrl.startBet(a.getUserInfo().gold,this.selfBet.bind(this));for(var r=0;r<this.playingStatusArr.length;++r)if(this.playingStatusArr[r]){var o=this.getUserChairIndex(r),n=this.userHeadCtrlArr[o].getHeadPos();this.showBetWidgetCtrlArr[o].initWidget(n)}},selfBet:function(e,t){var a=this.getUserChairIndex(this.myChairID);if("add"===e)this.showBetWidgetCtrlArr[a].addBetCount(t),this.userHeadCtrlArr[a].goldChange(-t,!1);else if("bet"===e){var r=this.betWidgetCtrl.getCurBetCount();if(0===r)return;this.updateUserStatus(this.myChairID,"alreadyBet"),this.betWidgetCtrl.stopBet(),this.clockWidgetCtrl.stopClock(),o.gameMessageNotify(i.gameUserBetNotify(r))}else if("clean"===e){var n=this.betWidgetCtrl.getCurBetCount();n>0&&(this.showBetWidgetCtrlArr[a].cleanBet(!0),this.userHeadCtrlArr[a].goldChange(n,!1))}else if("autoBet"===e){var s=this.betWidgetCtrl.getCurBetCount();s>0&&(this.showBetWidgetCtrlArr[a].cleanBet(!0),this.userHeadCtrlArr[a].goldChange(s,!1)),s=this.betWidgetCtrl.getMinBetCount(),this.showBetWidgetCtrlArr[a].betCount(s),this.userHeadCtrlArr[a].goldChange(-s,!1),this.updateUserStatus(this.myChairID,"alreadyBet"),this.betWidgetCtrl.stopBet(),this.clockWidgetCtrl.stopClock(),o.gameMessageNotify(i.gameUserBetNotify(s))}},onUserBet:function(e,t){this.betCountArr[e]=t;var a=this.getUserChairIndex(e);e!==this.myChairID&&(this.updateUserStatus(e,"alreadyBet"),this.showBetWidgetCtrlArr[a].betCount(t),this.userHeadCtrlArr[a].goldChange(-t,!1))},selfBuyInsurance:function(e){e&&(this.userHeadCtrlArr[this.getUserChairIndex(this.myChairID)].userInfo.gold<this.betCountArr[this.myChairID]?(e=!1,Global.DialogManager.addPopDialog("\u91d1\u5e01\u4e0d\u8db3\u65e0\u6cd5\u8d2d\u4e70\u4fdd\u9669")):this.userHeadCtrlArr[this.getUserChairIndex(this.myChairID)].goldChange(.5*-this.betCountArr[this.myChairID],!1));this.clockWidgetCtrl.stopClock(),o.gameMessageNotify(i.gameUserByInsuranceNotify(e))},onUserBuyInsurance:function(e,t){e!==this.myChairID&&t&&this.userHeadCtrlArr[this.getUserChairIndex(e)].goldChange(.5*-this.betCountArr[e],!1)},onGameSendCard:function(e,t){this.bankerHandCardCtrl.initWidget(),this.bankerHandCardCtrl.sendCard([e,null]);for(var a=0;a<this.playingStatusArr.length;++a)if(this.playingStatusArr[a]){var r=this.getUserChairIndex(a);this.handCardWidgetCtrlArr[r].initWidget(),a===this.myChairID?this.handCardWidgetCtrlArr[r].sendCard(t[a],function(){11===n.getCardValue(e[0])?(Global.DialogManager.addPopDialog("\u5e84\u5bb6\u53ef\u80fd\u4f1a\u62ff\u5230\u9ed1\u6770\u514b\uff0c\u662f\u5426\u8d2d\u4e70\u4fdd\u9669\uff1f",function(){this.selfBuyInsurance(!0)}.bind(this),function(){this.selfBuyInsurance(!1)}.bind(this)),this.clockWidgetCtrl.startClock(i.OPERATION_TIME,"insurance",this.autoOperation.bind(this))):21!==n.getCardPoint(e)&&this.startNext(this.myChairID,0)}.bind(this)):this.handCardWidgetCtrlArr[r].sendCard(t[a])}},onGameInsuranceResult:function(){this.startNext(this.myChairID,0)},userOperation:function(e,t){var a=this.getUserChairIndex(this.myChairID);if("addCard"===e)this.operationWidgetCtrl.stopOperation(),o.gameMessageNotify(i.gameUserAddCardNotify(t));else if("stopCard"===e){o.gameMessageNotify(i.gameUserStopCardNotify(t)),this.handCardWidgetCtrlArr[a].getCardDataArr()[t+1]||this.updateUserStatus(this.myChairID,"stopCard")}else"double"===e?o.gameMessageNotify(i.gameUserDoubleBetNotify(t)):"cutCard"===e&&o.gameMessageNotify(i.gameUserCutCardNotify());this.operationWidgetCtrl.stopOperation(),this.clockWidgetCtrl.stopClock()},startNext:function(e,t){if(2!==t){var a=this.getUserChairIndex(e),r=this.handCardWidgetCtrlArr[a].getCardDataArr();if(r[t]){if(n.getCardPoint(r[t])>=21)if(r[t+1]){if(this.myChairID===e){this.handCardWidgetCtrlArr[a].showOperation(t+1),this.operationWidgetCtrl.startOperation(["addCard","stopCard"],t+1,this.userOperation.bind(this)),this.clockWidgetCtrl.startClock(i.OPERATION_TIME,"stopCard",this.autoOperation.bind(this))}}else this.updateUserStatus(e,"stopCard");else if(this.myChairID===e){var o=["addCard","stopCard"];this.userHeadCtrlArr[this.getUserChairIndex(this.myChairID)].userInfo.gold>=this.betCountArr[this.myChairID]&&2===r[t].length&&!r[1]&&(o.push("double"),n.isCanCutCard(r[0])&&o.push("cutCard")),this.handCardWidgetCtrlArr[a].showOperation(t),this.operationWidgetCtrl.startOperation(o,t,this.userOperation.bind(this)),this.clockWidgetCtrl.startClock(i.OPERATION_TIME,"stopCard",this.autoOperation.bind(this))}}else this.updateUserStatus(e,"stopCard")}else this.updateUserStatus(e,"stopCard")},onUserAddCard:function(e,t,a){var r=this.getUserChairIndex(e);this.handCardWidgetCtrlArr[r].addCard(t,a,function(){this.startNext(e,t)}.bind(this))},onUserStopCard:function(e,t){this.handCardWidgetCtrlArr[this.getUserChairIndex(e)].stopCard(t),this.startNext(e,t+1)},onUserDouble:function(e,t,a){var r=this.getUserChairIndex(e);this.showBetWidgetCtrlArr[r].double(),this.userHeadCtrlArr[r].goldChange(-this.betCountArr[e],!1),this.handCardWidgetCtrlArr[r].addCard(t,a,function(){this.onUserStopCard(e,t)}.bind(this))},onUserCutCard:function(e,t){var a=this.getUserChairIndex(e),r=this.handCardWidgetCtrlArr[a];this.showBetWidgetCtrlArr[a].cutCard(),this.userHeadCtrlArr[a].goldChange(-this.betCountArr[e],!1),r.cutCard(t,function(){this.startNext(e,0)}.bind(this))},autoOperation:function(e){if("bet"===e)this.selfBet("autoBet",this.betWidgetCtrl.getMinBetCount());else if("stopCard"===e){var t=this.handCardWidgetCtrlArr[this.getUserChairIndex(this.myChairID)].getCurOperationIndex();this.userOperation("stopCard",t)}else"ready"===e?(Global.DialogManager.addLoadingCircle(),o.roomMessageNotify(r.userLeaveRoomNotify())):"insurance"===e&&this.selfBuyInsurance(!1)},updateUserStatus:function(e,t){if(!t||"ready"===t)for(var a=this.getUserChairIndex(e),r=this.userStatusNodeArr[a],i=0;i<r.children.length;++i)r.children[i].active=r.children[i].name===t},onGameResult:function(e){this.scheduleOnce(function(){this.bankerHandCardCtrl.showBankerHandCard(e.bankerCardArr,function(){this.bankerHandCardCtrl.stopCard(0);for(var t=0;t<e.scoreChangeArr.length;++t){var a=e.scoreChangeArr[t];if(a){var r=this.getUserChairIndex(t);a>0?(this.userHeadCtrlArr[r].goldChange(a*(1-this.profitPercentage/100),!0),t===this.myChairID&&Global.AudioManager.playSound("GameCommon/Sound/win_game")):this.userHeadCtrlArr[r].goldChange(a,!0)}}this.updateUserInfo(),this.operationWidgetCtrl.stopOperation(),this.clockWidgetCtrl.stopClock(),this.betWidgetCtrl.stopBet(),this.readyBtnNode.active=!0,this.clockWidgetCtrl.startClock(i.OPERATION_TIME,"ready",this.autoOperation.bind(this))}.bind(this))}.bind(this),1)},getUserChairIndex:function(e){return(e-this.myChairID+4)%4},clearState:function(){for(var e=0;e<4;++e)this.updateUserStatus(e,null)},exitGame:function(){Global.DialogManager.createDialog("Hall/HallDialog",null,function(){Global.DialogManager.destroyDialog(this,!0),Global.CCHelper.releaseRes(["Game/BlackJack"])}.bind(this))}}),cc._RF.pop()},{"../../API/RoomAPI":"RoomAPI","../../API/RoomProto":"RoomProto","./BJGameLogic":"BJGameLogic","./BJProto":"BJProto",BJBetWidgetCtrl:"BJBetWidgetCtrl",BJClockWidgetCtrl:"BJClockWidgetCtrl",BJHandCardWidgetCtrl:"BJHandCardWidgetCtrl",BJOperationWidgetCtrl:"BJOperationWidgetCtrl",BJShowBetWidgetCtrl:"BJShowBetWidgetCtrl",GameHeadController:"GameHeadController"}],BJOperationWidgetCtrl:[function(e,t,a){"use strict";cc._RF.push(t,"aae85faEqxLYbrLhZ55l9oN","BJOperationWidgetCtrl");cc.Class({extends:cc.Component,properties:{addCard:cc.Node,stopCard:cc.Node,double:cc.Node,cutCard:cc.Node},onLoad:function(){},startOperation:function(e,t,a){this.node.active=!0,this.index=t,this.callback=a,this.addCard.getComponent(cc.Button).enabled=!1,this.addCard.opacity=150,this.stopCard.getComponent(cc.Button).enabled=!1,this.stopCard.opacity=150,this.double.getComponent(cc.Button).enabled=!1,this.double.opacity=150,this.cutCard.getComponent(cc.Button).enabled=!1,this.cutCard.opacity=150;for(var r=0;r<e.length;++r)this[e[r]].getComponent(cc.Button).enabled=!0,this[e[r]].opacity=255},stopOperation:function(){this.node.active=!1},onBtnClick:function(e,t){Global.AudioManager.playCommonSoundClickButton(),this.callback(t,this.index)}}),cc._RF.pop()},{}],BJProto:[function(e,t,a){"use strict";cc._RF.push(t,"1b5e79SI7xC36zraJQkw9RJ","BJProto");var r=t.exports;r.GAME_USER_BET_NOTIFY=301,r.GAME_USER_BET_PUSH=401,r.GAME_USER_CUT_CARD_NOTIFY=302,r.GAME_USER_CUT_CARD_PUSH=402,r.GAME_USER_DOUBLE_BET_NOTIFY=303,r.GAME_USER_DOUBLE_BET_PUSH=403,r.GAME_USER_ADD_CARD_NOTIFY=304,r.GAME_USER_ADD_CARD_PUSH=404,r.GAME_USER_STOP_CARD_NOTIFY=305,r.GAME_USER_STOP_CARD_PUSH=405,r.GAME_USER_BUY_INSURANCE_NOTIFY=309,r.GAME_USER_BUY_INSURANCE_PUSH=409,r.GAME_START_PUSH=406,r.GAME_SEND_CARD_PUSH=407,r.GAME_END_PUSH=408,r.GAME_INSURANCE_RESULT_PUSH=410,r.gameStatus={NONE:0,WAIT_BET:1,PLAYING:2,WAIT_BUY_INSURANCE:3},r.OPERATION_TIME=15,r.NEXT_ROUND_TIME=15,r.chipAmount=[1,10,50,100,500],r.CHIP_NUMBER={btc:[5e-5,5e-4,.0025,.005,.02],ida:[2,20,100,200,1e3],usdt:[1,10,50,100,500],lbcn:[1,10,50,100,500],eth:[.001,.01,.05,.1,.5],eos:[.05,.5,2.5,5,25],vtt:[1,10,50,100,500]},r.gameStartPush=function(e){return{type:this.GAME_START_PUSH,data:{playingStatusArr:e}}},r.gameUserBetNotify=function(e){return{type:this.GAME_USER_BET_NOTIFY,data:{count:e}}},r.gameUserBetPush=function(e,t){return{type:this.GAME_USER_BET_PUSH,data:{chairID:e,count:t}}},r.gameSendCardPush=function(e,t){return{type:this.GAME_SEND_CARD_PUSH,data:{bankerCardArr:e,userCardArr:t}}},r.gameUserCutCardNotify=function(){return{type:this.GAME_USER_CUT_CARD_NOTIFY,data:{}}},r.gameUserCutCardPush=function(e,t){return{type:this.GAME_USER_CUT_CARD_PUSH,data:{chairID:e,userCardArr:t}}},r.gameUserDoubleBetNotify=function(e){return{type:this.GAME_USER_DOUBLE_BET_NOTIFY,data:{index:e}}},r.gameUserDoubleBetPush=function(e,t,a){return{type:this.GAME_USER_DOUBLE_BET_PUSH,data:{chairID:e,index:t,userCardArr:a}}},r.gameUserAddCardNotify=function(e){return{type:this.GAME_USER_ADD_CARD_NOTIFY,data:{index:e}}},r.gameUserAddCardPush=function(e,t,a){return{type:this.GAME_USER_ADD_CARD_PUSH,data:{index:t,chairID:e,userCardArr:a}}},r.gameUserStopCardNotify=function(e){return{type:this.GAME_USER_STOP_CARD_NOTIFY,data:{index:e}}},r.gameUserStopCardPush=function(e,t){return{type:this.GAME_USER_STOP_CARD_PUSH,data:{index:t,chairID:e}}},r.gameResultPush=function(e,t,a){return{type:this.GAME_END_PUSH,data:{bankerCardArr:e,allCardArr:t,scoreChangeArr:a}}},r.gameUserByInsuranceNotify=function(e){return{type:this.GAME_USER_BUY_INSURANCE_NOTIFY,data:{isBuy:e}}},r.gameUserByInsurancePush=function(e,t){return{type:this.GAME_USER_BUY_INSURANCE_PUSH,data:{chairID:e,isBuy:t}}},r.gameInsuranceResultPush=function(){return{type:this.GAME_INSURANCE_RESULT_PUSH,data:{}}},cc._RF.pop()},{}],BJShowBetWidgetCtrl:[function(e,t,a){"use strict";cc._RF.push(t,"77a90Mr5dtOaYhHbEbpsBYb","BJShowBetWidgetCtrl");var r=e("./BJProto").chipAmount;cc.Class({extends:cc.Component,properties:{showBetCountWidget:cc.Prefab},onLoad:function(){this.chipNumberArr=r,this.betNodeArr=[],this.totalBetNodeCount=0,this.totalBetCount=0},initWidget:function(e,t,a,r){if(this.cleanBet(!0),this.betNodeArr=[],this.headPos=e,t){var i=this.createBetNodes(t);if(r){i.parent=this.node,i.position=cc.v2(-80,0),this.betNodeArr.push(i);var o=cc.instantiate(this.showBetCountWidget);o.getChildByName("betCount").getComponent(cc.Label).string=parseFloat(t.toFixed(8)).toString(),o.parent=i;var n=cc.instantiate(i);n.parent=this.node,n.position=cc.v2(80,0),this.betNodeArr.push(i)}else{i.parent=this.node,i.position=cc.v2(0,0),this.betNodeArr.push(i);var s=cc.instantiate(this.showBetCountWidget);if(s.getChildByName("betCount").getComponent(cc.Label).string=parseFloat(t.toFixed(8)).toString(),s.parent=i,a){var c=cc.instantiate(i);c.parent=this.node,c.position=cc.v2(50,0),this.betNodeArr.push(i)}}}},createBetNodes:function(e){for(var t=new cc.Node,a=this.chipNumberArr.length-1;a>=0;--a)for(var r=this.chipNumberArr[a],i=Math.floor(e/r);i-- >0;){e-=r;var o=this.createBetNode(a);this.totalBetNodeCount>10?o.y=50:o.y=5*this.totalBetNodeCount,o.parent=t,this.totalBetNodeCount++}return t},createBetNode:function(e){var t=Global.CCHelper.createSpriteNode("GameCommon/chip_"+this.chipNumberArr[e]);return t.scale=.4,t},betCount:function(e){if(e){var t=this.createBetNodes(e);t.position=this.headPos,t.parent=this.node,this.betNodeArr.push(t);var a=cc.instantiate(this.showBetCountWidget);a.getChildByName("betCount").getComponent(cc.Label).string=parseFloat(e.toFixed(8)).toString(),a.parent=t,t.runAction(cc.moveTo(.3,cc.v2(0,0)))}},addBetCount:function(e){for(var t=0,a=this.chipNumberArr.length-1;a>=0;--a)if(this.chipNumberArr[a]===e){t=a;break}var r=this.createBetNode(t);r.position=this.headPos,r.parent=this.node;var i=void 0;i=this.totalBetNodeCount>10?50:5*this.totalBetNodeCount,this.totalBetNodeCount++,this.totalBetCount+=e,r.runAction(cc.sequence([cc.moveTo(.3,cc.v2(0,i)),cc.callFunc(function(){this.cleanBet(!1);var e=this.createBetNodes(this.totalBetCount);e.parent=this.node,this.betNodeArr.push(e);var t=cc.instantiate(this.showBetCountWidget);t.getChildByName("betCount").getComponent(cc.Label).string=parseFloat(this.totalBetCount.toFixed(2)).toString(),t.parent=e,r.removeFromParent()}.bind(this))]))},cleanBet:function(e){for(var t=0;t<this.betNodeArr.length;++t)this.betNodeArr[t].removeFromParent();this.betNodeArr=[];for(var a=0;a<this.node.children.length;++a){var r=this.node.children[a];"betCount"!==r.name&&r.destroy()}this.totalBetNodeCount=0,e&&(this.totalBetCount=0)},double:function(){var e=cc.instantiate(this.betNodeArr[0]);e.position=this.headPos,e.parent=this.node,this.betNodeArr.push(e),e.runAction(cc.moveTo(.3,cc.v2(70,0)))},cutCard:function(){var e=cc.instantiate(this.betNodeArr[0]);e.position=this.headPos,e.parent=this.node,this.betNodeArr.push(e),this.betNodeArr[0].runAction(cc.moveTo(.3,cc.v2(-80,0))),e.runAction(cc.moveTo(.3,cc.v2(80,0)))}}),cc._RF.pop()},{"./BJProto":"BJProto"}],BRNNCardWidgetCtrl:[function(e,t,a){"use strict";cc._RF.push(t,"b6fe9JcT1JB66bdGJMmvdbK","BRNNCardWidgetCtrl"),cc.Class({extends:cc.Component,properties:{cardSpriteArr:[cc.Sprite],cardTypeSprite:cc.Sprite},onLoad:function(){this.cardPosArr=[];for(var e=0;e<this.cardSpriteArr.length;++e)this.cardPosArr[e]=this.cardSpriteArr[e].node.position},sendCard:function(e,t){this.resetWidget(),this.node.active=!0,this.cardTypeSprite.node.parent.active=!1;for(var a=0;a<this.cardSpriteArr.length;++a)this.cardSpriteArr[a].node.active=!0;if(t)for(var r=this.node.parent.parent.convertToWorldSpaceAR(cc.v2(0,0)),i=0;i<this.cardSpriteArr.length;++i){var o=this.cardSpriteArr[i].node;o.position=this.node.convertToNodeSpaceAR(r);var n=cc.moveTo(.35,this.cardPosArr[i]);o.runAction(cc.sequence([cc.delayTime(.03*i+.2*e+.5),n]))}},showCard:function(e,t,a){this.resetWidget();var r=this;function i(e,t,i,o){r.node.active=!0,t.node.active=!0,t.node.runAction(cc.sequence([cc.delayTime(.7*a+1),cc.moveTo(.3,cc.v2(0,0)),cc.callFunc(function(){Global.CCHelper.updateSpriteFrame("GameCommon/Card/"+e,t)}.bind(r)),cc.delayTime(.05),cc.moveTo(.3,i),cc.callFunc(function(){null!==o&&Global.CCHelper.updateSpriteFrame("Game/BaiRenNiuNiu/win_"+o,r.cardTypeSprite,function(){r.cardTypeSprite.node.parent.active=!0}.bind(r))}.bind(r))]))}for(var o=0;o<this.cardSpriteArr.length;++o)i(e[o],this.cardSpriteArr[o],this.cardPosArr[o],0===o?t:null)},resetWidget:function(){for(var e=0;e<this.cardSpriteArr.length;++e)this.cardSpriteArr[e].node.active=!1,Global.CCHelper.updateSpriteFrame("GameCommon/Card/card_back",this.cardSpriteArr[e]),this.cardSpriteArr[e].node.stopAllActions(),this.cardSpriteArr[e].node.position=this.cardPosArr[e];this.cardTypeSprite.node.parent.active=!1,this.node.active=!1}}),cc._RF.pop()},{}],BRNNClockWidgetCtrl:[function(e,t,a){"use strict";cc._RF.push(t,"7f162+DCdZNKr4r5StTOWQp","BRNNClockWidgetCtrl"),cc.Class({extends:cc.Component,properties:{timeLabel:cc.Label,tipsLabel:cc.Label},start:function(){},startClock:function(e,t){this.time=e,this.tipsLabel.string=t,this.unscheduleAllCallbacks(),this.timeLabel.string=this.time.toString(),this.schedule(function(){this.time--,this.time>=0?this.timeLabel.string=this.time.toString():this.unscheduleAllCallbacks()}.bind(this),1)},resetWidget:function(){this.tipsLabel.string="",this.timeLabel.string="15",this.unscheduleAllCallbacks()}}),cc._RF.pop()},{}],BRNNGameCommonCtrl:[function(e,t,a){"use strict";cc._RF.push(t,"c6ebaPS5gFB4IgKSRXbL8gV","BRNNGameCommonCtrl");var r=e("../../API/RoomProto"),i=.4;cc.Class({extends:cc.Component,properties:{gameHeadRichCtrlArr:[e("GameHeadController")],gameHeadSelfCtrl:e("GameHeadController"),gameHeadShenSuanZiCtrl:e("GameHeadController"),onlineNode:cc.Node,betRootNode:cc.Node,chipNodeArr:[cc.Node],selectChipButtonArr:[cc.Button],betStartTipNode:cc.Node,betStopTipNode:cc.Node,waitTipNode:cc.Node,tipBgNode:cc.Node},start:function(){this.otherUserBetActionStartPos=Global.CCHelper.getRelativePosition(this.onlineNode,this.betRootNode),this.chipNumberArr=[1,10,50,100,500],this.curSelectedChipIndex=0,this.chipArr=[];for(var e=0;e<this.selectChipButtonArr.length;++e)this.selectChipButtonArr[e].enabled=!1,this.selectChipButtonArr[e].node.opacity=150;this.userBetCountList={},this.profitPercentage=0,this.kindID=0,this.selectedChipArr=[];for(var t=0;t<this.chipNumberArr.length;++t){var a=Global.CCHelper.createSpriteNode("GameCommon/selected_chip_"+this.chipNumberArr[t]);a.active=!1,a.parent=this.selectChipButtonArr[t].node,this.selectedChipArr.push(a)}Global.MessageCallback.addListener("RoomMessagePush",this)},onDestroy:function(){Global.MessageCallback.removeListener("RoomMessagePush",this)},messageCallbackHandler:function(e,t){"RoomMessagePush"===e&&(t.type===r.GET_ROOM_SHOW_USER_INFO_PUSH?this.updateRoomUserInfo(t.data):t.type===r.USER_LEAVE_ROOM_RESPONSE&&Global.DialogManager.removeLoadingCircle())},buttonEvent:function(e,t){"exit"===t?Global.DialogManager.addPopDialog("\u662f\u5426\u8981\u9000\u51fa\u623f\u95f4\uff1f",function(){Global.API.room.roomMessageNotify(r.userLeaveRoomNotify()),Global.DialogManager.addLoadingCircle()},function(){}):"settings"===t?Global.DialogManager.createDialog("Setting/SettingDialog"):"rule"===t?Global.DialogManager.createDialog("GameCommon/GameRule/GameRuleDialog",{kind:this.kindID}):"online"===t?Global.DialogManager.createDialog("GameCommon/GameOnlineUser/GameOnlineUserDialog"):"record"===t&&Global.DialogManager.createDialog("Game/BaiRenNiuNiu/BRNNGameRecordDialog")},betEvent:function(e,t){this.chipNumberArr.hasOwnProperty(t)&&this.updateChipButtonState(!0,t)},onGameInit:function(e,t){Global.API.room.roomMessageNotify(r.getRoomShowUserInfoNotify()),this.profitPercentage=e||0,this.kindID=t||0},onReconnection:function(){for(var e=0;e<this.chipArr.length;++e)this.chipArr[e].destroy();this.chipArr=[],this.updateChipButtonState(!1),this.curSelectedChipIndex=0,this.betStartTipNode.active=!1,this.betStopTipNode.active=!1,this.waitTipNode.active=!1,this.tipBgNode.active=!1,this.userBetCountList={}},onGameStart:function(){this.userBetCountList={},Global.API.room.roomMessageNotify(r.getRoomShowUserInfoNotify()),this.showWait(!1)},onGameBetStart:function(){this.betStartTipNode.active=!0,this.betStartTipNode.stopAllActions(),this.betStartTipNode.x=-1e3;var e=cc.moveTo(.3,cc.v2(0,0));e.easing(cc.easeIn(3));var t=cc.moveTo(.3,cc.v2(1e3,0));t.easing(cc.easeIn(3)),this.betStartTipNode.runAction(cc.sequence([e,cc.delayTime(.5),t,cc.callFunc(function(){this.betStartTipNode.active=!1}.bind(this))])),this.tipBgNode.active=!0,this.tipBgNode.stopAllActions(),this.tipBgNode.opacity=0,this.tipBgNode.runAction(cc.sequence([cc.fadeTo(.2,255),cc.delayTime(.7),cc.fadeTo(.2,0)])),this.updateChipButtonState(!0,0),Global.AudioManager.playSound("GameCommon/Sound/bet_start")},onGameBetEnd:function(){this.betStopTipNode.active=!0,this.betStopTipNode.stopAllActions(),this.betStopTipNode.x=-1e3;var e=cc.moveTo(.3,cc.v2(0,0));e.easing(cc.easeIn(3));var t=cc.moveTo(.3,cc.v2(1e3,0));t.easing(cc.easeIn(3)),this.betStopTipNode.runAction(cc.sequence([e,cc.delayTime(.5),t,cc.callFunc(function(){this.betStopTipNode.active=!1}.bind(this))])),this.tipBgNode.active=!0,this.tipBgNode.stopAllActions(),this.tipBgNode.opacity=0,this.tipBgNode.runAction(cc.sequence([cc.fadeTo(.2,255),cc.delayTime(.7),cc.fadeTo(.2,0)])),this.updateChipButtonState(!1),Global.AudioManager.playSound("GameCommon/Sound/bet_stop")},onGameResult:function(e,t){var a=this;function r(e){var t=a.getGameHeadCtrlByUid(e.uid);if(e.score>0){var r=e.uid,o=a.otherUserBetActionStartPos;t[0]&&(o=Global.CCHelper.getRelativePosition(t[0].node,a.betRootNode));for(var n=0;n<a.chipArr.length;++n){var s=a.chipArr[n];s.ownUid===r&&(s.runAction(cc.sequence([cc.moveTo(i,o),cc.removeSelf()])),s.ownUid=null)}}t.length>0&&a.scheduleOnce(function(){for(var r=0;r<t.length;++r)t[r].goldChange(a.userBetCountList[e.uid],!1),e.score>0?t[r].goldChange(e.score*(1-a.profitPercentage/100),0===r):t[r].goldChange(e.score,0===r)},i)}for(var o=0;o<e.length;++o)r(e[o]);for(var n=0;n<this.chipArr.length;++n){var s=this.chipArr[n];s&&(s.ownUid&&(s.runAction(cc.sequence([cc.moveTo(i,this.otherUserBetActionStartPos),cc.removeSelf()])),s.ownUid=null))}this.chipArr=[],Global.AudioManager.playSound("GameCommon/Sound/win_bet")},showWait:function(e){this.tipBgNode.active=e,this.tipBgNode.stopAllActions(),this.tipBgNode.opacity=255,this.waitTipNode.active=e},userBet:function(e,t,a,r){if(!(t<=0)){var i=this.getGameHeadCtrlByUid(e);if(i.length>0&&r){i[0].execBet(r),this.execBet(e,Global.CCHelper.getRelativePosition(i[0].node,this.betRootNode),a,t,r);for(var o=0;o<i.length;++o)i[o].goldChange(-1*t,!1)}else this.execBet(e,this.otherUserBetActionStartPos,a,t,r);e in this.userBetCountList?this.userBetCountList[e]=this.userBetCountList[e]+t:this.userBetCountList[e]=t,e===Global.Player.getPy("uid")&&this.updateChipButtonState(!0,this.curSelectedChipIndex)}},execBet:function(e,t,a,r,i){for(var o=this.chipNumberArr.length-1;o>=0;--o)for(var n=this.chipNumberArr[o],s=Math.floor(r/n);s-- >0;){r-=n;var c=cc.v2(a.x+Math.random()*a.width,a.y+Math.random()*a.height),l=cc.instantiate(this.chipNodeArr[o]);if(l.parent=this.betRootNode,i){l.position=t,l.setScale(.3);var d=cc.v2(c.x-t.x,c.y-t.y).mag()/2e3,h=cc.sequence([cc.spawn([cc.scaleTo(d,1),cc.moveTo(d,c)]),cc.scaleTo(.3,.8)]);l.runAction(h)}else l.setScale(.8),l.position=c;l.ownUid=e,this.chipArr.push(l)}i&&(r>100?Global.AudioManager.playSound("GameCommon/Sound/bet_big"):Global.AudioManager.playSound("GameCommon/Sound/bet_small"))},execBankerGainGold:function(e,t){for(var a=0;a<this.chipArr.length;++a){var r=this.chipArr[a];r&&(t.contains(r.position)&&r.runAction(cc.sequence([cc.moveTo(i,e),cc.removeSelf()])))}},execBankerSendGold:function(e,t,a){if(0!==a){for(var r=this.chipNumberArr.length-1;r>=0;--r)for(var i=this.chipNumberArr[r],o=Math.floor(a/i);o-- >0;){a-=i;var n=cc.v2(t.x+Math.random()*t.width,t.y+Math.random()*t.height),s=cc.instantiate(this.chipNodeArr[r]);s.parent=this.betRootNode,s.position=e,s.setScale(.3);var c=cc.sequence([cc.spawn([cc.scaleTo(.4,1),cc.moveTo(.4,n)]),cc.scaleTo(.3,.8)]);s.runAction(c),s.ownUid=-1,this.chipArr.push(s)}Global.AudioManager.playSound("GameCommon/Sound/bet_small")}},getCurChipNumber:function(){return this.chipNumberArr[this.curSelectedChipIndex]||0},updateRoomUserInfo:function(e){this.gameHeadSelfCtrl.updateInfo(e.selfUserInfo.userInfo)},getGameHeadCtrlByUid:function(e){var t=[];return this.gameHeadSelfCtrl.getUid()===e&&t.push(this.gameHeadSelfCtrl),t},updateChipButtonState:function(e,t){if(this.curSelectedChipIndex=t,e){for(var a=this.userBetCountList[Global.Player.getPy("uid")]||0,r=this.gameHeadSelfCtrl.getUserInfo().gold,i=0;i<this.selectChipButtonArr.length;++i){var o=this.selectChipButtonArr[i],n=3*this.chipNumberArr[i]+2*a<r;o.enabled=n,o.node.opacity=n?255:150,o.node.y=0,this.selectedChipArr[i].active=!1}var s=this.selectChipButtonArr[t];s.enabled?(s.node.y=5,this.selectedChipArr[t].active=!0):r>this.chipNumberArr[0]&&(this.selectChipButtonArr[0].node.y=5,this.curSelectedChipIndex=0,this.selectedChipArr[0].active=!0)}else{for(var c=0;c<this.selectChipButtonArr.length;++c){var l=this.selectChipButtonArr[c];l.enabled=!1,l.node.opacity=150,l.node.y=0,this.selectedChipArr[c].active=!1}this.curSelectedChipIndex=0}}}),cc._RF.pop()},{"../../API/RoomProto":"RoomProto",GameHeadController:"GameHeadController"}],BRNNGameRecordDialog:[function(e,t,a){"use strict";cc._RF.push(t,"cbd7aACguZHu4ztAGgwwGsf","BRNNGameRecordDialog"),cc.Class({extends:cc.Component,properties:{contentNode:cc.Node,itemNode:cc.Node,winColor:cc.Color,lostColor:cc.Color},start:function(){Global.API.hall.getGameRecordDataRequest({kind:Global.Enum.gameType.BRNN,uid:Global.Player.uid},{createTime:-1},function(e){for(var t=0;t<e.msg.recordArr.length;++t){var a=e.msg.recordArr[t],r=cc.instantiate(this.itemNode);r.getChildByName("drawID").getComponent(cc.Label).string=a.drawID||"",r.getChildByName("roomLevel").getComponent(cc.Label).string="\u5927\u5e08\u573a";var i=r.getChildByName("winGold").getComponent(cc.Label);a.changeGold>0?(i.node.color=this.winColor,i.string="+"+Global.Utils.formatNumberToString(a.changeGold,2)):(i.node.color=this.lostColor,i.string=Global.Utils.formatNumberToString(a.changeGold,2)),r.getChildByName("gameTime").getComponent(cc.Label).string=new Date(a.createTime).format("yyyy-MM-dd hh:mm:ss"),r.active=!0,r.parent=this.contentNode}}.bind(this))},onClose:function(){Global.DialogManager.destroyDialog(this,!0)}}),cc._RF.pop()},{}],BRNNMainDialog:[function(e,t,a){"use strict";cc._RF.push(t,"a2ceaaHewdFOaKVifL/psdl","BRNNMainDialog");var r=e("../../API/RoomProto"),i=e("./BRNNProto"),o=e("../../API/RoomAPI");cc.Class({extends:cc.Component,properties:{gameCommonCtrl:e("BRNNGameCommonCtrl"),cardWidgetPrefab:cc.Prefab,cardWidgetPosNode:[cc.Node],betRectNodeArr:[cc.Node],betCountLabelArr:[cc.Label],selfBetCountLabelArr:[cc.Label],winTypeShowNodeArr:[cc.Node],clockWidgetCtrl:e("BRNNClockWidgetCtrl"),recordWidgetCtrl:e("BRNNRecordWidgetCtrl"),drawIDLabel:cc.Label,bankerPosNode:cc.Node,otherUserWinLabel:cc.Label,otherUserLoseLabel:cc.Label},start:function(){this.enableBet=!1,this.gameInited=!1,this.roomID="",this.profitPercentage=0,this.cardWidgetCtrlArr=[];for(var e=0;e<5;++e){var t=cc.instantiate(this.cardWidgetPrefab),a=t.getComponent("BRNNCardWidgetCtrl");t.parent=this.cardWidgetPosNode[e],this.cardWidgetCtrlArr.push(a),t.active=!1}this.betCountList={},this.lastDrawBetCountList=null,this.betCountList[i.TIAN]=0,this.betCountList[i.DI]=0,this.betCountList[i.XUAN]=0,this.betCountList[i.HUANG]=0,this.selfBetCountList={},this.selfBetCountList[i.TIAN]=0,this.selfBetCountList[i.DI]=0,this.selfBetCountList[i.XUAN]=0,this.selfBetCountList[i.HUANG]=0,o.roomMessageNotify(r.getRoomSceneInfoNotify()),Global.MessageCallback.addListener("RoomMessagePush",this),Global.MessageCallback.addListener("GameMessagePush",this),Global.MessageCallback.addListener("ReConnectSuccess",this),Global.AudioManager.startPlayBgMusic("LongHuDou/Sound/bg")},onDestroy:function(){Global.MessageCallback.removeListener("RoomMessagePush",this),Global.MessageCallback.removeListener("GameMessagePush",this),Global.MessageCallback.removeListener("ReConnectSuccess",this)},messageCallbackHandler:function(e,t){if("RoomMessagePush"===e)t.type===r.USER_LEAVE_ROOM_PUSH?t.data.roomUserInfo.userInfo.uid===Global.Player.getPy("uid")&&this.exitGame():t.type===r.GET_ROOM_SCENE_INFO_PUSH&&this.gameInit(t.data.gameData);else if("GameMessagePush"===e){if(!this.gameInited)return;t.type===i.GAME_POURGOLD_PUSH?(this.userBet(t.data,!0),this.updateBetCount(this.betCountList,this.selfBetCountList)):t.type===i.GAME_START_PUSH?this.onGameStart(i.BET_TIME,t.data.drawID):t.type===i.GAME_RESULT_PUSH&&this.onGameEnd(t.data)}else"ReConnectSuccess"===e&&(Global.Player.isInRoom()?Global.API.hall.joinRoomRequest(Global.Player.roomID,function(){this.onReconnection()}):this.exitGame())},betEvent:function(e,t){if(this.enableBet)if("continueBet"===t){if(!this.lastDrawBetCountList)return void Global.DialogManager.addTipDialog("\u4e0a\u5c40\u6ca1\u6709\u4e0b\u6ce8\u4fe1\u606f\uff0c\u65e0\u6cd5\u4e0b\u6ce8");var a=0,r=[];for(var n in this.lastDrawBetCountList)if(this.lastDrawBetCountList.hasOwnProperty(n)){if(!this.lastDrawBetCountList[n])continue;r.push({betType:parseInt(n),betCount:this.lastDrawBetCountList[n]}),a+=this.betCountList[n]}if(this.gameCommonCtrl.getGameHeadCtrlByUid(Global.Player.getPy("uid"))[0].getUserInfo.gold<3*a)return void Global.DialogManager.addPopDialog("\u6700\u5927\u4e0b\u6ce8\u4e0d\u5f97\u8d85\u8fc7\u81ea\u5df1\u91d1\u5e01\u76841/3");o.gameMessageNotify(i.gameUserBetNotify(r))}else{if(this.selfBetCountList[i.TIAN]+this.selfBetCountList[i.DI]+this.selfBetCountList[i.XUAN]+this.selfBetCountList[i.HUANG]+this.gameCommonCtrl.getCurChipNumber()>Global.Player.gold/3)return void Global.DialogManager.addPopDialog("\u6700\u5927\u4e0b\u6ce8\u4e0d\u5f97\u8d85\u8fc7\u81ea\u5df1\u91d1\u5e01\u76841/3");"tian"===t?o.gameMessageNotify(i.gameUserBetNotify([{betType:i.TIAN,betCount:this.gameCommonCtrl.getCurChipNumber()}])):"di"===t?o.gameMessageNotify(i.gameUserBetNotify([{betType:i.DI,betCount:this.gameCommonCtrl.getCurChipNumber()}])):"xuan"===t?o.gameMessageNotify(i.gameUserBetNotify([{betType:i.XUAN,betCount:this.gameCommonCtrl.getCurChipNumber()}])):"huang"===t&&o.gameMessageNotify(i.gameUserBetNotify([{betType:i.HUANG,betCount:this.gameCommonCtrl.getCurChipNumber()}]))}else Global.DialogManager.addTipDialog("\u975e\u4e0b\u6ce8\u65f6\u95f4\uff0c\u65e0\u6cd5\u4e0b\u6ce8")},gameInit:function(e){if(this.gameInited=!0,this.profitPercentage=e.profitPercentage,this.gameCommonCtrl.onGameInit(parseInt(e.profitPercentage),Global.Enum.gameType.BRNN),this.recordWidgetCtrl.addDirRecord(e.dirRecord),this.drawIDLabel.node.active=!0,this.drawIDLabel.string="\u724c\u5c40\u7f16\u53f7:"+e.drawID,e.gameStatus!==i.gameStatus.NONE&&e.gameStatus!==i.gameStatus.GAME_END){if(e.gameStatus===i.gameStatus.GAME_STARTED&&this.onGameStart(e.betLeftTime,e.drawID),e.betRecordList)for(var t in e.betRecordList)if(e.betRecordList.hasOwnProperty(t)){var a=e.betRecordList[t];i.TIAN in a&&this.userBet({uid:t,betInfoArr:[{betType:i.TIAN,betCount:a[i.TIAN]}]},!1),i.DI in a&&this.userBet({uid:t,betInfoArr:[{betType:i.DI,betCount:a[i.DI]}]},!1),i.XUAN in a&&this.userBet({uid:t,betInfoArr:[{betType:i.XUAN,betCount:a[i.XUAN]}]},!1),i.HUANG in a&&this.userBet({uid:t,betInfoArr:[{betType:i.HUANG,betCount:a[i.HUANG]}]},!1)}this.updateBetCount(this.betCountList,this.selfBetCountList)}else this.gameCommonCtrl.showWait(!0)},resetGame:function(){this.enableBet=!1,this.gameInited=!1,this.node.stopAllActions(),this.betCountList={},this.betCountList[i.TIAN]=0,this.betCountList[i.DI]=0,this.betCountList[i.XUAN]=0,this.betCountList[i.HUANG]=0,this.selfBetCountList={},this.selfBetCountList[i.TIAN]=0,this.selfBetCountList[i.DI]=0,this.selfBetCountList[i.XUAN]=0,this.selfBetCountList[i.HUANG]=0,this.updateBetCount(this.betCountList,this.selfBetCountList);for(var e=0;e<this.cardWidgetCtrlArr.length;++e)this.cardWidgetCtrlArr[e].resetWidget();this.recordWidgetCtrl.resetWidget(),this.clockWidgetCtrl.resetWidget()},onReconnection:function(){this.resetGame(),this.gameCommonCtrl.onReconnection(),o.roomMessageNotify(r.getRoomSceneInfoNotify())},onGameStart:function(e,t){if(this.drawIDLabel.string="\u724c\u5c40\u7f16\u53f7:"+t,this.betCountList={},this.betCountList[i.TIAN]=0,this.betCountList[i.DI]=0,this.betCountList[i.XUAN]=0,this.betCountList[i.HUANG]=0,this.selfBetCountList={},this.selfBetCountList[i.TIAN]=0,this.selfBetCountList[i.DI]=0,this.selfBetCountList[i.XUAN]=0,this.selfBetCountList[i.HUANG]=0,this.updateBetCount(this.betCountList,this.selfBetCountList),this.node.stopAllActions(),e<=2){for(var a=0;a<this.cardWidgetCtrlArr.length;++a)this.cardWidgetCtrlArr[a].sendCard(a,!1);this.clockWidgetCtrl.startClock(e,"\u4e0b\u6ce8\u4e2d...")}else this.gameCommonCtrl.onGameStart(),this.node.runAction(cc.sequence([cc.callFunc(function(){this.onBetStart(e===i.BET_TIME)}.bind(this)),cc.delayTime(e),cc.callFunc(this.onBetStop.bind(this))])),this.clockWidgetCtrl.startClock(e,"\u4e0b\u6ce8\u4e2d...")},onBetStart:function(e){this.enableBet=!0,this.gameCommonCtrl.onGameBetStart();for(var t=0;t<this.cardWidgetCtrlArr.length;++t)this.cardWidgetCtrlArr[t].sendCard(t,e)},onBetStop:function(){this.enableBet=!1,this.gameCommonCtrl.onGameBetEnd(),this.node.stopAllActions(),this.lastDrawBetCountList=this.selfBetCountList},onGameEnd:function(e){this.enableBet&&this.onBetStop(),this.node.stopAllActions();var t=[cc.delayTime(this.enableBet?2:.1),cc.callFunc(function(){this.onShowCard(e.allCardDataArr,e.cardTypeArr)}.bind(this)),cc.delayTime(i.SHOW_CARD_TIME),cc.callFunc(function(){this.onShowWin(e.winTimesArr)}.bind(this)),cc.delayTime(2),cc.callFunc(function(){this.onShowResult(e.scoreChangeArr,e.winTimesArr)}.bind(this)),cc.delayTime(i.PAI_JIANG_TIME-2),cc.callFunc(this.onClear.bind(this))];this.node.runAction(cc.sequence(t))},onShowCard:function(e,t){this.clockWidgetCtrl.startClock(i.SHOW_CARD_TIME,"\u5f00\u724c\u4e2d...");for(var a=0;a<e.length;++a)this.cardWidgetCtrlArr[a].showCard(e[a],t[a],a)},onShowWin:function(e){this.clockWidgetCtrl.startClock(i.PAI_JIANG_TIME,"\u6d3e\u5956\u4e2d...");for(var t=0;t<e.length;++t)if(e[t]>0){var a=this.winTypeShowNodeArr[t];a.active=!0;var r=cc.sequence([cc.show(),cc.fadeTo(.3,255),cc.fadeTo(.3,0)]);a.opacity=0,a.runAction(cc.repeat(r,3))}},onShowResult:function(e,t){for(var a=[],r=!1,i=0;i<t.length;++i)if(t[i]<0){r=!0;break}r&&(a.push(cc.callFunc(function(){for(var e=0;e<t.length;++e)t[e]<0&&this.gameCommonCtrl.execBankerGainGold(this.bankerPosNode.position,this.betRectNodeArr[e].getBoundingBox()||cc.rect(0,0,0,0))}.bind(this))),a.push(cc.delayTime(.6)));for(var o=!1,n=0;n<t.length;++n)if(t[n]>0){o=!0;break}o&&(a.push(cc.callFunc(function(){for(var e=0;e<t.length;++e)t[e]>0&&this.gameCommonCtrl.execBankerSendGold(this.bankerPosNode.position,this.betRectNodeArr[e].getBoundingBox()||cc.rect(0,0,0,0),this.betCountList[e]*t[e])}.bind(this))),a.push(cc.delayTime(.6)));for(var s=0,c=0;c<t.length;++c)t[c]>0?s+=t[c]*(this.betCountList[c]-this.selfBetCountList[c])*(1-this.profitPercentage/100):s+=t[c]*(this.betCountList[c]-this.selfBetCountList[c]);a.length>0?(a.push(cc.callFunc(function(){this.gameCommonCtrl.onGameResult(e),s>0?(this.otherUserWinLabel.node.active=!0,this.otherUserWinLabel.string="+"+Global.Utils.formatNumberToString(s,2)+"\u5143",this.otherUserWinLabel.node.position=cc.v2(0,-50),this.otherUserWinLabel.node.runAction(cc.sequence([cc.show(),cc.moveTo(.2,cc.v2(0,0)),cc.delayTime(2),cc.hide()]))):s<0&&(this.otherUserLoseLabel.node.active=!0,this.otherUserLoseLabel.string=Global.Utils.formatNumberToString(s,2)+"\u5143",this.otherUserLoseLabel.node.position=cc.v2(0,-50),this.otherUserLoseLabel.node.runAction(cc.sequence([cc.show(),cc.moveTo(.2,cc.v2(0,0)),cc.delayTime(2),cc.hide()])))}.bind(this))),this.node.runAction(cc.sequence(a))):(this.gameCommonCtrl.onGameResult(e),s>0?(this.otherUserWinLabel.node.active=!0,this.otherUserWinLabel.string="+"+Global.Utils.formatNumberToString(s,2)+"\u5143",this.otherUserWinLabel.node.position=cc.v2(0,-50),this.otherUserWinLabel.node.runAction(cc.sequence([cc.show(),cc.moveTo(.2,cc.v2(0,0)),cc.delayTime(2),cc.hide()]))):s<0&&(this.otherUserLoseLabel.node.active=!0,this.otherUserLoseLabel.string=Global.Utils.formatNumberToString(s,2)+"\u5143",this.otherUserLoseLabel.node.position=cc.v2(0,-50),this.otherUserLoseLabel.node.runAction(cc.sequence([cc.show(),cc.moveTo(.2,cc.v2(0,0)),cc.delayTime(2),cc.hide()])))),this.recordWidgetCtrl.addDirRecord([t])},onClear:function(){this.clockWidgetCtrl.startClock(i.XIU_XI_TIME,"\u4f11\u606f\u65f6\u95f4");for(var e=0;e<this.cardWidgetCtrlArr.length;++e)this.cardWidgetCtrlArr[e].resetWidget();this.betCountList={},this.betCountList[i.TIAN]=0,this.betCountList[i.DI]=0,this.betCountList[i.XUAN]=0,this.betCountList[i.HUANG]=0,this.selfBetCountList={},this.selfBetCountList[i.TIAN]=0,this.selfBetCountList[i.DI]=0,this.selfBetCountList[i.XUAN]=0,this.selfBetCountList[i.HUANG]=0,this.updateBetCount(this.betCountList,this.selfBetCountList),this.node.stopAllActions()},userBet:function(e,t){for(var a=0;a<e.betInfoArr.length;++a){var r=e.betInfoArr[a];this.betCountList[r.betType]+=r.betCount,e.uid===Global.Player.getPy("uid")&&(this.selfBetCountList[r.betType]+=r.betCount);var i=this.betRectNodeArr[r.betType].getBoundingBox()||cc.rect(0,0,0,0);this.gameCommonCtrl.userBet(e.uid,r.betCount,i,t)}},updateBetCount:function(e,t){for(var a in e)e.hasOwnProperty(a)&&(this.betCountLabelArr[a].string=e[a].toString());for(var r in t)t.hasOwnProperty(r)&&(this.selfBetCountLabelArr[r].node.active=0!==t[r],this.selfBetCountLabelArr[r].string=t[r].toString())},exitGame:function(){Global.Player.setPy("roomID",null),Global.DialogManager.createDialog("Hall/HallDialog",null,function(){Global.DialogManager.destroyDialog(this,!0),Global.CCHelper.releaseRes(["Game/BaiRenNiuNiu"])}.bind(this))}}),cc._RF.pop()},{"../../API/RoomAPI":"RoomAPI","../../API/RoomProto":"RoomProto","./BRNNProto":"BRNNProto",BRNNClockWidgetCtrl:"BRNNClockWidgetCtrl",BRNNGameCommonCtrl:"BRNNGameCommonCtrl",BRNNRecordWidgetCtrl:"BRNNRecordWidgetCtrl"}],BRNNProto:[function(e,t,a){"use strict";cc._RF.push(t,"c07677YdgJN26rOn/6nTClk","BRNNProto");var r=t.exports;r.GAME_POURGOLD_NOTIFY=301,r.GAME_POURGOLD_PUSH=401,r.GAME_START_PUSH=402,r.GAME_RESULT_PUSH=403,r.gameStatus={NONE:0,GAME_STARTED:1,GAME_END:2},r.cardType={NIU_1:1,NIU_2:2,NIU_3:3,NIU_4:4,NIU_5:5,NIU_6:6,NIU_7:7,NIU_8:8,NIU_9:9,NIU_NIU:10,SI_HUA_NIU:11,WU_HUA_NIU:12,ZHA_DAN_NIU:13,WU_XIAO_NIU:14},r.BET_TIME=15,r.SHOW_CARD_TIME=5,r.PAI_JIANG_TIME=5,r.XIU_XI_TIME=5,r.SHOW_RESULT_TIME=r.SHOW_CARD_TIME+r.PAI_JIANG_TIME+r.XIU_XI_TIME,r.TIAN=0,r.DI=1,r.XUAN=2,r.HUANG=3,r.gameStartPush=function(e){return{type:this.GAME_START_PUSH,data:{drawID:e}}},r.gameResultPush=function(e,t,a,r){return{type:this.GAME_RESULT_PUSH,data:{allCardDataArr:t,scoreChangeArr:e,winTimesArr:a,cardTypeArr:r}}},r.gameUserBetNotify=function(e){return{type:this.GAME_POURGOLD_NOTIFY,data:{betInfoArr:e}}},r.gameUserBetPush=function(e,t){return{type:this.GAME_POURGOLD_PUSH,data:{uid:e,betInfoArr:t}}},cc._RF.pop()},{}],BRNNRecordWidgetCtrl:[function(e,t,a){"use strict";cc._RF.push(t,"de2c3KM/IhEeptRCaD2Rq77","BRNNRecordWidgetCtrl"),cc.Class({extends:cc.Component,properties:{recordItem:cc.Node,recordRootNode:cc.Node},start:function(){},addDirRecord:function(e){this.index=this.index||1e4;for(var t=0;t<e.length;++t){var a=cc.instantiate(this.recordItem);a.active=!0,a.zIndex=--this.index,a.parent=this.recordRootNode;for(var r=e[t],i=0;i<r.length;++i)r[i]>0&&Global.CCHelper.updateSpriteFrame("Game/BaiRenNiuNiu/img_record_win",a.getChildByName(i.toString()).getComponent(cc.Sprite))}var o=this.recordRootNode.getChildren();o.length>11&&o[o.length-2].removeFromParent(!0)},resetWidget:function(){for(var e=this.recordRootNode.getChildren(),t=0;t<e.length;++t)e[t]!==this.recordItem&&e[t].removeFromParent(!0)}}),cc._RF.pop()},{}],BankDialog:[function(e,t,a){"use strict";cc._RF.push(t,"885d1QccuRLSIguOudK6dTr","BankDialog"),cc.Class({extends:cc.Component,properties:{inGroup:cc.Node,outGroup:cc.Node,goldNum:cc.Label,bankGoldNum:cc.Label,outSlider:cc.Slider,outProgress:cc.ProgressBar,outEdit:cc.EditBox,inSlider:cc.Slider,inProgress:cc.ProgressBar,inEdit:cc.EditBox},showInGroup:function(){this.inGroup.active=!0,this.outGroup.active=!1},showOutGroup:function(){this.inGroup.active=!1,this.outGroup.active=!0},updateGold:function(){this.goldNum.string=Math.floor(Global.Player.gold).toString(),this.bankGoldNum.string=Math.floor(Global.Player.safeGold).toString()},updateEditText:function(){var e=this.inSlider.progress,t=this.outSlider.progress;this.inEdit.string=Math.floor(e*Global.Player.getPy("gold")),this.outEdit.string=Math.floor(t*Global.Player.getPy("safeGold"))},updateProgress:function(){var e=this.inEdit.string,t=this.outEdit.string;""===e?(this.inSlider.progress=0,this.inProgress.progress=0):(e=parseInt(e),this.inSlider.progress=e/parseInt(Global.Player.getPy("gold")),this.inProgress.progress=e/parseInt(Global.Player.getPy("gold"))),0===parseInt(Global.Player.getPy("gold"))&&(this.inSlider.progress=0,this.inProgress.progress=0),""===t?(this.outSlider.progress=0,this.outProgress.progress=0):(t=parseInt(t),this.outSlider.progress=t/parseInt(Global.Player.getPy("safeGold")),this.outProgress.progress=t/parseInt(Global.Player.getPy("safeGold"))),0===parseInt(Global.Player.getPy("safeGold"))&&(this.outSlider.progress=0,this.outProgress.progress=0)},start:function(){this.inProgress.progress=0,this.outProgress.progress=0,this.showInGroup(),this.updateGold(),Global.MessageCallback.addListener("UpdateUserInfoUI",this)},onDestroy:function(){Global.MessageCallback.removeListener("UpdateUserInfoUI",this)},messageCallbackHandler:function(e,t){switch(e){case"UpdateUserInfoUI":this.updateGold(),this.updateEditText()}},editEnd:function(e,t){switch(t){case"in":var a=this.inEdit.string;""===a||(a=parseInt(a))>Global.Player.getPy("gold")&&(this.inEdit.string=Global.Player.getPy("gold"));break;case"out":var r=this.outEdit.string;""===r||((r=parseInt(r))>Global.Player.getPy("safeGold")&&(this.outEdit.string=Global.Player.getPy("safeGold")),0===r&&(this.outEdit.string=0))}this.updateProgress()},onBtnClk:function(e,t){switch(t){case"close":Global.DialogManager.destroyDialog(this);break;case"in":this.showInGroup();break;case"out":this.showOutGroup();break;case"clear":this.inGroup.active?this.inEdit.string="":this.outEdit.string="",this.updateProgress();break;case"confirm_in":var a=this.inEdit.string;if(""===a)return void Global.DialogManager.addTipDialog("\u8bf7\u8f93\u5165\uff01");if((a=parseInt(a))<=0)return void Global.DialogManager.addTipDialog("\u8bf7\u8f93\u51650\u4ee5\u4e0a\u7684\u6570\u5b57\uff01");if(a>Global.Player.getPy("gold"))return void Global.DialogManager.addTipDialog("\u60a8\u643a\u5e26\u7684\u91d1\u989d\u4e0d\u8db3\uff01");Global.API.hall.safeBoxOperationRequest(parseInt(a),null,function(){Global.DialogManager.addPopDialog("\u5b58\u5165\u6210\u529f\uff01"),this.inEdit.string="",this.updateProgress()}.bind(this));break;case"confirm_out":var r=this.outEdit.string;if(""===r)return void Global.DialogManager.addTipDialog("\u8bf7\u8f93\u5165\uff01");if((r=parseInt(r))<=0)return void Global.DialogManager.addTipDialog("\u8bf7\u8f93\u51650\u4ee5\u4e0a\u7684\u6570\u5b57\uff01");if(r>Global.Player.getPy("safeGold"))return void Global.DialogManager.addTipDialog("\u4fdd\u9669\u67dc\u91d1\u989d\u4e0d\u8db3\uff01");Global.API.hall.safeBoxOperationRequest(-1*parseInt(r),null,function(){Global.DialogManager.addTipDialog("\u53d6\u51fa\u6210\u529f\uff01"),this.outEdit.string="",this.updateProgress()}.bind(this));break;case"in_slider":this.inProgress.progress=e.progress,this.updateEditText();break;case"out_slider":this.outProgress.progress=e.progress,this.updateEditText();break;case"inMax":this.inSlider.progress=1,this.inProgress.progress=1,this.updateEditText();break;case"outMax":this.outSlider.progress=1,this.outProgress.progress=1,this.updateEditText()}}}),cc._RF.pop()},{}],BindDialog:[function(e,t,a){"use strict";cc._RF.push(t,"8ee7ahUBCJKj56Lqwq882IQ","BindDialog"),cc.Class({extends:cc.Component,properties:{titleImg:cc.Sprite,accountLabelImg:cc.Sprite,tip:cc.Label,accountEdit:cc.EditBox,nameEdit:cc.EditBox},start:function(){this.showType=this.dialogParameters.showType,"wx"===this.showType?(this.node.active=!1,Global.CCHelper.updateSpriteFrame("Bank/labelImg_bindWX",this.titleImg),Global.CCHelper.updateSpriteFrame("Bank/labelImg_wxAccount",this.accountLabelImg,function(){this.node.active=!0}.bind(this)),this.tip.string="\u8bf7\u8f93\u5165\u6b63\u786e\u7684\u5fae\u4fe1\u8d26\u53f7\u4ee5\u53ca\u5fae\u4fe1\u5b9e\u540d\u5236\u59d3\u540d\uff0c\u5426\u5219\u4f1a\u5bfc\u81f4\u5151\u6362\u5931\u8d25\u54e6~"):"bankCard"===this.showType&&(this.node.active=!1,Global.CCHelper.updateSpriteFrame("Bank/labelImg_bindBankCard",this.titleImg),Global.CCHelper.updateSpriteFrame("Bank/labelImg_bankCardAccount",this.accountLabelImg,function(){this.node.active=!0}.bind(this)),this.tip.string="\u8bf7\u8f93\u5165\u6b63\u786e\u7684\u94f6\u884c\u5361\u8d26\u53f7\u4ee5\u53ca\u771f\u5b9e\u540d\u59d3\u540d\uff0c\u5426\u5219\u4f1a\u5bfc\u81f4\u5151\u6362\u5931\u8d25\u54e6~")},onBtnClk:function(e,t){switch(t){case"close":Global.DialogManager.destroyDialog(this);break;case"bind":cc.log(this.showType);var a=this.accountEdit.string,r=this.nameEdit.string;if(""===a)return void Global.DialogManager.addTipDialog("\u8bf7\u8f93\u5165\u8d26\u53f7\uff01");if(""===r)return void Global.DialogManager.addTipDialog("\u8bf7\u8f93\u5165\u59d3\u540d\uff01");if(-1!==r.indexOf(" "))return void Global.DialogManager.addTipDialog("\u59d3\u540d\u683c\u5f0f\u9519\u8bef\uff01");"bankCard"===this.showType?Global.API.hall.updateBankCardInfoRequest(a,"\u672a\u77e5",r,function(){Global.DialogManager.addTipDialog("\u7ed1\u5b9a\u6210\u529f\uff01"),Global.DialogManager.destroyDialog(this)}.bind(this)):"zfb"===this.showType&&Global.API.hall.updateAliPayInfoRequest(a,r,function(){Global.DialogManager.addTipDialog("\u7ed1\u5b9a\u6210\u529f\uff01"),Global.DialogManager.destroyDialog(this)}.bind(this))}}}),cc._RF.pop()},{}],BroadcastWidgetCtrl:[function(e,t,a){"use strict";cc._RF.push(t,"d205ddv7VFLUJyvuX8xnsha","BroadcastWidgetCtrl"),cc.Class({extends:cc.Component,properties:{noticeText:cc.RichText,rootNode:cc.Node},start:function(){Global.MessageCallback.addListener("BroadcastPush",this),this.broadcastContents=[];var e=Global.Data.getData("loopBroadcastContent");e&&this.broadcastContents.push({type:Global.Enum.broadcastType.LOOP,content:e}),this.startNext(),this.schedule(function(){if(!(this.broadcastContents.length>0)){var e=Global.Data.getData("loopBroadcastContent");e&&(this.broadcastContents=[{type:Global.Enum.broadcastType.LOOP,content:e}]),this.startNext()}}.bind(this),120)},onDestroy:function(){Global.MessageCallback.removeListener("BroadcastPush",this)},startNext:function(){if(!this.rootNode.active)if(0!==this.broadcastContents.length){this.rootNode.active=!0,this.noticeText.node.x=0;var e=this.noticeText.node.width+this.noticeText.node.parent.width+50,t=e/100,a=cc.moveBy(t,-e,0),r=this.broadcastContents.shift();if(r.type===Global.Enum.broadcastType.LOOP||r.type===Global.Enum.broadcastType.SYSTEM)this.noticeText.string=r.content;else if(r.type===Global.Enum.broadcastType.BIG_WIN){var i="";switch(r.content.kind){case 1:i="\u624e\u91d1\u82b1";break;case 10:i="\u62a2\u5e84\u725b\u725b";break;case 11:i="\u767e\u4eba\u725b\u725b";break;case 20:i="\u5341\u4e09\u5f20";break;case 30:i="\u63a8\u7b52\u5b50";break;case 40:i="\u7ea2\u9ed1\u5927\u6218";break;case 50:i="\u767e\u5bb6\u4e50";break;case 60:i="\u9f99\u864e\u6597";break;case 70:i="\u6355\u9c7c";break;case 80:i="\u6597\u5730\u4e3b";break;case 90:i="21\u70b9";break;case 100:i="\u5fb7\u5dde\u6251\u514b";break;case 110:i="\u8dd1\u5f97\u5feb"}var o=Global.Player.convertNickname(r.content.nickname),n=Global.Utils.formatNumberToString(r.content.gold,2);this.noticeText.string="\u73a9\u5bb6<color=#00ff00>"+o+"</c>\u8d22\u8fd0\u4ea8\u901a,\u5728<color=#D66F00>"+i+"</color>\u4e00\u628a\u8d62\u5f97<color=#E4D313>"+n+"\u5143</color>\uff01"}var s=cc.callFunc(function(){this.rootNode.active=!1,this.startNext()}.bind(this)),c=cc.sequence([a,s]);this.noticeText.node.runAction(c)}else this.rootNode.active=!1},messageCallbackHandler:function(e,t){switch(e){case"BroadcastPush":if(t.type===Global.Enum.broadcastType.BIG_WIN)for(var a=0;a<t.broadcastContentArr.length;++a)this.broadcastContents.push({type:t.type,content:t.broadcastContentArr[a]}),this.broadcastContents.length>10&&this.broadcastContents.shift();else this.broadcastContents.push(t),this.broadcastContents.length>10&&this.broadcastContents.shift();this.startNext()}}}),cc._RF.pop()},{}],BulletWidgetCtrl:[function(e,t,a){"use strict";cc._RF.push(t,"7a16a7+or9A9K7O7cJ5mxvH","BulletWidgetCtrl");var r=e("../../Shared/utils");cc.Class({extends:cc.Component,properties:{},start:function(){this.isDestroyed=!1},initWidget:function(e,t,a){this.ownerChairID=e,this.cannonType=t,this.captureCallback=a},emit:function(e,t,a){var r={x:Math.cos(t/180*Math.PI),y:Math.sin(t/180*Math.PI)};if(this.node.x=e.x+100*r.x,this.node.y=e.y+100*r.y,this.node.rotation=-1*t+90,this.unitVector=r,this.targetFish=a,this.targetFish)this.schedule(this.updateDir.bind(this),1/30);else{var i=new cc.Vec2(1e3*r.x,1e3*r.y);this.node.runAction(cc.moveBy(2,i))}},onCollisionEnter:function(e){if(!this.isDestroyed){var t=e.node.group;if("wall"===t){this.targetFish&&(this.targetFish=null);var a=e.node;"top"===a.name||"bottom"===a.name?this.unitVector.y*=-1:this.unitVector.x*=-1;var r=new cc.Vec2(3e3*this.unitVector.x,3e3*this.unitVector.y);this.node.stopAllActions(),this.node.runAction(cc.moveBy(6,r)),this.node.rotation=Math.acos(this.unitVector.x)/Math.PI*-180+90,this.unitVector.y<0&&(this.node.rotation=-1*(this.node.rotation-90)+90)}else if("fish"===t){var i=e.node.getComponent("FishWidgetCtrl");if(!i)return;if(this.targetFish&&this.targetFish.node&&this.targetFish!==i)return;this.captureCallback(this,i)}}},onShootFish:function(){this.node.destroy(),this.isDestroyed=!0},updateDir:function(e){if(this.targetFish&&this.targetFish.node){this.unitVector=r.getUnitVector(this.node.position,this.targetFish.node.position);var t=180*Math.acos(this.unitVector.x)/Math.PI;this.unitVector.y<0&&(t*=-1),this.node.rotation=-1*t+90,this.node.x+=500*e*this.unitVector.x,this.node.y+=500*e*this.unitVector.y}else{this.targetFish=null,this.unscheduleAllCallbacks();var a=new cc.Vec2(1e3*this.unitVector.x,1e3*this.unitVector.y);this.node.runAction(cc.moveBy(2,a))}}}),cc._RF.pop()},{"../../Shared/utils":"utils"}],CCHelper:[function(e,t,a){"use strict";cc._RF.push(t,"4e601ZqzdBPordQO9FroxkU","CCHelper");var r=e("./utils"),i=t.exports={};i.createFrameAnimationNode=function(e,t){cc.loader.loadRes(e+"_config",cc.JsonAsset,function(a,r){if(a)cc.error("createFrameAnimation err: load file fail url="+e+".json"),t("load file fail");else{var i=(r=r.json).width||0,o=r.height||0,n=r.count||0,s=r.intervalTime||0;if(i<=0||o<=0||n<=0||s<=0)return cc.error("animation data err"),void t("animation data err");cc.loader.loadRes(cc.url.raw(e+".png"),function(a,n){if(a)cc.error("createFrameAnimation err: load file fail url="+e+".png"),t("load file fail");else{var c=Math.floor(n.width/i)||1,l=Math.floor(n.height/o)||1,d=new cc.Node,h=d.addComponent(cc.Sprite);h.spriteFrame=new cc.SpriteFrame(n,new cc.Rect(0,64,i,o)),d.startAnimation=function(e,t,a){(!t||t<=0)&&(t=1),s/=t,d.stopAllActions();var u=0;function g(){var e=u++%r.count,t=new cc.Rect(e%c*i,Math.floor(e/l)*o,i,o);h.spriteFrame=new cc.SpriteFrame(n,t),a&&e===r.count-1&&a()}e?d.runAction(cc.repeatForever(cc.sequence([cc.delayTime(s),cc.callFunc(g)]))):d.runAction(cc.repeat(cc.sequence([cc.delayTime(s),cc.callFunc(g)]),r.count))},d.stopAnimation=function(){d.stopAllActions()},t(null,d)}})}})},i.getUnitVector=function(e,t){var a=cc.v2(0,0),r=void 0;return r=Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2),0===(r=Math.sqrt(r))?a:(a.x=(t.x-e.x)/r,a.y=(t.y-e.y)/r,a)},i.getRelativePosition=function(e,t){return t.convertToNodeSpace(e.parent.convertToWorldSpace(e.position))},i.isWechatBrowser=function(){return!1},i.setPageTitle=function(e){cc.sys.isBrowser&&(document.title=e)},i.updateSpriteFrame=function(e,t,a){var i=t;e&&e.indexOf("http")>=0?cc.loader.load({url:e,type:"png"},function(e,t){e?(cc.error(e),r.invokeCallback(a,e)):i.isValid&&(i.spriteFrame=new cc.SpriteFrame(t),r.invokeCallback(a))}):cc.loader.loadRes(e,cc.SpriteFrame,function(e,t){e?(cc.log(e),r.invokeCallback(a,e)):i.isValid&&(i.spriteFrame=t,r.invokeCallback(a))})},i.loadRes=function(e,t){for(var a=0,i=0;i<e.length;i++)cc.loader.loadResDir(e[i],function(i){(a+=1)>=e.length&&r.invokeCallback(t,i)}.bind(this))},i.releaseRes=function(e){for(var t=0;t<e.length;t++)cc.loader.releaseResDir(e[t])},i.createSpriteNode=function(e){var t=new cc.Node,a=t.addComponent(cc.Sprite);return a.spriteFrame=new cc.SpriteFrame,i.updateSpriteFrame(e,a),t},i.httpRequest=function(e){cc.log("\u8bf7\u6c42url:",e.url),cc.log("\u8bf7\u6c42\u6570\u636e:",JSON.stringify(e.data));var t=e.url,a=e.method||"GET",i=e.responseType||"json",o=new XMLHttpRequest;if(o.responseType=i,o.onload=function(){cc.log("\u6536\u5230\u6570\u636e:",JSON.stringify(o.response)),200===o.status?r.invokeCallback(e.cb,null,o.response):(cc.error("\u8bf7\u6c42\u5931\u8d25\uff1astatus="+o.status),r.invokeCallback(e.cb,Global.Code.FAIL))},o.timeout=2e4,o.ontimeout=function(){cc.error("\u8bf7\u6c42\u8d85\u65f6"),Global.DialogManager.removeLoadingCircle(),r.invokeCallback(e.cb,Global.Code.FAIL)},o.onerror=function(t){cc.error("\u8bf7\u6c42\u9519\u8bef"),Global.DialogManager.removeLoadingCircle(),r.invokeCallback(e.cb,Global.Code.FAIL)},o.open(a,t,!0),o.setRequestHeader("CONTENT-TYPE","application/x-www-form-urlencoded"),e.data){var n="";for(var s in e.data)e.data.hasOwnProperty(s)&&(n.length>0&&(n+="&"),n+=s+"="+e.data[s]);n.length>0?o.send(n):o.send()}else o.send()},i.screenShoot=function(e){if(cc.sys.isNative);},i.capScreen=function(e){},i.updateNodeAlignment=function(e){var t=e.getComponent(cc.Widget);t&&t.updateAlignment();for(var a=0;a<e.children.length;++a)i.updateNodeAlignment(e.children[a])},i.screenAdaptation=function(e,t){var a=new cc.size(e.width,e.height),r=cc.view.getFrameSize();a.height/a.width<r.height/r.width?(t.fitHeight=!1,t.fitWidth=!0):(a.width=a.height*(r.width/r.height),t.designResolution=a,t.node.width=a.width,t.node.height=a.height),cc.sys.isNative},i.playPreSound=function(){cc.loader.loadRes("Sound/button",function(e,t){e||cc.audioEngine.play(t,!1,0)})},cc._RF.pop()},{"./utils":"utils"}],CannonWidgetCtrl:[function(e,t,a){"use strict";cc._RF.push(t,"0fbe2J9m8NBmJpcVmzZlU+P","CannonWidgetCtrl");e("../../Shared/utils");cc.Class({extends:cc.Component,properties:{cannonAnimationCtrl:e("SpriteFrameAnimationWidgetCtrl"),powerLabel:cc.Label,changePowerNode:cc.Node,cannonBaseNode:cc.Node,userInfoNode:cc.Node,avatarSprite:cc.Sprite,goldCountLabel:cc.Label,nicknameLabel:cc.Label,winScoreLabel:cc.Label,lockLineWidgetCtrl:e("LockLineWidgetCtrl")},start:function(){this.isDestroyed=!1,this.powerIndex=this.powerIndex||1,this.lockFishCtrl=this.lockFishCtrl||null},onDestroy:function(){this.isDestroyed=!0},initWidget:function(e,t,a,r,i){this.roomUserInfo=e,this.changePowerNode.active=t,this.posIndex=a,this.winGold=r,this.updateUserInfo(e.userInfo,this.winGold),1===a?this.userInfoNode.x*=-1:2===a?(this.userInfoNode.x*=-1,this.userInfoNode.y*=-1,this.cannonBaseNode.rotation=180,this.powerLabel.node.rotation=180):3===a&&(this.userInfoNode.y*=-1,this.cannonBaseNode.rotation=180,this.powerLabel.node.rotation=180),this.changeCannonPowerCallback=i,this.cannonAnimationCtrl.initAnimation()},updateUserInfo:function(e,t){this.isDestroyed||(this.roomUserInfo.userInfo=e,this.winGold=t,Global.CCHelper.updateSpriteFrame(e.avatar,this.avatarSprite),this.goldCountLabel.string=parseFloat((e.gold+t).toFixed(2))+"",this.nicknameLabel.string=Global.Player.convertNickname(e.nickname))},goldChange:function(e,t){if(!this.isDestroyed&&0!==e){this.winGold+=e;var a=this.roomUserInfo.userInfo.gold+this.winGold;this.goldCountLabel.string=parseFloat(a.toFixed(2))+"",e>0&&t&&this.showGoldChange(e)}},showGoldChange:function(e){0!==e&&(this.winScoreLabel.string="+"+parseFloat(e.toFixed(2)),this.winScoreLabel.node.y=20,this.winScoreLabel.node.runAction(cc.sequence([cc.show(),cc.moveTo(.2,cc.p(0,40)),cc.delayTime(3),cc.hide()])))},onFire:function(e){this.isDestroyed||(this.cannonAnimationCtrl.node.rotation=-1*e+90,this.cannonAnimationCtrl.node.rotation-=this.cannonBaseNode.rotation,this.cannonAnimationCtrl.startAnimation(!1),this.lockFishCtrl&&this.lockFishCtrl.node&&this.lockLineWidgetCtrl.updateLine(this.lockFishCtrl.node.parent.convertToWorldSpaceAR(this.lockFishCtrl.node.position)))},getCannonWorldPos:function(){return this.isDestroyed?cc.p(0,0):this.cannonBaseNode.convertToWorldSpaceAR(this.cannonAnimationCtrl.node.position)},getUserHeadWorldPos:function(){return this.isDestroyed?cc.p(0,0):this.avatarSprite.node.parent.convertToWorldSpaceAR(this.avatarSprite.node.position)},getCurGold:function(){return this.roomUserInfo.userInfo.gold+this.winGold},onLeave:function(){this.isDestroyed||(this.cannonAnimationCtrl.stopAnimation(),this.node.destroy())},onChangeCannonPower:function(e,t){this.isDestroyed||(this.powerIndex=t,this.powerLabel.string=parseFloat(e.toFixed(2)).toString())},onLockFish:function(e){e&&e.node?(this.lockFishCtrl=e,this.lockLineWidgetCtrl.node.active=!0):(this.lockFishCtrl=null,this.lockLineWidgetCtrl.node.active=!1)},onBtnClick:function(e,t){if("addPower"===t){if(10===this.powerIndex)return;this.powerIndex++,this.changeCannonPowerCallback(this.powerIndex)}else if("downPower"===t){if(1===this.powerIndex)return;this.powerIndex--,this.changeCannonPowerCallback(this.powerIndex)}},onClear:function(){this.isDestroyed=!0,this.lockFishCtrl=null,this.cannonAnimationCtrl.stopAnimation(),this.node.destroy()},update:function(){this.lockFishCtrl&&this.lockFishCtrl.node&&this.lockLineWidgetCtrl.updateLine(this.lockFishCtrl.node.parent.convertToWorldSpaceAR(this.lockFishCtrl.node.position))}}),cc._RF.pop()},{"../../Shared/utils":"utils",LockLineWidgetCtrl:"LockLineWidgetCtrl",SpriteFrameAnimationWidgetCtrl:"SpriteFrameAnimationWidgetCtrl"}],ChangeAvatarDialog:[function(e,t,a){"use strict";cc._RF.push(t,"36bd3GELotLPaIwC91vMZlw","ChangeAvatarDialog"),cc.Class({extends:cc.Component,properties:{avatar:cc.Sprite,avatarItem:cc.Prefab,content:cc.Node},updatePlayerInfo:function(){this.avatar.node.active=!1,Global.CCHelper.updateSpriteFrame(Global.Player.getPy("avatar"),this.avatar,function(){this.avatar.node.active=!0}.bind(this))},start:function(){this.updatePlayerInfo(),this.items=[];for(var e=0;e<16;e++){var t={callback:function(e){cc.log(e);for(var t=0;t<this.items.length;t++)this.items[t].getComponent("AvatarItem").hideSelect(),t===e&&this.items[t].getComponent("AvatarItem").showSelect();Global.DialogManager.addLoadingCircle(),Global.API.hall.changeAvatarRequest("UserInfo/head_"+e,function(e){Global.DialogManager.removeLoadingCircle()})}.bind(this),icon:"UserInfo/head_"+e},a=cc.instantiate(this.avatarItem);a.parent=this.content,a.getComponent("AvatarItem").updateUI(t,e),a.getComponent("AvatarItem").hideSelect(),Global.Player.getPy("avatar")==="UserInfo/head_"+e&&a.getComponent("AvatarItem").showSelect(),this.items[this.items.length]=a}Global.MessageCallback.addListener("UpdateUserInfoUI",this)},onDestroy:function(){Global.MessageCallback.removeListener("UpdateUserInfoUI",this)},messageCallbackHandler:function(e,t){switch(e){case"UpdateUserInfoUI":this.updatePlayerInfo()}},onBtnClk:function(e,t){switch(t){case"close":Global.DialogManager.destroyDialog(this)}}}),cc._RF.pop()},{}],CommissionDialog:[function(e,t,a){"use strict";cc._RF.push(t,"40f1dkKBCZIF4o6zwvgiIum","CommissionDialog"),cc.Class({extends:cc.Component,properties:{yejiGroup:cc.Node,huiyuanGroup:cc.Node,dailiGroup:cc.Node,HYDLItem:cc.Prefab,huiyuanContent:cc.Node,dailiContent:cc.Node,weekTotalAchievementText:cc.Label,directlyMemberAchievementText:cc.Label,agentMemberAchievementText:cc.Label,thisWeekLowerAgentCommisionText:cc.Label,realCommisionText:cc.Label,totalCommisionText:cc.Label,lowerAgentCommisionText:cc.Label,currentLevelTip:cc.Label,directlyMemberCountText:cc.Label,weekAddedDirectlyMemberCountText:cc.Label,monthAddedDirectlyMemberCountText:cc.Label,agentMemberCountText:cc.Label,weekAddedAgentMemberCountText:cc.Label,monthAddedAgentMemberCountText:cc.Label},updateInfo:function(){var e=Global.Player;this.weekTotalAchievementText.string=(e.directlyMemberAchievement+e.agentMemberAchievement).toFixed(2),this.directlyMemberAchievementText.string=e.directlyMemberAchievement.toFixed(2),this.agentMemberAchievementText.string=e.agentMemberAchievement.toFixed(2);var t=e.directlyMemberAchievement+e.agentMemberAchievement,a=Global.AgentProfit.getProportionByNum(t);this.thisWeekLowerAgentCommisionText.string=(t*a.proportion).toFixed(2),this.currentLevelTip.string="\u5f53\u524d\u6bcf\u4e07\u5143\u8fd4{0}\u5143\n\u60a8\u4ea7\u751f\u7684\u4e1a\u7ee9\u91cf\u8fbe\u5230{1}\u5373\u6bcf\u4e07\u5143\u8fd4{2}\u5143".format(1e4*a.proportion,a.min,1e4*a.proportion),t<a.min&&(this.currentLevelTip.string="\u5f53\u524d\u6bcf\u4e07\u5143\u8fd4{0}\u5143\n\u60a8\u4ea7\u751f\u7684\u4e1a\u7ee9\u91cf\u8fbe\u5230{1}\u5373\u6bcf\u4e07\u5143\u8fd4{2}\u5143".format(0,a.min,1e4*a.proportion)),this.realCommisionText.string=e.realCommision.toFixed(2),this.totalCommisionText.string=e.totalCommision.toFixed(2),this.lowerAgentCommisionText.string=e.lowerAgentCommision.toFixed(2),this.directlyMemberCountText.string=e.directlyMemberCount,this.weekAddedDirectlyMemberCountText.string=e.weekAddedDirectlyMemberCount,this.monthAddedDirectlyMemberCountText.string=e.monthAddedDirectlyMemberCount,this.agentMemberCountText.string=e.agentMemberCount,this.weekAddedAgentMemberCountText.string=e.weekAddedAgentMemberCount,this.monthAddedAgentMemberCountText.string=e.monthAddedAgentMemberCount},showGroup:function(e){this.yejiGroup.active="yeji"===e,this.huiyuanGroup.active="huiyuan"===e,this.dailiGroup.active="daili"===e},onScrollEvent:function(e,t){switch(t){case cc.ScrollView.EventType.SCROLL_TO_BOTTOM:this.huiyuanGroup.active?this.updateHuiYuanList():this.dailiGroup.active&&this.updateDaiLiList()}},updateHuiYuanList:function(){this.huiyuanMax?cc.log("\u5df2\u52a0\u8f7d\u6240\u6709\u4f1a\u5458\u6570\u636e"):(cc.log("\u66f4\u65b0\u4f1a\u5458\u6570\u636e"),Global.DialogManager.addLoadingCircle(),Global.API.hall.getDirectlyMemberRecordDataRequest(this.huiyuanIndex,this.perCount,function(e){for(var t=e.msg.totalCount,a=e.msg.recordArr,r=0;r<a.length;r++){var i=cc.instantiate(this.HYDLItem);i.parent=this.huiyuanContent,i.getComponent("HuiYuanItem").updateUI(a[r])}this.huiyuanIndex+=this.perCount,this.huiyuanIndex>t&&(this.huiyuanMax=!0),Global.DialogManager.removeLoadingCircle()}.bind(this)))},updateDaiLiList:function(){this.dailiMax?cc.log("\u5df2\u52a0\u8f7d\u6240\u6709\u4ee3\u7406\u6570\u636e"):(cc.log("\u66f4\u65b0\u4ee3\u7406\u6570\u636e"),Global.DialogManager.addLoadingCircle(),Global.API.hall.getAgentMemberRecordDataRequest(this.dailiIndex,this.perCount,function(e){for(var t=e.msg.totalCount,a=e.msg.recordArr,r=0;r<a.length;r++){var i=cc.instantiate(this.HYDLItem);i.parent=this.huiyuanContent,i.getComponent("HuiYuanItem").updateUI(a[r])}this.dailiIndex+=this.perCount,this.dailiIndex>t&&(this.dailiMax=!0),Global.DialogManager.removeLoadingCircle()}.bind(this)))},start:function(){this.updateInfo(),this.showGroup("yeji"),this.huiyuanMax=!1,this.dailiMax=!1,this.huiyuanIndex=0,this.dailiIndex=0,this.perCount=10,this.updateHuiYuanList(),this.updateDaiLiList(),Global.MessageCallback.addListener("UpdateUserInfoUI",this)},onDestroy:function(){Global.MessageCallback.removeListener("UpdateUserInfoUI",this)},messageCallbackHandler:function(e,t){switch(e){case"UpdateUserInfoUI":this.updateInfo()}},onBtnClk:function(e,t){switch(t){case"close":Global.DialogManager.destroyDialog(this);break;case"yeji":case"huiyuan":case"daili":this.showGroup(t);break;case"tixian":if(Global.Player.realCommision<=0)return void Global.DialogManager.addTipDialog("\u53ef\u63d0\u73b0\u4f63\u91d1\u4e0d\u8db3\uff01");Global.API.hall.extractionCommissionRequest(function(e){Global.DialogManager.addPopDialog("\u63d0\u53d6\u6210\u529f\uff01")});break;case"tixianDetail":Global.DialogManager.createDialog("Commission/TiXianDetailDialog")}}}),cc._RF.pop()},{}],Constant:[function(e,t,a){"use strict";cc._RF.push(t,"c45973c8NFMO5AMVvd/cWBT","Constant");var r=t.exports={};r.gameServerAddress="server_url",r.webServerAddress="web_url",r.imgServerAddress=r.webServerAddress+"/",r.test=!1,cc._RF.pop()},{}],DDZClockWidgetCtrl:[function(e,t,a){"use strict";cc._RF.push(t,"4cf5c4FyWBGxqJnk6Sf5Tzk","DDZClockWidgetCtrl"),cc.Class({extends:cc.Component,properties:{clockTime:cc.Label},onLoad:function(){},startClock:function(e,t){this.unscheduleAllCallbacks(),this.curTime=e,this.callback=t,this.clockTime.string=this.curTime.toString(),this.schedule(this.updateClock.bind(this),1)},stopClock:function(){this.unscheduleAllCallbacks()},updateClock:function(){this.curTime--,this.curTime<0?(this.unscheduleAllCallbacks(),Global.Utils.invokeCallback(this.callback)):(this.clockTime.string=this.curTime.toString(),5===this.curTime&&Global.AudioManager.playSound("Game/DDZ/Sound/sound_remind"))},setClockEnd:function(){this.curTime=0}}),cc._RF.pop()},{}],DDZHandCradWidgetCtrl:[function(e,t,a){"use strict";cc._RF.push(t,"9184dXux19OOYL/ykLrAxSy","DDZHandCradWidgetCtrl");var r=e("./gameLogic"),i=e("./DDZProto");cc.Class({extends:cc.Component,properties:{},onLoad:function(){},initWidget:function(){this.cardNodeArr=[],this.selectedCardArr=[],this.searchOutCardResultArr=[],this.ignoreCardValueArr=[]},resetWidget:function(){this.node.removeAllChildren(),this.removeTouchCardEvent(),this.cardNodeArr=[],this.selectedCardArr=[]},onSendCard:function(e,t,a){for(var r=0;r<e.length;++r)this.addCardNode(e[r],r,t,function(e){Global.Utils.invokeCallback(a,e)}.bind(this))},startGame:function(){this.addTouchCardEvent()},addCardNode:function(e,t,a,r){var i=Global.CCHelper.createSpriteNode("Game/DDZ/Card/"+e);i.cardData=e,i.cardUp=!1,i.zIndex=t+1,this.cardNodeArr.push(i),a?this.scheduleOnce(function(){i.parent=this.node,Global.Utils.invokeCallback(r,t+1)}.bind(this),.1*(t+1)):(i.parent=this.node,Global.Utils.invokeCallback(r,t+1))},addTouchCardEvent:function(){this.node.on(cc.Node.EventType.TOUCH_START,this.onTouchCardStart,this),this.node.on(cc.Node.EventType.TOUCH_MOVE,this.onTouchMove,this),this.node.on(cc.Node.EventType.TOUCH_END,this.onTouchCardEnd,this),this.node.on(cc.Node.EventType.TOUCH_CANCEL,this.onTouchCardEnd,this)},removeTouchCardEvent:function(){this.node.off(cc.Node.EventType.TOUCH_START,this.onTouchCardStart,this),this.node.off(cc.Node.EventType.TOUCH_MOVE,this.onTouchMove,this),this.node.off(cc.Node.EventType.TOUCH_END,this.onTouchCardEnd,this),this.node.off(cc.Node.EventType.TOUCH_CANCEL,this.onTouchCardEnd,this)},onTouchCard:function(e){if(e)if(e.cardUp=!e.cardUp,e.y=e.cardUp?30:0,e.cardUp)this.selectedCardArr.push(e.cardData);else{var t=this.selectedCardArr.indexOf(e.cardData);t>=0&&this.selectedCardArr.splice(t,1)}},onTouchCardStart:function(e){var t=this.node.convertTouchToNodeSpaceAR(e.touch);this.touchStartCardIndex=this.getTouchPosIndex(t)},onTouchMove:function(e){for(var t=this.node.convertTouchToNodeSpaceAR(e.touch),a=this.getTouchPosIndex(t),r=0;r<this.cardNodeArr.length;++r){this.cardNodeArr[r].color=r>=this.touchStartCardIndex&&r<=a||r>=a&&r<=this.touchStartCardIndex?cc.Color.GRAY:cc.Color.WHITE}},onTouchCardEnd:function(e){for(var t=this.node.convertTouchToNodeSpaceAR(e.touch),a=this.getTouchPosIndex(t),o=0,n=0;n<this.cardNodeArr.length;++n){var s=this.cardNodeArr[n];s.color=cc.Color.WHITE,(n>=this.touchStartCardIndex&&n<=a||n>=a&&n<=this.touchStartCardIndex)&&(this.onTouchCard(s),o++)}if(Global.AudioManager.playSound("Game/DDZ/Sound/sound_select_card"),!(this.selectedCardArr.length<=4||o<=4)){var c=[];if(r.analyseOutCardTypeActive(this.selectedCardArr,c),c[i.cardType.SINGLE_LINE].cardTypeCount>0){for(var l=c[i.cardType.SINGLE_LINE],d=0,h=1;h<l.cardTypeCount;++h)l.eachHandCardCount[h]>l.eachHandCardCount[d]&&(d=h);var u=l.cardDataArr[d],g=this.selectedCardArr.slice();r.removeCard(u,g),this.setSelectedCard(g)}else if(c[i.cardType.DOUBLE_LINE].cardTypeCount>0){for(var C=c[i.cardType.DOUBLE_LINE],p=0,f=1;f<C.cardTypeCount;++f)C.eachHandCardCount[f]>C.eachHandCardCount[p]&&(p=f);var m=C.cardDataArr[p],A=this.selectedCardArr.slice();r.removeCard(m,A),this.setSelectedCard(A)}else if(c[i.cardType.THREE_LINE_TAKE_TWO].cardTypeCount>0){for(var b=c[i.cardType.THREE_LINE_TAKE_TWO],y=0,T=1;T<b.cardTypeCount;++T)b.eachHandCardCount[T]>b.eachHandCardCount[y]&&(y=T);var S=b.cardDataArr[y],v=this.selectedCardArr.slice();r.removeCard(S,v),this.setSelectedCard(v)}else if(c[i.cardType.THREE_LINE_TAKE_ONE].cardTypeCount>0){for(var N=c[i.cardType.THREE_LINE_TAKE_ONE],D=0,I=1;I<N.cardTypeCount;++I)N.eachHandCardCount[I]>N.eachHandCardCount[D]&&(D=I);var R=N.cardDataArr[D],_=this.selectedCardArr.slice();r.removeCard(R,_),this.setSelectedCard(_)}else if(c[i.cardType.BOMB_CARD].cardTypeCount>0){var G=c[i.cardType.BOMB_CARD].cardDataArr[0],P=this.selectedCardArr.slice();r.removeCard(G,P),this.setSelectedCard(P)}}},getTouchPosIndex:function(e){var t=this.cardNodeArr[this.cardNodeArr.length-1];if(e.x>=t.x-t.width/2)return this.cardNodeArr.length-1;var a=t.x-t.width/2-e.x,r=t.width-105,i=this.cardNodeArr.length-Math.floor(a/r)-2;return i<0&&(i=0),i},getSelectedCard:function(){return this.selectedCardArr},getAllCard:function(){for(var e=[],t=0;t<this.cardNodeArr.length;++t)e.push(this.cardNodeArr[t].cardData);return e},setSelectedCard:function(e){for(var t=0;t<e.length;++t)for(var a=e[t],r=0;r<this.cardNodeArr.length;++r)if(this.cardNodeArr[r].cardData===a){this.onTouchCard(this.cardNodeArr[r]);break}},resetCardPos:function(){for(var e=0;e<this.cardNodeArr.length;++e){var t=this.cardNodeArr[e];t.cardUp&&(t.cardUp=!1,t.y=0)}this.selectedCardArr=[]},addCard:function(e,t){function a(e){e.runAction(cc.sequence([cc.delayTime(1),cc.callFunc(function(){e.cardUp=!1,e.y=0,Global.Utils.invokeCallback(t)})]))}for(var i=0;i<e.length;++i){var o=e[i],n=Global.CCHelper.createSpriteNode("Game/DDZ/Card/"+o);n.cardData=o,n.cardUp=!0,n.y=30,n.parent=this.node;for(var s=r.getCardLogicValue(o),c=0;c<this.cardNodeArr.length;++c){var l=this.cardNodeArr[c].cardData,d=r.getCardLogicValue(l);if(d<s||d===s&&l<o){this.cardNodeArr.splice(c,0,n);break}if(c===this.cardNodeArr.length-1){this.cardNodeArr.push(n);break}}a(n,e.length)}for(var h=0;h<this.cardNodeArr.length;++h)this.cardNodeArr[h].zIndex=h+1},removeCard:function(e){this.selectedCardArr=[];for(var t=0;t<e.length;++t)for(var a=e[t],r=0;r<this.cardNodeArr.length;++r)if(this.cardNodeArr[r].cardData===a){this.cardNodeArr[r].destroy(),this.cardNodeArr.splice(r,1);break}},searchOutCard:function(e){for(var t=[],a=0;a<this.cardNodeArr.length;++a)t.push(this.cardNodeArr[a].cardData);if(this.searchOutCardResultArr.length>0){var o=this.searchOutCardResultArr[this.searchOutCardResultArr.length-1],n=r.getCardType(o);if(n===i.cardType.THREE_LINE||n===i.cardType.THREE_LINE_TAKE_ONE||n===i.cardType.THREE_LINE_TAKE_TWO){var s=r.analyseCardDataArr(o),c=r.getCardLogicValue(s.threeCardData[s.threeCardData.length-1]);this.ignoreCardValueArr.push(c)}else{var l=r.getCardLogicValue(o[o.length-1]);this.ignoreCardValueArr.push(l)}r.removeCardByValue(this.ignoreCardValueArr,t)}var d=r.searchOutCard(t,e);if(0===d.length){if(0===this.searchOutCardResultArr.length)return!1;d=this.searchOutCardResultArr[0],this.searchOutCardResultArr=[],this.ignoreCardValueArr=[]}return this.resetCardPos(),this.setSelectedCard(d),this.searchOutCardResultArr.push(d),!0},resetSearchOutCardState:function(){this.searchOutCardResultArr=[],this.ignoreCardValueArr=[]}}),cc._RF.pop()},{"./DDZProto":"DDZProto","./gameLogic":"gameLogic"}],DDZMainDialog:[function(e,t,a){"use strict";cc._RF.push(t,"2e6fbCGKH5GA7urGRR44jZD","DDZMainDialog");var r=e("../../API/RoomProto"),i=e("./DDZProto"),o=e("../../API/RoomAPI"),n=e("./gameLogic");cc.Class({extends:cc.Component,properties:{handCardWidgetCtrl:e("DDZHandCradWidgetCtrl"),operationBtnWidgetCtrl:e("DDZOperationBtnWdigetCtrl"),cardCountLabelArr:[cc.Label],showTipNodeArr:[cc.Node],showOutCardNodeArr:[cc.Node],clockPosNodeArr:[cc.Node],showHandCardNode:[cc.Node],landScoreLabel:cc.Label,nicknameLabelArr:[cc.Label],goldLabelArr:[cc.Label],userIconSpriteArr:[cc.Sprite],showOutCardWidgetPrefab:cc.Prefab,showHandCardWidgetPrefab:cc.Prefab,clockWidgetPrefab:cc.Prefab,backCardNode:cc.Node,landCapNodeArr:[cc.Node],cardNode:cc.Node,shunziAnimationPrefab:cc.Prefab,zhandanAnimationPrefab:cc.Prefab,huojianAnimationPrefab:cc.Prefab,huojianGuangAnimationPrefab:cc.Prefab,animationNode:cc.Node,fieldInfoLabel:cc.Label,trusteeshipNode:cc.Node},onLoad:function(){this.gameInited=!1,this.myChairID=-1,this.roomID="",this.baseScore=1,this.bankerUserChairID=-1,this.handCardWidgetCtrl.initWidget(),this.turnCardDataArr=[],this.landCapNode=null,this.roomUserInfoArr=[null,null,null],Global.MessageCallback.addListener("RoomMessagePush",this),Global.MessageCallback.addListener("GameMessagePush",this),Global.MessageCallback.addListener("ReConnectSuccess",this),this.scheduleOnce(function(){o.roomMessageNotify(r.getRoomSceneInfoNotify())},.2),Global.AudioManager.startPlayBgMusic("Game/DDZ/Sound/sound_bg")},onDestroy:function(){Global.MessageCallback.removeListener("RoomMessagePush",this),Global.MessageCallback.removeListener("GameMessagePush",this),Global.MessageCallback.removeListener("ReConnectSuccess",this)},messageCallbackHandler:function(e,t){if("RoomMessagePush"===e){if(t.type===r.USER_LEAVE_ROOM_RESPONSE)t.data.chairId===this.myChairID&&Global.DialogManager.removeLoadingCircle();else if(t.type===r.OTHER_USER_ENTRY_ROOM_PUSH){if(!this.gameInited)return;this.onUserEntryRoom(t.data.roomUserInfo)}else if(t.type===r.USER_LEAVE_ROOM_PUSH){if(!this.gameInited)return;this.onUserLeaveRoom(t.data.roomUserInfo)}else if(t.type===r.USER_READY_PUSH){if(!this.gameInited)return;this.onUserReady(t.data.chairId)}else if(t.type===r.GET_ROOM_SCENE_INFO_PUSH)this.gameInit(t.data.roomUserInfoArr,t.data.gameData);else if(t.type===r.ROOM_USER_INFO_CHANGE_PUSH){if(!this.gameInited)return;for(var a=0;a<this.roomUserInfoArr.length;++a)if(this.roomUserInfoArr[a].userInfo.uid===t.data.changeInfo.uid){this.roomUserInfoArr[a].userInfo=t.data.changeInfo;break}}}else if("GameMessagePush"===e){if(!this.gameInited)return;t.type===i.GAME_SEND_CARD_PUSH?this.onGameSendCard(t.data.curChairID,t.data.selfCardArr):t.type===i.GAME_SNATCH_LANDLORD_PUSH?this.onUserSnatchLand(t.data.chairID,t.data.score,t.data.curChairID,t.data.curMaxScore):t.type===i.GAME_START_PUSH?this.onGameStart(t.data.landChairID,t.data.landScore,t.data.backCardArr):t.type===i.GAME_USER_OUT_CARD_PUSH?this.onUserOutCard(t.data.chairID,t.data.outCardArr,t.data.curChairID,t.data.leftCardCount):t.type===i.GAME_USER_PASS_PUSH?this.onUserPass(t.data.chairID,t.data.curChairID,t.data.isNewTurn):t.type===i.GAME_RESULT_PUSH&&this.onGameResult(t.data)}else"ReConnectSuccess"===e&&(Global.Player.isInRoom()?Global.API.hall.joinRoomRequest(this.roomID,function(){o.roomMessageNotify(r.getRoomSceneInfoNotify())},function(){this.exitGame()}.bind(this)):this.exitGame())},onBtnClick:function(e,t){if(this.gameInited)if(Global.AudioManager.playCommonSoundClickButton(),"ready"===t){var a=this.operationBtnWidgetCtrl.getClockNode();a&&a.destroyAllChildren(),this.operationBtnWidgetCtrl.clearWidget(),Global.DialogManager.createDialog("Match/MatchGameDialog",{gameTypeID:this.gameTypeInfo.gameTypeID})}else if("point0"===t)this.onSelfSnatchLand(0);else if("point1"===t)this.onSelfSnatchLand(1);else if("point2"===t)this.onSelfSnatchLand(2);else if("point3"===t)this.onSelfSnatchLand(3);else if("pass"===t)this.selfOutCardCallback(null);else if("tip"===t)this.turnCardDataArr&&this.turnCardDataArr.length>0&&(this.handCardWidgetCtrl.searchOutCard(this.turnCardDataArr)||this.selfOutCardCallback(null));else if("outCard"===t){var i=this.handCardWidgetCtrl.getSelectedCard();this.selfOutCardCallback(i)}else if("exit"===t){if(!this.gameInited)return;Global.DialogManager.addPopDialog("\u786e\u8ba4\u9000\u51fa\u6e38\u620f?",function(){Global.Player.getPy("roomID")?(o.roomMessageNotify(r.userLeaveRoomNotify()),Global.DialogManager.addLoadingCircle()):this.exitGame()}.bind(this),function(){})}else if("settings"===t)Global.DialogManager.createDialog("Setting/SettingDialog");else if("trusteeship"===t){if(this.trusteeshipNode.active)return;this.trusteeshipNode.active=!0;var n=this.operationBtnWidgetCtrl.getClockNode();if(!n)return;var s=n.children[0];if(s&&s.active){var c=s.getComponent("DDZClockWidgetCtrl");c&&c.setClockEnd()}}else"trusteeshipCancel"===t?this.trusteeshipNode.active=!1:"help"===t&&Global.DialogManager.createDialog("GameCommon/GameRule/GameRuleDialog",{kind:Global.Enum.gameType.DDZ})},gameInit:function(e,t){this.gameInited=!0,this.gameTypeInfo=t.gameTypeInfo;for(var a=0;a<e.length;++a){var n=e[a];if(n.userInfo.uid===Global.Player.getPy("uid")){this.myChairID=n.chairId;break}}var s="";1===t.gameTypeInfo.level?s="\u521d\u7ea7\u573a":2===t.gameTypeInfo.level?s="\u4e2d\u7ea7\u573a":3===t.gameTypeInfo.level?s="\u9ad8\u7ea7\u573a":4===t.gameTypeInfo.level&&(s="\u5927\u5e08\u573a"),this.fieldInfoLabel.string="\u6597\u5730\u4e3b "+s+"  \u5e95\u5206 "+t.baseScore;for(var c=0;c<e.length;++c)this.onUserEntryRoom(e[c]);if(this.baseScore=t.baseScore,this.profitPercentage=t.profitPercentage,t.gameStatus===i.gameStatus.NONE)o.roomMessageNotify(r.userReadyNotify(!0));else if(t.gameStatus===i.gameStatus.SNATCH_LANDLORD){this.handCardWidgetCtrl.onSendCard(t.selfCardArr,!1);for(var l=0;l<3;++l)this.updateCardCount(l,t.allUserCardCountArr[l]),this.updateCallLandScore(l,t.snatchScoreArr[l]);this.landScoreLabel.string=t.landScore.toString(),t.curChairID===this.myChairID&&this.operationBtnWidgetCtrl.startCallLand(t.landScore+1),this.showClock(t.curChairID,i.SNATCH_LANDLORD_TIME,this.autoCallScore.bind(this))}else if(t.gameStatus===i.gameStatus.OUT_CARD){this.handCardWidgetCtrl.onSendCard(t.selfCardArr,!1),this.handCardWidgetCtrl.startGame(),this.bankerUserChairID=t.bankerUserChairID,this.showLandCapAnimation(this.bankerUserChairID,!1);for(var d=0;d<3;++d)this.updateCardCount(d,t.allUserCardCountArr[d]);this.landScoreLabel.string=t.landScore.toString();var h=cc.instantiate(this.showOutCardWidgetPrefab);h.getComponent("DDZShowOutCardWidgetCtrl").initWidget(t.backCardArr),h.parent=this.backCardNode,this.turnCardDataArr=t.turnCardDataArr,t.curChairID===this.myChairID&&this.operationBtnWidgetCtrl.startOutCard(t.curChairID===t.turnWinerChairID),this.showClock(t.curChairID,i.OUT_CARD_TIME,this.autoOutCard.bind(this))}},resetGame:function(e){this.handCardWidgetCtrl.resetWidget(),this.clearState(e);for(var t=0;t<3;++t)this.showOutCardNodeArr[t].removeAllChildren();this.backCardNode.removeAllChildren();for(var a=0;a<3;++a)if(0===a){var r=this.operationBtnWidgetCtrl.getClockNode();r&&r.destroyAllChildren()}else this.clockPosNodeArr[a].destroyAllChildren();this.operationBtnWidgetCtrl.clearWidget();for(var i=1;i<3;++i)this.cardCountLabelArr[i].node.parent.active=!1;this.turnCardDataArr=[],this.landCapNode.destroy(),this.landCapNode=null,this.bankerUserChairID=-1;for(var o=0;o<this.showHandCardNode.length;++o)this.showHandCardNode[o].removeAllChildren();this.landScoreLabel.string="0",this.stopSendCardAnimation(),this.trusteeshipNode.active=!1},onReconnection:function(){this.resetGame(),o.roomMessageNotify(r.getRoomSceneInfoNotify())},onUserEntryRoom:function(e){var t=this.getUserChairIndex(e.chairId);this.nicknameLabelArr[t].string=Global.Player.convertNickname(e.userInfo.nickname),this.goldLabelArr[t].string=e.userInfo.gold.toFixed(2),Global.CCHelper.updateSpriteFrame(e.userInfo.avatar,this.userIconSpriteArr[t]),t>0&&(this.nicknameLabelArr[t].node.parent.active=!0),0!=(e.userStatus&r.userStatusEnum.READY)&&0==(e.userStatus&r.userStatusEnum.PLAYING)&&this.onUserReady(e.chairId),this.roomUserInfoArr[e.chairId]=e},onUserLeaveRoom:function(e){if(e.chairId===this.myChairID)this.exitGame();else{var t=this.getUserChairIndex(e.chairId);this.nicknameLabelArr[t].node.parent.active=!1,this.roomUserInfoArr[e.chairId]=null}},updateUserInfo:function(){for(var e=0;e<3;++e){var t=this.roomUserInfoArr[e];if(e===this.myChairID){var a=this.getUserChairIndex(e);this.goldLabelArr[a].string=Global.Player.getPy("gold").toString()}else if(t){var r=this.getUserChairIndex(t.chairId);this.goldLabelArr[r].string=t.userInfo.gold.toFixed(2)}}},onUserReady:function(e){},onGameSendCard:function(e,t){0!==this.handCardWidgetCtrl.getAllCard().length&&this.handCardWidgetCtrl.resetWidget(),this.clearState(),this.handCardWidgetCtrl.onSendCard(t,!0,function(t){for(var a=0;a<3;++a)this.updateCardCount(a,t);Global.AudioManager.playSound("Game/DDZ/Sound/sound_send_card"),17===t&&(this.onStartSnatchLand(e,0),this.stopSendCardAnimation())}.bind(this)),this.showSendCardAnimation();for(var a=0;a<3;++a)this.updateCardCount(a,17)},onStartSnatchLand:function(e,t){e===this.myChairID&&this.operationBtnWidgetCtrl.startCallLand(t);var a=i.SNATCH_LANDLORD_TIME;this.trusteeshipNode.active&&e===this.myChairID&&(a=1),this.showClock(e,a,this.autoCallScore.bind(this))},onSelfSnatchLand:function(e){var t=this.operationBtnWidgetCtrl.getClockNode();t?t.destroyAllChildren():console.error("selfOutCardCallback"),this.operationBtnWidgetCtrl.clearWidget(),o.gameMessageNotify(i.gameUserSnatchLandlordNotify(e))},onUserSnatchLand:function(e,t,a,r){this.updateCallLandScore(e,t);var i=this.getUserChairIndex(e);this.clockPosNodeArr[i].destroyAllChildren(),a>=0&&this.onStartSnatchLand(a,r+1)},onGameStart:function(e,t,a){this.clearState(),this.bankerUserChairID=e,this.showLandCapAnimation(this.bankerUserChairID,!0),this.landScoreLabel.string=t.toString(),this.handCardWidgetCtrl.startGame(),e>=0&&(e===this.myChairID&&this.handCardWidgetCtrl.addCard(a),this.onUserStartOutCard(e,!0),this.updateCardCount(e,20));var r=cc.instantiate(this.showOutCardWidgetPrefab);r.getComponent("DDZShowOutCardWidgetCtrl").initWidget(a),r.parent=this.backCardNode},onUserStartOutCard:function(e,t){var a=this.getUserChairIndex(e);e===this.myChairID&&this.operationBtnWidgetCtrl.startOutCard(t);for(var r=this.showTipNodeArr[a],o=0;o<r.children.length;++o)r.children[o].active=!1;this.showOutCardNodeArr[a].removeAllChildren();var n=i.OUT_CARD_TIME;this.trusteeshipNode.active&&e===this.myChairID&&(n=1),this.showClock(e,n,this.autoOutCard.bind(this))},selfOutCardCallback:function(e){if(e){if(0===e.length)return;e=n.sortCardList(e);var t=n.getCardType(e);if(t===i.cardType.ERROR)return void Global.DialogManager.addTipDialog("\u51fa\u724c\u4e0d\u7b26\u5408\u89c4\u5219");if(this.turnCardDataArr.length>0&&!n.compareCard(this.turnCardDataArr,e))return void Global.DialogManager.addTipDialog("\u51fa\u724c\u5fc5\u987b\u5927\u8fc7\u4e0a\u8f6e");var a=this.operationBtnWidgetCtrl.getClockNode();a?a.destroyAllChildren():console.error("selfOutCardCallback"),this.operationBtnWidgetCtrl.clearWidget(),o.gameMessageNotify(i.gameUserOutCardNotify(e)),this.handCardWidgetCtrl.removeCard(e),this.handCardWidgetCtrl.resetSearchOutCardState();var r=this.getUserChairIndex(this.myChairID);this.playOutCardSound(!this.turnCardDataArr||0===this.turnCardDataArr.length,e),this.turnCardDataArr=e;var s=cc.instantiate(this.showOutCardWidgetPrefab);s.parent=this.showOutCardNodeArr[r];var c=s.getComponent("DDZShowOutCardWidgetCtrl");c.initWidget(e,r),this.playOutCardAnimation(e,c),t>=i.cardType.BOMB_CARD&&(this.landScoreLabel.string=(2*parseInt(this.landScoreLabel.string)).toString())}else{var l=this.operationBtnWidgetCtrl.getClockNode();l?l.destroyAllChildren():console.error("selfOutCardCallback"),this.operationBtnWidgetCtrl.clearWidget(),this.handCardWidgetCtrl.resetCardPos(),this.handCardWidgetCtrl.resetSearchOutCardState();var d=this.getUserChairIndex(this.myChairID);this.showTipNodeArr[d].getChildByName("pass").active=!0,o.gameMessageNotify(i.gameUserPassNotify())}},onUserOutCard:function(e,t,a,r){var o=this.getUserChairIndex(e);if(e!==this.myChairID){this.playOutCardSound(!this.turnCardDataArr||0===this.turnCardDataArr.length,t),this.turnCardDataArr=t;var s=cc.instantiate(this.showOutCardWidgetPrefab);s.parent=this.showOutCardNodeArr[o];var c=s.getComponent("DDZShowOutCardWidgetCtrl");c.initWidget(t,o),this.playOutCardAnimation(t,c),n.getCardType(t)>=i.cardType.BOMB_CARD&&(this.landScoreLabel.string=(2*parseInt(this.landScoreLabel.string)).toString())}this.clockPosNodeArr[o].destroyAllChildren(),this.updateCardCount(e,r),a>=0&&this.onUserStartOutCard(a,!1)},playOutCardSound:function(e,t){var a=n.getCardType(t);if(a===i.cardType.SINGLE){var r=n.getCardValue(t[0]);Global.AudioManager.playSound("Game/DDZ/Sound/Man/Man_"+r)}else if(a===i.cardType.DOUBLE){var o=n.getCardValue(t[0]);Global.AudioManager.playSound("Game/DDZ/Sound/Man/Man_dui"+o)}else if(a===i.cardType.THREE){var s=n.getCardValue(t[0]);Global.AudioManager.playSound("Game/DDZ/Sound/Man/Man_tuple"+s)}else a===i.cardType.SINGLE_LINE?e?Global.AudioManager.playSound("Game/DDZ/Sound/Man/Man_shunzi"):Global.AudioManager.playSound("Game/DDZ/Sound/Man/Man_dani"+Global.Utils.getRandomNum(1,3)):a===i.cardType.DOUBLE_LINE?e?Global.AudioManager.playSound("Game/DDZ/Sound/Man/Man_liandui"):Global.AudioManager.playSound("Game/DDZ/Sound/Man/Man_dani"+Global.Utils.getRandomNum(1,3)):a===i.cardType.THREE_LINE?e?Global.AudioManager.playSound("Game/DDZ/Sound/Man/Man_feiji"):Global.AudioManager.playSound("Game/DDZ/Sound/Man/Man_dani"+Global.Utils.getRandomNum(1,3)):a===i.cardType.THREE_LINE_TAKE_ONE?e?4===t.length?Global.AudioManager.playSound("Game/DDZ/Sound/Man/Man_sandaiyi"):Global.AudioManager.playSound("Game/DDZ/Sound/Man/Man_feiji"):Global.AudioManager.playSound("Game/DDZ/Sound/Man/Man_dani"+Global.Utils.getRandomNum(1,3)):a===i.cardType.THREE_LINE_TAKE_TWO?e?5===t.length?Global.AudioManager.playSound("Game/DDZ/Sound/Man/Man_sandaiyidui"):Global.AudioManager.playSound("Game/DDZ/Sound/Man/Man_feiji"):Global.AudioManager.playSound("Game/DDZ/Sound/Man/Man_dani"+Global.Utils.getRandomNum(1,3)):a===i.cardType.BOMB_CARD?Global.AudioManager.playSound("Game/DDZ/Sound/Man/Man_zhadan"):a===i.cardType.FOUR_LINE_TAKE_ONE?Global.AudioManager.playSound("Game/DDZ/Sound/Man/Man_sidaier"):a===i.cardType.FOUR_LINE_TAKE_TWO?Global.AudioManager.playSound("Game/DDZ/Sound/Man/Man_sidailiangdui"):a===i.cardType.MISSILE_CARD&&Global.AudioManager.playSound("Game/DDZ/Sound/Man/Man_wangzha")},playOutCardAnimation:function(e,t){var a=n.getCardType(e);a===i.cardType.BOMB_CARD?this.showZhadanAnimation():a===i.cardType.THREE_LINE_TAKE_ONE?e.length>4&&this.showFeijiAnimation():a===i.cardType.THREE_LINE_TAKE_TWO?e.length>5&&this.showFeijiAnimation():a===i.cardType.MISSILE_CARD?this.showHuojianAnimation():a===i.cardType.SINGLE_LINE?this.showShunziAnimation(null,t):a===i.cardType.DOUBLE_LINE&&this.showLianduiAnimation(null,t)},onUserPass:function(e,t,a){var r=this.getUserChairIndex(e);e!==this.myChairID&&(this.showTipNodeArr[r].getChildByName("pass").active=!0),a&&(this.turnCardDataArr=[]),0!==r&&this.clockPosNodeArr[r].destroyAllChildren(),t>=0&&this.onUserStartOutCard(t,a),Global.AudioManager.playSound("Game/DDZ/Sound/Man/Man_buyao1")},onGameResult:function(e){for(var t=0;t<3;++t){var a=this.getUserChairIndex(t);if(0!==a){var r=e.allCardArr[t];if(r.length>0)for(var i=0;i<r.length;i+=10){var o=cc.instantiate(this.showHandCardWidgetPrefab);o.getComponent("DDZShowHandCardWidgetCtrl").initWidget(r.slice(i,i+10),a),o.parent=this.showHandCardNode[a]}}}e.isLandWin&&this.bankerUserChairID===this.myChairID||!e.isLandWin&&this.bankerUserChairID!==this.myChairID?Global.AudioManager.playSound("Game/DDZ/Sound/sound_win"):Global.AudioManager.playSound("Game/DDZ/Sound/sound_lose"),this.scheduleOnce(function(){var t={resultData:e,myChairID:this.myChairID,baseScore:this.baseScore,profitPercentage:this.profitPercentage,bankerUserChairID:this.bankerUserChairID,buttonEventCallback:this.onBtnClick.bind(this)};Global.DialogManager.createDialog("Game/DDZ/DDZResultDialog",t,function(){this.resetGame()}.bind(this)),this.updateUserInfo()}.bind(this),3)},autoCallScore:function(){this.onSelfSnatchLand(0)},autoOutCard:function(){if(this.trusteeshipNode.active){var e=null;if(0===this.turnCardDataArr.length){var t=this.handCardWidgetCtrl.getAllCard();e=n.getCardType(t)?t.slice():[t[t.length-1]]}else this.handCardWidgetCtrl.searchOutCard(this.turnCardDataArr)&&(e=this.handCardWidgetCtrl.getSelectedCard());this.selfOutCardCallback(e)}else{var a=null;if(0===this.turnCardDataArr.length){var r=this.handCardWidgetCtrl.getAllCard();a=[r[r.length-1]]}this.selfOutCardCallback(a)}},showClock:function(e,t,a){var r=cc.instantiate(this.clockWidgetPrefab),i=r.getComponent("DDZClockWidgetCtrl"),o=this.getUserChairIndex(e);r.parent=0===o?this.operationBtnWidgetCtrl.getClockNode():this.clockPosNodeArr[o],i.startClock(t,this.myChairID===e?a:null)},updateCardCount:function(e,t){if(e!==this.myChairID){var a=this.getUserChairIndex(e);this.cardCountLabelArr[a].node.parent.active=!0,this.cardCountLabelArr[a].string=t.toString()}},updateCallLandScore:function(e,t){if(!(t<0)){var a=this.getUserChairIndex(e);this.showTipNodeArr[a].getChildByName("point"+t).active=!0,Global.AudioManager.playSound("Game/DDZ/Sound/Man/Man_fen"+t)}},getUserChairIndex:function(e){return(e-this.myChairID+3)%3},clearState:function(e){for(var t=0;t<this.showTipNodeArr.length;++t)for(var a=this.showTipNodeArr[t],r=0;r<a.children.length;++r)e&&"ready"===a.children[r].name&&a.children[r].active||(a.children[r].active=!1)},exitGame:function(){Global.DialogManager.createDialog("Hall/HallDialog",null,function(){Global.DialogManager.destroyDialog(this,!0),Global.DialogManager.destroyDialog("Game/DDZ/DDZResultDialog",!0),Global.CCHelper.releaseRes(["Game/DDZ"])}.bind(this))},showSendCardAnimation:function(){this.cardNode.active=!0,this.schedule(this.createCard,.1)},stopSendCardAnimation:function(){this.cardNode.active=!1,this.unschedule(this.createCard)},createCard:function(){var e=cc.instantiate(this.cardNode);e.active=!0,e.parent=this.cardNode.parent,e.runAction(cc.sequence([cc.moveBy(.2,cc.p(0,-300)),cc.removeSelf()]));var t=cc.instantiate(this.cardNode);t.active=!0,t.parent=this.cardNode.parent,t.runAction(cc.sequence([cc.moveBy(.2,cc.p(400,-100)),cc.removeSelf()]));var a=cc.instantiate(this.cardNode);a.active=!0,a.parent=this.cardNode.parent,a.runAction(cc.sequence([cc.moveBy(.2,cc.p(-400,-100)),cc.removeSelf()]))},showLandCapAnimation:function(e,t){this.landCapNode&&(this.landCapNode.destroy(),this.landCapNode=null),this.landCapNode=Global.CCHelper.createSpriteNode("Game/DDZ/img_land_cap");var a=this.getUserChairIndex(e),r=this.landCapNodeArr[a];if(this.landCapNode.parent=r.parent,t){this.landCapNode.scale=3;var i=cc.scaleTo(.2,1.05);i.easing(cc.easeIn(3));var o=cc.moveTo(.2,r.position);o.easing(cc.easeOut(3));var n=cc.scaleTo(.2,1);this.landCapNode.runAction(cc.sequence([i,cc.delayTime(.3),o,n]))}else this.landCapNode.x=r.x,this.landCapNode.y=r.y},showShunziAnimation:function(e,t){e||(e=t.getCenterPos());var a=cc.instantiate(this.shunziAnimationPrefab);a.parent=this.animationNode,a.position=this.animationNode.convertToNodeSpaceAR(t.node.convertToWorldSpaceAR(e));var r=a.getComponent("SpriteFrameAnimationWidgetCtrl");r.startAnimation(!1,1,function(){r.node.removeFromParent()});var i=Global.CCHelper.createSpriteNode("Game/DDZ/Animation/shunzi/shunzi");i.parent=a,i.x=-200;var o=cc.moveTo(.3,cc.p(0,0));o.easing(cc.easeOut(3)),i.runAction(cc.sequence([o,cc.fadeOut(.4),cc.removeSelf()]))},showLianduiAnimation:function(e,t){e||(e=t.getCenterPos());var a=cc.instantiate(this.shunziAnimationPrefab);a.parent=this.animationNode,a.position=this.animationNode.convertToNodeSpaceAR(t.node.convertToWorldSpaceAR(e));var r=a.getComponent("SpriteFrameAnimationWidgetCtrl");r.startAnimation(!1,1,function(){r.node.removeFromParent()});var i=Global.CCHelper.createSpriteNode("Game/DDZ/Animation/shunzi/liandui");i.parent=a,i.x=-200;var o=cc.moveTo(.3,cc.p(0,0));o.easing(cc.easeOut(3)),i.runAction(cc.sequence([o,cc.fadeOut(.4),cc.removeSelf()]))},showFeijiAnimation:function(){var e=Global.CCHelper.createSpriteNode("Game/DDZ/Animation/feiji/1q");e.parent=this.animationNode,e.x=-800,e.y=0;var t=cc.moveTo(.6,cc.p(0,0));t.easing(cc.easeOut(2));var a=cc.moveTo(.6,cc.p(800,0));a.easing(cc.easeIn(2)),e.runAction(cc.sequence([t,a,cc.removeSelf()])),this.scheduleOnce(function(){var e=cc.instantiate(this.shunziAnimationPrefab);e.parent=this.animationNode,e.x=0,e.y=-100;var t=e.getComponent("SpriteFrameAnimationWidgetCtrl");t.startAnimation(!1,1,function(){t.node.removeFromParent()});var a=Global.CCHelper.createSpriteNode("Game/DDZ/Animation/feiji/1w");a.parent=e,a.x=-200,a.y=0;var r=cc.moveTo(.3,cc.p(0,0));r.easing(cc.easeOut(2)),a.runAction(cc.sequence([r,cc.fadeOut(.4),cc.removeSelf()]))}.bind(this),1)},showZhadanAnimation:function(){var e=Global.CCHelper.createSpriteNode("Game/DDZ/Animation/zhadan/o");e.x=-200,e.parent=this.animationNode,e.runAction(cc.sequence([cc.jumpTo(.3,cc.p(0,0),100,1),cc.callFunc(function(){var t=cc.instantiate(this.zhandanAnimationPrefab);t.parent=this.animationNode;var a=t.getComponent("SpriteFrameAnimationWidgetCtrl");a.startAnimation(!1,1,function(){a.node.removeFromParent()}),e.removeFromParent();var r=Global.CCHelper.createSpriteNode("Game/DDZ/Animation/zhadan/1");r.scale=.6;var i=cc.scaleTo(.5,1);i.easing(cc.easeBackOut()),r.runAction(cc.sequence([i,cc.delayTime(.2),cc.fadeOut(.3),cc.removeSelf()])),r.parent=this.animationNode}.bind(this))]))},showHuojianAnimation:function(){var e=cc.instantiate(this.huojianAnimationPrefab);e.parent=this.animationNode;var t=e.getComponent("SpriteFrameAnimationWidgetCtrl");t.startAnimation(!1,1,function(){t.node.removeFromParent()});var a=Global.CCHelper.createSpriteNode("Game/DDZ/Animation/huojian/11111111");a.parent=this.animationNode;var r=cc.moveTo(.5,cc.p(0,1e3));r.easing(cc.easeIn(1.5));var i=cc.moveTo(.8,cc.p(0,0));i.easing(cc.easeIn(2)),a.runAction(cc.sequence([r,cc.callFunc(function(){a.scaleY=-1}.bind(this)),i,cc.callFunc(function(){var e=cc.instantiate(this.huojianGuangAnimationPrefab);e.parent=this.animationNode;var t=e.getComponent("SpriteFrameAnimationWidgetCtrl");t.startAnimation(!1,1,function(){t.node.removeFromParent()});var a=Global.CCHelper.createSpriteNode("Game/DDZ/Animation/huojian/2222");a.scale=.6;var r=cc.scaleTo(.5,1);r.easing(cc.easeBackOut()),a.runAction(cc.sequence([r,cc.delayTime(.2),cc.fadeOut(.3),cc.removeSelf()])),a.parent=this.animationNode}.bind(this)),cc.removeSelf()]))}}),cc._RF.pop()},{"../../API/RoomAPI":"RoomAPI","../../API/RoomProto":"RoomProto","./DDZProto":"DDZProto","./gameLogic":"gameLogic",DDZHandCradWidgetCtrl:"DDZHandCradWidgetCtrl",DDZOperationBtnWdigetCtrl:"DDZOperationBtnWdigetCtrl"}],DDZOperationBtnWdigetCtrl:[function(e,t,a){"use strict";cc._RF.push(t,"16b81g7NpVEYqV/DbfEv0m0","DDZOperationBtnWdigetCtrl"),cc.Class({extends:cc.Component,properties:{callLandNode:cc.Node,outCardNode:cc.Node,readyNode:cc.Node},onLoad:function(){},startReady:function(){this.callLandNode.active=!1,this.outCardNode.active=!1,this.readyNode.active=!0},startCallLand:function(e){this.callLandNode.active=!0,this.outCardNode.active=!1,this.readyNode.active=!1;for(var t=1;t<=3;++t){var a=this.callLandNode.getChildByName(t.toString());a&&(a.active=e<=t)}},startOutCard:function(e){this.callLandNode.active=!1,this.outCardNode.active=!0,this.readyNode.active=!1,this.outCardNode.getChildByName("buchu").active=!e,this.outCardNode.getChildByName("tip").active=!e},clearWidget:function(){this.callLandNode.active=!1,this.outCardNode.active=!1,this.readyNode.active=!1},getClockNode:function(){return this.callLandNode.active?this.callLandNode.getChildByName("selfClockNode"):this.outCardNode.active?this.outCardNode.getChildByName("selfClockNode"):this.readyNode.active?this.readyNode.getChildByName("selfClockNode"):null}}),cc._RF.pop()},{}],DDZProto:[function(e,t,a){"use strict";cc._RF.push(t,"2a249M06lFD2I0FfKkvDin0","DDZProto");var r=t.exports;r.GAME_SNATCH_LANDLORD_NOTIFY=301,r.GAME_SNATCH_LANDLORD_PUSH=401,r.GAME_USER_OUT_CARD_NOTIFY=302,r.GAME_USER_OUT_CARD_PUSH=402,r.GAME_USER_PASS_NOTIFY=303,r.GAME_USER_PASS_PUSH=403,r.GAME_SEND_CARD_PUSH=404,r.GAME_START_PUSH=405,r.GAME_RESULT_PUSH=406,r.gameStatus={NONE:0,SNATCH_LANDLORD:1,OUT_CARD:2,GAME_END:3},r.READY_TIME=20,r.SNATCH_LANDLORD_TIME=15,r.OUT_CARD_TIME=15,r.cardType={ERROR:0,SINGLE:1,DOUBLE:2,THREE:3,SINGLE_LINE:4,DOUBLE_LINE:5,THREE_LINE:6,THREE_LINE_TAKE_ONE:7,THREE_LINE_TAKE_TWO:8,FOUR_LINE_TAKE_ONE:9,FOUR_LINE_TAKE_TWO:10,BOMB_CARD:11,MISSILE_CARD:12},r.gameSendCardPush=function(e,t){return{type:this.GAME_SEND_CARD_PUSH,data:{curChairID:e,selfCardArr:t}}},r.gameUserSnatchLandlordNotify=function(e){return{type:this.GAME_SNATCH_LANDLORD_NOTIFY,data:{score:e}}},r.gameUserSnatchLandlordPush=function(e,t,a,r){return{type:this.GAME_SNATCH_LANDLORD_PUSH,data:{chairID:a,curChairID:t,score:e,curMaxScore:r}}},r.gameStartPush=function(e,t,a){return{type:this.GAME_START_PUSH,data:{landChairID:e,landScore:t,backCardArr:a}}},r.gameUserOutCardNotify=function(e){return{type:this.GAME_USER_OUT_CARD_NOTIFY,data:{outCardArr:e}}},r.gameUserOutCardPush=function(e,t,a,r){return{type:this.GAME_USER_OUT_CARD_PUSH,data:{chairID:e,curChairID:t,outCardArr:a,leftCardCount:r}}},r.gameUserPassNotify=function(){return{type:this.GAME_USER_PASS_NOTIFY,data:{}}},r.gameUserPassPush=function(e,t,a){return{type:this.GAME_USER_PASS_PUSH,data:{chairID:e,curChairID:t,isNewTurn:a}}},r.gameResultPush=function(e,t,a,r,i,o){return{type:this.GAME_RESULT_PUSH,data:{allCardArr:e,scoreChangeArr:t,bombTimes:a,nicknameArr:r,isSpring:i,isLandWin:o}}},cc._RF.pop()},{}],DDZResultDialog:[function(e,t,a){"use strict";cc._RF.push(t,"e9e4aRyKLFHjYMMbpyfY2xa","DDZResultDialog"),cc.Class({extends:cc.Component,properties:{rowTitleNode:cc.Node,resultInfoItemArr:[cc.Node],lostNode:cc.Node,winNode:cc.Node,frameBg:cc.Node,btnNode:cc.Node,rowTitleGold:cc.Label,profitPercentageLabel:cc.Label},onLoad:function(){var e=this.dialogParameters.resultData,t=this.dialogParameters.baseScore,a=this.dialogParameters.myChairID,r=this.dialogParameters.bankerUserChairID;this.buttonEventCallback=this.dialogParameters.buttonEventCallback,this.dialogParameters.profitPercentage>0?this.profitPercentageLabel.string="\u62bd\u53d6\u8d62\u5f97\u91d1\u5e01\u7684{0}%\u4f5c\u4e3a\u53f0\u8d39".format(this.dialogParameters.profitPercentage):this.profitPercentageLabel.node.active=!1;var i=a===r;e.isLandWin===i?(this.lostNode.active=!1,this.winNode.active=!0):(this.lostNode.active=!0,this.winNode.active=!1);for(var o=0;o<3;++o){var n=this.resultInfoItemArr[o],s=n.getChildByName("nickname").getComponent(cc.Label);s.string=Global.Player.convertNickname(e.nicknameArr[o]);var c=n.getChildByName("baseScore").getComponent(cc.Label);c.string=t.toString();var l=n.getChildByName("landScore").getComponent(cc.Label);l.string=e.bombTimes.toString();var d=n.getChildByName("gold").getComponent(cc.Label),h=e.scoreChangeArr[o],u=h.toFixed(2);if(d.string=h>=0?"+"+u:u.toString(),o===a){var g=new cc.Color(255,180,0);s.node.color=g,c.node.color=g,l.node.color=g,d.node.color=g}o===r&&(n.getChildByName("land").active=!0)}this.showAnimation(e.isLandWin===i)},onBtnClick:function(e,t){Global.AudioManager.playCommonSoundClickButton(),"ready"===t?(Global.DialogManager.destroyDialog(this,!0),Global.Utils.invokeCallback(this.buttonEventCallback,e,t)):"exit"===t&&Global.Utils.invokeCallback(this.buttonEventCallback,e,t)},showAnimation:function(e){var t=null;(t=e?this.winNode.getChildByName("titleBg"):this.lostNode.getChildByName("titleBg")).scale=3;var a=cc.scaleTo(.3,1);a.easing(cc.easeIn(3)),t.runAction(a),this.frameBg.opacity=0,this.frameBg.runAction(cc.sequence([cc.delayTime(.3),cc.fadeTo(.3,100)])),this.rowTitleNode.runAction(cc.sequence([cc.hide(),cc.delayTime(.4),cc.show()]));for(var r=0;r<3;++r){var i=this.resultInfoItemArr[r];i.opacity=0,i.runAction(cc.sequence([cc.delayTime(.7+.2*r),cc.fadeIn(.2)]))}}}),cc._RF.pop()},{}],DDZShowHandCardWidgetCtrl:[function(e,t,a){"use strict";cc._RF.push(t,"c6ce9MGHkVPY57zHFZIRwgV","DDZShowHandCardWidgetCtrl"),cc.Class({extends:cc.Component,properties:{},onLoad:function(){},initWidget:function(e,t){for(var a=0;a<e.length;++a){Global.CCHelper.createSpriteNode("Game/DDZ/CardSmall/"+e[a]).parent=this.node}1===t?this.node.anchorX=1:2===t&&(this.node.anchorX=0)}}),cc._RF.pop()},{}],DDZShowOutCardWidgetCtrl:[function(e,t,a){"use strict";cc._RF.push(t,"db3eekoqMpBO6AUku5MXLhG","DDZShowOutCardWidgetCtrl"),cc.Class({extends:cc.Component,properties:{},onLoad:function(){},initWidget:function(e,t){for(var a=0;a<e.length;++a){Global.CCHelper.createSpriteNode("Game/DDZ/Card/"+e[a]).parent=this.node}1===t?this.node.anchorX=1:2===t&&(this.node.anchorX=0),this.node.scale=.45;var r=cc.scaleTo(.15,.5);r.easing(cc.easeBackOut()),this.node.runAction(r)},getCenterPos:function(){return 1===this.node.anchorX?cc.p(-30*this.node.childrenCount,0):0===this.node.anchorX?cc.p(30*this.node.childrenCount,0):cc.p(0,0)}}),cc._RF.pop()},{}],DZGameLogic:[function(e,t,a){"use strict";cc._RF.push(t,"3d439iouylCqZ+ptNm3loSW","DZGameLogic");var r=t.exports,i=e("../../Shared/utils"),o=e("./DZProto");r.CARD_DATA_ARRAY=[1,2,3,4,5,6,7,8,9,10,11,12,13,17,18,19,20,21,22,23,24,25,26,27,28,29,33,34,35,36,37,38,39,40,41,42,43,44,45,49,50,51,52,53,54,55,56,57,58,59,60,61];r.getCardValue=function(e){return 15&e},r.getCardColor=function(e){return 240&e},r.getCardLogicValue=function(e){var t=r.getCardValue(e);return 1===t?t+13:t},r.getRandCardList=function(){var e=this.CARD_DATA_ARRAY.slice(),t=[],a=e.length,r=0,i=0;do{i=Math.floor(Math.random()*(a-r)),t[r++]=e[i],e[i]=e[a-r]}while(r<a);return t},r.sortCardList=function(e){e.sort(function(e,t){var a=r.getCardLogicValue(e),i=r.getCardLogicValue(t);return a!==i?i-a:t-e})},r.getCardType=function(e){for(var t=!0,a=!0,i=r.getCardColor(e[0]),n=r.getCardLogicValue(e[0]),s=1;s<e.length&&(t&&r.getCardColor(e[s])!==i&&(t=!1),a&&n!==r.getCardLogicValue(e[s])+s&&(a=!1),t||a);s++);if(!a&&14===n)for(var c=1;c<e.length;c++){if(n!==r.getCardLogicValue(e[c])+c+8)break;c===e.length-1&&(a=!0)}if(t&&a&&13===r.getCardLogicValue(e[1]))return o.cardType.KING_TONG_HUA_SHUN;if(!t&&a)return o.cardType.SHUN_ZI;if(t&&!a)return o.cardType.TONG_HUA;if(t&&a)return o.cardType.TONG_HUA_SHUN;var l=r.analyseCardData(e);return 1===l.fourCount?o.cardType.TIE_ZHI:2===l.doubleCount?o.cardType.TWO_DOUBLE:1===l.doubleCount&&1===l.threeCount?o.cardType.HU_LU:1===l.threeCount&&0===l.doubleCount?o.cardType.THREE:1===l.doubleCount&&3===l.singleCount?o.cardType.ONE_DOUBLE:o.cardType.SINGLE},r.analyseCardData=function(e){for(var t={singleCount:0,singleLogicValue:[],doubleCount:0,doubleLogicValue:[],threeCount:0,threeLogicValue:[],fourCount:0,fourLogicValue:[]},a=0;a<e.length;a++){for(var i=1,o=[e[a],0,0,0],n=r.getCardLogicValue(e[a]),s=a+1;s<e.length&&r.getCardLogicValue(e[s])===n;s++)o[i++]=e[s];switch(i){case 1:t.singleCount++,t.singleLogicValue.push(r.getCardLogicValue(o[0]));break;case 2:t.doubleCount++,t.doubleLogicValue.push(r.getCardLogicValue(o[0]));break;case 3:t.threeCount++,t.threeLogicValue.push(r.getCardLogicValue(o[0]));break;case 4:t.fourCount++,t.fourLogicValue.push(r.getCardLogicValue(o[0]))}a+=i-1}return t},r.fiveFromSeven=function(e,t){var a=e.concat(t);a.length<5&&console.error("fiveFromSeven err count < 5"),r.sortCardList(a);for(var o=i.getCombinationFlagArrs(a.length,5),n=-1,s=[],c=0;c<o.length;++c){for(var l=o[c],d=[],h=0;h<l.length;++h)l[h]&&d.push(a[h]);var u=r.getCardType(d);n<u?(n=u,s=d):n===u&&2===r.compareCard(d,s)&&(n=u,s=d)}return s},r.compareCard=function(e,t){if(e.length!==t.length)return console.error("compareCard err: card count err"),0;var a=r.getCardType(t),i=r.getCardType(e);if(i>a)return 2;if(i<a)return 1;switch(i){case o.cardType.SINGLE:for(var n=0;n<e.length;n++){var s=r.getCardLogicValue(t[n]),c=r.getCardLogicValue(e[n]);if(c>s)return 2;if(c<s)return 1;if(n===e.length-1)return 0}break;case o.cardType.ONE_DOUBLE:case o.cardType.TWO_DOUBLE:case o.cardType.THREE:case o.cardType.TIE_ZHI:case o.cardType.HU_LU:var l=r.analyseCardData(t),d=r.analyseCardData(e);if(d.fourCount>0){var h=l.fourLogicValue[0],u=d.fourLogicValue[0];return u!==h?u>h?2:1:(u=d.singleLogicValue[0])!==(h=d.singleLogicValue[0])?u>h?2:1:0}if(d.threeCount>0){var g=l.threeLogicValue[0],C=d.threeLogicValue[0];if(C!==g)return C>g?2:1;if(o.cardType.HU_LU===i)return(C=d.doubleLogicValue[0])!==(g=d.doubleLogicValue[0])?C>g?2:1:0;for(var p=0;p<d.singleLogicValue.length;p++){var f=l.singleLogicValue[p],m=d.singleLogicValue[p];if(m>f)return 2;if(m<f)return 1;if(p===d.singleCount-1)return 0}}for(var A=0;A<d.doubleCount;A++){var b=l.doubleLogicValue[A],y=d.doubleLogicValue[A];if(y>b)return 2;if(y<b)return 1}for(var T=0;T<d.singleCount;T++){var S=l.singleLogicValue[T],v=d.singleLogicValue[T];if(v>S)return 2;if(v<S)return 1;if(T===d.singleCount-1)return 0}break;case o.cardType.SHUN_ZI:case o.cardType.TONG_HUA_SHUN:var N=r.getCardLogicValue(t[0]),D=r.getCardLogicValue(e[0]),I=D===r.getCardLogicValue(e[1])+9,R=N===r.getCardLogicValue(t[1])+9;return I&&!R?1:!I&&R?2:D===N?0:D>N?2:1;case o.cardType.TONG_HUA:for(var _=0;_<e.length;_++){var G=r.getCardLogicValue(t[_]),P=r.getCardLogicValue(e[_]);if(P>G)return 2;if(P<G)return 1;if(_===e.length-1)return 0}}return 0},r.selectMaxUser=function(e){for(var t=[],a=void 0,i=0;i<e.length;i++){if(e[i]){a=i;break}if(i===e.length-1)return t}for(var o=a+1;o<e.length;o++)e[o]&&r.compareCard(e[o],e[a])>1&&(a=o);t.push(a);for(var n=0;n<e.length;n++)n!==a&&e[n]&&0===r.compareCard(e[n],e[a])&&t.push(n);return t},r.getKeyCardArr=function(e){if(!(e.length<5)){var t=r.getCardType(e);switch(t){case o.cardType.SINGLE:for(var a=e[0],i=1;i<e.length;++i)r.getCardLogicValue(a)<r.getCardLogicValue(e[i])&&(a=e[i]);return[a];case o.cardType.ONE_DOUBLE:case o.cardType.TWO_DOUBLE:case o.cardType.THREE:case o.cardType.TIE_ZHI:for(var n={singleCardData:[],doubleCardData:[],threeCardData:[],fourCardData:[]},s=0;s<e.length;s++){for(var c=1,l=[e[s],0,0,0],d=r.getCardLogicValue(e[s]),h=s+1;h<e.length&&r.getCardLogicValue(e[h])===d;h++)l[c++]=e[h];switch(c){case 1:n.singleCardData.push(l[0]);break;case 2:n.doubleCardData.push(l[0]),n.doubleCardData.push(l[1]);break;case 3:n.threeCardData.push(l[0]),n.threeCardData.push(l[1]),n.threeCardData.push(l[2]);break;case 4:n.fourCardData.push(l[0]),n.fourCardData.push(l[1]),n.fourCardData.push(l[2]),n.fourCardData.push(l[3])}s+=c-1}if(t===o.cardType.ONE_DOUBLE||t===o.cardType.TWO_DOUBLE)return n.doubleCardData;if(t===o.cardType.THREE)return n.threeCardData;if(t===o.cardType.TIE_ZHI)return n.fourCardData;break;default:return e}}},cc._RF.pop()},{"../../Shared/utils":"utils","./DZProto":"DZProto"}],DZGameRecordDialog:[function(e,t,a){"use strict";cc._RF.push(t,"dfc01zOtixEwLLnPbDjGnia","DZGameRecordDialog"),cc.Class({extends:cc.Component,properties:{contentNode:cc.Node,itemNode:cc.Node,winColor:cc.Color,lostColor:cc.Color},start:function(){Global.API.hall.getGameRecordDataRequest({kind:Global.Enum.gameType.DZ,uid:Global.Player.uid},{createTime:-1},function(e){for(var t=0;t<e.msg.recordArr.length;++t){var a=e.msg.recordArr[t],r=cc.instantiate(this.itemNode);r.getChildByName("drawID").getComponent(cc.Label).string=a.drawID||"";var i="";1===a.roomLevel?i="\u4f53\u9a8c\u623f":2===a.roomLevel?i="\u521d\u7ea7\u623f":3===a.roomLevel?i="\u4e2d\u7ea7\u623f":4===a.roomLevel?i="\u9ad8\u7ea7\u623f":5===a.roomLevel?i="\u8d22\u5927\u6c14\u7c97":6===a.roomLevel?i="\u8170\u7f20\u4e07\u8d2f":7===a.roomLevel?i="\u6325\u571f\u5982\u91d1":8===a.roomLevel&&(i="\u5bcc\u8d35\u903c\u4eba"),r.getChildByName("roomLevel").getComponent(cc.Label).string=i;var o=r.getChildByName("winGold").getComponent(cc.Label);a.changeGold>0?(o.node.color=this.winColor,o.string="+"+Global.Utils.formatNumberToString(a.changeGold,2)):(o.node.color=this.lostColor,o.string=Global.Utils.formatNumberToString(a.changeGold,2)),r.getChildByName("gameTime").getComponent(cc.Label).string=new Date(a.createTime).format("yyyy-MM-dd hh:mm:ss"),r.active=!0,r.parent=this.contentNode}}.bind(this))},onClose:function(){Global.DialogManager.destroyDialog(this,!0)}}),cc._RF.pop()},{}],DZGameRuleDialog:[function(e,t,a){"use strict";cc._RF.push(t,"c2384EbkJZEtKQgpKbCcaE1","DZGameRuleDialog"),cc.Class({extends:cc.Component,properties:{},start:function(){},onBtnClick:function(){Global.DialogManager.destroyDialog(this,!0)}}),cc._RF.pop()},{}],DZHandCardWidgetCtrl:[function(e,t,a){"use strict";cc._RF.push(t,"61c6aqCqoVOarfU5DRewKBL","DZHandCardWidgetCtrl");var r=e("./DZProto"),i=e("./DZGameLogic");cc.Class({extends:cc.Component,properties:{cardSpriteArr:[cc.Sprite],cardTypeSprite:cc.Sprite,lightNodeArr:[cc.Node]},onLoad:function(){this.cardPosArr=[this.cardSpriteArr[0].node.position,this.cardSpriteArr[1].node.position]},sendCard:function(e,t,a){if(t===r.gameStatus.PLAYING)if(this.node.active=!0,this.cardDataArr=e,this.cardSpriteArr[0].node.opacity=255,this.cardSpriteArr[1].node.opacity=255,this.cardSpriteArr[0].node.active=!0,this.cardSpriteArr[1].node.active=!0,this.cardSpriteArr[0].node.position=this.cardPosArr[0],this.cardSpriteArr[1].node.position=this.cardPosArr[1],a>=0){var i=function(t,a,r,i){var s=a.node;s.position=s.parent.convertToNodeSpaceAR(o);var c=cc.moveTo(n,r);e||(s.scale=1/.6),c=cc.spawn([c,cc.scaleTo(n,1)]);var l=[cc.delayTime(i),c];e&&(l.push(cc.scaleTo(.1,.01,1)),l.push(cc.callFunc(function(){Global.CCHelper.updateSpriteFrame("GameCommon/Card/"+t,a)}.bind(this))),l.push(cc.scaleTo(.1,1,1))),s.runAction(cc.sequence(l))};Global.CCHelper.updateSpriteFrame("GameCommon/Card/card_back",this.cardSpriteArr[0]),Global.CCHelper.updateSpriteFrame("GameCommon/Card/card_back",this.cardSpriteArr[1]);for(var o=this.node.parent.parent.convertToWorldSpaceAR(cc.v2(0,0)),n=.3,s=0;s<this.cardSpriteArr.length;++s)i(e?e[s]:null,this.cardSpriteArr[s],this.cardPosArr[s],.1*s+.2*a+.2)}else e&&0!==e.length?(Global.CCHelper.updateSpriteFrame("GameCommon/Card/"+e[0],this.cardSpriteArr[0]),Global.CCHelper.updateSpriteFrame("GameCommon/Card/"+e[1],this.cardSpriteArr[1])):(Global.CCHelper.updateSpriteFrame("GameCommon/Card/card_back",this.cardSpriteArr[0]),Global.CCHelper.updateSpriteFrame("GameCommon/Card/card_back",this.cardSpriteArr[1]))},showCard:function(e){if(e&&0!==e.length&&!(this.cardDataArr&&this.cardDataArr.length>0))for(var t=0;t<this.cardSpriteArr.length;++t)a(e?e[t]:null,this.cardSpriteArr[t],.1*t);function a(t,a,r){var i=a.node,o=[cc.delayTime(r)];e&&(o.push(cc.scaleTo(.1,.01,1)),o.push(cc.callFunc(function(){Global.CCHelper.updateSpriteFrame("GameCommon/Card/"+t,a)}.bind(this))),o.push(cc.scaleTo(.1,1,1))),i.runAction(cc.sequence(o))}},updatePublicCard:function(e){if(this.cardDataArr&&0!==this.cardDataArr.length){var t=e.concat(this.cardDataArr),a=i.fiveFromSeven(t),r=i.getCardType(a);return this.cardTypeSprite.node.parent.active=!0,Global.CCHelper.updateSpriteFrame("Game/DeZhouPoker/self_card_type_"+r,this.cardTypeSprite),a}},resetWidget:function(){this.cardPosArr&&0!==this.cardPosArr.length&&(this.cardSpriteArr[0].node.active=!1,this.cardSpriteArr[1].node.active=!1,this.cardSpriteArr[0].node.position=this.cardPosArr[0],this.cardSpriteArr[1].node.position=this.cardPosArr[1],this.cardSpriteArr[0].node.opacity=255,this.cardSpriteArr[1].node.opacity=255,this.cardTypeSprite.node.parent.active=!1,this.node.active=!1)},giveUp:function(e){e||(this.cardSpriteArr[0].node.active=!0,this.cardSpriteArr[1].node.active=!0)},setCardDataArrLight:function(e){if(this.cardDataArr)for(var t=0;t<this.cardDataArr.length;++t)this.lightNodeArr[t].active=-1!==e.indexOf(this.cardDataArr[t])}}),cc._RF.pop()},{"./DZGameLogic":"DZGameLogic","./DZProto":"DZProto"}],DZMainDialog:[function(e,t,a){"use strict";cc._RF.push(t,"30e8epBYyZJ4Jf+lhetJnVM","DZMainDialog");var r=e("../../API/RoomProto"),i=e("./DZProto"),o=e("../../API/RoomAPI"),n=e("./DZGameLogic");cc.Class({extends:cc.Component,properties:{userHeadPosNodeArr:[cc.Node],userHeadWidgetPrefab:cc.Prefab,publicCardWidgetCtrl:e("DZPublicCardWidgetCtrl"),handCardPosNodeArr:[cc.Node],handCardWidgetPrefab:cc.Prefab,operationWidgetCtrl:e("DZOperationWidgetCtrl"),userBetCountLabelArr:[cc.Label],totalBetCountLabel:cc.Label,gameIndexLabel:cc.Label,bankerLogoNode:cc.Node,bankerLogoPosNodeArr:[cc.Node],continueNode:cc.Node,goldAnimationRoot:cc.Node,youWinNode:cc.Node,showWinCardTypeRoot:cc.Node,showWinCardTypePrefab:cc.Prefab},onLoad:function(){this.gameInited=!1,this.myChairID=-1,this.gameTypeInfo=null,this.curUserChairID=-1,this.reMatchGame=!1,this.totalBetCount=0,this.roomUserInfoArr=[],this.handCardWidgetCtrlArr=[],this.userHeadWidgetCtrlArr=[];for(var e=0;e<9;++e){this.roomUserInfoArr.push(null);var t=cc.instantiate(this.handCardWidgetPrefab),a=t.getComponent("DZHandCardWidgetCtrl");this.handCardWidgetCtrlArr.push(a),t.parent=this.handCardPosNodeArr[e];var i=cc.instantiate(this.userHeadWidgetPrefab),n=i.getComponent("DZUserHeadWidgetCtrl");this.userHeadWidgetCtrlArr.push(n),i.parent=this.userHeadPosNodeArr[e]}Global.MessageCallback.addListener("RoomMessagePush",this),Global.MessageCallback.addListener("GameMessagePush",this),Global.MessageCallback.addListener("ReConnectSuccess",this),this.scheduleOnce(function(){o.roomMessageNotify(r.getRoomSceneInfoNotify())},.2)},onDestroy:function(){Global.MessageCallback.removeListener("RoomMessagePush",this),Global.MessageCallback.removeListener("GameMessagePush",this),Global.MessageCallback.removeListener("ReConnectSuccess",this)},messageCallbackHandler:function(e,t){if("RoomMessagePush"===e){if(t.type===r.USER_LEAVE_ROOM_RESPONSE)t.data.chairId===this.myChairID&&Global.DialogManager.removeLoadingCircle();else if(t.type===r.OTHER_USER_ENTRY_ROOM_PUSH){if(!this.gameInited)return;this.onUserEntryRoom(t.data.roomUserInfo)}else if(t.type===r.USER_LEAVE_ROOM_PUSH){if(!this.gameInited)return;this.onUserLeaveRoom(t.data.roomUserInfo)}else if(t.type===r.USER_READY_PUSH){if(!this.gameInited)return;this.onUserReady(t.data.chairId)}else if(t.type===r.GET_ROOM_SCENE_INFO_PUSH)this.gameTypeInfo=t.data.gameTypeInfo,this.gameIndexLabel.string=t.data.drawID,this.gameInit(t.data.roomUserInfoArr,t.data.gameData);else if(t.type===r.ROOM_USER_INFO_CHANGE_PUSH){if(!this.gameInited)return;for(var a=0;a<this.roomUserInfoArr.length;++a)if(this.roomUserInfoArr[a].userInfo.uid===t.data.changeInfo.uid){this.roomUserInfoArr[a].userInfo=t.data.changeInfo;break}}}else if("GameMessagePush"===e){if(!this.gameInited)return;t.type===i.GAME_START_PUSH?this.onGameStart(t.data):t.type===i.GAME_SEND_CARD_PUSH?this.onGameSendCard(t.data.cardDataArr,t.data.nextUserChairID,t.data.curBetCount,t.data.maxBetCount,t.data.totalBetCount):t.type===i.GAME_USER_BET_PUSH?this.onUserBet(t.data.chairID,t.data.count,t.data.curTurnTotalBetCount,t.data.nextUserChairID,t.data.curBetCount,t.data.maxBetCount,t.data.operationType):t.type===i.GAME_USER_GIVE_UP_PUSH?this.onUserGiveUp(t.data.chairID,t.data.nextUserChairID,t.data.curBetCount,t.data.maxBetCount):t.type===i.GAME_END_PUSH?this.onGameResult(t.data):t.type===i.GAME_USER_UPDATE_TAKE_GOLD_PUSH&&this.updateTakeGold(t.data.chairID,t.data.takeGold)}else"ReConnectSuccess"===e&&(Global.Player.isInRoom()?Global.API.hall.joinRoomRequest(this.roomID,function(){o.roomMessageNotify(r.getRoomSceneInfoNotify())},function(){this.exitGame()}.bind(this)):this.exitGame())},onBtnClick:function(e,t){if(this.gameInited)if(Global.AudioManager.playCommonSoundClickButton(),"continue"===t){if(Global.Player.isInRoom())return this.reMatchGame=!0,Global.API.room.roomMessageNotify(r.userLeaveRoomNotify()),void Global.DialogManager.addLoadingCircle();Global.DialogManager.createDialog("Match/MatchGameDialog",{gameTypeID:this.gameTypeInfo.gameTypeID})}else"exit"===t?Global.DialogManager.addPopDialog("\u786e\u8ba4\u9000\u51fa\u6e38\u620f?",function(){Global.Player.getPy("roomID")?(o.roomMessageNotify(r.userLeaveRoomNotify()),Global.DialogManager.addLoadingCircle()):this.exitGame()}.bind(this),function(){}):"settings"===t?Global.DialogManager.createDialog("Setting/SettingDialog"):"rule"===t&&Global.DialogManager.createDialog("Game/DeZhouPoker/RoomLayer/DZGameRuleDialog")},gameInit:function(e,t){this.gameInited=!0;for(var a=0;a<e.length;++a){var o=e[a];if(o.userInfo.uid===Global.Player.getPy("uid")){this.myChairID=o.chairId;break}}this.roomUserInfoArr=[null,null,null,null,null,null,null,null,null];for(var n=0;n<e.length;++n)this.onUserEntryRoom(e[n]);for(var s=0;s<this.roomUserInfoArr.length;++s)if(!this.roomUserInfoArr[s]){var c=this.getUserChairIndex(s);this.userHeadWidgetCtrlArr[c].resetWidget()}if(this.profitPercentage=t.profitPercentage,t.gameStatus===i.gameStatus.NONE)this.totalBetCount=0,this.totalBetCountLabel.string=Global.Utils.formatNumberToString(this.totalBetCount,2),Global.API.room.roomMessageNotify(r.userReadyNotify(!0));else if(t.gameStatus===i.gameStatus.PLAYING){this.publicCardWidgetCtrl.sendCard(t.showPublicCardArr,!1);for(var l=0,d=0;d<t.userStatusArr.length;++d){var h=this.getUserChairIndex(d);d===this.myChairID?this.handCardWidgetCtrlArr[h].sendCard(t.selfCardArr,t.userStatusArr[d],-1):this.handCardWidgetCtrlArr[h].sendCard(null,t.userStatusArr[d],-1),this.userBetCountLabelArr[h].string=Global.Utils.formatNumberToString(t.curTurnBetCountArr[d],2),t.userStatusArr[d]===i.userStatus.PLAYING&&(this.userBetCountLabelArr[h].node.parent.active=!0),l+=t.totalBetCountArr[d]-t.curTurnBetCountArr[d],this.userHeadWidgetCtrlArr[h].addGold(-t.totalBetCountArr[d]),this.userHeadWidgetCtrlArr[h].setStatus(t.userStatusArr[d])}this.totalBetCount=l,this.totalBetCountLabel.string=Global.Utils.formatNumberToString(l,2);var u=this.getUserChairIndex(t.bankerUserChairID);this.bankerLogoNode.active=!0,this.bankerLogoNode.position=this.bankerLogoPosNodeArr[u],this.curUserChairID=t.currentUserChairID,t.currentUserChairID>=0&&this.startNextUserOperation(t.currentUserChairID,t.curTurnBetCountArr[t.currentUserChairID],t.curTurnMaxBetCount)}},resetGame:function(){for(var e=0;e<this.handCardWidgetCtrlArr.length;++e)this.handCardWidgetCtrlArr[e].resetWidget();this.publicCardWidgetCtrl.resetWidget();for(var t=0;t<this.userHeadWidgetCtrlArr.length;++t)this.userHeadWidgetCtrlArr[t].clearWidget();this.bankerLogoNode.active=!1,this.operationWidgetCtrl.resetWidget(),this.showWinCardTypeRoot.removeAllChildren(!0),this.youWinNode.stopAllActions(),this.youWinNode.active=!1,this.goldAnimationRoot.removeAllChildren(!0);for(var a=0;a<this.userBetCountLabelArr.length;++a)this.userBetCountLabelArr[a].string="0",this.userBetCountLabelArr[a].node.parent.active=!1;this.totalBetCountLabel.string="0",this.continueNode.active=!1},onReconnection:function(){this.resetGame(),o.roomMessageNotify(r.getRoomSceneInfoNotify())},onUserEntryRoom:function(e){var t=this.getUserChairIndex(e.chairId);this.userHeadWidgetCtrlArr[t].initWidget(e.userInfo),this.roomUserInfoArr[e.chairId]=e},onUserLeaveRoom:function(e){if(e.chairId===this.myChairID)Global.DialogManager.removeLoadingCircle(),this.reMatchGame?(this.reMatchGame=!1,Global.DialogManager.createDialog("Match/MatchGameDialog",{gameTypeID:this.gameTypeInfo.gameTypeID})):this.exitGame();else{var t=this.getUserChairIndex(e.chairId);this.userHeadWidgetCtrlArr[t].resetWidget(),this.handCardWidgetCtrlArr[t].resetWidget(),this.roomUserInfoArr[e.chairId]=null}},updateUserInfo:function(){for(var e=0;e<this.roomUserInfoArr.length;++e){var t=this.roomUserInfoArr[e];if(t){var a=this.getUserChairIndex(e);this.userHeadWidgetCtrlArr[a].updateGold(t.userInfo.takeGold)}}},updateTakeGold:function(e,t){var a=this.getUserChairIndex(e);this.userHeadWidgetCtrlArr[a].updateGold(t),e===this.myChairID&&Global.DialogManager.addTipDialog("\u5e26\u5165\u91d1\u5e01\u4e0d\u8db3\uff0c\u5df2\u81ea\u52a8\u8865\u5145")},onUserReady:function(e){},onGameStart:function(e){var t=this;this.gameIndexLabel.string="\u724c\u5c40\u7f16\u53f7:"+e.drawID;var a=this.getUserChairIndex(e.bankerUserChairID);this.bankerLogoNode.active=!0,this.bankerLogoNode.position=this.bankerLogoPosNodeArr[a].position;for(var r=function(a){if(e.userStatusArr[a]===i.userStatus.NONE)return"continue";var r=t.getUserChairIndex(a),o=t.userHeadWidgetCtrlArr[a].getCenterPos(),n=t.userBetCountLabelArr[a].node.parent.convertToWorldSpaceAR(t.userBetCountLabelArr[a].node.position);t.playGoldAnimation(o,n,!0,function(){var t=this.userBetCountLabelArr[r];t.node.parent.active=!0,t.string=Global.Utils.formatNumberToString(e.betCountArr[a],2)}.bind(t))},o=0;o<this.userBetCountLabelArr.length;++o)r(o);for(o=0;o<this.userHeadWidgetCtrlArr.length;++o)if(e.userStatusArr[o]!==i.userStatus.NONE){var n=this.getUserChairIndex(o);this.userHeadWidgetCtrlArr[n].addGold(-e.betCountArr[o],!1)}for(var s=0,c=0;c<this.handCardWidgetCtrlArr.length;++c)if(e.userStatusArr[c]!==i.userStatus.NONE)if(c===this.myChairID){var l=this.getUserChairIndex(this.myChairID);this.handCardWidgetCtrlArr[l].sendCard(e.selfCardArr,e.userStatusArr[this.myChairID],s++)}else{var d=this.getUserChairIndex(c);this.handCardWidgetCtrlArr[d].sendCard(null,e.userStatusArr[c],s++)}this.curUserChairID=e.nextUserChairID,this.startNextUserOperation(e.nextUserChairID,e.betCountArr[e.nextUserChairID],e.maxBetCount,0)},onGameSendCard:function(e,t,a,r,o){this.curUserChairID=t,this.totalBetCount=o;for(var s=this.totalBetCountLabel.node.parent.convertToWorldSpaceAR(this.totalBetCountLabel.node.position),c=!1,l=0;l<this.userBetCountLabelArr.length;++l){if(this.userBetCountLabelArr[l].node.parent.active)if(!(parseFloat(this.userBetCountLabelArr[l].string)<=0)){this.userBetCountLabelArr[l].string="0";var d=this.userBetCountLabelArr[l].node.parent.convertToWorldSpaceAR(this.userBetCountLabelArr[l].node.position);c?this.playGoldAnimation(d,s,!1):(c=!0,this.playGoldAnimation(d,s,!1,function(){this.totalBetCountLabel.string=Global.Utils.formatNumberToString(o,2),this.publicCardWidgetCtrl.sendCard(e,!0,function(){for(var o=0;o<this.userHeadWidgetCtrlArr.length;++o)this.userHeadWidgetCtrlArr[o].node.active&&this.userHeadWidgetCtrlArr[o].setOperation(i.operationType.NONE);var s=this.getUserChairIndex(this.myChairID),c=this.handCardWidgetCtrlArr[s].updatePublicCard(e),l=n.getKeyCardArr(c);this.publicCardWidgetCtrl.setCardDataArrLight(l,!1),this.handCardWidgetCtrlArr[s].setCardDataArrLight(l),t>=0&&this.startNextUserOperation(t,a,r)}.bind(this))}.bind(this)))}}c||this.publicCardWidgetCtrl.sendCard(e,!0,function(){for(var o=0;o<this.userHeadWidgetCtrlArr.length;++o)this.userHeadWidgetCtrlArr[o].node.active&&this.userHeadWidgetCtrlArr[o].setOperation(i.operationType.NONE);var s=this.getUserChairIndex(this.myChairID),c=this.handCardWidgetCtrlArr[s].updatePublicCard(e),l=n.getKeyCardArr(c);this.publicCardWidgetCtrl.setCardDataArrLight(l,!1),this.handCardWidgetCtrlArr[s].setCardDataArrLight(l),t>=0&&this.startNextUserOperation(t,a,r)}.bind(this))},onSelfBet:function(e,t){var a=this.getUserChairIndex(this.myChairID),r=this.userHeadWidgetCtrlArr[a];r.stopClock(),this.operationWidgetCtrl.node.active=!1,-1===e?(r.updateGold(0),t=i.operationType.ALL_IN):(r.addGold(-e),0===e&&(t=i.operationType.PASS)),this.userHeadWidgetCtrlArr[a].setOperation(t),Global.API.room.gameMessageNotify(i.gameUserBetNotify(e))},onUserBet:function(e,t,a,r,i,o,n){var s=this.getUserChairIndex(e);e!==this.myChairID&&(this.userHeadWidgetCtrlArr[s].stopClock(),this.userHeadWidgetCtrlArr[s].addGold(-t,!1),this.userHeadWidgetCtrlArr[s].setOperation(n));var c=this.userBetCountLabelArr[s].node.parent.convertToWorldSpaceAR(this.userBetCountLabelArr[s].node.position);this.userBetCountLabelArr[s].string=Global.Utils.formatNumberToString(a,2),t>0&&this.playGoldAnimation(this.userHeadWidgetCtrlArr[s].getCenterPos(),c,!0),this.curUserChairID=r,r>=0&&this.startNextUserOperation(r,i,o)},onSelfGiveUp:function(){var e=this.getUserChairIndex(this.myChairID);this.userHeadWidgetCtrlArr[e].stopClock(),this.operationWidgetCtrl.node.active=!1,this.userHeadWidgetCtrlArr[e].setStatus(i.userStatus.GIVE_UP),this.userHeadWidgetCtrlArr[e].setOperation(i.operationType.GIVE_UP),this.handCardWidgetCtrlArr[e].giveUp(!0),Global.API.room.gameMessageNotify(i.gameUserGiveUpNotify())},onUserGiveUp:function(e,t,a,r){if(e!==this.myChairID){var o=this.getUserChairIndex(e);this.userHeadWidgetCtrlArr[o].stopClock(),this.userHeadWidgetCtrlArr[o].setStatus(i.userStatus.GIVE_UP),this.userHeadWidgetCtrlArr[o].setOperation(i.operationType.GIVE_UP),this.handCardWidgetCtrlArr[o].giveUp(!1)}else this.continueNode.active=!0;this.curUserChairID=t,t>=0&&this.startNextUserOperation(t,a,r)},onGameResult:function(e){this.operationWidgetCtrl.node.active=!1;var t=e.totalBetCount,a=this;new Promise(function(e){for(var r=a.totalBetCountLabel.node.parent.convertToWorldSpaceAR(a.totalBetCountLabel.node.position),i=!1,o=0;o<a.userBetCountLabelArr.length;++o)if(a.userBetCountLabelArr[o].node.parent.active&&!(parseFloat(a.userBetCountLabelArr[o].string)<=0)){a.userBetCountLabelArr[o].string="0";var n=a.userBetCountLabelArr[o].node.parent.convertToWorldSpaceAR(a.userBetCountLabelArr[o].node.position);i?a.playGoldAnimation(n,r,!1):(i=!0,a.playGoldAnimation(n,r,!1,function(){a.totalBetCountLabel.string=Global.Utils.formatNumberToString(t,2),e()}.bind(a)))}i||e()}).then(function(){return new Promise(function(t){a.publicCardWidgetCtrl.sendCard(e.showPublicCardArr,!0,function(){t()})})}).then(function(){return new Promise(function(t){if(e.winType===i.winType.ONLY_ONE)t();else{for(var r=0;r<e.allUserCardArr.length;++r){var o=e.allUserCardArr[r];if(o&&0!==o.length){var s=a.getUserChairIndex(r);if(-1!==e.winChairIDArr.indexOf(r)){a.handCardWidgetCtrlArr[s].node.active=!1;var c=n.fiveFromSeven(e.allUserCardArr[r],e.showPublicCardArr);a.publicCardWidgetCtrl.setCardDataArrLight(c,!0),a.handCardWidgetCtrlArr[s].setCardDataArrLight([]),a.showWinUserCard(r,e.allUserCardArr[r],e.showPublicCardArr,c)}else a.handCardWidgetCtrlArr[s].showCard(e.allUserCardArr[r]),a.handCardWidgetCtrlArr[s].setCardDataArrLight([])}}a.scheduleOnce(function(){t()},1)}})}).then(function(){return new Promise(function(t){a.totalBetCountLabel.string="0";for(var r=a.totalBetCountLabel.node.parent.convertToWorldSpaceAR(a.totalBetCountLabel.node.position),i=!1,o=0;o<e.scoreChangeArr.length;++o)if(!(e.scoreChangeArr[o]<=0)){var n=a.getUserChairIndex(o);a.playGoldAnimation(r,a.userHeadWidgetCtrlArr[n].getCenterPos(),!1,i?null:function(){for(var r=0;r<e.scoreChangeArr.length;++r){var i=e.scoreChangeArr[r];if(0!==i){var o=a.getUserChairIndex(r);a.userHeadWidgetCtrlArr[o].addGold(i,!0)}}a.updateUserInfo(),a.scheduleOnce(function(){a.continueNode.active=!0}.bind(this),3),t()}),i=!0,o===a.myChairID&&-1!==e.winChairIDArr.indexOf(a.myChairID)&&a.playSelfWinAnimation()}})}).catch(function(e){console.error(e)})},startNextUserOperation:function(e,t,a){if(this.curUserChairID===e){var r=this.getUserChairIndex(e),o=null;if(e===this.myChairID&&(o=t===a?this.onSelfBet.bind(this):this.onSelfGiveUp.bind(this)),this.userHeadWidgetCtrlArr[r].startClock(i.OPERATION_TIME,o),e===this.myChairID){var n=JSON.parse(this.gameTypeInfo.parameters||"{}").blindBetCount;this.operationWidgetCtrl.updateWidget(!0,t,a,this.userHeadWidgetCtrlArr[r].getGold(),2*n,this.totalBetCount,this.selfOperationCallback.bind(this))}else e>=0&&this.operationWidgetCtrl.updateWidget(!1)}},selfOperationCallback:function(e,t){"flow"===e?this.onSelfBet(t,i.operationType.FLOW):"addBet"===e?this.onSelfBet(t,i.operationType.ADD_BET):"pass"===e?this.onSelfBet(0):"giveup"===e&&this.onSelfGiveUp()},getUserChairIndex:function(e){return(e-this.myChairID+9)%9},exitGame:function(){Global.DialogManager.createDialog("Hall/HallDialog",null,function(){Global.DialogManager.destroyDialog(this,!0),Global.CCHelper.releaseRes(["Game/DeZhouPoker"])}.bind(this))},showWinUserCard:function(e,t,a,r){this.showWinCardTypeRoot.removeAllChildren(!0);var i=cc.instantiate(this.showWinCardTypePrefab),o=this.getUserChairIndex(e);i.position=this.showWinCardTypeRoot.convertToNodeSpaceAR(this.userHeadWidgetCtrlArr[o].getCenterPos()),i.parent=this.showWinCardTypeRoot;var s=i.getChildByName("card0").getComponent(cc.Sprite),c=i.getChildByName("card1").getComponent(cc.Sprite),l=i.getChildByName("light0"),d=i.getChildByName("light1");Global.CCHelper.updateSpriteFrame("GameCommon/Card/card_back",s),Global.CCHelper.updateSpriteFrame("GameCommon/Card/card_back",c),s.node.stopAllActions(),c.node.stopAllActions();var h=n.getCardType(n.fiveFromSeven(t,a)),u=i.getChildByName("winCardType");Global.CCHelper.updateSpriteFrame("Game/DeZhouPoker/win_card_type_"+h,u.getComponent(cc.Sprite)),u.active=!1,s.node.runAction(cc.sequence([cc.scaleTo(.2,.01,1),cc.callFunc(function(){Global.CCHelper.updateSpriteFrame("GameCommon/Card/"+t[0],s)}.bind(this)),cc.scaleTo(.1,1,1)])),c.node.runAction(cc.sequence([cc.scaleTo(.2,.01,1),cc.callFunc(function(){Global.CCHelper.updateSpriteFrame("GameCommon/Card/"+t[1],c)}.bind(this)),cc.scaleTo(.1,1,1),cc.callFunc(function(){u.active=!0,-1!==r.indexOf(t[0])&&(l.active=!0),-1!==r.indexOf(t[1])&&(d.active=!0)}.bind(this))]))},playGoldAnimation:function(e,t,a,r){e=this.goldAnimationRoot.convertToNodeSpaceAR(e),t=this.goldAnimationRoot.convertToNodeSpaceAR(t);var i=Global.CCHelper.createSpriteNode("Game/DeZhouPoker/img_chip");i.parent=this.goldAnimationRoot,i.position=e,i.runAction(cc.sequence([cc.moveTo(a?.2:.5,t),cc.callFunc(function(){Global.Utils.invokeCallback(r)}.bind(this)),cc.removeSelf()]))},playSelfWinAnimation:function(){this.youWinNode.stopAllActions(),this.youWinNode.active=!0,this.youWinNode.scale=.01;var e=cc.scaleTo(.3,1);e.easing(cc.easeBackOut()),this.youWinNode.runAction(cc.sequence([cc.show(),e,cc.delayTime(2),cc.hide()]))}}),cc._RF.pop()},{"../../API/RoomAPI":"RoomAPI","../../API/RoomProto":"RoomProto","./DZGameLogic":"DZGameLogic","./DZProto":"DZProto",DZOperationWidgetCtrl:"DZOperationWidgetCtrl",DZPublicCardWidgetCtrl:"DZPublicCardWidgetCtrl"}],DZOperationWidgetCtrl:[function(e,t,a){"use strict";cc._RF.push(t,"ac1fbRBU4RF5pJuqf0CK8dD","DZOperationWidgetCtrl"),cc.Class({extends:cc.Component,properties:{selfOperationNode:cc.Node,flowCountLabel:cc.Label,passNode:cc.Node,flowNode:cc.Node,allInNode:cc.Node,autoOperationNode:cc.Node,autoPass:cc.Toggle,autoGiveUp:cc.Toggle,flowAny:cc.Toggle,addBetNode:cc.Node,addBetProgressBar:cc.ProgressBar,progressHandler:cc.Node,curSelectCountLabel:cc.Label,allinNode:cc.Node,totalCount1Label:cc.Label,totalCount2_3Label:cc.Label,totalCount1_2Label:cc.Label},start:function(){this.progressHandler.on(cc.Node.EventType.TOUCH_MOVE,function(e){if(this.maxBetCount-this.curBetCount+this.bigHideBetCount>=this.leftCount)return this.addBetProgressBar.progress=1,void this.updateSelectBetCount();var t=e.getDelta();this.progressHandler.y+=t.y;var a=.5*this.progressHandler.parent.height-10,r=-.5*this.progressHandler.parent.height+10;this.progressHandler.y>a&&(this.progressHandler.y=a),this.progressHandler.y<r&&(this.progressHandler.y=r),this.addBetProgressBar.progress=(this.progressHandler.y+a)/(this.progressHandler.parent.height-20),this.addBetProgressBar.progress=Global.Utils.keepNumberPoint(this.addBetProgressBar.progress,2),this.updateSelectBetCount()}.bind(this))},updateWidget:function(e,t,a,r,i,o,n){if(this.node.active=!0,this.callback=n,this.isSelfOperation=e,this.curBetCount=t,this.maxBetCount=a,this.leftCount=r,this.bigHideBetCount=i,this.totalBetCount=o,this.curSelectCount=0,this.addBetNode.active=!1,e){if(this.checkAutoOperation())return;this.selfOperationNode.active=!0,this.autoOperationNode.active=!1,this.autoPass.isChecked=!1,this.autoGiveUp.isChecked=!1,this.flowAny.isChecked=!1,t>=a?(this.passNode.active=!0,this.flowNode.active=!1,this.allInNode.active=!1):a-t>r?(this.passNode.active=!1,this.flowNode.active=!1,this.allInNode.active=!0):(this.passNode.active=!1,this.flowNode.active=!0,this.allInNode.active=!1,this.flowCountLabel.string=Global.Utils.formatNumberToString(a-t,2))}else this.autoOperationNode.active=!0,this.selfOperationNode.active=!1},checkAutoOperation:function(){if(this.autoGiveUp.isChecked)return this.maxBetCount>this.curBetCount?Global.Utils.invokeCallback(this.callback,"giveup"):Global.Utils.invokeCallback(this.callback,"pass"),!0;if(this.autoPass.isChecked){if(this.maxBetCount<=this.curBetCount)return Global.Utils.invokeCallback(this.callback,"pass"),!0}else if(this.flowAny.isChecked)return this.maxBetCount===this.curBetCount?(Global.Utils.invokeCallback(this.callback,"pass"),!0):this.leftCount>this.maxBetCount-this.curBetCount?(Global.Utils.invokeCallback(this.callback,"flow",this.maxBetCount-this.curBetCount),!0):(Global.Utils.invokeCallback(this.callback,"flow",-1),!0);return!1},updateSelectBetCount:function(){var e=this.maxBetCount-this.curBetCount+this.bigHideBetCount;1===this.addBetProgressBar.progress||e>=this.leftCount?(this.curSelectCountLabel.node.active=!1,this.allinNode.active=!0,this.curSelectCount=-1):(this.curSelectCountLabel.node.active=!0,this.allinNode.active=!1,this.curSelectCount=e+(this.leftCount-e)*this.addBetProgressBar.progress,this.curSelectCountLabel.string=Global.Utils.formatNumberToString(this.curSelectCount,2))},onBtnEvent:function(e,t){if("giveup"===t){if(!this.isSelfOperation)return;Global.DialogManager.addPopDialog("\u786e\u5b9a\u8981\u5f03\u724c\u5417\uff1f",function(){Global.Utils.invokeCallback(this.callback,"giveup")}.bind(this),function(){})}else if("pass"===t){if(!this.isSelfOperation)return;if(this.curBetCount!==this.maxBetCount)return;this.addBetNode.active=!1,Global.Utils.invokeCallback(this.callback,"pass")}else if("flow"===t){if(!this.isSelfOperation)return;var a=this.maxBetCount-this.curBetCount;if(a<=0)return;this.addBetNode.active=!1,Global.Utils.invokeCallback(this.callback,"flow",a)}else if("addBet"===t){if(!this.isSelfOperation)return;if(this.allInNode.active)return void Global.DialogManager.addTipDialog("\u91d1\u5e01\u4e0d\u8db3\u65e0\u6cd5\u52a0\u6ce8");if(this.addBetNode.active)this.addBetNode.active=!1,Global.Utils.invokeCallback(this.callback,"addBet",this.curSelectCount);else{this.addBetNode.active=!0,this.maxBetCount-this.curBetCount+this.bigHideBetCount>=this.leftCount?(this.addBetProgressBar.progress=1,this.progressHandler.y=.5*this.progressHandler.parent.height-10):(this.addBetProgressBar.progress=0,this.progressHandler.y=-.5*this.progressHandler.parent.height+10),this.updateSelectBetCount(),this.addBetProgressBar.progress=0;var r=this.maxBetCount-this.curBetCount+this.bigHideBetCount;this.leftCount>=this.totalBetCount&&this.leftCount>this.curSelectCount&&this.totalBetCount>=r?(this.totalCount1Label.node.parent.active=!0,this.totalCount1Label.string=Global.Utils.formatNumberToString(this.totalBetCount,2)):this.totalCount1Label.node.parent.active=!1,this.leftCount>=2*this.totalBetCount/3&&this.leftCount>this.curSelectCount&&2*this.totalBetCount/3>=r?(this.totalCount2_3Label.node.parent.active=!0,this.totalCount2_3Label.string=Global.Utils.keepNumberPoint(2*this.totalBetCount/3,2).toString()):this.totalCount2_3Label.node.parent.active=!1,this.leftCount>=this.totalBetCount/2&&this.leftCount>this.curSelectCount&&this.totalBetCount/2>=r?(this.totalCount1_2Label.node.parent.active=!0,this.totalCount1_2Label.string=Global.Utils.keepNumberPoint(1*this.totalBetCount/2,2).toString()):this.totalCount1_2Label.node.parent.active=!1}}else if("count1"===t){if(!this.isSelfOperation)return;this.addBetNode.active=!1,Global.Utils.invokeCallback(this.callback,"addBet",this.totalBetCount)}else if("count2_3"===t){if(!this.isSelfOperation)return;this.addBetNode.active=!1,Global.Utils.invokeCallback(this.callback,"addBet",Global.Utils.keepNumberPoint(2*this.totalBetCount/3),2)}else if("count1_2"===t){if(!this.isSelfOperation)return;this.addBetNode.active=!1,Global.Utils.invokeCallback(this.callback,"addBet",Global.Utils.keepNumberPoint(1*this.totalBetCount/2),2)}else if("cancelAdd"===t)this.addBetNode.active=!1;else if("autoPass"===t)this.autoGiveUp.isChecked=!1,this.flowAny.isChecked=!1;else if("autoGiveUp"===t)this.autoPass.isChecked=!1,this.flowAny.isChecked=!1;else if("flowAny"===t)this.autoPass.isChecked=!1,this.autoGiveUp.isChecked=!1;else if("allin"===t){if(!this.isSelfOperation)return;this.addBetNode.active=!1,Global.Utils.invokeCallback(this.callback,"addBet",-1)}},resetWidget:function(){this.selfOperationNode.active=!1,this.autoOperationNode.active=!1,this.addBetNode.active=!1,this.autoPass.isChecked=!1,this.autoGiveUp.isChecked=!1,this.flowAny.isChecked=!1,this.callback=!1}}),cc._RF.pop()},{}],DZPreBetRuleDialog:[function(e,t,a){"use strict";cc._RF.push(t,"a27c2eOROdLGIoZ94FRCB9P","DZPreBetRuleDialog"),cc.Class({extends:cc.Component,properties:{},start:function(){},onBtnClick:function(){Global.DialogManager.destroyDialog(this,!0)}}),cc._RF.pop()},{}],DZProto:[function(e,t,a){"use strict";cc._RF.push(t,"30ccffgMf9K3KWIQdse/zP4","DZProto");var r=t.exports;r.GAME_USER_BET_NOTIFY=301,r.GAME_USER_BET_PUSH=401,r.GAME_USER_GIVE_UP_NOTIFY=302,r.GAME_USER_GIVE_UP_PUSH=402,r.GAME_START_PUSH=406,r.GAME_SEND_CARD_PUSH=407,r.GAME_END_PUSH=408,r.GAME_USER_UPDATE_TAKE_GOLD_PUSH=409,r.gameStatus={NONE:0,PLAYING:1},r.userStatus={NONE:0,PLAYING:1,GIVE_UP:2},r.cardType={SINGLE:1,ONE_DOUBLE:2,TWO_DOUBLE:3,THREE:4,SHUN_ZI:5,TONG_HUA:6,HU_LU:7,TIE_ZHI:8,TONG_HUA_SHUN:9,KING_TONG_HUA_SHUN:10},r.winType={ONLY_ONE:1,MAX_CARD:2},r.operationType={NONE:0,ADD_BET:1,FLOW:2,PASS:3,GIVE_UP:4,ALL_IN:5},r.OPERATION_TIME=15,r.NEXT_ROUND_TIME=15,r.gameStartPush=function(e,t,a,r,i,o,n){return{type:this.GAME_START_PUSH,data:{bankerUserChairID:e,nextUserChairID:a,maxBetCount:r,selfCardArr:t,betCountArr:i,userStatusArr:o,drawID:n}}},r.gameUserBetNotify=function(e){return{type:this.GAME_USER_BET_NOTIFY,data:{count:e}}},r.gameUserBetPush=function(e,t,a,r,i,o,n){return{type:this.GAME_USER_BET_PUSH,data:{chairID:e,count:t,curTurnTotalBetCount:a,nextUserChairID:r,curBetCount:i,maxBetCount:o,operationType:n}}},r.gameSendPublicCardPush=function(e,t,a,r,i){return{type:this.GAME_SEND_CARD_PUSH,data:{cardDataArr:e,nextUserChairID:t,curBetCount:a,maxBetCount:r,totalBetCount:i}}},r.gameUserGiveUpNotify=function(){return{type:this.GAME_USER_GIVE_UP_NOTIFY,data:{}}},r.gameUserGiveUpPush=function(e,t,a,r){return{type:this.GAME_USER_GIVE_UP_PUSH,data:{chairID:e,nextUserChairID:t,curBetCount:a,maxBetCount:r}}},r.gameResultPush=function(e,t,a,r,i,o){return{type:this.GAME_END_PUSH,data:{allUserCardArr:e,winChairIDArr:a,scoreChangeArr:t,winType:r,showPublicCardArr:i,totalBetCount:o}}},r.gameUserUpdateTakeGoldPush=function(e,t){return{type:this.GAME_USER_UPDATE_TAKE_GOLD_PUSH,data:{chairID:e,takeGold:t}}},cc._RF.pop()},{}],DZPublicCardWidgetCtrl:[function(e,t,a){"use strict";cc._RF.push(t,"cf2d2UOMblGvaqSDQJgA94O","DZPublicCardWidgetCtrl");cc.Class({extends:cc.Component,properties:{cardSpriteArr:[cc.Sprite]},start:function(){},sendCard:function(e,t,a){if(this.node.active=!0,this.cardDataArr=this.cardDataArr||[],this.cardDataArr.length>=e.length)Global.Utils.invokeCallback(a);else if(t){for(var r=this.cardDataArr.length;r<e.length;++r)this.showCard(this.cardSpriteArr[r],e[r],.5*(r-this.cardDataArr.length));this.scheduleOnce(function(){this.cardDataArr=e,Global.Utils.invokeCallback(a)}.bind(this),.5*(e.length-this.cardDataArr.length))}else{for(var i=this.cardDataArr.length;i<e.length;++i)Global.CCHelper.updateSpriteFrame("GameCommon/Card/"+e[i],this.cardSpriteArr[i]),this.cardSpriteArr[i].node.active=!0;this.cardDataArr=e,Global.Utils.invokeCallback(a)}},showCard:function(e,t,a){e.node.stopAllActions(),e.node.scale=1,e.node.active=!0,e.node.runAction(cc.sequence([cc.delayTime(a),cc.scaleTo(.2,.01,1),cc.callFunc(function(){Global.CCHelper.updateSpriteFrame("GameCommon/Card/"+t,e)}.bind(this)),cc.scaleTo(.2,1,1)]))},resetWidget:function(){for(var e=0;e<this.cardSpriteArr.length;++e){var t=this.cardSpriteArr[e];t.node.getChildByName("light").active=!1,t.node.active&&(t.node.stopAllActions(),Global.CCHelper.updateSpriteFrame("GameCommon/Card/card_back",this.cardSpriteArr[e]),t.node.active=!1)}this.cardDataArr=null,this.unscheduleAllCallbacks()},setCardDataArrLight:function(e,t){for(var a=0;a<this.cardDataArr.length;++a)-1!==e.indexOf(this.cardDataArr[a])?(this.cardSpriteArr[a].node.getChildByName("light").active=!0,this.cardSpriteArr[a].node.y=t?15:0):(this.cardSpriteArr[a].node.getChildByName("light").active=!1,this.cardSpriteArr[a].node.y=0)}}),cc._RF.pop()},{}],DZRoomLayerDialog:[function(e,t,a){"use strict";cc._RF.push(t,"444e9W3S6ZPd63JDM8ckCXP","DZRoomLayerDialog"),cc.Class({extends:cc.Component,properties:{blindCountLabelArr:[cc.Label],preCountLabelArr:[cc.Label],minTakeCountLabelArr:[cc.Label],nickname:cc.Label,goldLabel:cc.Label,avatarSprite:cc.Sprite},start:function(){this.nickname.string=Global.Player.convertNickname(Global.Player.getPy("nickname")),this.goldLabel.string=Global.Utils.formatNumberToString(Global.Player.gold,2),Global.CCHelper.updateSpriteFrame(Global.Player.getPy("avatar"),this.avatarSprite);for(var e=0;e<8;++e){var t=Global.GameTypes.getGameInfoByKindAndLevel(Global.Enum.gameType.DZ,e+1);if(t){var a=JSON.parse(t.parameters);this.blindCountLabelArr[e].string=a.blindBetCount+"/"+2*a.blindBetCount,this.preCountLabelArr[e]&&(this.preCountLabelArr[e].string=a.preBetCount.toString()),this.minTakeCountLabelArr[e].string=t.goldLowerLimit.toString()}else this.minTakeCountLabelArr[e].string="0",this.blindCountLabelArr[e].string="0/0",this.preCountLabelArr[e]&&(this.preCountLabelArr[e].string="0")}},onBtnClick:function(e,t){switch(t){case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":var a=parseInt(t),r=Global.GameTypes.getGameInfoByKindAndLevel(Global.Enum.gameType.DZ,a);if(!r)return void Global.DialogManager.addPopDialog("\u623f\u95f4\u672a\u5f00\u542f\uff0c\u8bf7\u9009\u62e9\u8fdb\u5165\u5176\u4ed6\u623f\u95f4");Global.DialogManager.createDialog("Match/MatchGameDialog",{gameTypeID:r.gameTypeID});break;case"record":Global.DialogManager.createDialog("Game/DeZhouPoker/RoomLayer/DZGameRecordDialog");break;case"help":Global.DialogManager.createDialog("Game/DeZhouPoker/RoomLayer/DZGameRuleDialog");break;case"back":Global.DialogManager.destroyDialog(this,!0);break;case"preHelp":Global.DialogManager.createDialog("Game/DeZhouPoker/RoomLayer/DZPreBetRuleDialog")}}}),cc._RF.pop()},{}],DZUserHeadWidgetCtrl:[function(e,t,a){"use strict";cc._RF.push(t,"f34ffGVU2hD45AZKk0UTTYV","DZUserHeadWidgetCtrl");var r=e("./DZProto");cc.Class({extends:cc.Component,properties:{nicknameLabel:cc.Label,goldLabel:cc.Label,avatar:cc.Sprite,timeDown:cc.ProgressBar,winGoldLabel:cc.Label,loseGoldLabel:cc.Label,operationTypeNode:cc.Node},start:function(){},initWidget:function(e){this.node.active=!0,this.userInfo=e,this.nicknameLabel.string=Global.Player.convertNickname(e.nickname),this.goldLabel.string=Global.Utils.formatNumberToString(e.takeGold,2),Global.CCHelper.updateSpriteFrame(e.avatar,this.avatar)},updateGold:function(e){this.userInfo&&(this.userInfo.takeGold=e,this.goldLabel.string=Global.Utils.formatNumberToString(e,2))},addGold:function(e,t){if(this.userInfo&&(this.userInfo.takeGold+=e,this.goldLabel.string=Global.Utils.formatNumberToString(this.userInfo.takeGold,2),t)){var a=Global.Utils.formatNumberToString(e,2)+"\u5143";e>0?(a="+"+a,this.winGoldLabel.string=a,this.winGoldLabel.node.runAction(cc.sequence([cc.show(),cc.moveTo(.2,cc.v2(0,20)),cc.delayTime(3),cc.hide()]))):(this.loseGoldLabel.string=a,this.loseGoldLabel.node.runAction(cc.sequence([cc.show(),cc.moveTo(.2,cc.v2(0,20)),cc.delayTime(3),cc.hide()])))}},getGold:function(){return this.userInfo?this.userInfo.takeGold:0},setStatus:function(e){e===r.userStatus.NONE?this.node.active=!1:e===r.userStatus.PLAYING?(this.node.active=!0,this.node.opacity=255):e===r.userStatus.GIVE_UP&&(this.node.active=!0,this.node.opacity=200)},setOperation:function(e){if(this.operationType!==r.operationType.ALL_IN&&this.operationType!==r.operationType.GIVE_UP){this.operationType=e;var t="";e===r.operationType.ADD_BET?t="add":e===r.operationType.PASS?t="pass":e===r.operationType.FLOW?t="flow":e===r.operationType.ALL_IN?t="allin":e===r.operationType.GIVE_UP&&(t="giveup");for(var a=0;a<this.operationTypeNode.children.length;++a){var i=this.operationTypeNode.children[a];i.active=i.name===t}}},startClock:function(e,t){this.totalTime=e,this.curTime=e,this.unscheduleAllCallbacks(),this.timeDown.progress=1,this.timeDown.node.active=!0,this.schedule(function(e){this.curTime-=e,this.curTime>=0?this.timeDown.progress=this.curTime/this.totalTime:(this.unscheduleAllCallbacks(),this.timeDown.node.active=!1,Global.Utils.invokeCallback(t,0))}.bind(this),1/30)},stopClock:function(){this.unscheduleAllCallbacks(),this.timeDown.node.active=!1},getCenterPos:function(){return this.node.parent.convertToWorldSpaceAR(this.node.position)},resetWidget:function(){this.userInfo=null,this.stopClock(),this.winGoldLabel.node.stopAllActions(),this.winGoldLabel.node.y=0,this.winGoldLabel.node.active=!1,this.loseGoldLabel.node.stopAllActions(),this.loseGoldLabel.node.y=0,this.loseGoldLabel.node.active=!1,this.node.opacity=255,this.operationType=r.operationType.NONE,this.setOperation(r.operationType.NONE)},clearWidget:function(){this.stopClock(),this.winGoldLabel.node.stopAllActions(),this.winGoldLabel.node.y=0,this.winGoldLabel.node.active=!1,this.loseGoldLabel.node.stopAllActions(),this.loseGoldLabel.node.y=0,this.loseGoldLabel.node.active=!1,this.node.opacity=255,this.operationType=r.operationType.NONE,this.setOperation(r.operationType.NONE)}}),cc._RF.pop()},{"./DZProto":"DZProto"}],DaiLiDetailDialog:[function(e,t,a){"use strict";cc._RF.push(t,"8f34aBDgN9HC64DbGJcN+yd","DaiLiDetailDialog"),cc.Class({extends:cc.Component,properties:{thisWeekYeJi:cc.Label,zhishuhuiyuan:cc.Label,daili:cc.Label,lastLoginTime:cc.Label},start:function(){var e=this.dialogParameters.data;this.thisWeekYeJi.string=(e.directlyMemberAchievement+e.agentMemberAchievement).toFixed(2),this.zhishuhuiyuan.string=e.directlyMemberCount,this.daili.string=e.agentMemberCount,this.lastLoginTime.string=new Date(e.lastLoginTime).format("yyyy-MM-dd hh:mm:ss")},onBtnClk:function(e,t){switch(t){case"close":Global.DialogManager.destroyDialog(this)}}}),cc._RF.pop()},{}],Data:[function(e,t,a){"use strict";cc._RF.push(t,"d2e13IrxmtBa5G0ohd16Ic1","Data");var r=t.exports={};r.init=function(e){this.setDatas(e)},r.getData=function(e){return this[e]},r.setDatas=function(e){for(var t in e)e.hasOwnProperty(t)&&(this[t]=e[t])},cc._RF.pop()},{}],DialogActionWidgetCtrl:[function(e,t,a){"use strict";cc._RF.push(t,"8e46c0jqJVBrJ7Jg3Lkzxzx","DialogActionWidgetCtrl"),cc.Class({extends:cc.Component,properties:{maskNode:cc.Node,popUpNode:cc.Node},onLoad:function(){this.dialogIn()},dialogIn:function(){if(this.maskNode&&(this.maskNode.opacity=0,this.maskNode.runAction(cc.fadeTo(.3,150))),this.popUpNode){this.popUpNode.scale=.1;var e=cc.scaleTo(.2,1);e.easing(cc.easeBackOut()),this.popUpNode.runAction(e)}},dialogOut:function(e){if(this.maskNode||this.popUpNode){if(this.maskNode&&this.maskNode.runAction(cc.sequence([cc.fadeTo(.3,0),cc.callFunc(function(){Global.Utils.invokeCallback(e)})])),this.popUpNode){var t=cc.scaleTo(.2,0);t.easing(cc.easeBackIn()),this.maskNode?this.popUpNode.runAction(t):this.popUpNode.runAction(cc.sequence([t,cc.callFunc(function(){Global.Utils.invokeCallback(e)})]))}}else Global.Utils.invokeCallback(e)}}),cc._RF.pop()},{}],DialogManager:[function(e,t,a){"use strict";cc._RF.push(t,"133c4Mh1TFFNJZRsyknonbF","DialogManager");var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i=t.exports={};i.init=function(e){this.rootNode=e,this.dialogNode=this.rootNode.getChildByName("dialogNode"),this.dialogNode.width=e.width,this.dialogNode.height=e.height,this.frontNode=this.rootNode.getChildByName("frontNode"),this.frontNode.width=e.width,this.frontNode.height=e.height,this.loadedDialogPrefabs={},this.createdDialogs={},this.loadingCircleDialog=this.frontNode.getChildByName("LoadingCircleDialog").getComponent("LoadingCircleDialog"),this.popDialog=this.frontNode.getChildByName("PopDialog").getComponent("PopDialog"),this.tipDialog=this.frontNode.getChildByName("TipDialog").getComponent("TipDialog"),Global.MessageCallback.addListener("DesignResolutionChanged",this)},i.messageCallbackHandler=function(e,t){"DesignResolutionChanged"===e&&i.updateDialogNodeSize(t)},i.updateDialogNodeSize=function(e){this.dialogNode.width=e.width,this.dialogNode.height=e.height,this.frontNode.width=e.width,this.frontNode.height=e.height},i.createDialog=function(e,t,a){cc.log("create dialog:"+e);var r=e,i=e.split("/"),o=i[i.length-1];if(!e)return cc.error("Create Dialog failed: dialog type is null"),void Global.Utils.invokeCallback(a,Global.Code.FAIL);var n=this.createdDialogs,s=n[e]||null;if(s)cc.error("Create dialog is exist"),s.zIndex+=5,Global.Utils.invokeCallback(a,null,s);else{var c=this.loadedDialogPrefabs;c[e]?(s=cc.instantiate(c[e]),n[e]=s,s.getComponent(o).dialogParameters=t||{},s.getComponent(o).isDestroy=!1,s.parent=this.dialogNode,Global.Utils.invokeCallback(a,null,s)):cc.loader.loadRes(r,function(r,i){r?(cc.error(r),Global.Utils.invokeCallback(a,r)):(c[e]=i,s=cc.instantiate(i),n[e]=s,s.getComponent(o).dialogParameters=t||{},s.getComponent(o).isDestroy=!1,s.parent=this.dialogNode,Global.Utils.invokeCallback(a,null,s))}.bind(this))}},i.isDialogExit=function(e){return!!this.createdDialogs[e]},i.addDialogToManager=function(e,t){this.createdDialogs[e]=this.createdDialogs[e]||t},i.destroyDialog=function(e,t){t=t||!1;var a=this.createdDialogs,i=null,o=null;if("object"===(void 0===e?"undefined":r(e))){for(var n in i=e.node,o=e,a)if(a.hasOwnProperty(n)&&a[n]===i){e=n;break}}else{i=a[e]||null;var s=e.split("/"),c=s[s.length-1];i&&(o=i.getComponent(c))}if(i){var l=i.getComponent("DialogActionWidgetCtrl");l?l.dialogOut(function(){i.destroy(),o.isDestroy=!0,delete a[e],t&&(cc.loader.releaseRes(e),delete this.loadedDialogPrefabs[e]),cc.log("destroy dialog succeed:"+e)}.bind(this)):(i.destroy(),o.isDestroy=!0,delete a[e],t&&(cc.loader.releaseRes(e),delete this.loadedDialogPrefabs[e]),cc.log("destroy dialog succeed:"+e))}else cc.warn("destroy dialog not exist:"+e)},i.destroyAllDialog=function(e){for(var t in cc.log("destroyAllDialog"),this.createdDialogs)if(this.createdDialogs.hasOwnProperty(t)){if(e&&e.indexOf(t)>=0)continue;var a=this.createdDialogs[t];a.destroy();var r=t.split("/"),i=r[r.length-1];a.getComponent(i).isDestroy=!0,delete this.createdDialogs[t]}},i.addLoadingCircle=function(e){this.loadingCircleDialog.addLoadingCircle(e)},i.removeLoadingCircle=function(){this.loadingCircleDialog.removeLoadingCircle()},i.addPopDialog=function(e,t,a,r){this.popDialog.node.active=!0,this.popDialog.addPopDialog(e,t,a,r)},i.addTipDialog=function(e){this.tipDialog.addTip(e)},cc._RF.pop()},{}],EffectCtrl:[function(e,t,a){"use strict";cc._RF.push(t,"77045AN+zpC9YZ/Bg7bdRFa","EffectCtrl"),cc.Class({extends:cc.Component,properties:{goldAnimationWidgetPrefab:cc.Prefab,gainGoldLabelNode:cc.Node},start:function(){},fishCapture:function(e,t,a){var r=this,i=t.fishTypeInfo,o=this.node.convertToNodeSpaceAR(t.node.parent.convertToWorldSpaceAR(t.node.position)),n=i.rewardTimes/10;n<5&&(n=5);for(var s=n/5*150,c=function(t){var i=cc.instantiate(r.goldAnimationWidgetPrefab),n=(Math.random()-.5)*s;i.position=new cc.Vec2(o.x+n,o.y),i.parent=r.node;var c=i.getComponent("SpriteFrameAnimationWidgetCtrl");c.initAnimation(),c.startAnimation();var l=cc.jumpTo(1,i.position,100,2),d=r.node.convertToNodeSpaceAR(a.getUserHeadWorldPos()),h=Global.Utils.getDist(i.position,d)/2e3;0===t?i.runAction(cc.sequence([cc.delayTime(.05*t),l,cc.delayTime(.1),cc.moveTo(h,d),cc.callFunc(function(){i.destroy(),a.goldChange(e,!0)})])):i.runAction(cc.sequence([cc.delayTime(.05*t),l,cc.delayTime(.1),cc.moveTo(h,d),cc.removeSelf()]))},l=0;l<n;++l)c(l);var d=cc.instantiate(this.gainGoldLabelNode);d.active=!0,d.parent=this.node,d.position=o,d.y+=100,d.getComponent(cc.Label).string="+"+parseFloat(e.toFixed(2)),d.runAction(cc.sequence([cc.delayTime(1),cc.fadeTo(.5,0),cc.removeSelf()]))}}),cc._RF.pop()},{}],FireControlWidget:[function(e,t,a){"use strict";cc._RF.push(t,"697fdbS+FRPv5FK5jAMlMdd","FireControlWidget");var r=e("../../Shared/utils");cc.Class({extends:cc.Component,properties:{},start:function(){this.fireTargetPoint=null,this.lastFireTime=0,this.bulletCount=0,this.stopAutoFireCallback=null,this.lockedFishCtrl=null,this.isOnLockFishState=!1,this.selectLockFishCallback=null,this.robotOperationTimer=-1,this.robotChairIDArr=[],this.robotFireCallback=null,this.robotFireRoteArr=[-1,-1,-1,-1],this.node.on(cc.Node.EventType.TOUCH_START,function(e){this.onTouchEvent(cc.Node.EventType.TOUCH_START,this.node.convertTouchToNodeSpace(e.touch))}.bind(this)),this.node.on(cc.Node.EventType.TOUCH_MOVE,function(e){this.onTouchEvent(cc.Node.EventType.TOUCH_MOVE,this.node.convertTouchToNodeSpace(e.touch))}.bind(this)),this.node.on(cc.Node.EventType.TOUCH_END,function(){this.onTouchEvent(cc.Node.EventType.TOUCH_END)}.bind(this))},onDestroy:function(){this.robotOperationTimer>=0&&(clearInterval(this.robotOperationTimer),this.robotOperationTimer=-1)},initWidget:function(e){this.fireCallback=e},onTouchEvent:function(e,t){this.isOnLockFishState?e===cc.Node.EventType.TOUCH_START&&r.invokeCallback(this.selectLockFishCallback,t):e===cc.Node.EventType.TOUCH_START?(this.stopAutoFire(),this.fireTargetPoint=t,this.onFire(),this.schedule(this.onFire.bind(this),.3)):e===cc.Node.EventType.TOUCH_MOVE?this.fireTargetPoint=t:e===cc.Node.EventType.TOUCH_END&&this.unscheduleAllCallbacks()},onFire:function(){this.bulletCount>=30||(Date.now()-this.lastFireTime<=270?console.log("fire fail interval time too short"):(this.lastFireTime=Date.now(),this.fireCallback&&this.fireCallback(this.fireTargetPoint)))},bulletCountChange:function(e){this.bulletCount+=e},autoFire:function(e){this.unscheduleAllCallbacks(),this.autoSelectTarget(),this.schedule(this.autoSelectTarget.bind(this),2),this.onFire(),this.schedule(this.onFire.bind(this),.3),this.stopAutoFireCallback=e},autoSelectTarget:function(){this.fireTargetPoint=cc.p(0,0),this.fireTargetPoint.x=r.getRandomNum(100,1e3),this.fireTargetPoint.y=r.getRandomNum(100,500)},stopAutoFire:function(){this.stopAutoFireCallback&&(this.stopAutoFireCallback(),this.stopAutoFireCallback=null,this.unscheduleAllCallbacks())},onChangeLockFishState:function(e,t){this.isOnLockFishState=e,this.selectLockFishCallback=t||null},startLockFire:function(e){e&&e.node&&(this.unscheduleAllCallbacks(),this.lockedFishCtrl=e,this.lockTargetPos(),this.schedule(this.lockTargetPos.bind(this),1),this.onFire(),this.schedule(this.onFire.bind(this),.3))},lockTargetPos:function(){this.lockedFishCtrl&&this.lockedFishCtrl.node&&(this.fireTargetPoint=this.lockedFishCtrl.node.parent.convertToWorldSpaceAR(this.lockedFishCtrl.node.position))},stopLockFire:function(){this.lockedFishCtrl=null,this.unscheduleAllCallbacks()},startRobotOperation:function(e,t){this.robotOperationTimer>=0&&clearInterval(this.robotOperationTimer),this.robotChairIDArr=e,this.robotFireCallback=t,this.robotOperationTimer=setInterval(this.robotOperationScheduler.bind(this),300)},robotOperationScheduler:function(){for(var e=[],t=[],a=0;a<this.robotChairIDArr.length;++a){var i=this.robotChairIDArr[a],o=this.robotFireRoteArr[i];o>0?Math.random()<.05&&(o=r.getRandomNum(20,160),this.robotFireRoteArr[i]=o):(o=r.getRandomNum(20,160),this.robotFireRoteArr[i]=o),e.push(i),t.push(o)}e.length>0&&r.invokeCallback(this.robotFireCallback,e,t)},stopRobotOperation:function(){this.robotOperationTimer>=0&&(clearInterval(this.robotOperationTimer),this.robotOperationTimer=-1),this.robotChairIDArr=[],this.robotFireCallback=null}}),cc._RF.pop()},{"../../Shared/utils":"utils"}],FishHelpDialog:[function(e,t,a){"use strict";cc._RF.push(t,"8ec62z3fYdCZr71tap2pN4m","FishHelpDialog");var r=e("./API/fishConfig");cc.Class({extends:cc.Component,properties:{fishInfoItem:cc.Node},start:function(){for(var e=this,t=function(t){var a=r.fishType[t],i=cc.instantiate(e.fishInfoItem);i.getChildByName("Label").getComponent(cc.Label).string=a.rewardTimes+"\u500d";var o=i.getChildByName("fishSprite").getComponent(cc.Sprite);Global.CCHelper.updateSpriteFrame("Fish/Fish/fish"+a.resIndex+"_1",o,function(){o.node.width>this.fishInfoItem.width-10&&(o.node.scale=(this.fishInfoItem.width-10)/o.node.width)}.bind(e)),i.active=!0,i.parent=e.fishInfoItem.parent},a=0;a<r.fishType.length;++a)t(a)},onBtnClick:function(){Global.DialogManager.destroyDialog(this,!0)}}),cc._RF.pop()},{"./API/fishConfig":"fishConfig"}],FishMainDialog:[function(e,t,a){"use strict";cc._RF.push(t,"8847eOrgx1Lg6PeMY7VVTdq","FishMainDialog");var r=e("../../API/RoomProto"),i=e("../../API/RoomAPI"),o=e("./API/gameProto"),n=e("../../Shared/utils");cc.Class({extends:cc.Component,properties:{cannonPosArr:[cc.Node],cannonWidgetPrefab:cc.Prefab,fireControlWidgetCtrl:e("FireControlWidget"),effectCtrl:e("EffectCtrl"),bulletRoot:cc.Node,bulletWidgetPrefab:cc.Prefab,bulletBoomAnimationWidgetPrefab:cc.Prefab,fishRoot:cc.Node,fishWidgetPrefab:cc.Prefab,rightMenuRoot:cc.Node,menuOutBtnNode:cc.Node,menuInBtnNode:cc.Node,toggleAutoFire:cc.Toggle,toggleLockFish:cc.Toggle},start:function(){this.gameInited=!1,this.selfChairID=-1,this.cannonWidgetCtrlList={},this.fishWidgetCtrlArr=[],this.lockFishCtrlArr=[null,null,null,null],this.baseScore=.01,this.profitPercentage=0,this.isOnLockFishState=!1,this.isRoomOwner=!1,this.fireControlWidgetCtrl.initWidget(this.onSelfFire.bind(this)),this.startCollision(!0),Global.MessageCallback.addListener("RoomMessagePush",this),Global.MessageCallback.addListener("GameMessagePush",this),Global.MessageCallback.addListener("ReConnectSuccess",this),Global.MessageCallback.addListener("GAME_EVENT",this),i.roomMessageNotify(r.getRoomSceneInfoNotify())},onDestroy:function(){Global.MessageCallback.removeListener("RoomMessagePush",this),Global.MessageCallback.removeListener("GameMessagePush",this),Global.MessageCallback.removeListener("ReConnectSuccess",this),Global.MessageCallback.removeListener("GAME_EVENT",this),Global.AudioManager.stopBgMusic(),this.startCollision(!1)},messageCallbackHandler:function(e,t){if("RoomMessagePush"===e){if(t.type===r.USER_LEAVE_ROOM_PUSH)t.data.roomUserInfo.userInfo.uid===Global.Player.getPy("uid")?this.exitGame():(this.onUserLeave(t.data.roomUserInfo),this.updateRoomOwner());else if(t.type===r.GET_ROOM_SCENE_INFO_PUSH)this.gameInit(t.data.gameData,t.data.roomUserInfoArr);else if(t.type===r.OTHER_USER_ENTRY_ROOM_PUSH){if(!this.gameInited)return;this.onUserEntry(t.data.roomUserInfo,0),this.onChangeCannonPower(t.data.roomUserInfo.chairId,1),this.updateRoomOwner()}}else if("GameMessagePush"===e){if(!this.gameInited)return;if(t.type===o.GAME_FIRE_PUSH){if(t.data.chairID===this.selfChairID)return;this.onOtherUserFire(t.data)}else if(t.type===o.GAME_CHANGE_CANNON_PUSH){if(t.data.chairID===this.selfChairID)return;this.onChangeCannonPower(t.data.chairID,t.data.powerIndex)}else if(t.type===o.GAME_CAPTURE_PUSH)this.onCapture(t.data);else if(t.type===o.GAME_LOCK_FISH_PUSH){if(t.data.chairID===this.selfChairID)return;this.onUserLockFish(t.data.chairID,t.data.fishID)}else if(t.type===o.GAME_ADD_FISH_PUSH)for(var a=0;a<t.data.fishArr.length;++a)this.addFish(t.data.fishArr[a])}else"ReConnectSuccess"===e?this.exitGame():"GAME_EVENT"===e&&(t===cc.game.EVENT_HIDE?this.gameInited=!1:t===cc.game.EVENT_SHOW&&this.onReconnection())},onBtnClick:function(e,t){if("exit"===t)Global.DialogManager.addPopDialog("\u662f\u5426\u8981\u9000\u51fa\u623f\u95f4\uff1f",function(){Global.API.room.roomMessageNotify(r.userLeaveRoomNotify()),Global.DialogManager.addLoadingCircle()},function(){});else if("autoFire"===t){if(!this.gameInited)return;var a=e.node.getComponent(cc.Toggle);this.onChangeAutoFire(a.isChecked)}else if("lockFish"===t){if(!this.gameInited)return;var i=e.node.getComponent(cc.Toggle);this.onChangeLockFishState(i.isChecked)}else"settings"===t?Global.DialogManager.createDialog("Setting/SettingDialog"):"help"===t&&Global.DialogManager.createDialog("Fish/FishHelpDialog")},startCollision:function(e){cc.director.getCollisionManager().enabled=e},gameInit:function(e,t){this.clearScene(),this.gameInited=!0,this.serverOffsetTime=e.serverTime-Date.now(),this.baseScore=e.baseScore,this.profitPercentage=e.profitPercentage;for(var a=Global.Player.getPy("uid"),r=0;r<t.length;++r)if(t[r].userInfo.uid===a){this.selfChairID=t[r].chairId;break}if(this.selfChairID<0)console.error("game data error chairID:"+this.selfChairID);else{for(var i=0;i<t.length;++i){var o=t[i];this.onUserEntry(o,e.winGoldCountArr[o.chairId]||0),this.onChangeCannonPower(o.chairId,e.cannonPowerIndexArr[o.chairId])}for(var n in e.fishList)e.fishList.hasOwnProperty(n)&&this.addFish(e.fishList[n]);for(var s=0;s<e.userLockFishIDArr.length;++s){var c=e.userLockFishIDArr[s];if(c>=0)for(var l=0;l<this.fishWidgetCtrlArr.length;++l)c===this.fishWidgetCtrlArr[l].fishID&&this.onUserLockFish(s,c)}this.updateRoomOwner()}},clearScene:function(){for(var e in this.gameInited=!1,this.selfChairID=-1,this.cannonWidgetCtrlList)this.cannonWidgetCtrlList.hasOwnProperty(e)&&this.cannonWidgetCtrlList[e].onClear();this.cannonWidgetCtrlList={};for(var t=0;t<this.fishWidgetCtrlArr.length;++t)this.fishWidgetCtrlArr[t].onClear();this.fishWidgetCtrlArr=[],this.lockFishCtrlArr=[null,null,null,null],this.baseScore=.01,this.profitPercentage=0,this.isOnLockFishState=!1,this.onChangeLockFishState(!1),this.onChangeAutoFire(!1),this.isRoomOwner=!1,this.bulletRoot.removeAllChildren(!0)},onReconnection:function(){this.clearScene(),i.roomMessageNotify(r.getRoomSceneInfoNotify())},onUserEntry:function(e,t){var a=(e.chairId+(this.selfChairID>=2?2:0))%4,r=cc.instantiate(this.cannonWidgetPrefab),i=r.getComponent("CannonWidgetCtrl");i.initWidget(e,e.chairId===this.selfChairID,a,t,this.onSelfCannonPowerChange.bind(this)),r.parent=this.cannonPosArr[a],this.cannonWidgetCtrlList[e.chairId]=i,this.cannonPosArr[a].getChildByName("wait").active=!1},onUserLeave:function(e){this.lockFishCtrlArr[e.chairId]=null;var t=this.cannonWidgetCtrlList[e.chairId];if(t){t.onLeave(),delete this.cannonWidgetCtrlList[e.chairId];var a=(e.chairId+(this.selfChairID>=2?2:0))%4;this.cannonPosArr[a].getChildByName("wait").active=!0}else console.error("onUserLeave err:cannon ctrl not find")},updateRoomOwner:function(){this.isRoomOwner=!0;var e=[];for(var t in this.cannonWidgetCtrlList)if(this.cannonWidgetCtrlList.hasOwnProperty(t)){var a=this.cannonWidgetCtrlList[t];a.roomUserInfo.chairId<this.selfChairID&&!a.roomUserInfo.userInfo.robot&&(this.isRoomOwner=!1),a.roomUserInfo.userInfo.robot&&e.push(a.roomUserInfo.chairId)}this.isRoomOwner&&e.length>0?this.fireControlWidgetCtrl.startRobotOperation(e,this.onRobotFire.bind(this)):this.fireControlWidgetCtrl.stopRobotOperation()},onRobotFire:function(e,t){for(var a=[],r=[],n=0;n<e.length;++n){var s=this.cannonWidgetCtrlList[e[n]];if(!s)return void console.error("onRobotFire err: not fid ctrl");if(s.roomUserInfo.userInfo.gold+s.winGold<s.powerIndex*this.baseScore)return void console.warn("onRobotFire warn: robot gold not enough");a.push(e[n]),r.push(t[n])}i.gameMessageNotify(o.gameRobotFireNotify(e,t))},onChangeAutoFire:function(e){this.toggleAutoFire.isChecked=e,e?(this.onChangeLockFishState(!1),this.fireControlWidgetCtrl.autoFire(function(){this.toggleAutoFire.isChecked=!1}.bind(this))):this.fireControlWidgetCtrl.stopAutoFire()},onChangeLockFishState:function(e){e?(this.onChangeAutoFire(!1),this.fireControlWidgetCtrl.onChangeLockFishState(!0,this.onSelectLockFish.bind(this))):(this.toggleLockFish.isChecked=!1,this.fireControlWidgetCtrl.onChangeLockFishState(!1),this.fireControlWidgetCtrl.stopLockFire(),i.gameMessageNotify(o.gameLockFishNotify(-1)),this.onUserLockFish(this.selfChairID,-1))},onSelectLockFish:function(e){if(this.gameInited){for(var t=null,a=0;a<this.fishWidgetCtrlArr.length;++a){var r=this.fishWidgetCtrlArr[a];cc.Intersection.pointInPolygon(e,r.fishCollider.world.points)&&r.isInScene()&&(t?r.fishTypeInfo.rewardTimes>t.fishTypeInfo.rewardTimes&&(t=r):t=r)}t&&(i.gameMessageNotify(o.gameLockFishNotify(t.fishID)),this.onUserLockFish(this.selfChairID,t.fishID),this.fireControlWidgetCtrl.startLockFire(t))}},selectedLockFishLeaved:function(){for(var e=null,t=0;t<this.fishWidgetCtrlArr.length;++t){var a=this.fishWidgetCtrlArr[t];a.isInScene()&&(e?a.fishTypeInfo.rewardTimes>e.fishTypeInfo.rewardTimes&&(e=a):e=a)}e?(i.gameMessageNotify(o.gameLockFishNotify(e.fishID)),this.onUserLockFish(this.selfChairID,e.fishID),this.fireControlWidgetCtrl.startLockFire(e)):this.onChangeLockFishState(!1)},onUserLockFish:function(e,t){var a=this.cannonWidgetCtrlList[e];if(a)if(t<0)a.onLockFish(null),e===this.selfChairID&&(this.fireControlWidgetCtrl.stopLockFire(),this.lockFishCtrlArr[e]&&this.lockFishCtrlArr[e].listenerOutScene(!1)),this.lockFishCtrlArr[e]=null;else{for(var r=null,i=0;i<this.fishWidgetCtrlArr.length;++i){var o=this.fishWidgetCtrlArr[i];if(o.fishID===t){r=o;break}}if(!r)return void console.error("onUserLockFish fish not find");a.onLockFish(r),e===this.selfChairID&&(r.listenerOutScene(!0),this.lockFishCtrlArr[e]&&this.lockFishCtrlArr[e].listenerOutScene(!1)),this.lockFishCtrlArr[e]=r}},onOtherUserFire:function(e){this.gameInited&&e.chairID!==this.selfChairID&&this.onFire(e.chairID,e.rote)},onSelfFire:function(e){if(this.gameInited){var t=this.cannonWidgetCtrlList[this.selfChairID];if(t){if(t.getCurGold()<t.powerIndex*this.baseScore)return Global.DialogManager.addTipDialog("\u91d1\u5e01\u4e0d\u8db3\uff0c\u65e0\u6cd5\u5f00\u70ae"),this.onChangeAutoFire(!1),void this.onChangeLockFishState(!1);this.fireControlWidgetCtrl.bulletCountChange(1);var a=this.bulletRoot.convertToNodeSpaceAR(t.getCannonWorldPos()),r=this.bulletRoot.convertToNodeSpaceAR(e),i=n.getUnitVector(a,r),o=Math.acos(i.x)/Math.PI*180;i.y<0&&(o*=-1),this.onFire(this.selfChairID,o)}else console.error("not find ctrl")}},onFire:function(e,t){if(this.gameInited){var a=this.cannonWidgetCtrlList[e];if(a){a.posIndex>=2&&(t+=180);var r=this.bulletRoot.convertToNodeSpaceAR(a.getCannonWorldPos()),n=cc.instantiate(this.bulletWidgetPrefab);n.parent=this.bulletRoot;var s=n.getComponent("BulletWidgetCtrl");s.initWidget(e,0,this.onBeShot.bind(this)),s.emit(r,t,this.lockFishCtrlArr[e]),a.onFire(t),a.goldChange(a.powerIndex*this.baseScore*-1,!1),e===this.selfChairID&&i.gameMessageNotify(o.gameFireNotify(t))}else console.error("not find ctrl")}},onBeShot:function(e,t){e.onShootFish();var a=cc.instantiate(this.bulletBoomAnimationWidgetPrefab);a.parent=this.bulletRoot,a.position=e.node.position;var r=a.getComponent("SpriteFrameAnimationWidgetCtrl");if(r.initAnimation(),r.startAnimation(!1,1,function(){r.node.destroy()}),t.onBeShot(),e.ownerChairID===this.selfChairID)this.fireControlWidgetCtrl.bulletCountChange(-1),i.gameMessageNotify(o.gameCaptureNotify(t.fishID));else if(this.isRoomOwner){var n=this.cannonWidgetCtrlList[e.ownerChairID];if(!n)return;n.roomUserInfo.userInfo.robot&&i.gameMessageNotify(o.gameRobotCaptureNotify(n.roomUserInfo.chairId,t.fishID))}},onCapture:function(e){for(var t=null,a=0;a<this.fishWidgetCtrlArr.length;++a){var r=this.fishWidgetCtrlArr[a];if(r.fishID===e.fishID){t=r,this.fishWidgetCtrlArr.splice(a,1);break}}if(t){var i=this.cannonWidgetCtrlList[e.chairID];if(i){this.effectCtrl.fishCapture(e.gainGold,t,i),t.onCapture();for(var o=0;o<this.lockFishCtrlArr.length;++o)this.lockFishCtrlArr[o]===t&&(o===this.selfChairID?this.selectedLockFishLeaved():this.onUserLockFish(o,-1))}else console.error("not find cannon ctrl")}else console.error("not find fish id")},addFish:function(e){var t=cc.instantiate(this.fishWidgetPrefab),a=t.getComponent("FishWidgetCtrl");t.parent=this.fishRoot,a.initWidget(e,Date.now()+this.serverOffsetTime,this.selfChairID>=2,this.onFishLeaved.bind(this)),this.fishWidgetCtrlArr.push(a)},onFishLeaved:function(e,t){if("leave"===t){for(var a=0;a<this.fishWidgetCtrlArr.length;++a)if(this.fishWidgetCtrlArr[a]===e){this.fishWidgetCtrlArr.splice(a,1);break}e.onRemove(),this.lockFishCtrlArr[this.selfChairID]===e&&this.selectedLockFishLeaved()}else"outScene"===t&&this.lockFishCtrlArr[this.selfChairID]===e&&this.selectedLockFishLeaved()},onSelfCannonPowerChange:function(e){e<=0||e>10?console.error("onSelfCannonPowerChange index err:"+e):(this.onChangeCannonPower(this.selfChairID,e),i.gameMessageNotify(o.gameChangeCannonNotify(e)))},onChangeCannonPower:function(e,t){var a=this.cannonWidgetCtrlList[e];a?a.onChangeCannonPower(t*this.baseScore,t):console.error("onChangeCannonPower err: not find ctrl")},exitGame:function(){Global.DialogManager.createDialog("Hall/HallDialog",null,function(){Global.DialogManager.removeLoadingCircle(),Global.DialogManager.destroyDialog(this,!0),Global.CCHelper.releaseRes(["Fish"])}.bind(this))}}),cc._RF.pop()},{"../../API/RoomAPI":"RoomAPI","../../API/RoomProto":"RoomProto","../../Shared/utils":"utils","./API/gameProto":"gameProto",EffectCtrl:"EffectCtrl",FireControlWidget:"FireControlWidget"}],FishWidgetCtrl:[function(e,t,a){"use strict";cc._RF.push(t,"dec96sgNUpIWb3HBDcQdibp","FishWidgetCtrl");var r=e("../../Shared/utils"),i=(e("./API/gameProto"),e("./API/fishConfig"));cc.Class({extends:cc.Component,properties:{fishSprite:cc.Sprite,fishShadowSprite:cc.Sprite,fishCollider:cc.BoxCollider},start:function(){this.lastPos=this.node.position,this.fishSpriteFrameArr=this.fishSpriteFrameArr||[],this.startMove(),this.startAnimation(),this.listenerOutSenceEvent=!1},onDestroy:function(){this.showBeShotTimer&&clearTimeout(this.showBeShotTimer)},initWidget:function(e,t,a,r){this.fishInfo=e,this.fishID=e.fishID,this.pathData=this.getPathData(e.pathArr,a),this.fishTypeInfo=i.fishType[e.fishTypeID],this.curServerTime=t;for(var o=[],n=1;n<=this.fishTypeInfo.frameCount;++n)o.push("Fish/Fish/fish"+this.fishTypeInfo.resIndex+"_"+n);cc.loader.loadResArray(o,cc.SpriteFrame,function(e,t){if(e)console.error(e);else{if(!this.node)return;if(this.fishSpriteFrameArr=t,this.fishSpriteFrameArr.length>0){var a=t[0].getRect();this.node.width=a.width,this.node.height=a.height,this.fishCollider.size.width=this.node.width,this.fishCollider.size.height=this.node.height,this.fishSprite.node.width=this.node.width,this.fishSprite.node.height=this.node.height,this.fishShadowSprite.node.width=this.node.width,this.fishShadowSprite.node.height=this.node.height}}}.bind(this)),this.pathData?(this.node.position=this.pathData.pointArr[0],this.callback=r):console.error("fish path data err")},getPathData:function(e,t){var a=new cc.Vec2(0,0),r=Math.floor(e[0]/21),o=i.createFishRange.x/20,n=i.createFishRange.x/20;r%2==0?(a.x=(e[0]%21-10)*o,a.y=(r%4-1)*i.createFishRange.y):(a.x=(r%4-2)*-i.createFishRange.x,a.y=(e[0]%21-10)*n);var s=new cc.Vec2(0,0);s.x=(Math.floor(e[1]/10)-5)*o,s.y=(e[1]%10-5)*n;var c=new cc.Vec2(0,0),l=Math.floor(e[2]/21);l%2==0?(c.x=(e[2]%21-10)*o,c.y=(l%4-1)*i.createFishRange.y):(c.x=(l%4-2)*-i.createFishRange.x,c.y=(e[2]%21-10)*n);var d=(Global.Utils.getDist(a,s)+Global.Utils.getDist(s,c))/50;return t&&(a.x*=-1,a.y*=-1,s.x*=-1,s.y*=-1,c.x*=-1,c.y*=-1),{time:d,pointArr:[a,s,c]}},startMove:function(){this.lastPos=this.node.position;var e=cc.bezierTo(this.pathData.time/(this.fishTypeInfo.moveSpeed||1),this.pathData.pointArr),t=cc.sequence([e,cc.callFunc(function(){this.callback&&this.callback(this,"leave")}.bind(this))]);this.node.runAction(t);var a=(this.curServerTime-this.fishInfo.createTime)/1e3;a>0&&(t.step(0),t.step(a))},startAnimation:function(){var e=0,t=this.fishTypeInfo.frameCount;this.schedule(function(){e=(e+1)%t,this.fishSpriteFrameArr[e]&&(this.fishSprite.spriteFrame=this.fishSpriteFrameArr[e],this.fishShadowSprite.spriteFrame=this.fishSpriteFrameArr[e])}.bind(this),.15)},onBeShot:function(){this.showBeShotTimer&&clearTimeout(this.showBeShotTimer),this.fishSprite.node.color=new cc.Color(255,100,100,255),this.showBeShotTimer=setTimeout(function(){this.fishSprite.node.color=new cc.Color(255,255,255,255)}.bind(this),1e3)},onCapture:function(){this.onRemove()},onRemove:function(){this.unscheduleAllCallbacks(),clearTimeout(this.showBeShotTimer),this.node.destroy()},listenerOutScene:function(e){this.listenerOutSenceEvent=e},isInScene:function(){var e=this.node;if(!e)return!1;var t=this.node.parent;return!(e.x>.5*t.width||e.x<-.5*t.width||e.y>.5*t.height||e.y<-.5*t.height)},onClear:function(){this.showBeShotTimer&&clearTimeout(this.showBeShotTimer),this.node.stopAllActions(),this.node.destroy()},update:function(){if(this.fishTypeInfo.fixedRotation){if(!this.fishTypeInfo.fixedDir)r.getUnitVector(this.lastPos,this.node.position).x>=0?this.node.scaleX=1:this.node.scaleX=-1}else{var e=r.getUnitVector(this.lastPos,this.node.position);0===e.x&&0===e.y||(this.node.rotation=Math.acos(e.x)/Math.PI*-180,e.y<0&&(this.node.rotation*=-1),this.lastPos=this.node.position)}this.listenerOutSenceEvent&&(this.isInScene()||(r.invokeCallback(this.callback,this,"outScene"),this.listenerOutSenceEvent=!1))}}),cc._RF.pop()},{"../../Shared/utils":"utils","./API/fishConfig":"fishConfig","./API/gameProto":"gameProto"}],GameBtnItem:[function(e,t,a){"use strict";cc._RF.push(t,"47c49KSWc5HKaz9+sTPoumV","GameBtnItem"),cc.Class({extends:cc.Component,properties:{imgBtn1:cc.Sprite,imgBtn2:cc.Sprite},onLoad:function(){},updateUI:function(e,t){this.data=e,this.callback=t,Global.CCHelper.updateSpriteFrame("Hall/btn_game_"+e.game1,this.imgBtn1),e.game2&&Global.CCHelper.updateSpriteFrame("Hall/btn_game_"+e.game2,this.imgBtn2)},onBtnClk:function(e,t){var a="";switch(t){case"game1":a=this.data.game1;break;case"game2":a=this.data.game2}this.callback&&this.callback(a)}}),cc._RF.pop()},{}],GameCommonController:[function(e,t,a){"use strict";cc._RF.push(t,"81196SyjRBLCaQ9Q1F1rurP","GameCommonController");var r=e("../../API/RoomProto"),i=.4;cc.Class({extends:cc.Component,properties:{gameHeadRichCtrlArr:[e("GameHeadController")],gameHeadSelfCtrl:e("GameHeadController"),gameHeadShenSuanZiCtrl:e("GameHeadController"),onlineNode:cc.Node,betRootNode:cc.Node,chipNodeArr:[cc.Node],selectChipButtonArr:[cc.Button],betStartTipNode:cc.Node,betStopTipNode:cc.Node,waitTipNode:cc.Node,tipBgNode:cc.Node},start:function(){this.otherUserBetActionStartPos=Global.CCHelper.getRelativePosition(this.onlineNode,this.betRootNode),this.chipNumberArr=[1,10,50,100,500],this.curSelectedChipIndex=0,this.chipArr=[];for(var e=0;e<this.selectChipButtonArr.length;++e)this.selectChipButtonArr[e].enabled=!1,this.selectChipButtonArr[e].node.opacity=150;this.userBetCountList={},this.profitPercentage=0,this.kindID=0,this.selectedChipArr=[];for(var t=0;t<this.chipNumberArr.length;++t){var a=Global.CCHelper.createSpriteNode("GameCommon/selected_chip_"+this.chipNumberArr[t]);a.active=!1,a.parent=this.selectChipButtonArr[t].node,this.selectedChipArr.push(a)}Global.MessageCallback.addListener("RoomMessagePush",this)},onDestroy:function(){Global.MessageCallback.removeListener("RoomMessagePush",this)},messageCallbackHandler:function(e,t){"RoomMessagePush"===e&&(t.type===r.GET_ROOM_SHOW_USER_INFO_PUSH?this.updateRoomUserInfo(t.data):t.type===r.USER_LEAVE_ROOM_RESPONSE&&Global.DialogManager.removeLoadingCircle())},buttonEvent:function(e,t){"exit"===t?Global.DialogManager.addPopDialog("\u662f\u5426\u8981\u9000\u51fa\u623f\u95f4\uff1f",function(){Global.API.room.roomMessageNotify(r.userLeaveRoomNotify()),Global.DialogManager.addLoadingCircle()},function(){}):"settings"===t?Global.DialogManager.createDialog("Setting/SettingDialog"):"rule"===t?Global.DialogManager.createDialog("GameCommon/GameRule/GameRuleDialog",{kind:this.kindID}):"online"===t&&Global.DialogManager.createDialog("GameCommon/GameOnlineUser/GameOnlineUserDialog")},betEvent:function(e,t){this.chipNumberArr.hasOwnProperty(t)&&this.updateChipButtonState(!0,t)},onGameInit:function(e,t){Global.API.room.roomMessageNotify(r.getRoomShowUserInfoNotify()),this.profitPercentage=e||0,this.kindID=t||0},onReconnection:function(){for(var e=0;e<this.chipArr.length;++e)this.chipArr[e].destroy();this.chipArr=[],this.gameHeadSelfCtrl.updateInfo(null),this.gameHeadShenSuanZiCtrl.updateInfo(null);for(var t=0;t<this.gameHeadRichCtrlArr.length;++t)this.gameHeadRichCtrlArr[t].updateInfo(null);this.updateChipButtonState(!1),this.curSelectedChipIndex=0,this.betStartTipNode.active=!1,this.betStopTipNode.active=!1,this.waitTipNode.active=!1,this.tipBgNode.active=!1,this.userBetCountList={}},onGameStart:function(){this.userBetCountList={},Global.API.room.roomMessageNotify(r.getRoomShowUserInfoNotify()),this.showWait(!1)},onGameBetStart:function(){this.betStartTipNode.active=!0,this.betStartTipNode.stopAllActions(),this.betStartTipNode.x=-1e3;var e=cc.moveTo(.3,cc.v2(0,0));e.easing(cc.easeIn(3));var t=cc.moveTo(.3,cc.v2(1e3,0));t.easing(cc.easeIn(3)),this.betStartTipNode.runAction(cc.sequence([e,cc.delayTime(.5),t,cc.callFunc(function(){this.betStartTipNode.active=!1}.bind(this))])),this.tipBgNode.active=!0,this.tipBgNode.stopAllActions(),this.tipBgNode.opacity=0,this.tipBgNode.runAction(cc.sequence([cc.fadeTo(.2,255),cc.delayTime(.7),cc.fadeTo(.2,0)])),this.updateChipButtonState(!0,0),Global.AudioManager.playSound("GameCommon/Sound/bet_start")},onGameBetEnd:function(){this.betStopTipNode.active=!0,this.betStopTipNode.stopAllActions(),this.betStopTipNode.x=-1e3;var e=cc.moveTo(.3,cc.v2(0,0));e.easing(cc.easeIn(3));var t=cc.moveTo(.3,cc.v2(1e3,0));t.easing(cc.easeIn(3)),this.betStopTipNode.runAction(cc.sequence([e,cc.delayTime(.5),t,cc.callFunc(function(){this.betStopTipNode.active=!1}.bind(this))])),this.tipBgNode.active=!0,this.tipBgNode.stopAllActions(),this.tipBgNode.opacity=0,this.tipBgNode.runAction(cc.sequence([cc.fadeTo(.2,255),cc.delayTime(.7),cc.fadeTo(.2,0)])),this.updateChipButtonState(!1),Global.AudioManager.playSound("GameCommon/Sound/bet_stop")},onGameResult:function(e){var t=this;function a(e){var a=t.getGameHeadCtrlByUid(e.uid);if(e.score>0){var r=e.uid,o=t.otherUserBetActionStartPos;a[0]&&(o=Global.CCHelper.getRelativePosition(a[0].node,t.betRootNode));for(var n=0;n<t.chipArr.length;++n){var s=t.chipArr[n];s.ownUid===r&&(s.runAction(cc.sequence([cc.moveTo(i,o),cc.removeSelf()])),s.ownUid=null)}}a.length>0&&t.scheduleOnce(function(){for(var r=0;r<a.length;++r)a[r].goldChange(t.userBetCountList[e.uid],!1),e.score>0?a[r].goldChange(e.score*(1-t.profitPercentage/100),0===r):a[r].goldChange(e.score,0===r)},i)}for(var r=0;r<e.length;++r)a(e[r]);for(var o=0;o<this.chipArr.length;++o){var n=this.chipArr[o];n.ownUid&&(n.runAction(cc.sequence([cc.moveTo(i,this.otherUserBetActionStartPos),cc.removeSelf()])),n.ownUid=null)}this.chipArr=[],Global.AudioManager.playSound("GameCommon/Sound/win_bet")},showWait:function(e){this.tipBgNode.active=e,this.tipBgNode.stopAllActions(),this.tipBgNode.opacity=255,this.waitTipNode.active=e},userBet:function(e,t,a,r){if(!(t<=0)){var i=this.getGameHeadCtrlByUid(e);if(i.length>0&&r){i[0].execBet(r),this.execBet(e,Global.CCHelper.getRelativePosition(i[0].node,this.betRootNode),a,t,r);for(var o=0;o<i.length;++o)i[o].goldChange(-1*t,!1)}else this.execBet(e,this.otherUserBetActionStartPos,a,t,r);e===Global.Player.getPy("uid")&&this.updateChipButtonState(!0,this.curSelectedChipIndex),e in this.userBetCountList?this.userBetCountList[e]=this.userBetCountList[e]+t:this.userBetCountList[e]=t}},execBet:function(e,t,a,r,i){for(var o=this.chipNumberArr.length-1;o>=0;--o)for(var n=this.chipNumberArr[o],s=Math.floor(r/n);s-- >0;){r-=n;var c=cc.v2(a.x+Math.random()*a.width,a.y+Math.random()*a.height),l=cc.instantiate(this.chipNodeArr[o]);if(l.parent=this.betRootNode,i){l.position=t,l.setScale(.3);var d=cc.v2(c.x-t.x,c.y-t.y).mag()/2e3,h=cc.sequence([cc.spawn([cc.scaleTo(d,1),cc.moveTo(d,c)]),cc.scaleTo(.3,.8)]);l.runAction(h)}else l.setScale(.8),l.position=c;l.ownUid=e,this.chipArr.push(l)}i&&(r>100?Global.AudioManager.playSound("GameCommon/Sound/bet_big"):Global.AudioManager.playSound("GameCommon/Sound/bet_small"))},getCurChipNumber:function(){return this.chipNumberArr[this.curSelectedChipIndex]||0},updateRoomUserInfo:function(e){if(this.gameHeadSelfCtrl.updateInfo(e.selfUserInfo.userInfo),this.gameHeadShenSuanZiCtrl.updateInfo(e.shenSuanZiInfo?e.shenSuanZiInfo.userInfo:null),e.fuHaoUserInfoArr)for(var t=0;t<this.gameHeadRichCtrlArr.length;++t)this.gameHeadRichCtrlArr[t].updateInfo(e.fuHaoUserInfoArr[t]?e.fuHaoUserInfoArr[t].userInfo:null)},getGameHeadCtrlByUid:function(e){var t=[];this.gameHeadSelfCtrl.getUid()===e&&t.push(this.gameHeadSelfCtrl),this.gameHeadShenSuanZiCtrl.getUid()===e&&t.push(this.gameHeadShenSuanZiCtrl);for(var a=0;a<this.gameHeadRichCtrlArr.length;++a)this.gameHeadRichCtrlArr[a].getUid()===e&&t.push(this.gameHeadRichCtrlArr[a]);return t},updateChipButtonState:function(e,t){if(this.curSelectedChipIndex=t,e){for(var a=this.gameHeadSelfCtrl.getUserInfo().gold,r=0;r<this.selectChipButtonArr.length;++r){var i=this.selectChipButtonArr[r],o=this.chipNumberArr[r]<a;i.enabled=o,i.node.opacity=o?255:150,i.node.y=0,this.selectedChipArr[r].active=!1}var n=this.selectChipButtonArr[t];n.enabled?(n.node.y=5,this.selectedChipArr[t].active=!0):a>this.chipNumberArr[0]&&(this.selectChipButtonArr[0].node.y=5,this.curSelectedChipIndex=0,this.selectedChipArr[0].active=!0)}else{for(var s=0;s<this.selectChipButtonArr.length;++s){var c=this.selectChipButtonArr[s];c.enabled=!1,c.node.opacity=150,c.node.y=0,this.selectedChipArr[s].active=!1}this.curSelectedChipIndex=0}}}),cc._RF.pop()},{"../../API/RoomProto":"RoomProto",GameHeadController:"GameHeadController"}],GameHeadController:[function(e,t,a){"use strict";cc._RF.push(t,"334e2r5B5pDgatxFKgwNyFP","GameHeadController");cc.Class({extends:cc.Component,properties:{goldLabel:cc.Label,nicknameLabel:cc.Label,headSprite:cc.Sprite,betActionDir:0,winGoldLabel:cc.Label,loseGoldLabel:cc.Label},start:function(){this.userInfo||(this.userInfo={uid:this.uid,gold:110,nickname:"",avatar:""})},updateInfo:function(e){e?(this.node.parent.active=!0,this.userInfo=Global.Utils.clone(e),this.goldLabel&&(this.goldLabel.string=e.gold.toFixed(2)),this.nicknameLabel.string=Global.Player.convertNickname(e.nickname),Global.CCHelper.updateSpriteFrame(e.avatar,this.headSprite)):(this.userInfo={uid:0,gold:0,nickname:"",avatar:""},this.node.parent.active=!1)},goldChange:function(e,t){if(0!==e&&(this.userInfo.gold+=e,this.goldLabel&&(this.goldLabel.string=this.userInfo.gold.toFixed(2)),t)){var a=parseFloat(e.toFixed(2))+"\u5143";e>0?(a="+"+a,this.winGoldLabel.string=a,this.winGoldLabel.node.y=20,this.winGoldLabel.node.runAction(cc.sequence([cc.show(),cc.moveTo(.2,cc.v2(0,40)),cc.delayTime(3),cc.hide()]))):(this.loseGoldLabel.string=a,this.loseGoldLabel.node.y=20,this.loseGoldLabel.node.runAction(cc.sequence([cc.show(),cc.moveTo(.2,cc.v2(0,40)),cc.delayTime(3),cc.hide()])))}},execBet:function(e){0!==this.betActionDir&&e&&this.node.runAction(cc.sequence([cc.moveBy(.1,cc.v2(20*this.betActionDir,0)),cc.moveBy(.1,cc.v2(-20*this.betActionDir,0))]))},getUserInfo:function(){return this.userInfo},getUid:function(){return this.userInfo?this.userInfo.uid:""},getHeadPos:function(){return this.node.parent.position}}),cc._RF.pop()},{}],GameOnlineUserDialog:[function(e,t,a){"use strict";cc._RF.push(t,"ab598VBg21Eh7XNgUOL9Eax","GameOnlineUserDialog");var r=e("../../API/RoomProto"),i=e("../../API/RoomAPI");cc.Class({extends:cc.Component,properties:{shenSuanZiItem:cc.Node,fuhao1Item:cc.Node,fuhaoItem:cc.Node},start:function(){Global.MessageCallback.addListener("RoomMessagePush",this),i.roomMessageNotify(r.getRoomOnlineUserInfoNotify())},onDestroy:function(){Global.MessageCallback.removeListener("RoomMessagePush",this)},buttonEventClose:function(){Global.DialogManager.destroyDialog(this)},messageCallbackHandler:function(e,t){if("RoomMessagePush"===e&&t.type===r.GET_ROOM_ONLINE_USER_INFO_PUSH){t.data.shenSuanZiInfo&&this.setItemInfo(this.shenSuanZiItem,t.data.shenSuanZiInfo);for(var a=0;a<t.data.fuHaoUserInfoArr.length;++a)if(0===a)this.setItemInfo(this.fuhao1Item,t.data.fuHaoUserInfoArr[a]);else{var i=cc.instantiate(this.fuhaoItem);this.setItemInfo(i,t.data.fuHaoUserInfoArr[a]),this.setItemNumber(i,a+1)}}},setItemInfo:function(e,t){e.parent=this.fuhaoItem.parent,e.active=!0,e.getChildByName("nickname").getComponent(cc.Label).string=Global.Player.convertNickname(t.userInfo.nickname),e.getChildByName("gold").getComponent(cc.Label).string=t.userInfo.gold.toFixed(2),e.getChildByName("winCount").getComponent(cc.Label).string=t.winCount+"\u5c40",e.getChildByName("betCount").getComponent(cc.Label).string=t.betCount.toFixed(2)+"\u5143",Global.CCHelper.updateSpriteFrame(t.userInfo.avatar,e.getChildByName("head_sprite").getComponent(cc.Sprite))},setItemNumber:function(e,t){e.getChildByName("fuhaoNumber").getComponent(cc.Label).string=t.toString()}}),cc._RF.pop()},{"../../API/RoomAPI":"RoomAPI","../../API/RoomProto":"RoomProto"}],GameProtoZJH:[function(e,t,a){"use strict";cc._RF.push(t,"fcf28tASQNN8aVGfxSYju72","GameProtoZJH");var r=t.exports;r.gameStatus={NONE:0,PLAYING:1},r.STAKE_LEVEL_BASE=[1,2,3,4,5],r.STAKE_XUE_PIN_BASE=50,r.STAKE_LEVEL=[1,2,3,4,5],r.STAKE_XUE_PIN=50,r.LOOK_CARD_MULTIPLE=2,r.MAX_ROUND=10,r.CARD_TYPE_ZASE_235=1,r.CARD_TYPE_DAN_ZHANG=10,r.CARD_TYPE_DUI_ZI=20,r.CARD_TYPE_SHUN_ZI=30,r.CARD_TYPE_TONG_HUA=40,r.CARD_TYPE_TONG_HUA_SHUN=50,r.CARD_TYPE_BAO_ZI=60,r.NORMAL_PLAYING=1e4,r.LOOK_CARD=10001,r.LOSE=10002,r.GIVE_UP=10003,r.LEAVE=10004,r.WIN_TYPE_OTHERS_GIVE=1,r.WIN_TYPE_WIN=2,r.OPERATION_TIME=115,r.GAME_OPERATE_STAKE_NOTIFY=401,r.GAME_OPERATE_STAKE_PUSH=301,r.GAME_OPERATE_GIVEUP_NOTIFY=402,r.GAME_OPERATE_GIVEUP_PUSH=302,r.GAME_OPERATE_LOOK_NOTIFY=403,r.GAME_OPERATE_LOOK_PUSH=303,r.GAME_OPERATE_COMPARE_NOTIFY=404,r.GAME_OPERATE_COMPARE_PUSH=304,r.GAME_OPERATE_SHOWDOWN_NOTIFY=405,r.GAME_OPERATE_SHOWDOWN_PUSH=305,r.GAME_OPERATE_GET_GAME_DATA_NOTIFY=406,r.GAME_OPERATE_GET_GAME_DATA_PUSH=306,r.GAME_OPERATE_GU_ZHU_YI_ZHI_NOTIFY=407,r.GAME_OPERATE_GU_ZHU_YI_ZHI_PUSH=307,r.GAME_START_PUSH=308,r.GAME_CHAIR_TURN_PUSH=309,r.GAME_END_PUSH=310,r.OPERATION_TIME=15,r.gameStartPush=function(e,t,a,i,o){return{type:r.GAME_START_PUSH,data:{stakeLevel:e,firstXiaZhu:t,goldSumAmount:a,round:i,userStakeCountArr:o}}},r.chairTurnPush=function(e,t,a){return{type:r.GAME_CHAIR_TURN_PUSH,data:{chairId:e,currentStakeLevel:t,canCompare:a}}},r.gameEndPush=function(e,t,a,i,o){return{type:r.GAME_END_PUSH,data:{winType:e,winnerchairId:t,userCardIndexArr:i,userCardTypeArr:a,scoreChangeArr:o}}},r.userStakeNotify=function(e){return{type:r.GAME_OPERATE_STAKE_NOTIFY,data:{stakeLevel:e}}},r.userStakePush=function(e,t,a,i,o){return{type:r.GAME_OPERATE_STAKE_PUSH,data:{chairId:e,stakeLevel:t,goldSumAmount:i,round:o,multiple:a}}},r.userGiveUpNotify=function(){return{type:r.GAME_OPERATE_GIVEUP_NOTIFY,data:{}}},r.userGiveUpPush=function(e){return{type:r.GAME_OPERATE_GIVEUP_PUSH,data:{chairId:e}}},r.userLookCardNotify=function(){return{type:r.GAME_OPERATE_LOOK_NOTIFY}},r.userLookCardPush=function(e,t){return{type:r.GAME_OPERATE_LOOK_PUSH,data:{cardDataArr:e,chairId:t}}},r.userShowDownNotify=function(e){return{type:r.GAME_OPERATE_SHOWDOWN_NOTIFY,data:{showchairId:e}}},r.userShowdownPush=function(e,t){return{type:r.GAME_OPERATE_SHOWDOWN_PUSH,data:{chairId:t,cards:e}}},r.userCompareNotify=function(e){return{type:r.GAME_OPERATE_COMPARE_NOTIFY,data:{comparechairId:e}}},r.userComparePush=function(e,t,a){return{type:r.GAME_OPERATE_COMPARE_PUSH,data:{loserchairId:a,comparechairId:t,chairId:e}}},r.guzhuyizhiNotify=function(e){return{type:r.GAME_OPERATE_GU_ZHU_YI_ZHI_NOTIFY,data:{stakeNum:e}}},r.guzhuyizhiPush=function(e){return{type:r.GAME_OPERATE_GU_ZHU_YI_ZHI_PUSH,data:e}},cc._RF.pop()},{}],GameRuleDialog:[function(e,t,a){"use strict";cc._RF.push(t,"b6232u6IxBMb6oRhv1ymCZj","GameRuleDialog"),cc.Class({extends:cc.Component,properties:{contentRoot:cc.Node},start:function(){var e=this.contentRoot.getChildByName(this.dialogParameters.kind.toString());e&&(e.active=!0)},closeEvent:function(){Global.DialogManager.destroyDialog(this)}}),cc._RF.pop()},{}],GameTypes:[function(e,t,a){"use strict";cc._RF.push(t,"56766MBT9FAWquAuGPzSrgi","GameTypes");var r=t.exports={};r.init=function(e){this.allGames=e},r.setState=function(e){e&&(this.stateParams=e.split("_"),"game"===this.stateParams[0]&&this.setCurrentKind(this.stateParams[1]))},r.getJoinRoomID=function(){var e=this.stateParams[2];return!(!e||0===parseInt(e))&&e},r.getAddFriendUid=function(){var e=this.stateParams[3];return!(!e||0===parseInt(e))&&e},r.clearState=function(){this.setState("game_"+this.getCurrentGameTypeID())},r.setCurrentKind=function(e){this.kind=parseInt(e)},r.getCurrentKind=function(){return this.kind},r.getCurrentGameType=function(){return this.kind},r.getCurrentGameTypeID=function(){for(var e in this.allGames)if(this.allGames.hasOwnProperty(e)&&this.allGames[e].kind===this.kind)return e;return!1},r.getGameInfoByGameTypeID=function(e){for(var t=0;t<this.allGames.length;++t)if(this.allGames[t].gameTypeID===e)return this.allGames[t];return null},r.getCUrrentGameInfo=function(){return this.allGames[this.getCurrentGameTypeID()]},r.getAllGames=function(){return Global.Constant.gameTypesConf},r.getLevelsByKind=function(e){var t=[];for(var a in this.allGames)this.allGames.hasOwnProperty(a)&&this.allGames[a].kind===e&&t.push(this.allGames[a]);for(var r=0;r<t.length-1;r++)for(var i=r+1;i<t.length;i++)if(t[r].level>t[i].level){var o=t[r];t[r]=t[i],t[i]=o}return t},r.getGameConfByKind=function(e){for(var t in Global.Constant.gameTypesConf)if(Global.Constant.gameTypesConf.hasOwnProperty(t)&&Global.Constant.gameTypesConf[t].kind===e)return Global.Constant.gameTypesConf[t]},r.getGameInfoByKindAndLevel=function(e,t){for(var a in this.allGames)if(this.allGames.hasOwnProperty(a)&&this.allGames[a].kind===e&&this.allGames[a].level===t)return this.allGames[a];return null},cc._RF.pop()},{}],HHDZAPI:[function(e,t,a){"use strict";cc._RF.push(t,"dacd3OFkOJBUYqG8Mqg4r6J","HHDZAPI");var r=e("./HHDZGameProto");t.exports.stake=function(e){var t={type:r.GAME_OPERATE_STAKE_NOTIFY,data:e};Global.NetworkManager.notify("game.gameHandler.gameMessageNotify",t)},cc._RF.pop()},{"./HHDZGameProto":"HHDZGameProto"}],HHDZCards:[function(e,t,a){"use strict";cc._RF.push(t,"f99a28MBV9ErIQ6y3egEV5X","HHDZCards"),cc.Class({extends:cc.Component,properties:{cards:[cc.Sprite],cardType:cc.Sprite},start:function(){this.hideCards()},hideCards:function(){this.cardType.node.active=!1;for(var e=0;e<this.cards.length;e++)Global.CCHelper.updateSpriteFrame("GameCommon/Card/card_back",this.cards[e])},showCards:function(e){Global.CCHelper.updateSpriteFrame("GameCommon/ZJHCardType/labelImg_cardType_"+e.cardType,this.cardType),this.scheduleOnce(function(){this.cardType.node.active=!0,Global.AudioManager.playSound("HongHeiDaZhan/Sound/cardType_"+e.cardType)}.bind(this),1.5);for(var t=0;t<e.cards.length;t++)this.cardAnimation(this.cards[t].node,e.cards[t]+"",t)},cardAnimation:function(e,t,a){this.scheduleOnce(function(){Global.AudioManager.playSound("GameCommon/Sound/flipcard");var a={x:e.x,y:e.y},r={x:e.scaleX,y:e.scaleY},i=[];i[i.length]=cc.moveBy(.2,10,a.y),i[i.length]=cc.spawn([cc.scaleTo(.1,.1,r.y),cc.moveBy(.1,-10,a.y+10)]),i[i.length]=cc.callFunc(function(){Global.CCHelper.updateSpriteFrame("GameCommon/Card/"+t,e.getComponent(cc.Sprite))}.bind(this)),i[i.length]=cc.spawn([cc.scaleTo(.1,r.x,r.y),cc.moveTo(.1,a.x,a.y)]),i[i.length]=cc.moveTo(.3,a.x,a.y).easing(cc.easeBackOut()),e.runAction(cc.sequence(i))}.bind(this),.5*a)}}),cc._RF.pop()},{}],HHDZDirRecordDialog:[function(e,t,a){"use strict";cc._RF.push(t,"23725yVJnxLSZ9xotEWfzaD","HHDZDirRecordDialog");var r=e("./API/HHDZGameProto");cc.Class({extends:cc.Component,properties:{trendItemController:e("../LongHuDou/LHDTrendItem"),blackWinPercentLabel:cc.Label,redWinPercentLabel:cc.Label,dirPoint:cc.Prefab,pointContent:cc.Node,dirCardTypeImg:cc.Prefab,cardTypeImgContent:cc.Node,redCount:cc.Label,blackCount:cc.Label,totalCount:cc.Label},start:function(){this.points=[],this.cardTypeImgs=[],this.dirRecordArr=this.dialogParameters.dirRecordArr,this.updateTrendItemController(),this.addDirRecord(this.dirRecordArr),this.updateWinPercent(),Global.MessageCallback.addListener("UpdateDirRecord",this)},onDestroy:function(){Global.MessageCallback.removeListener("UpdateDirRecord",this)},messageCallbackHandler:function(e,t){"UpdateDirRecord"===e&&(this.dirRecordArr=this.dirRecordArr.concat(t),this.addDirRecord(t),this.updateWinPercent(),this.updateTrendItemController())},buttonEvent:function(e,t){"close"===t&&Global.DialogManager.destroyDialog(this,!0)},updateTrendItemController:function(){var e=[],t=0,a=0,i=0;this.dirRecordArr.length>r.DIR_COUNT&&(t=this.dirRecordArr.length-r.DIR_COUNT);for(var o=t;o<this.dirRecordArr.length;o++)e.push(this.dirRecordArr[o].winner),this.dirRecordArr[o].winner===r.BLACK?i++:this.dirRecordArr[o].winner===r.RED&&a++;this.redCount.string="\u7ea2 "+a,this.blackCount.string="\u9ed1 "+i,this.totalCount.string="\u5c40\u6570 "+(a+i),this.trendItemController.init(e,Global.Enum.gameType.HHDZ)},addDirRecord:function(e){for(var t=0;t<e.length;t++){20===this.points.length&&(this.points[0].destroy(),this.points.shift()),20===this.cardTypeImgs.length&&(this.cardTypeImgs[0].destroy(),this.cardTypeImgs.shift());var a=cc.instantiate(this.dirPoint);a.parent=this.pointContent,a.getChildByName("redPoint").active=e[t].winner===r.RED,this.points[this.points.length]=a;var i=cc.instantiate(this.dirCardTypeImg);i.parent=this.cardTypeImgContent,Global.CCHelper.updateSpriteFrame("HongHeiDaZhan/dir_cardType_"+e[t].winnerCardType,i.getComponent(cc.Sprite)),this.cardTypeImgs[this.cardTypeImgs.length]=i}},updateWinPercent:function(){var e=0,t=0,a=0;this.dirRecordArr.length>=20&&(a=this.dirRecordArr.length-20);for(var i=a;i<this.dirRecordArr.length;i++)this.dirRecordArr[i].winner===r.BLACK?e++:this.dirRecordArr[i].winner===r.RED&&t++;if(e===t)this.blackWinPercentLabel.string="50%",this.redWinPercentLabel.string="50%",this.blackWinPercentLabel.node.parent.width=(this.blackWinPercentLabel.node.parent.width+this.redWinPercentLabel.node.parent.width)/2,this.redWinPercentLabel.node.parent.width=this.blackWinPercentLabel.node.parent.width;else{var o=Math.floor(e/(e+t)*100);this.blackWinPercentLabel.string=o+"%",this.redWinPercentLabel.string=100-o+"%",this.blackWinPercentLabel.node.parent.width=(this.blackWinPercentLabel.node.parent.width+this.redWinPercentLabel.node.parent.width)*(o/100),this.blackWinPercentLabel.node.parent.width<60&&(this.blackWinPercentLabel.node.parent.width=60),this.blackWinPercentLabel.node.parent.width>540&&(this.blackWinPercentLabel.node.parent.width=540),this.redWinPercentLabel.node.parent.width=600-this.blackWinPercentLabel.node.parent.width}}}),cc._RF.pop()},{"../LongHuDou/LHDTrendItem":"LHDTrendItem","./API/HHDZGameProto":"HHDZGameProto"}],HHDZGameProto:[function(e,t,a){"use strict";cc._RF.push(t,"92d22F9KXNBlJQw7QNFw5cB","HHDZGameProto");var r=t.exports;r.GAME_NAME="\u624e\u91d1\u82b1",r.STAKE_LEVEL=[1,2,3,4,5],r.campCount=2,r.BLACK=0,r.RED=1,r.stakeTime=12,r.gameStartDelayTime=9,r.CARD_TYPE_ZASE_235=1,r.CARD_TYPE_DAN_ZHANG=10,r.CARD_TYPE_DUI_ZI=20,r.CARD_TYPE_SHUN_ZI=30,r.CARD_TYPE_TONG_HUA=40,r.CARD_TYPE_TONG_HUA_SHUN=50,r.CARD_TYPE_BAO_ZI=60,r.GAME_OPERATE_STAKE_NOTIFY=401,r.GAME_OPERATE_STAKE_PUSH=301,r.GAME_START_PUSH=201,r.GAME_END_PUSH=202,r.SCORE_BLACK=0,r.SCORE_RED=1,r.SCORE_LUCK=2,r.gameStatus={NONE:0,GAME_STARTED:1,GAME_END:2},r.DIR_COUNT=50,cc._RF.pop()},{}],HHDZMainDialog:[function(e,t,a){"use strict";cc._RF.push(t,"a636bRArK5AlaAIT3PKIFQt","HHDZMainDialog");var r=e("../../API/RoomProto"),i=e("./API/HHDZGameProto"),o=e("../../API/RoomAPI"),n=e("./HHDZModel");cc.Class({extends:cc.Component,properties:{gameCommonCtrl:e("GameCommonController"),blackCardsGroup:cc.Node,redCardsGroup:cc.Node,blackBetRectNode:cc.Node,redBetRectNode:cc.Node,luckBetRectNode:cc.Node,blackBetCountLabel:cc.Label,redBetCountLabel:cc.Label,luckBetCountLabel:cc.Label,winTypeShowNode:cc.Node,betRecordItemNode:cc.Node,cards:cc.Prefab,pointContent:cc.Node,cardTypeContent:cc.Node,dirPoint:cc.Prefab,dirCardType:cc.Prefab,selfBetCountBlack:cc.Label,selfBetCountRed:cc.Label,selfBetCountLuck:cc.Label},start:function(){this.enableBet=!1,this.gameResultData=null,this.gameInited=!1,this.dirRecordArr=[],this.dirRecordNodeArr=[],this.betCountList={},this.betCountList[i.SCORE_BLACK]=0,this.betCountList[i.SCORE_RED]=0,this.betCountList[i.SCORE_LUCK]=0,this.selfBetCountList=[],this.selfBetCountList[i.SCORE_BLACK]=0,this.selfBetCountList[i.SCORE_RED]=0,this.selfBetCountList[i.SCORE_LUCK]=0,this.points=[],this.cardTypeImgs=[],this.blackCardsPos=this.blackCardsGroup.position,this.redCardsPos=this.redCardsGroup.position,this.blackCards=cc.instantiate(this.cards),this.blackCards.parent=this.blackCardsGroup,this.redCards=cc.instantiate(this.cards),this.redCards.parent=this.redCardsGroup,o.roomMessageNotify(r.getRoomSceneInfoNotify()),Global.MessageCallback.addListener("RoomMessagePush",this),Global.MessageCallback.addListener("GameMessagePush",this),Global.MessageCallback.addListener("ReConnectSuccess",this),Global.AudioManager.startPlayBgMusic("LongHuDou/Sound/bg")},onDestroy:function(){Global.MessageCallback.removeListener("RoomMessagePush",this),Global.MessageCallback.removeListener("GameMessagePush",this),Global.MessageCallback.removeListener("ReConnectSuccess",this),n.onDestroy(),Global.AudioManager.stopBgMusic()},messageCallbackHandler:function(e,t){if("RoomMessagePush"===e)t.type===r.USER_LEAVE_ROOM_PUSH?t.data.roomUserInfo.userInfo.uid===Global.Player.getPy("uid")&&this.exitGame():t.type===r.GET_ROOM_SCENE_INFO_PUSH&&this.gameInit(t.data.gameData);else if("GameMessagePush"===e){if(!this.gameInited)return;t.type===i.GAME_OPERATE_STAKE_PUSH?(this.userBet(t.data,!0),this.updateBetCount(this.betCountList)):t.type===i.GAME_START_PUSH?(cc.log("\u6e38\u620f\u5f00\u59cb",t),this.onGameStart()):t.type===i.GAME_END_PUSH&&(cc.log("\u6e38\u620f\u7ed3\u675f",t),this.onGameEnd(t.data))}else"ReConnectSuccess"===e&&Global.API.hall.joinRoomRequest(n.roomID,function(){this.onReconnection()})},betEvent:function(e,t){if(this.enableBet){var a=i.SCORE_BLACK;"black"===t?a=i.SCORE_BLACK:"red"===t?a=i.SCORE_RED:"luck"===t&&(a=i.SCORE_LUCK);var r={type:i.GAME_OPERATE_STAKE_NOTIFY,data:{betType:a,count:this.gameCommonCtrl.getCurChipNumber()}};o.gameMessageNotify(r)}},buttonEvent:function(e,t){"recordNode"===t&&Global.DialogManager.createDialog("HongHeiDaZhan/HHDZDirRecordDialog",{dirRecordArr:this.dirRecordArr})},gameInit:function(e){if(this.gameInited=!0,this.gameCommonCtrl.onGameInit(n.profitPercentage,Global.Enum.gameType.HHDZ),this.dirRecordArr=[],this.dirRecordNodeArr.length>0)for(var t=0;t<this.dirRecordNodeArr.length;++t)this.dirRecordNodeArr[t].destroy();if(this.dirRecordNodeArr=[],this.addDirRecord(e.dirRecord),e.gameStatus!==i.gameStatus.NONE){if(e.gameStatus===i.gameStatus.GAME_STARTED?this.onGameStart():e.gameStatus===i.gameStatus.GAME_END&&(e.resultData&&(this.gameResultData=e.resultData,this.onShowCard(!1),this.onShowResult()),this.gameCommonCtrl.showWait(!0)),e.betRecordList)for(var a in e.betRecordList)if(e.betRecordList.hasOwnProperty(a)){var r=e.betRecordList[a];r[i.SCORE_BLACK]&&this.userBet({uid:a,betType:i.SCORE_BLACK,count:r[i.SCORE_BLACK]},!1),r[i.SCORE_RED]&&this.userBet({uid:a,betType:i.SCORE_RED,count:r[i.SCORE_RED]},!1),r[i.SCORE_LUCK]&&this.userBet({uid:a,betType:i.SCORE_LUCK,count:r[i.SCORE_LUCK]},!1)}this.updateBetCount(this.betCountList)}},onReconnection:function(){this.enableBet=!1,this.gameResultData=null,this.gameInited=!1,this.node.stopAllActions(),this.betCountList={},this.betCountList[i.SCORE_BLACK]=0,this.betCountList[i.SCORE_RED]=0,this.betCountList[i.SCORE_LUCK]=0,this.selfBetCountList=[],this.selfBetCountList[i.SCORE_BLACK]=0,this.selfBetCountList[i.SCORE_RED]=0,this.selfBetCountList[i.SCORE_LUCK]=0,this.updateBetCount(this.betCountList),this.blackCardsGroup.stopAllActions(),this.blackCardsGroup.active=!1,this.redCardsGroup.stopAllActions(),this.redCardsGroup.active=!1,this.dirRecordArr=[];for(var e=0;e<this.dirRecordNodeArr.length;++e)this.dirRecordNodeArr[e].destroy();this.dirRecordNodeArr=[],this.gameCommonCtrl.onReconnection(),o.roomMessageNotify(r.getRoomSceneInfoNotify())},onGameStart:function(){this.betCountList={},this.betCountList[i.SCORE_BLACK]=0,this.betCountList[i.SCORE_RED]=0,this.betCountList[i.SCORE_LUCK]=0,this.selfBetCountList=[],this.selfBetCountList[i.SCORE_BLACK]=0,this.selfBetCountList[i.SCORE_RED]=0,this.selfBetCountList[i.SCORE_LUCK]=0,this.updateBetCount(this.betCountList),this.node.stopAllActions(),this.gameCommonCtrl.onGameStart(),this.node.runAction(cc.sequence([cc.delayTime(1),cc.callFunc(this.onBetStart.bind(this)),cc.delayTime(i.stakeTime),cc.callFunc(this.onBetStop.bind(this))]))},onBetStart:function(){cc.log("\u5f00\u59cb\u4e0b\u6ce8"),this.enableBet=!0,this.gameCommonCtrl.onGameBetStart(),this.onDispatchCard()},onBetStop:function(){cc.log("\u505c\u6b62\u4e0b\u6ce8"),this.enableBet=!1,this.gameCommonCtrl.onGameBetEnd(),this.node.stopAllActions()},onGameEnd:function(e){this.gameResultData=e,this.enableBet&&this.onBetStop(),this.node.stopAllActions();var t=[cc.delayTime(this.enableBet?2:.1),cc.callFunc(this.onShowCard.bind(this)),cc.delayTime(4),cc.callFunc(this.onShowWin.bind(this)),cc.delayTime(3),cc.callFunc(this.onShowResult.bind(this))];this.node.runAction(cc.sequence(t))},onShowCard:function(e){this.gameResultData&&(this.blackCardsGroup.active=!0,this.redCardsGroup.active=!0,cc.log(this.gameResultData),this.blackCards.getComponent("HHDZCards").showCards(this.gameResultData.cardsData[i.BLACK]),this.scheduleOnce(function(){this.redCards.getComponent("HHDZCards").showCards(this.gameResultData.cardsData[i.RED])}.bind(this),2))},onDispatchCard:function(){this.blackCardsGroup.active=!0,this.redCardsGroup.active=!0,this.blackCards.getComponent("HHDZCards").hideCards(),this.redCards.getComponent("HHDZCards").hideCards(),this.blackCardsGroup.position=cc.v2(0,25);var e=cc.moveTo(.2,this.blackCardsPos);e.easing(cc.easeIn(3)),this.blackCardsGroup.runAction(e),this.redCardsGroup.position=cc.v2(0,25);var t=cc.moveTo(.2,this.redCardsPos);t.easing(cc.easeIn(3)),this.redCardsGroup.runAction(t),Global.AudioManager.playSound("GameCommon/Sound/sendcard")},onShowWin:function(){if(this.gameResultData){var e=this.gameResultData.winType,t="";e===i.BLACK?(t="Black","long_win"):e===i.RED&&(t="Red","hu_win");var a=this.winTypeShowNode.getChildByName(t);if(a){a.active=!0;var r=cc.sequence([cc.fadeIn(.3),cc.delayTime(.2),cc.fadeOut(.6)]);a.opacity=0,a.runAction(cc.repeat(r,3))}if(this.gameResultData.luck){var o=this.winTypeShowNode.getChildByName("Luck");if(o){o.active=!0;var n=cc.sequence([cc.fadeIn(.3),cc.delayTime(.2),cc.fadeOut(.6)]);o.opacity=0,o.runAction(cc.repeat(n,3))}}}},onShowResult:function(){this.gameCommonCtrl.onGameResult(this.gameResultData.scoreChangeArr),this.addDirRecord([{winner:this.gameResultData.winType,winnerCardType:this.gameResultData.winnerCardType}])},userBet:function(e,t){this.betCountList[e.betType]+=e.count,e.uid===Global.Player.getPy("uid")&&(this.selfBetCountList[e.betType]+=e.count);var a=cc.rect(0,0,0,0);e.betType===i.SCORE_BLACK?a=this.blackBetRectNode.getBoundingBox():e.betType===i.SCORE_RED?a=this.redBetRectNode.getBoundingBox():e.betType===i.SCORE_LUCK&&(a=this.luckBetRectNode.getBoundingBox()),this.gameCommonCtrl.userBet(e.uid,e.count,a,t)},updateBetCount:function(e){this.blackBetCountLabel.string=e[i.SCORE_BLACK].toString(),this.redBetCountLabel.string=e[i.SCORE_RED].toString(),this.luckBetCountLabel.string=e[i.SCORE_LUCK].toString(),this.selfBetCountBlack.string="\u4e0b\u6ce8:"+this.selfBetCountList[i.SCORE_BLACK].toString(),this.selfBetCountRed.string="\u4e0b\u6ce8:"+this.selfBetCountList[i.SCORE_RED].toString(),this.selfBetCountLuck.string="\u4e0b\u6ce8:"+this.selfBetCountList[i.SCORE_LUCK].toString()},addDirRecord:function(e){for(Global.MessageCallback.emitMessage("UpdateDirRecord",e),this.dirRecordArr=this.dirRecordArr.concat(e);this.dirRecordArr.length>i.DIR_COUNT;)this.dirRecordArr.shift();for(var t=0;t<e.length;t++){18===this.points.length&&(this.points[0].destroy(),this.points.shift()),7===this.cardTypeImgs.length&&(this.cardTypeImgs[0].destroy(),this.cardTypeImgs.shift());var a=cc.instantiate(this.dirPoint);a.parent=this.pointContent,a.getChildByName("redPoint").active=e[t].winner===i.RED,this.points[this.points.length]=a;var r=cc.instantiate(this.dirCardType);r.parent=this.cardTypeContent,Global.CCHelper.updateSpriteFrame("HongHeiDaZhan/dir_cardType_"+e[t].winnerCardType,r.getComponent(cc.Sprite)),this.cardTypeImgs[this.cardTypeImgs.length]=r}},exitGame:function(){Global.DialogManager.createDialog("Hall/HallDialog",null,function(){Global.DialogManager.destroyDialog(this,!0),Global.CCHelper.releaseRes(["HongHeiDaZhan"])}.bind(this))}}),cc._RF.pop()},{"../../API/RoomAPI":"RoomAPI","../../API/RoomProto":"RoomProto","./API/HHDZGameProto":"HHDZGameProto","./HHDZModel":"HHDZModel",GameCommonController:"GameCommonController"}],HHDZModel:[function(e,t,a){"use strict";cc._RF.push(t,"82c0dy3lhtCt4rp97E/HTq9","HHDZModel");e("./API/HHDZGameProto");var r=t.exports={};r.COLOR_LABEL=["\u65b9","\u6885","\u7ea2","\u9ed1"],r.COLOR={red:new cc.Color(173,27,27,255),black:new cc.Color(32,27,27,255)},r.init=function(e){this.data=e,this.profitPercentage=e.gameData.profitPercentage},r.getCardLogicValue=function(e){return e&this.LOGIC_MASK_VALUE},r.getCardColorValue=function(e){return(e&this.LOGIC_MASK_COLOR)/16},r.getCardDesNormal=function(e){return this.COLOR_LABEL[this.getCardColorValue(e)]+this.getCardLogicValue(e)},r.onDestroy=function(){this.data=null},cc._RF.pop()},{"./API/HHDZGameProto":"HHDZGameProto"}],HallAPI:[function(e,t,a){"use strict";cc._RF.push(t,"913d9YLOt9MAbcjdyTzFELp","HallAPI");var r=t.exports={};r.entry=function(e,t,a,r){var i={token:e,userInfo:t};Global.NetworkManager.send("connector.entryHandler.entry",i,a||"EntryHallResponse",r)},r.searchRequest=function(e,t){var a={uid:e};Global.NetworkManager.send("hall.userHandler.searchUserData",a,t||"SearchResponse")},r.bindPhoneRequest=function(e,t,a,r){var i={phone:e,verificationCode:t,imgCodeInfo:a};Global.NetworkManager.send("hall.userHandler.bindPhone",i,r||"BindPhoneResponse")},r.changeNicknameRequest=function(e,t){var a={nickname:e};Global.NetworkManager.send("hall.userHandler.updateNickname",a,t||"ChangeNicknameResponse")},r.changeAvatarRequest=function(e,t){var a={avatar:e};Global.NetworkManager.send("hall.userHandler.updateAvatar",a,t||"ChangeAvatarResponse")},r.updateBankCardInfoRequest=function(e,t,a,r){var i={bankCardInfo:{cardNumber:e,bankName:t,ownerName:a}};Global.NetworkManager.send("hall.userHandler.updateBankCardInfo",i,r||"UpdateBankCardInfoResponse")},r.updateAliPayInfoRequest=function(e,t,a){var r={aliPayInfo:{aliPayAccount:e,ownerName:t}};Global.NetworkManager.send("hall.userHandler.updateAliPayInfoRequest",r,a||"UpdateAliPayInfoResponse")},r.safeBoxOperationRequest=function(e,t,a){var r={count:e,safePassword:t};Global.NetworkManager.send("hall.userHandler.safeBoxOperation",r,a||"SafeBoxOperationResponse")},r.updateLoginPasswordRequest=function(e,t,a){var r={oldPassword:e,newPassword:t};Global.NetworkManager.send("hall.userHandler.updateLoginPassword",r,a||"UpdateLoginPasswordResponse")},r.updateSafePasswordRequest=function(e,t,a){var r={oldPassword:e,newPassword:t};Global.NetworkManager.send("hall.userHandler.updateSafePassword",r,a||"UpdateSafePasswordResponse")},r.withdrawCashRequest=function(e,t,a){var r={count:e,withdrawCashType:t};Global.NetworkManager.send("hall.currencyHandler.withdrawCashRequest",r,a||"WithdrawCashResponse")},r.extractionCommissionRequest=function(e){Global.NetworkManager.send("hall.currencyHandler.extractionCommission",{},e||"ExtractionCommissionResponse")},r.getTodayWinGoldCountRankRequest=function(e,t,a){var r={startIndex:e,count:t};Global.NetworkManager.send("center.rankHandler.getTodayWinGoldCountRankRequest",r,a||"GetTodayWinGoldCountRankResponse")},r.purchaseRechargeItemRequest=function(e,t,a,r){var i={itemID:e,rechargePlatform:t,rechargeInfo:a};Global.NetworkManager.send("hall.rechargeHandler.purchaseItem",i,r||"PurchaseRechargeItemResponse")},r.getRecordDataRequest=function(e,t,a,r){var i={recordType:e,startIndex:t,count:a};Global.NetworkManager.send("hall.recordHandler.getRecordData",i,r||"GetRecordDataResponse")},r.getGameRecordDataRequest=function(e,t,a){var r={matchData:e,sortData:t,startIndex:0,count:10};Global.NetworkManager.send("hall.recordHandler.getGameRecordDataRequest",r,a||"GetGameRecordDataResponse")},r.getDirectlyMemberRecordDataRequest=function(e,t,a){var r={startIndex:e,count:t};Global.NetworkManager.send("hall.recordHandler.getDirectlyMemberRecordData",r,a||"GetDirectlyMemberRecordDataResponse")},r.getAgentMemberRecordDataRequest=function(e,t,a){var r={startIndex:e,count:t};Global.NetworkManager.send("hall.recordHandler.getAgentMemberRecordData",r,a||"GetAgentMemberRecordDataResponse")},r.createRoomRequest=function(e,t,a){var r={gameRule:e,gameTypeID:t};Global.NetworkManager.send("hall.gameHandler.createRoom",r,a||"CreateRoomResponse")},r.joinRoomRequest=function(e,t,a){var r={roomId:e};Global.NetworkManager.send("hall.gameHandler.joinRoom",r,t||"JoinRoomResponse",a)},r.exitRoomRequest=function(e){Global.NetworkManager.send("hall.gameHandler.exitRoom",{},e||"ExitRoomResponse")},r.matchRoomRequest=function(e,t){var a={gameTypeID:e};Global.NetworkManager.send("hall.gameHandler.matchRoom",a,t||"MatchRoomResponse")},r.stopMatchRoomRequest=function(e){Global.NetworkManager.send("hall.gameHandler.stopMatchRoom",{},e||"StopMatchRoomResponse")},r.getAllRoomGameDataByKind=function(e,t){var a={kindID:e};Global.NetworkManager.send("hall.gameHandler.getAllRoomGameDataByKind",a,t||"GetAllRoomGameDataByKindResponse")},r.getRoomGameDataByRoomID=function(e,t){var a={roomID:e};Global.NetworkManager.send("hall.gameHandler.getRoomGameDataByRoomID",a,t||"GetRoomGameDataByRoomIDResponse")},r.readEmailRequest=function(e,t){var a={emailID:e};Global.NetworkManager.send("hall.emailHandler.readEmail",a,t||"ReadEmailResponse")},cc._RF.pop()},{}],HallDialog:[function(e,t,a){"use strict";cc._RF.push(t,"11f25QrXH5KsoO5LTVJmNPU","HallDialog"),cc.Class({extends:cc.Component,properties:{nicknameText:cc.Label,scoreText:cc.Label,scoreText1:cc.Label,headIcon:cc.Sprite,gameBtnItem:cc.Prefab,gameBtnGroup:cc.Node,showItem:cc.Prefab,pageViewContent:cc.Node,gameGroup:cc.Node,roomGroup:cc.Node,roomItem:cc.Prefab,roomContent:cc.Node,gameTitleImg:cc.Sprite,topGroup:cc.Node,bottomGroup:cc.Node,backGroup:cc.Node,noticeRedPoint:cc.Node,broadcastNode:cc.Node,broadcastWidget:cc.Prefab},init:function(){this.updatePlayerInfo(),this.showGameGroup(),cc.instantiate(this.broadcastWidget).parent=this.broadcastNode},showNotice:function(){Global.alreadyShowNotice||(Global.DialogManager.createDialog("Notice/NoticeListDialog"),Global.alreadyShowNotice=!0)},updatePlayerInfo:function(){this.nicknameText.string=Global.Player.convertNickname(Global.Player.getPy("nickname")),this.scoreText.string=Global.Player.getPy("gold"),this.scoreText1.string=Global.Player.getPy("gold"),Global.CCHelper.updateSpriteFrame(Global.Player.getPy("avatar"),this.headIcon),this.noticeRedPoint.active=0!==Global.Player.checkUnRead()},checkJoinRoom:function(){var e=Global.Player.getPy("roomID");e&&Global.DialogManager.createDialog("Match/MatchGameDialog",{roomID:e})},createShowView:function(){for(var e=0;e<1;e++){cc.instantiate(this.showItem).parent=this.pageViewContent}},createGameItem:function(){for(var e=Global.GameTypes.allGames,t=[],a=0;a<e.length;++a){var r=e[a];-1===t.indexOf(r.kind)&&t.push(r.kind)}t.push("more");for(var i=0;i<t.length;i+=2){var o=cc.instantiate(this.gameBtnItem);o.parent=this.gameBtnGroup,o.getComponent("GameBtnItem").updateUI({game1:t[i],game2:t[i+1]},function(e){this.showRoomGroup(e)}.bind(this))}},showRoomGroup:function(e){if("more"!==e){if(e===Global.Enum.gameType.DZ)return Global.DialogManager.addLoadingCircle(1),void Global.DialogManager.createDialog("Game/DeZhouPoker/RoomLayer/DZRoomLayerDialog",null,function(){Global.DialogManager.removeLoadingCircle()});var t=Global.GameTypes.getLevelsByKind(e);if(1!==t.length){Global.CCHelper.updateSpriteFrame("Hall/labelImg_game_"+e,this.gameTitleImg),this.roomContent.destroyAllChildren();for(var a=0;a<t.length;a++){var r=cc.instantiate(this.roomItem);r.parent=this.roomContent,r.getComponent("RoomItem").updateUI(t[a])}this.gameGroup.active=!1,this.topGroup.active=!1,this.bottomGroup.active=!1,this.roomGroup.active=!0,this.backGroup.active=!0}else Global.DialogManager.createDialog("Match/MatchGameDialog",{gameTypeID:t[0].gameTypeID})}else Global.DialogManager.addTipDialog("\u656c\u8bf7\u671f\u5f85\uff01")},showGameGroup:function(){this.gameGroup.active=!0,this.topGroup.active=!0,this.bottomGroup.active=!0,this.roomGroup.active=!1,this.backGroup.active=!1},onLoad:function(){Global.MessageCallback.addListener("UpdateUserInfoUI",this),Global.MessageCallback.addListener("ReConnectSuccess",this),this.init(),this.showNotice(),this.createShowView(),this.createGameItem(),this.checkJoinRoom(),Global.AudioManager.startPlayBgMusic("Hall/Sound/hall_bg_music"),this.gameGroup.active=!1,setTimeout(function(){this.gameGroup.active=!0}.bind(this),100)},onDestroy:function(){Global.MessageCallback.removeListener("UpdateUserInfoUI",this),Global.MessageCallback.removeListener("ReConnectSuccess",this)},messageCallbackHandler:function(e,t){switch(e){case"SelfEntryRoomPush":this.enterGame(t);break;case"UpdateUserInfoUI":case"ReConnectSuccess":this.updatePlayerInfo()}},enterGame:function(t){Global.DialogManager.addLoadingCircle();var a=[];switch(t.kindId){case Global.Enum.gameType.ZJH:e("../../Game/ZhaJinHua/ZJHModel").init(t),a=["ZhaJinHua"],Global.CCHelper.loadRes(a,function(){Global.DialogManager.createDialog("ZhaJinHua/UIPrefabs/ZhaJinHuaDialog",null,function(){Global.DialogManager.removeLoadingCircle(),Global.DialogManager.destroyDialog("Hall/HallDialog")})});break;case Global.Enum.gameType.NN:e("../../Game/Niuniu/NNModel").setEntryRoomData(t),a=["Niuniu"],Global.CCHelper.loadRes(a,function(){Global.DialogManager.createDialog("Niuniu/NNMainDialog",null,function(){Global.DialogManager.removeLoadingCircle(),Global.DialogManager.destroyDialog("Hall/HallDialog")})});break;case Global.Enum.gameType.TTZ:e("../../Game/TuiTongZi/TTZModel").setEntryRoomData(t),a=["TuiTongZi"],Global.CCHelper.loadRes(a,function(){Global.DialogManager.createDialog("TuiTongZi/TTZMainDialog",null,function(){Global.DialogManager.removeLoadingCircle(),Global.DialogManager.destroyDialog("Hall/HallDialog")})});break;case Global.Enum.gameType.LHD:e("../../Game/LongHuDou/LHDModel").setEntryRoomData(t),a=["LongHuDou"],Global.CCHelper.loadRes(a,function(){Global.DialogManager.createDialog("LongHuDou/LHDMainDialog",null,function(){Global.DialogManager.removeLoadingCircle(),Global.DialogManager.destroyDialog("Hall/HallDialog")})});break;case Global.Enum.gameType.HHDZ:e("../../Game/HongHeiDaZhan/HHDZModel").init(t),a=["HongHeiDaZhan"],Global.CCHelper.loadRes(a,function(){Global.DialogManager.createDialog("HongHeiDaZhan/HHDZMainDialog",null,function(){Global.DialogManager.removeLoadingCircle(),Global.DialogManager.destroyDialog("Hall/HallDialog")})});break;case Global.Enum.gameType.BJL:e("../../Game/BaiJiaLe/BJLModel").setEntryRoomData(t),a=["BaiJiaLe"],Global.CCHelper.loadRes(a,function(){Global.DialogManager.createDialog("BaiJiaLe/BJLMainDialog",null,function(){Global.DialogManager.removeLoadingCircle(),Global.DialogManager.destroyDialog("Hall/HallDialog")})});break;case Global.Enum.gameType.FISH:a=["Fish"],Global.CCHelper.loadRes(a,function(){Global.DialogManager.createDialog("Fish/FishMainDialog",null,function(){Global.DialogManager.removeLoadingCircle(),Global.DialogManager.destroyDialog("Hall/HallDialog")})});break;case Global.Enum.gameType.SSS:a=["ThirteenWater"],Global.CCHelper.loadRes(a,function(){Global.DialogManager.createDialog("ThirteenWater/TWMainDialog",null,function(){Global.DialogManager.removeLoadingCircle(),Global.DialogManager.destroyDialog("Hall/HallDialog")})});break;case Global.Enum.gameType.DDZ:a=["Game/DDZ"],Global.CCHelper.loadRes(a,function(){Global.DialogManager.createDialog("Game/DDZ/DDZMainDialog",null,function(){Global.DialogManager.removeLoadingCircle(),Global.DialogManager.destroyDialog("Hall/HallDialog")})});break;case Global.Enum.gameType.BJ:a=["Game/BlackJack"],Global.CCHelper.loadRes(a,function(){Global.DialogManager.createDialog("Game/BlackJack/BJMainDialog",null,function(){Global.DialogManager.removeLoadingCircle(),Global.DialogManager.destroyDialog("Hall/HallDialog")})});break;case Global.Enum.gameType.BRNN:a=["Game/BaiRenNiuNiu"],Global.CCHelper.loadRes(a,function(){Global.DialogManager.createDialog("Game/BaiRenNiuNiu/BRNNMainDialog",null,function(){Global.DialogManager.removeLoadingCircle(),Global.DialogManager.destroyDialog("Hall/HallDialog")})});break;case Global.Enum.gameType.DZ:a=["Game/DeZhouPoker"],Global.CCHelper.loadRes(a,function(){Global.DialogManager.createDialog("Game/DeZhouPoker/DZMainDialog",null,function(){Global.DialogManager.removeLoadingCircle(),Global.DialogManager.destroyDialog("Hall/HallDialog"),Global.DialogManager.isDialogExit("Game/DeZhouPoker/RoomLayer/DZRoomLayerDialog")&&Global.DialogManager.destroyDialog("Game/DeZhouPoker/RoomLayer/DZRoomLayerDialog",!0)})});break;case Global.Enum.gameType.PDK:a=["Game/PaoDeKuai"],Global.CCHelper.loadRes(a,function(){Global.DialogManager.createDialog("Game/PaoDeKuai/PDKMainDialog",null,function(){Global.DialogManager.removeLoadingCircle(),Global.DialogManager.destroyDialog("Hall/HallDialog")})})}},onBtnClk:function(e,t){switch(t){case"back":this.showGameGroup();break;case"bank":Global.DialogManager.createDialog("Bank/BankDialog");break;case"exchange":Global.DialogManager.createDialog("Bank/TiXianDialog");break;case"commission":Global.DialogManager.createDialog("Commission/CommissionDialog");break;case"head":Global.DialogManager.createDialog("UserInfo/UserInfoDialog");break;case"rank":Global.DialogManager.createDialog("Rank/RankDialog");break;case"notice":Global.DialogManager.createDialog("Notice/NoticeListDialog");break;case"recharge":case"addGold":Global.DialogManager.createDialog("Recharge/RechargeDialog")}Global.CCHelper.playPreSound()}}),cc._RF.pop()},{"../../Game/BaiJiaLe/BJLModel":"BJLModel","../../Game/HongHeiDaZhan/HHDZModel":"HHDZModel","../../Game/LongHuDou/LHDModel":"LHDModel","../../Game/Niuniu/NNModel":"NNModel","../../Game/TuiTongZi/TTZModel":"TTZModel","../../Game/ZhaJinHua/ZJHModel":"ZJHModel"}],HttpAPI:[function(e,t,a){"use strict";cc._RF.push(t,"c917eHJyG9I17fAmQHJiKs3","HttpAPI"),(t.exports={}).getPhoneCode=function(e,t,a){var r={phoneNumber:e};Global.NetworkLogic.gameServerHttpRequest("/getSMSCode","POST",r,t,a)},cc._RF.pop()},{}],HuiYuanDetailDialog:[function(e,t,a){"use strict";cc._RF.push(t,"68d47nSH6BNWad2FC4o2NrD","HuiYuanDetailDialog"),cc.Class({extends:cc.Component,properties:{thisWeekYeJi:cc.Label,lastLoginTime:cc.Label},start:function(){var e=this.dialogParameters.data;this.thisWeekYeJi.string=e.achievement.toFixed(2),this.lastLoginTime.string=new Date(e.lastLoginTime).format("yyyy-MM-dd hh:mm:ss")},onBtnClk:function(e,t){switch(t){case"close":Global.DialogManager.destroyDialog(this)}}}),cc._RF.pop()},{}],HuiYuanItem:[function(e,t,a){"use strict";cc._RF.push(t,"23b71sVxQ1Hl7I2LPvak7z+","HuiYuanItem"),cc.Class({extends:cc.Component,properties:{nicknameText:cc.Label,headIcon:cc.Sprite,idText:cc.Label},start:function(){},onBtnClk:function(e,t){switch(t){case"detail":this.data.directlyMemberCount?Global.DialogManager.createDialog("Commission/DaiLiDetailDialog",{data:this.data}):Global.DialogManager.createDialog("Commission/HuiYuanDetailDialog",{data:this.data})}},updateUI:function(e){this.data=e,this.idText.string=e.uid,this.nicknameText.string=e.nickname,Global.CCHelper.updateSpriteFrame(e.avatar,this.headIcon)}}),cc._RF.pop()},{}],LHDMainDialog:[function(e,t,a){"use strict";cc._RF.push(t,"a563fvLMwtHgYdKYaBLzG0D","LHDMainDialog");var r=e("../../API/RoomProto"),i=e("./LHDProto"),o=e("../../API/RoomAPI"),n=e("./LHDModel");cc.Class({extends:cc.Component,properties:{gameCommonCtrl:e("GameCommonController"),longCardSprite:cc.Sprite,huCardSprite:cc.Sprite,longBetRectNode:cc.Node,huBetRectNode:cc.Node,heBetRectNode:cc.Node,longBetCountLabel:cc.Label,huBetCountLabel:cc.Label,heBetCountLabel:cc.Label,selfLongBetCountLabel:cc.Label,selfHuBetCountLabel:cc.Label,selfHeBetCountLabel:cc.Label,winTypeShowNode:cc.Node,betRecordItemNode:cc.Node},start:function(){this.enableBet=!1,this.gameResultData=null,this.gameInited=!1,this.dirRecordArr=[],this.dirRecordNodeArr=[],this.betCountList={},this.betCountList[i.LONG]=0,this.betCountList[i.HU]=0,this.betCountList[i.HE]=0,this.selfBetCountList={},this.selfBetCountList[i.LONG]=0,this.selfBetCountList[i.HU]=0,this.selfBetCountList[i.HE]=0,this.longCardPos=this.longCardSprite.node.position,this.huCardPos=this.huCardSprite.node.position,o.roomMessageNotify(r.getRoomSceneInfoNotify()),Global.MessageCallback.addListener("RoomMessagePush",this),Global.MessageCallback.addListener("GameMessagePush",this),Global.MessageCallback.addListener("ReConnectSuccess",this),Global.AudioManager.startPlayBgMusic("LongHuDou/Sound/bg")},onDestroy:function(){Global.MessageCallback.removeListener("RoomMessagePush",this),Global.MessageCallback.removeListener("GameMessagePush",this),Global.MessageCallback.removeListener("ReConnectSuccess",this),n.onDestroy()},messageCallbackHandler:function(e,t){if("RoomMessagePush"===e)t.type===r.USER_LEAVE_ROOM_PUSH?t.data.roomUserInfo.userInfo.uid===n.selfUid&&this.exitGame():t.type===r.GET_ROOM_SCENE_INFO_PUSH&&this.gameInit(t.data.gameData);else if("GameMessagePush"===e){if(!this.gameInited)return;t.type===i.GAME_POURGOLD_PUSH?(this.userBet(t.data,!0),this.updateBetCount(this.betCountList,this.selfBetCountList)):t.type===i.GAME_START_PUSH?this.onGameStart(i.BET_TIME):t.type===i.GAME_RESULT_PUSH&&this.onGameEnd(t.data)}else"ReConnectSuccess"===e&&Global.API.hall.joinRoomRequest(n.roomID,function(){this.onReconnection()}.bind(this))},betEvent:function(e,t){this.enableBet&&("long"===t?o.gameMessageNotify(i.gameUserBetNotify(i.LONG,this.gameCommonCtrl.getCurChipNumber())):"hu"===t?o.gameMessageNotify(i.gameUserBetNotify(i.HU,this.gameCommonCtrl.getCurChipNumber())):"he"===t&&o.gameMessageNotify(i.gameUserBetNotify(i.HE,this.gameCommonCtrl.getCurChipNumber())))},buttonEvent:function(e,t){"recordNode"===t&&Global.DialogManager.createDialog("LongHuDou/Trend/LHDTrendDialog",{dirRecordArr:this.dirRecordArr})},gameInit:function(e){if(this.gameInited=!0,this.gameCommonCtrl.onGameInit(n.profitPercentage,n.kindId),this.dirRecordArr=[],this.dirRecordNodeArr.length>0)for(var t=0;t<this.dirRecordNodeArr.length;++t)this.dirRecordNodeArr[t].destroy();if(this.dirRecordNodeArr=[],this.addDirRecord(e.dirRecord),e.gameStatus!==i.gameStatus.NONE){if(e.betRecordList)for(var a in e.betRecordList)if(e.betRecordList.hasOwnProperty(a)){var r=e.betRecordList[a];i.LONG in r&&this.userBet({uid:a,betType:i.LONG,count:r[i.LONG]},!1),i.HU in r&&this.userBet({uid:a,betType:i.HU,count:r[i.HU]},!1),i.HE in r&&this.userBet({uid:a,betType:i.HE,count:r[i.HE]},!1)}this.updateBetCount(this.betCountList,this.selfBetCountList),e.gameStatus===i.gameStatus.GAME_STARTED?this.onGameStart(e.betLeftTime):e.gameStatus===i.gameStatus.GAME_END&&(e.resultData&&(this.gameResultData=e.resultData,this.onShowCard(!1),this.onShowResult()),this.gameCommonCtrl.showWait(!0))}},onReconnection:function(){this.enableBet=!1,this.gameResultData=null,this.gameInited=!1,this.node.stopAllActions(),this.betCountList={},this.betCountList[i.LONG]=0,this.betCountList[i.HU]=0,this.betCountList[i.HE]=0,this.selfBetCountList={},this.selfBetCountList[i.LONG]=0,this.selfBetCountList[i.HU]=0,this.selfBetCountList[i.HE]=0,this.updateBetCount(this.betCountList,this.selfBetCountList),this.longCardSprite.node.stopAllActions(),this.longCardSprite.node.active=!1,this.huCardSprite.node.stopAllActions(),this.huCardSprite.node.active=!1,this.dirRecordArr=[];for(var e=0;e<this.dirRecordNodeArr.length;++e)this.dirRecordNodeArr[e].destroy();this.dirRecordNodeArr=[],this.gameCommonCtrl.onReconnection(),o.roomMessageNotify(r.getRoomSceneInfoNotify())},onGameStart:function(e){this.betCountList={},this.betCountList[i.LONG]=0,this.betCountList[i.HU]=0,this.betCountList[i.HE]=0,this.selfBetCountList={},this.selfBetCountList[i.LONG]=0,this.selfBetCountList[i.HU]=0,this.selfBetCountList[i.HE]=0,this.updateBetCount(this.betCountList,this.selfBetCountList),this.node.stopAllActions(),this.gameCommonCtrl.onGameStart(),this.node.runAction(cc.sequence([cc.callFunc(this.onBetStart.bind(this)),cc.delayTime(i.BET_TIME),cc.callFunc(this.onBetStop.bind(this))]))},onBetStart:function(){this.enableBet=!0,this.gameCommonCtrl.onGameBetStart(),this.onDispatchCard()},onBetStop:function(){this.enableBet=!1,this.gameCommonCtrl.onGameBetEnd(),this.node.stopAllActions()},onGameEnd:function(e){this.gameResultData=e,this.enableBet&&this.onBetStop(),this.node.stopAllActions();var t=[cc.delayTime(this.enableBet?2:.1),cc.callFunc(this.onShowCard.bind(this)),cc.delayTime(2.5),cc.callFunc(this.onShowWin.bind(this)),cc.delayTime(2),cc.callFunc(this.onShowResult.bind(this))];this.node.runAction(cc.sequence(t))},onShowCard:function(e){this.gameResultData&&(this.longCardSprite.node.active=!0,this.huCardSprite.node.active=!0,this.longCardSprite.node.position=this.longCardPos,this.huCardSprite.node.position=this.huCardPos,e?(this.cardAnimation(this.longCardSprite,this.gameResultData.longCard,.2),this.cardAnimation(this.huCardSprite,this.gameResultData.huCard,1)):(Global.CCHelper.updateSpriteFrame("GameCommon/Card/"+this.gameResultData.longCard,this.longCardSprite),Global.CCHelper.updateSpriteFrame("GameCommon/Card/"+this.gameResultData.huCard,this.huCardSprite)))},cardAnimation:function(e,t,a){var r=[],i={x:e.node.x,y:e.node.y},o={x:e.node.scaleX,y:e.node.scaleY};r.push(cc.delayTime(a)),r.push(cc.callFunc(function(){Global.AudioManager.playSound("GameCommon/Sound/flipcard")})),r.push(cc.moveBy(.2,10,i.y)),r.push(cc.spawn([cc.scaleTo(.1,.1,o.y),cc.moveBy(.1,-10,i.y+10)])),r.push(cc.callFunc(function(){Global.CCHelper.updateSpriteFrame("GameCommon/Card/"+t,e),Global.AudioManager.playSound("LongHuDou/Sound/lhb_p_"+(15&t))})),r.push(cc.spawn([cc.scaleTo(.1,o.x,o.y),cc.moveTo(.1,i.x,i.y)]));var n=cc.moveTo(.3,i.x,i.y);n.easing(cc.easeBackOut()),r.push(n),e.node.runAction(cc.sequence(r))},onDispatchCard:function(){this.longCardSprite.node.active=!0,this.huCardSprite.node.active=!0,this.longCardSprite.node.stopAllActions(),this.huCardSprite.node.stopAllActions(),Global.CCHelper.updateSpriteFrame("GameCommon/Card/card_back",this.longCardSprite),Global.CCHelper.updateSpriteFrame("GameCommon/Card/card_back",this.huCardSprite),this.longCardSprite.node.position=cc.p(0,25);var e=cc.moveTo(.2,this.longCardPos);e.easing(cc.easeIn(3)),this.longCardSprite.node.runAction(e),this.huCardSprite.node.position=cc.p(0,25);var t=cc.moveTo(.2,this.huCardPos);t.easing(cc.easeIn(3)),this.huCardSprite.node.runAction(t),Global.AudioManager.playSound("GameCommon/Sound/sendcard")},onShowWin:function(){if(this.gameResultData){var e=this.gameResultData.winType,t="",a="LongHuDou/Sound/";e===i.LONG?(t="Long",a+="long_win"):e===i.HU?(t="Hu",a+="hu_win"):e===i.HE&&(t="He",a+="he"),Global.AudioManager.playSound(a);var r=this.winTypeShowNode.getChildByName(t);if(r){r.active=!0;var o=cc.sequence([cc.show(),cc.fadeTo(.3,255),cc.fadeTo(.3,0)]);r.opacity=0,r.runAction(cc.repeat(o,3))}}},onShowResult:function(){this.gameCommonCtrl.onGameResult(this.gameResultData.scoreChangeArr),this.addDirRecord([this.gameResultData.winType]),Global.MessageCallback.emitMessage("UpdateTrendDataNotify",{dirRecordArr:this.dirRecordArr})},userBet:function(e,t){this.betCountList[e.betType]+=e.count,e.uid===n.selfUid&&(this.selfBetCountList[e.betType]+=e.count);var a=cc.rect(0,0,0,0);e.betType===i.LONG?a=this.longBetRectNode.getBoundingBox():e.betType===i.HU?a=this.huBetRectNode.getBoundingBox():e.betType===i.HE&&(a=this.heBetRectNode.getBoundingBox()),this.gameCommonCtrl.userBet(e.uid,e.count,a,t)},updateBetCount:function(e,t){this.longBetCountLabel.string=e[i.LONG].toString(),this.huBetCountLabel.string=e[i.HU].toString(),this.heBetCountLabel.string=e[i.HE].toString(),this.selfLongBetCountLabel.string="\u4e0b\u6ce8:"+t[i.LONG].toString(),this.selfHuBetCountLabel.string="\u4e0b\u6ce8:"+t[i.HU].toString(),this.selfHeBetCountLabel.string="\u4e0b\u6ce8:"+t[i.HE].toString()},addDirRecord:function(e){this.dirRecordArr=this.dirRecordArr.concat(e);for(var t=0;t<e.length;++t){var a=this.createBetRecordItem(e[t]);if(a.parent=this.betRecordItemNode.parent,a.x=this.betRecordItemNode.x+this.dirRecordNodeArr.length*this.betRecordItemNode.width,a.y=0,a.setScale(.1),a.runAction(cc.scaleTo(.1,1)),this.dirRecordNodeArr.push(a),this.dirRecordNodeArr.length>20){a.x-=this.betRecordItemNode.width,this.dirRecordNodeArr.shift().destroy(),this.dirRecordArr.shift();for(var r=0;r<this.dirRecordNodeArr.length-1;++r)this.dirRecordNodeArr[r].runAction(cc.moveBy(.1,cc.p(-this.betRecordItemNode.width,0)))}}},createBetRecordItem:function(e){var t="";return e===i.LONG?t="LongHuDou/sprite_long":e===i.HU?t="LongHuDou/sprite_hu":e===i.HE&&(t="LongHuDou/sprite_he"),Global.CCHelper.createSpriteNode(t)},exitGame:function(){Global.DialogManager.createDialog("Hall/HallDialog",null,function(){Global.DialogManager.destroyDialog(this,!0),Global.CCHelper.releaseRes(["LongHuDou"])}.bind(this))}}),cc._RF.pop()},{"../../API/RoomAPI":"RoomAPI","../../API/RoomProto":"RoomProto","./LHDModel":"LHDModel","./LHDProto":"LHDProto",GameCommonController:"GameCommonController"}],LHDModel:[function(e,t,a){"use strict";cc._RF.push(t,"a6ef7k1SvNI/6X+typYjWy2","LHDModel");var r=t.exports,i=e("./LHDProto");e("../../API/RoomProto");r.setEntryRoomData=function(e){this.onLoad(e)},r.onLoad=function(e){var t=e.gameData;this.profitPercentage=t.profitPercentage,this.roomID=e.roomID,this.selfUid=Global.Player.getPy("uid"),this.kindId=e.kindId,this.betCountList={},this.betCountList[i.LONG]=0,this.betCountList[i.HU]=0,this.betCountList[i.HE]=0},r.onDestroy=function(){},cc._RF.pop()},{"../../API/RoomProto":"RoomProto","./LHDProto":"LHDProto"}],LHDProto:[function(e,t,a){"use strict";cc._RF.push(t,"89071QcdlNEF5Ob9gUBqMLx","LHDProto");var r=t.exports;r.GAME_POURGOLD_NOTIFY=301,r.GAME_POURGOLD_PUSH=401,r.GAME_START_PUSH=402,r.GAME_RESULT_PUSH=403,r.gameStatus={NONE:0,GAME_STARTED:1,GAME_END:2},r.BET_TIME=10,r.SHOW_RESULT_TIME=8,r.LONG=0,r.HU=1,r.HE=2,r.gameStartPush=function(){return{type:this.GAME_START_PUSH,data:{}}},r.gameResultPush=function(e,t,a,r){return{type:this.GAME_RESULT_PUSH,data:{longCard:t,huCard:a,winType:r,scoreChangeArr:e}}},r.gameUserBetNotify=function(e,t){return{type:this.GAME_POURGOLD_NOTIFY,data:{betType:e,count:t}}},r.gameUserBetPush=function(e,t,a){return{type:this.GAME_POURGOLD_PUSH,data:{uid:e,betType:t,count:a}}},cc._RF.pop()},{}],LHDTrendDialog:[function(e,t,a){"use strict";cc._RF.push(t,"7df8fdcrIBAdbKOiUVNQTh7","LHDTrendDialog");var r=e("./LHDProto");cc.Class({extends:cc.Component,properties:{trendItemController:e("LHDTrendItem"),betRecordItemNode:cc.Node,longWinPercentLabel:cc.Label,huWinPercentLabel:cc.Label},start:function(){this.recordTypeNode=[],this.initDialog(this.dialogParameters.dirRecordArr),Global.MessageCallback.addListener("UpdateTrendDataNotify",this)},onDestroy:function(){Global.MessageCallback.removeListener("UpdateTrendDataNotify",this)},messageCallbackHandler:function(e,t){"UpdateTrendDataNotify"===e&&this.initDialog(t.dirRecordArr)},buttonEvent:function(e,t){"close"===t&&Global.DialogManager.destroyDialog(this,!0)},initDialog:function(e){this.trendItemController.init(e),this.addDirRecord(e);for(var t=0,a=0,i=0;i<e.length;++i)e[i]===r.LONG?t++:e[i]===r.HU&&a++;this.updateWinPercent(t,a)},addDirRecord:function(e){for(var t=0;t<this.recordTypeNode.length;++t)this.recordTypeNode[t].destroy();this.recordTypeNode=[];for(var a=0;a<e.length;++a){var r=this.createBetRecordItem(e[a]);r.parent=this.betRecordItemNode.parent,r.x=this.betRecordItemNode.x+a*this.betRecordItemNode.width,r.y=0,this.recordTypeNode.push(r)}},createBetRecordItem:function(e){var t="";return e===r.LONG?t="LongHuDou/sprite_long":e===r.HU?t="LongHuDou/sprite_hu":e===r.HE&&(t="LongHuDou/sprite_he"),Global.CCHelper.createSpriteNode(t)},updateWinPercent:function(e,t){if(e===t)this.longWinPercentLabel.string="50%",this.huWinPercentLabel.string="50%",this.longWinPercentLabel.node.parent.width=(this.longWinPercentLabel.node.parent.width+this.huWinPercentLabel.node.parent.width)/2,this.huWinPercentLabel.node.parent.width=this.longWinPercentLabel.node.parent.width;else{var a=Math.floor(e/(e+t)*100);this.longWinPercentLabel.string=a+"%",this.huWinPercentLabel.string=100-a+"%",this.longWinPercentLabel.node.parent.width=(this.longWinPercentLabel.node.parent.width+this.huWinPercentLabel.node.parent.width)*(a/100),this.longWinPercentLabel.node.parent.width<60&&(this.longWinPercentLabel.node.parent.width=60),this.longWinPercentLabel.node.parent.width>780&&(this.longWinPercentLabel.node.parent.width=720),this.huWinPercentLabel.node.parent.width=780-this.longWinPercentLabel.node.parent.width}}}),cc._RF.pop()},{"./LHDProto":"LHDProto",LHDTrendItem:"LHDTrendItem"}],LHDTrendItem:[function(e,t,a){"use strict";cc._RF.push(t,"93085vCSAREq4QErS0sTbcx","LHDTrendItem");var r=null,i=e("../GameCommon/TrendHelper");cc.Class({extends:cc.Component,properties:{zhupanContent:cc.Node,daluContent:cc.Node,dayanContent:cc.Node,tanglangContent:cc.Node,xiaoluContent:cc.Node},onLoad:function(){this.createdNodeArr=[]},init:function(e,t){this.clearOldData();var a=null;a=t&&t===Global.Enum.gameType.HHDZ?this.convertToHHDZZhupanArr(e):this.convertToZhupanArr(e),this.writeAllRoad(a)},clearOldData:function(){for(var e=0;e<this.createdNodeArr.length;++e)this.createdNodeArr[e].destroy();this.createdNodeArr=[]},convertToHHDZZhupanArr:function(t){r=e("../HongHeiDaZhan/API/HHDZGameProto");for(var a=[],o=[],n=0;n<t.length;++n){var s=t[n];s===r.BLACK?o.push(i.TYPE_ZHUANG):s===r.RED&&o.push(i.TYPE_XIAN),6===o.length&&(a.push(o),o=[])}return 0!==o.length&&a.push(o),a},convertToZhupanArr:function(t){r=e("./LHDProto");for(var a=[],o=[],n=0;n<t.length;++n){var s=t[n];s===r.LONG?o.push(i.TYPE_ZHUANG):s===r.HU?o.push(i.TYPE_XIAN):s===r.HE&&o.push(i.TYPE_HU),6===o.length&&(a.push(o),o=[])}return 0!==o.length&&a.push(o),a},writeAllRoad:function(e){var t=i.getDaluArr(e),a=i.getDayanArr(t),r=i.getXiaoluArr(t),o=i.getTanglangArr(t);this.writeZhuPan(e),this.writeDalu(i.getFormatArr(t)),this.writeDayan(i.getFormatArr(a)),this.writeTanglang(i.getFormatArr(o)),this.writeXiaolu(i.getFormatArr(r))},writeZhuPan:function(e){var t=this.zhupanContent.getChildByName("item"),a=t.width,r=t.height,i=t.x,o=t.y,n=void 0,s=void 0,c=void 0;for(n=0;n<e.length;++n)for(s=0;s<e[n].length;++s)(c=this.getZhupanNodeByType(e[n][s])).active=!0,c.parent=this.zhupanContent,c.x=i+a*n,c.y=o-r*s,this.createdNodeArr.push(c)},getZhupanNodeByType:function(e){var t=null;return t=(e&i.TYPE_ZHUANG)>0?this.zhupanContent.getChildByName("zhuang"):(e&i.TYPE_XIAN)>0?this.zhupanContent.getChildByName("xian"):this.zhupanContent.getChildByName("he"),cc.instantiate(t)},writeDalu:function(e){var t,a,r,i=this.daluContent.getChildByName("item"),o=i.width,n=i.height,s=i.x,c=i.y;for(t=0;t<e.length;++t)for(a=0;a<e[t].length;++a)e[t][a]&&((r=this.getDaluNodeByType(e[t][a])).active=!0,r.parent=this.daluContent,r.x=s+o*t,r.y=c-n*a,this.createdNodeArr.push(r))},getDaluNodeByType:function(e){var t=null;t=(e&i.TYPE_ZHUANG)>0?this.daluContent.getChildByName("hong"):this.daluContent.getChildByName("lan"),t=cc.instantiate(t);var a=Math.floor(e/i.TYPE_HU);if(a>0){var r=new cc.Node;r.parent=t;var o=r.addComponent(cc.Label);o.node.color=cc.Color.GREEN,o.fontSize=t.height-2,o.lineHeight=t.height-2,o.string=a}return t},writeDayan:function(e){var t=this.dayanContent.getChildByName("item"),a=t.width,r=t.height,i=t.x,o=t.y,n=void 0,s=void 0,c=void 0;for(n=0;n<e.length;++n)for(s=0;s<e[n].length;++s)e[n][s]&&((c=this.getDayanNodeType(e[n][s])).active=!0,c.parent=this.dayanContent,c.x=i+a*n,c.y=o-r*s,this.createdNodeArr.push(c))},getDayanNodeType:function(e){var t=null;return t=e===i.HONG?this.dayanContent.getChildByName("hong"):this.dayanContent.getChildByName("lan"),cc.instantiate(t)},writeXiaolu:function(e){var t,a,r,i=this.xiaoluContent.getChildByName("item"),o=i.width,n=i.height,s=i.x,c=i.y;for(t=0;t<e.length;++t)for(a=0;a<e[t].length;++a)e[t][a]&&((r=this.getXiaoluNodeByType(e[t][a])).active=!0,r.parent=this.xiaoluContent,r.x=s+o*t,r.y=c-n*a,this.createdNodeArr.push(r))},getXiaoluNodeByType:function(e){var t=null;return t=e===i.HONG?this.xiaoluContent.getChildByName("hong"):this.xiaoluContent.getChildByName("lan"),cc.instantiate(t)},writeTanglang:function(e){var t,a,r,i=this.tanglangContent.getChildByName("item"),o=i.width,n=i.height,s=i.x,c=i.y;for(t=0;t<e.length;++t)for(a=0;a<e[t].length;++a)e[t][a]&&((r=this.getTanglangNodeByType(e[t][a])).parent=this.tanglangContent,r.active=!0,r.x=s+o*t,r.y=c-n*a,this.createdNodeArr.push(r))},getTanglangNodeByType:function(e){var t=null;return t=e===i.HONG?this.tanglangContent.getChildByName("hong"):this.tanglangContent.getChildByName("lan"),cc.instantiate(t)},getNodeByType:function(e){var t,a=new cc.Node;e===i.HONG?t="Common/btn_check_select":e===i.LAN&&(t="Common/btn_check");var r=a.addComponent(cc.Sprite);return cc.loader.loadRes(t,cc.SpriteFrame,function(e,t){e?console.log(e):r.spriteFrame=t}),a}}),cc._RF.pop()},{"../GameCommon/TrendHelper":"TrendHelper","../HongHeiDaZhan/API/HHDZGameProto":"HHDZGameProto","./LHDProto":"LHDProto"}],LoadingCircleDialog:[function(e,t,a){"use strict";cc._RF.push(t,"7517bh7y5RJFIxfi7/ZgDS/","LoadingCircleDialog"),cc.Class({extends:cc.Component,properties:{circle:cc.Node},onLoad:function(){this.loadingCoinAnimationNode=null},addLoadingCircle:function(e){cc.log("\u663e\u793aloading"),this.node.active=!0,this.loadingCoinAnimationNode?this.loadingCoinAnimationNode.startAnimation(!0):Global.Animation.createFrameAnimationNode("Loading/loading_coin",function(e,t){e||(this.loadingCoinAnimationNode=t,this.loadingCoinAnimationNode.parent=this.node,this.node.active&&this.loadingCoinAnimationNode.startAnimation(!0))}.bind(this))},removeLoadingCircle:function(){cc.log("\u79fb\u9664loading"),this.loadingCoinAnimationNode&&this.loadingCoinAnimationNode.stopAnimation(),this.node.active=!1}}),cc._RF.pop()},{}],LockLineWidgetCtrl:[function(e,t,a){"use strict";cc._RF.push(t,"dbf31O1jXZB6rVL1ooegnBS","LockLineWidgetCtrl");var r=e("../../Shared/utils");cc.Class({extends:cc.Component,properties:{pointsNode:cc.Node,armNode:cc.Node},start:function(){},updateLine:function(e){var t=this.node.parent.convertToNodeSpaceAR(e),a=r.getDist(this.node.position,t),i=r.getUnitVector(this.node.position,t),o=Math.acos(i.x)/Math.PI*180;i.y<0&&(o*=-1),this.node.rotation=-1*o+90,this.armNode.position=this.node.convertToNodeSpaceAR(e),this.pointsNode.height=a-this.armNode.height/2}}),cc._RF.pop()},{"../../Shared/utils":"utils"}],LoginDialog:[function(e,t,a){"use strict";cc._RF.push(t,"cdbce4eCVBLOJUG4bnCsrRh","LoginDialog"),cc.Class({extends:cc.Component,properties:{loadingGroup:cc.ProgressBar,progressText:cc.Label,accountEdit:cc.EditBox,passwordEdit:cc.EditBox,loginGroup:cc.Node,btnGroup:cc.Node,logo:cc.Node},onLoad:function(){this.logo.active=!1,this.btnGroup.active=!1,this.loginGroup.active=!1,this.isLoadingFinished=!1,this.loading()},onDestroy:function(){},loading:function(){var e=["Bank","Commission","Common","CommonJPG","Font","GameCommon","Hall","Loading","Login","Notice","Pop","Rank","Recharge","Setting","Sound","Update","UserInfo"],t=0,a=0,r=0;this.loadingGroup.progress=0;var i=this;function o(o){var n=0,s=0;cc.loader.loadResDir(o,cc.Prefab,function(o,c){if((r!==e.length||1!==i.loadingGroup.progress)&&!i.isLoadingFinished){0===n?(t+=c,a+=o):(t+=c-n,a+=o-s),n=c,s=o,c===o&&r++;var l=0;(l=0===t?r/e.length:a/t)>i.loadingGroup.progress&&(i.progressText.string=(100*l).toFixed(0)+"%",i.loadingGroup.progress=l),l>=1&&i.loadingFinished()}},function(e){e&&cc.log(e)})}for(var n=0;n<e.length;++n)o(e[n])},loadingFinished:function(){if(!this.isLoadingFinished){this.isLoadingFinished=!0,this.loadingGroup.progress=1,this.progressText.string=Math.floor(100*this.loadingGroup.progress.toFixed(2))+"%",this.loadingGroup.node.active=!1,this.logo.active=!0,this.logo.scale=.1,this.logo.runAction(cc.scaleTo(.5,1).easing(cc.easeBackOut()));var e=cc.sys.isMobile;this.dialogParameters&&this.dialogParameters.logoutEvent&&(e=!1);var t=cc.sys.localStorage.getItem("account");if(e&&t&&t.length>0){var a={account:t,password:cc.sys.localStorage.getItem("password"),loginPlatform:parseInt(cc.sys.localStorage.getItem("platform"))};this.login(a)}else this.btnGroup.active=!0,this.loginGroup.active=Global.Constant.test}},onBtnClk:function(e,t){switch(Global.CCHelper.playPreSound(),t){case"register":var a={account:this.accountEdit.string,password:this.passwordEdit.string,loginPlatform:Global.Enum.loginPlatform.ACCOUNT};this.registerAP(a);break;case"login":var r={account:this.accountEdit.string,password:this.passwordEdit.string,loginPlatform:Global.Enum.loginPlatform.ACCOUNT};this.login(r);break;case"wechatLogin":break;case"phoneLogin":Global.DialogManager.createDialog("Login/LoginPhoneDialog",{loginCb:function(e){this.login(e)}.bind(this)});break;case"visitorLogin":this.visitorLogin()}},enterGame:function(){Global.DialogManager.createDialog("Hall/HallDialog",null,function(){Global.DialogManager.removeLoadingCircle(),Global.DialogManager.destroyDialog(this),Global.DialogManager.isDialogExit("Login/RegisterDialog")&&Global.DialogManager.destroyDialog("Login/RegisterDialog"),Global.DialogManager.isDialogExit("Login/LoginPhoneDialog")&&Global.DialogManager.destroyDialog("Login/LoginPhoneDialog")}.bind(this))},visitorLogin:function(){var e=cc.sys.localStorage.getItem("account"),t=cc.sys.localStorage.getItem("password"),a=parseInt(cc.sys.localStorage.getItem("platform")||"");e&&t&&a?this.login({account:e,password:t,loginPlatform:a}):(e=Date.now().toString(),t=Date.now().toString(),a=Global.Enum.loginPlatform.ACCOUNT,this.registerAP({account:e,password:t,loginPlatform:a,smsCode:""}))},registerAP:function(e){e.account&&e.password&&e.loginPlatform?(Global.DialogManager.addLoadingCircle(),Global.NetworkLogic.register(e,{avatar:"Common/head_icon_default"},function(){Global.DialogManager.removeLoadingCircle(),this.saveAccount(e.account,e.password,e.loginPlatform),this.enterGame()}.bind(this))):Global.DialogManager.addTipDialog("\u8bf7\u8f93\u5165\u6709\u6548\u5e10\u53f7\u5bc6\u7801")},login:function(e){e.account&&e.password&&e.loginPlatform?(Global.DialogManager.addLoadingCircle(),Global.NetworkLogic.login(e,function(){Global.DialogManager.removeLoadingCircle(),this.saveAccount(e.account,e.password,e.loginPlatform),this.enterGame()}.bind(this),function(){Global.DialogManager.removeLoadingCircle(),Global.DialogManager.addPopDialog("\u767b\u5f55\u5931\u8d25\uff0c\u8bf7\u91cd\u8bd5"),this.saveAccount("","","")}.bind(this))):Global.DialogManager.addTipDialog("\u8bf7\u8f93\u5165\u6709\u6548\u5e10\u53f7\u5bc6\u7801")},saveAccount:function(e,t,a){cc.sys.localStorage.setItem("account",e),cc.sys.localStorage.setItem("password",t),cc.sys.localStorage.setItem("platform",a.toString())}}),cc._RF.pop()},{}],LoginPhoneDialog:[function(e,t,a){"use strict";cc._RF.push(t,"540ebfNgBhDuJWBzomCfgDZ","LoginPhoneDialog"),cc.Class({extends:cc.Component,properties:{phoneEdit:cc.EditBox,pwdEdit:cc.EditBox},start:function(){},onBtnClk:function(e,t){switch(t){case"register":Global.DialogManager.createDialog("Login/RegisterDialog");break;case"login":var a=this.phoneEdit.string,r=this.pwdEdit.string;if(""===a)return void Global.DialogManager.addTipDialog("\u8bf7\u8f93\u5165\u624b\u673a\u53f7\uff01");if(a.length<11)return void Global.DialogManager.addTipDialog("\u8bf7\u8f93\u5165\u6b63\u786e\u7684\u624b\u673a\u53f7\uff01");if(""===r)return void Global.DialogManager.addTipDialog("\u8bf7\u8f93\u5165\u5bc6\u7801\uff01");var i={account:a,password:r,loginPlatform:Global.Enum.loginPlatform.ACCOUNT};this.dialogParameters&&this.dialogParameters.loginCb&&this.dialogParameters.loginCb(i);break;case"reset":Global.DialogManager.createDialog("Login/ResetPwdDialog");break;case"close":Global.DialogManager.destroyDialog(this)}}}),cc._RF.pop()},{}],Lu:[function(e,t,a){"use strict";cc._RF.push(t,"d1ab2gUJO9K35jxoR1m97re","Lu");var r=t.exports;r.TYPE_DUI=1,r.TYPE_XIAN=2,r.TYPE_ZHUANG=4,r.TYPE_HU=8,r.HONG=1,r.LAN=2,r.getZhupanArr=function(e){var t,a=[];for(t=0;t<e.length;++t)t%6==0&&a.push([]),a[a.length-1].push(e[t]);return a},r.getDaluArr=function(e){var t,a,r=[],i=0,o=0;for(t=0;t<e.length;++t)for(a=0;a<e[t].length;++a)(e[t][a]&this.TYPE_HU)>0?r[i]&&r[i][o]&&(r[i][o]+=this.TYPE_HU):r[i]&&r[i][o]?((e[t][a]&this.TYPE_ZHUANG)>0&&(r[i][o]&this.TYPE_ZHUANG)>0?++o:(e[t][a]&this.TYPE_XIAN)>0&&(r[i][o]&this.TYPE_XIAN)>0?++o:(r[++i]=[],o=0),r[i][o]=e[t][a]):(r[i]=[],r[i][o]=e[t][a]);return r},r.getDayanArr=function(e){var t,a,r=[];for(t=1;t<e.length;++t)for(a=1===t?1:0;a<e[t].length;){var i;if(i=0===a?e[t-1].length===e[t-2].length?this.HONG:this.LAN:e[t-1][a]?this.HONG:e[t-1][a-1]?this.LAN:this.HONG,0===r.length)r.push([i]);else{var o=r[r.length-1];0===o.length?o.push(i):o[o.length-1]!==i?r.push([i]):o.push(i)}++a}return r},r.getXiaoluArr=function(e){var t,a,r=[];for(t=2;t<e.length;++t)for(a=2===t?1:0;a<e[t].length;){var i;if(i=0===a?e[t-1].length===e[t-3].length?this.HONG:this.LAN:e[t-2][a]?this.HONG:e[t-2][a-1]?this.LAN:this.HONG,0===r.length)r.push([i]);else{var o=r[r.length-1];0===o.length?o.push(i):o[o.length-1]!==i?r.push([i]):o.push(i)}++a}return r},r.getTanglangArr=function(e){var t,a,r=[];for(t=3;t<e.length;++t)for(a=3===t?1:0;a<e[t].length;){var i;if(i=0===a?e[t-1].length===e[t-4].length?this.HONG:this.LAN:e[t-3][a]?this.HONG:e[t-3][a-1]?this.LAN:this.HONG,0===r.length)r.push([i]);else{var o=r[r.length-1];0===o.length?o.push(i):o[o.length-1]!==i?r.push([i]):o.push(i)}++a}return r},r.getFormatArr=function(e){var t,a,r=0,i=0,o=[];for(t=0;t<e.length;++t)for(o[r=t]||(o[r]=[null,null,null,null,null,null]),a=0;a<e[t].length;++a)0===a?(i=0,o[r][i]=e[t][a]):null!==o[r][i+1]||5===i||null===o[r][i-1]?(o[++r]||(o[r]=[null,null,null,null,null,null]),o[r][i]=e[t][a]):(++i,o[r][i]=e[t][a]);return o},cc._RF.pop()},{}],MatchGameDialog:[function(e,t,a){"use strict";cc._RF.push(t,"218b0TV/51INaKE9Pn5+djo","MatchGameDialog"),cc.Class({extends:cc.Component,properties:{tipLabel:cc.Label},onLoad:function(){if(Global.MessageCallback.addListener("SelfEntryRoomPush",this),this.dialogParameters.roomID)this.node.active=!1,Global.Player.setPy("roomID",0),Global.DialogManager.addLoadingCircle(),Global.API.hall.joinRoomRequest(this.dialogParameters.roomID,function(){},function(){Global.DialogManager.removeLoadingCircle()});else{this.gameTypeID=this.dialogParameters.gameTypeID;var e=Global.GameTypes.getGameInfoByGameTypeID(this.gameTypeID);if(Global.Player.gold<e.goldLowerLimit)return Global.DialogManager.destroyDialog(this),void Global.DialogManager.addPopDialog("\u91d1\u5e01\u4e0d\u8db3\uff0c\u65e0\u6cd5\u5339\u914d");if(e.goldUpper>0&&Global.Player.gold>e.goldUpper)return Global.DialogManager.destroyDialog(this),void Global.DialogManager.addPopDialog("\u91d1\u5e01\u8d85\u8fc7\u623f\u95f4\u4e0a\u9650\uff0c\u65e0\u6cd5\u5339\u914d");if(!e.matchRoom)return this.node.active=!1,Global.DialogManager.addLoadingCircle(),void Global.API.hall.matchRoomRequest(this.gameTypeID);this.node.active=!0;var t=2;this.schedule(function(){t=++t%3,this.tipLabel.string=2===t?"\u6e38\u620f\u5373\u5c06\u5f00\u59cb\uff0c\u8bf7\u8010\u5fc3\u7b49\u5f85...":1===t?"\u6e38\u620f\u5373\u5c06\u5f00\u59cb\uff0c\u8bf7\u8010\u5fc3\u7b49\u5f85..":"\u6e38\u620f\u5373\u5c06\u5f00\u59cb\uff0c\u8bf7\u8010\u5fc3\u7b49\u5f85."}.bind(this),1),Global.API.hall.matchRoomRequest(this.gameTypeID)}},onDestroy:function(){Global.MessageCallback.removeListener("SelfEntryRoomPush",this)},onBtnEvent:function(){Global.DialogManager.addLoadingCircle(1),Global.API.hall.stopMatchRoomRequest(function(){Global.DialogManager.removeLoadingCircle(),Global.DialogManager.destroyDialog(this)}.bind(this))},messageCallbackHandler:function(e,t){switch(e){case"SelfEntryRoomPush":this.enterGame(t)}},enterGame:function(t){Global.DialogManager.addLoadingCircle();var a=[];switch(t.kindId){case Global.Enum.gameType.ZJH:Global.DialogManager.destroyAllDialog(["Hall/HallDialog"]),a=["ZhaJinHua"],Global.CCHelper.loadRes(a,function(){Global.DialogManager.createDialog("Game/ZhaJinHua/UIPrefabs/ZhaJinHuaDialog",null,function(){Global.DialogManager.removeLoadingCircle(),Global.DialogManager.destroyDialog("Hall/HallDialog")})});break;case Global.Enum.gameType.NN:Global.DialogManager.destroyAllDialog(["Hall/HallDialog"]),e("../../Game/Niuniu/NNModel").setEntryRoomData(t),a=["Niuniu"],Global.CCHelper.loadRes(a,function(){Global.DialogManager.createDialog("Niuniu/NNMainDialog",null,function(){Global.DialogManager.removeLoadingCircle(),Global.DialogManager.destroyDialog("Hall/HallDialog")})});break;case Global.Enum.gameType.TTZ:Global.DialogManager.destroyAllDialog(["Hall/HallDialog"]),e("../../Game/TuiTongZi/TTZModel").setEntryRoomData(t),a=["TuiTongZi"],Global.CCHelper.loadRes(a,function(){Global.DialogManager.createDialog("TuiTongZi/TTZMainDialog",null,function(){Global.DialogManager.removeLoadingCircle(),Global.DialogManager.destroyDialog("Hall/HallDialog")})});break;case Global.Enum.gameType.LHD:Global.DialogManager.destroyAllDialog(["Hall/HallDialog"]),e("../../Game/LongHuDou/LHDModel").setEntryRoomData(t),a=["LongHuDou"],Global.CCHelper.loadRes(a,function(){Global.DialogManager.createDialog("LongHuDou/LHDMainDialog",null,function(){Global.DialogManager.removeLoadingCircle(),Global.DialogManager.destroyDialog("Hall/HallDialog")})});break;case Global.Enum.gameType.HHDZ:Global.DialogManager.destroyAllDialog(["Hall/HallDialog"]),e("../../Game/HongHeiDaZhan/HHDZModel").init(t),a=["HongHeiDaZhan"],Global.CCHelper.loadRes(a,function(){Global.DialogManager.createDialog("HongHeiDaZhan/HHDZMainDialog",null,function(){Global.DialogManager.removeLoadingCircle(),Global.DialogManager.destroyDialog("Hall/HallDialog")})});break;case Global.Enum.gameType.BJL:Global.DialogManager.destroyAllDialog(["Hall/HallDialog"]),e("../../Game/BaiJiaLe/BJLModel").setEntryRoomData(t),a=["BaiJiaLe"],Global.CCHelper.loadRes(a,function(){Global.DialogManager.createDialog("BaiJiaLe/BJLMainDialog",null,function(){Global.DialogManager.removeLoadingCircle(),Global.DialogManager.destroyDialog("Hall/HallDialog")})});break;case Global.Enum.gameType.FISH:Global.DialogManager.destroyAllDialog(["Hall/HallDialog"]),a=["Fish"],Global.CCHelper.loadRes(a,function(){Global.DialogManager.createDialog("Fish/FishMainDialog",null,function(){Global.DialogManager.removeLoadingCircle(),Global.DialogManager.destroyDialog("Hall/HallDialog")})});break;case Global.Enum.gameType.SSS:Global.DialogManager.destroyAllDialog(["Hall/HallDialog"]),a=["ThirteenWater"],Global.CCHelper.loadRes(a,function(){Global.DialogManager.createDialog("ThirteenWater/TWMainDialog",null,function(){Global.DialogManager.removeLoadingCircle(),Global.DialogManager.destroyDialog("Hall/HallDialog")})});break;case Global.Enum.gameType.DDZ:Global.DialogManager.destroyAllDialog(["Hall/HallDialog"]),a=["Game/DDZ"],Global.CCHelper.loadRes(a,function(){Global.DialogManager.createDialog("Game/DDZ/DDZMainDialog",null,function(){Global.DialogManager.removeLoadingCircle(),Global.DialogManager.destroyDialog("Hall/HallDialog")})});break;case Global.Enum.gameType.BJ:Global.DialogManager.destroyAllDialog(["Hall/HallDialog"]),a=["Game/BlackJack"],Global.CCHelper.loadRes(a,function(){Global.DialogManager.createDialog("Game/BlackJack/BJMainDialog",null,function(){Global.DialogManager.removeLoadingCircle(),Global.DialogManager.destroyDialog("Hall/HallDialog")})});break;case Global.Enum.gameType.BRNN:Global.DialogManager.destroyAllDialog(["Hall/HallDialog"]),a=["Game/BaiRenNiuNiu"],Global.CCHelper.loadRes(a,function(){Global.DialogManager.createDialog("Game/BaiRenNiuNiu/BRNNMainDialog",null,function(){Global.DialogManager.removeLoadingCircle(),Global.DialogManager.destroyDialog("Hall/HallDialog")})});break;case Global.Enum.gameType.DZ:Global.DialogManager.destroyAllDialog(["Hall/HallDialog","Game/DeZhouPoker/RoomLayer/DZRoomLayerDialog"]),a=["Game/DeZhouPoker"],Global.CCHelper.loadRes(a,function(){Global.DialogManager.createDialog("Game/DeZhouPoker/DZMainDialog",null,function(){Global.DialogManager.removeLoadingCircle(),Global.DialogManager.destroyDialog("Hall/HallDialog"),Global.DialogManager.isDialogExit("Game/DeZhouPoker/RoomLayer/DZRoomLayerDialog")&&Global.DialogManager.destroyDialog("Game/DeZhouPoker/RoomLayer/DZRoomLayerDialog",!0)})});break;case Global.Enum.gameType.PDK:Global.DialogManager.destroyAllDialog(["Hall/HallDialog"]),a=["Game/PaoDeKuai"],Global.CCHelper.loadRes(a,function(){Global.DialogManager.createDialog("Game/PaoDeKuai/PDKMainDialog",null,function(){Global.DialogManager.removeLoadingCircle(),Global.DialogManager.destroyDialog("Hall/HallDialog")})})}}}),cc._RF.pop()},{"../../Game/BaiJiaLe/BJLModel":"BJLModel","../../Game/HongHeiDaZhan/HHDZModel":"HHDZModel","../../Game/LongHuDou/LHDModel":"LHDModel","../../Game/Niuniu/NNModel":"NNModel","../../Game/TuiTongZi/TTZModel":"TTZModel"}],MessageCallback:[function(e,t,a){"use strict";cc._RF.push(t,"7bcbcAYE0xAe6wx5z28vWMS","MessageCallback");var r=t.exports={};r.addListener=function(e,t){this.handlers=this.handlers||[];var a=this.handlers[e]||null;if(a){var r=!1;for(var i in a)if(a.hasOwnProperty(i)&&a[i]===t){r=!0;break}r||a.push(t)}else(a=[]).push(t),this.handlers[e]=a},r.removeListener=function(e,t){this.handlers=this.handlers||[];var a=this.handlers[e]||null;if(a)for(var r=0;r<a.length;++r)if(a[r]===t){a.splice(r,1);break}},r.emitMessage=function(e,t){this.handlers=this.handlers||[];var a=this.handlers[e]||[];if(a){var r=a.slice();for(var i in r)r.hasOwnProperty(i)&&r[i].messageCallbackHandler&&!r[i].isDestroy&&r[i].messageCallbackHandler(e,t)}},cc._RF.pop()},{}],NNAudioNode:[function(e,t,a){"use strict";cc._RF.push(t,"96cbaZuWSVOG45lZ9eafDOv","NNAudioNode"),cc.Class({extends:cc.Component,properties:{niu0:cc.AudioSource,niu1:cc.AudioSource,niu2:cc.AudioSource,niu3:cc.AudioSource,niu4:cc.AudioSource,niu5:cc.AudioSource,niu6:cc.AudioSource,niu7:cc.AudioSource,niu8:cc.AudioSource,niu9:cc.AudioSource,niu10:cc.AudioSource,wuhuaniu:cc.AudioSource,zhadanniu:cc.AudioSource,wuxiaoniu:cc.AudioSource,backMusic:cc.AudioSource,pourGold:cc.AudioSource,tick:cc.AudioSource},start:function(){this.setVolume(),Global.AudioManager.startPlayBgMusic("Niuniu/Audio/back")},onDestroy:function(){Global.AudioManager.stopBgMusic()},playNiuType:function(e){[this.niu0,this.niu1,this.niu2,this.niu3,this.niu4,this.niu5,this.niu6,this.niu7,this.niu8,this.niu9,this.niu10][e].play()},playWuhuaniu:function(){this.wuhuaniu.play()},playZhadanniu:function(){this.zhadanniu.play()},playWuxiaoniu:function(){this.wuxiaoniu.play()},playPourGold:function(){this.pourGold.play()},playTick:function(){this.tick.play()},setVolume:function(){for(var e=Global.AudioManager.getSoundVolume(),t=[this.niu0,this.niu1,this.niu2,this.niu3,this.niu4,this.niu5,this.niu6,this.niu7,this.niu8,this.niu9,this.niu10,this.wuhuaniu,this.zhadanniu,this.wuxiaoniu,this.pourGold,this.tick],a=0;a<t.length;++a)t[a].volume=e}}),cc._RF.pop()},{}],NNCardItem:[function(e,t,a){"use strict";cc._RF.push(t,"7e733aki5RBcJTGTo7JNgWH","NNCardItem");var r=e("./NNProto"),i=e("../../API/RoomProto"),o=e("./NNLogic"),n=e("./NNModel");cc.Class({extends:cc.Component,properties:{cardsNode:cc.Node,cardSprite1:cc.Sprite,cardSprite2:cc.Sprite,cardSprite3:cc.Sprite,cardSprite4:cc.Sprite,cardSprite5:cc.Sprite,typeSprite:cc.Sprite},onLoad:function(){this.audioManager=this.node.parent.getComponent("NNMainDialog").getAudioManager(),this.cardsNode.active=!1,this.cardSpriteArr=[this.cardSprite1,this.cardSprite2,this.cardSprite3,this.cardSprite4,this.cardSprite5],this.cardPosArr=[];for(var e=0;e<this.cardSpriteArr.length;++e)this.cardPosArr.push(this.cardSpriteArr[e].node.getPosition());this.typeSprite.node.active=!1,Global.MessageCallback.addListener("RoomMessagePush",this),Global.MessageCallback.addListener("GameMessagePush",this)},offLineAndClient:function(){var e,t,a=n.getGameStatus(),i=n.getChairIdIndex(this.chairId);if(!(i<0)){var o=[cc.v2(-132,0),cc.v2(-66,0),cc.v2(0,0),cc.v2(66,0),cc.v2(132,0)];if(a===r.GAME_STATUS_ROBBANK||a===r.GAME_STATUS_POURSCORE)this.cardsNode.active=!1;else if(a===r.GAME_STATUS_SORTCARD){var s=n.getShowCardArr();if(this.cardsNode.active=!0,1===s[i]){for(e=n.getCardsArr()[i],t=0;t<5;++t)Global.CCHelper.updateSpriteFrame(this.getCardUrl(e[t]),this.cardSpriteArr[t]);this.typeSprite.node.active=!0;var c=this.getTypeSpriteUrl(e);if(Global.CCHelper.updateSpriteFrame(c,this.typeSprite),this.chairId===n.getMyChairId())for(this.node.setPosition(0,-119),this.node.setScale(.7,.7),t=0;t<this.cardSpriteArr.length;++t)this.cardSpriteArr[t].node.setPosition(o[t])}else if(this.chairId===n.getMyChairId())for(this.cardArr=n.getCardsArr()[i],this.node.getChildByName("CountNode").active=!0,t=0;t<5;++t)Global.CCHelper.updateSpriteFrame(this.getCardUrl(this.cardArr[t]),this.cardSpriteArr[t]),this.setCardClickFunc(t);else for(t=0;t<5;++t)Global.CCHelper.updateSpriteFrame("GameCommon/Card/card_back",this.cardSpriteArr[t])}else a===r.GAME_STATUS_RESOUT&&(e=n.getCardsArr()[i],this.chairId===n.getMyChairId()?this.answerShowCardPush(this.chairId,e):this.showAllCardAndType(e))}},messageCallbackHandler:function(e,t){if(this.pos){n.getMyChairId();if("RoomMessagePush"===e)t.type===i.USER_READY_PUSH?this.answerUserReadyPush(t.data.chairId):t.type===i.USER_LEAVE_ROOM_PUSH&&this.answerUserLeavePush(t.data.roomUserInfo.chairId);else if("GameMessagePush"===e){if(n.getChairIdIndex(this.chairId)<0)return;t.type===r.RESOUT_CARD_PUSH?this.answerResoutCardPush(t.data.chairId,t.data.cardArr):t.type===r.GAME_RESOUT_PUSH?this.answerResoutPush(t.data.cardsArr):t.type===r.SHOW_CARD_PUSH?this.answerShowCardPush(t.data.chairId,t.data.cardArr):t.type===r.GAME_STATUS_PUSH&&t.data.gameStatus===r.GAME_STATUS_PREPARE&&this.scheduleOnce(function(){this.answerUserReadyPush(this.chairId)}.bind(this),r.AUTO_READY_TM-4)}}},answerUserReadyPush:function(e){if(e===this.chairId){this.cardsNode.active=!1,this.typeSprite.node.active=!1;for(var t=0;t<this.cardSpriteArr.length;++t)this.cardSpriteArr[t].node.setPosition(this.cardPosArr[t]);e===n.getMyChairId()&&(this.node.setScale(1,1),this.node.setPosition(0,-212))}},answerUserLeavePush:function(e){e===this.chairId&&(this.cardsNode.active=!1,this.typeSprite.node.active=!1)},answerResoutCardPush:function(e,t){e===this.chairId&&e===n.getMyChairId()?this.cardArr=t:this.cardArr=[0,0,0,0,0],this.sendCard()},answerResoutPush:function(e){var t=n.getChairIdIndex(this.chairId);if(t>=0&&e[t]&&(this.showAllCardAndType(e[t]),this.chairId===n.getMyChairId())){this.node.getChildByName("CountNode").active=!1;for(var a=0;a<5;++a)this.cardSpriteArr[a].node.targetOff(this.node)}},answerShowCardPush:function(e,t){if(e===n.getMyChairId()&&e===this.chairId){this.node.setPosition(0,-119),this.node.setScale(.7,.7);for(var a=[cc.v2(-132,0),cc.v2(-66,0),cc.v2(0,0),cc.v2(66,0),cc.v2(132,0)],r=0;r<this.cardSpriteArr.length;++r)this.cardSpriteArr[r].node.setPosition(a[r]);this.node.getChildByName("CountNode").active=!1}e===this.chairId&&this.showAllCardAndType(t)},showAllCardAndType:function(e){this.cardsNode.active=!0;for(var t=0;t<5;++t)Global.CCHelper.updateSpriteFrame(this.getCardUrl(e[t]),this.cardSpriteArr[t]);this.typeSprite.node.active=!0;var a=this.getTypeSpriteUrl(e);Global.CCHelper.updateSpriteFrame(a,this.typeSprite);var r=o.getSpecialCardTypeRate(e);0!==r?r===o.RATE_WUHUA?this.audioManager.playWuhuaniu():r===o.RATE_ZHADAN&&this.audioManager.playZhadanniu():(r=o.getNormalCardType(e),this.audioManager.playNiuType(r))},sendCard:function(){this.cardsNode.active=!0;for(var e,t=this.node.getPosition(),a=[],r=0;r<5;++r)e=this.cardSpriteArr[r].node,a.push(e.getPosition()),e.active=!1,Global.CCHelper.updateSpriteFrame("GameCommon/Card/card_back",this.cardSpriteArr[r]);var i=0,o=this;this.schedule(function e(){var r;if(i<5){(r=o.cardSpriteArr[i%5].node).active=!0;var n=a[0],s=cc.v2(-t.x/o.node.scaleX,-t.y/o.node.scaleX);r.setPosition(s),r.runAction(cc.bezierTo(.5,o.getBezierPosArr(s,n)))}if(i>=6&&(r=o.cardSpriteArr[(i-1)%5].node).runAction(cc.moveTo(.1,a[(i-1)%5])),++i>=11){for(var c=1;c<=5;++c)o.cardSpriteArr[c-1].node.zIndex=c;o.unschedule(e),o.showMyCard()}},.1)},showMyCard:function(){if(this.chairId===n.getMyChairId()){for(var e=0;e<5;++e)this.flipCard(this.cardSpriteArr[e],this.getCardUrl(this.cardArr[e]));for(e=0;e<5;++e)this.setCardClickFunc(e)}},flipCard:function(e,t){var a,r=this.node.getChildByName("CountNode");for(r.active=!0,a=1;a<=4;++a)r.getChildByName("Label"+a).getComponent(cc.Label).string="";e.node.runAction(cc.sequence(cc.scaleTo(.1,0,1),cc.callFunc(function(){Global.CCHelper.updateSpriteFrame(t,e)}),cc.scaleTo(.1,1,1)))},setCardClickFunc:function(e){var t=this.node.getChildByName("CountNode"),a=t.getChildByName("Label1").getComponent(cc.Label),r=t.getChildByName("Label2").getComponent(cc.Label),i=t.getChildByName("Label3").getComponent(cc.Label),n=t.getChildByName("Label4").getComponent(cc.Label),s=this;this.cardSpriteArr[e].node.targetOff(this.node),this.cardSpriteArr[e].node.y=this.cardSpriteArr[0].node.y;var c=this.cardSpriteArr[e].node.y;this.cardSpriteArr[e].node.on(cc.Node.EventType.TOUCH_END,function(){if(Math.abs(s.cardSpriteArr[e].node.y-c)>5){a.string="",r.string="",i.string="",n.string="";for(var t=0;t<5;++t)s.cardSpriteArr[t].node.y=c}else if(""===a.string)a.string=o.getCardCount(s.cardArr[e]),s.cardSpriteArr[e].node.y=c+20;else if(""===r.string)r.string=o.getCardCount(s.cardArr[e]),s.cardSpriteArr[e].node.y=c+20;else if(""===i.string){i.string=o.getCardCount(s.cardArr[e]),s.cardSpriteArr[e].node.y=c+20;var l=0;parseInt(a.string)<10?l+=parseInt(a.string):l+=10,parseInt(r.string)<10?l+=parseInt(r.string):l+=10,parseInt(i.string)<10?l+=parseInt(i.string):l+=10,n.string=l}else if(""!==n.string){a.string="",r.string="",i.string="",n.string="";for(t=0;t<5;++t)s.cardSpriteArr[t].node.y=c}},this.node)},getBezierPosArr:function(e,t){return[e,cc.v2((e.x+t.x)/2,(e.y+t.y)/2+300),t]},setCardPosAndChairId:function(e,t){this.pos=e,this.chairId=t},getTypeSpriteUrl:function(e){n.getGameRule();var t=o.getSpecialCardTypeRate(e);return t===o.RATE_WUHUA?"Niuniu/NNType/nn_five_flower":t===o.RATE_ZHADAN?"Niuniu/NNType/nn_four_bull":"Niuniu/NNType/niu_"+o.getNormalCardType(e)},getCardUrl:function(e){var t=o.getCardNumber(e),a=o.getCardColor(e),r="GameCommon/Card/";return a===o.COLOR_FANGKUAI?r+=t:a===o.COLOR_CAOHUA?r+=16+t:a===o.COLOR_HONGTAO?r+=32+t:a===o.COLOR_HEITAO&&(r+=48+t),r},onDestroy:function(){Global.MessageCallback.removeListener("RoomMessagePush",this),Global.MessageCallback.removeListener("GameMessagePush",this)}}),cc._RF.pop()},{"../../API/RoomProto":"RoomProto","./NNLogic":"NNLogic","./NNModel":"NNModel","./NNProto":"NNProto"}],NNGameRuleDialog:[function(e,t,a){"use strict";cc._RF.push(t,"f6193M+pkBP45gl64gLWKhM","NNGameRuleDialog"),cc.Class({extends:cc.Component,properties:{content:cc.Node,ruleItem:cc.Prefab,titleImg:cc.Sprite},createContent:function(){for(var e=[{typ:"title",text:"\u4eba\u6570"},{typ:"des",text:"\u6700\u591a6\u4eba"},{typ:"title",text:"\u724c\u6570"},{typ:"des",text:"\u4e00\u526f\u724c\u9664\u53bb\u5927\u5c0f\u738b52\u5f20\uff0c\u6bcf\u4f4d\u73a9\u5bb6\u6bcf\u6b215\u5f20\u724c"},{typ:"title",text:"\u6d41\u7a0b"},{typ:"des",text:"\u6bcf\u4f4d\u73a9\u5bb6\u53d15\u5f20\u724c\uff0c\u5176\u4e2d4\u5f20\u53ea\u6709\u81ea\u5df1\u80fd\u770b\u5230\uff0c\u6b64\u65f6\u5f00\u59cb\u6839\u636e4\u5f20\u660e\u724c\u5f00\u59cb\u8fdb\u884c\u62a2\u5e84\uff0c\u6700\u5927\u500d\u7387\u4f18\u5148\u5750\u5e84\uff0c\u786e\u5b9a\u5b8c\u5e84\u5bb6\u540e\u95f2\u5bb6\u62bc\u6ce8\uff0c\u6700\u540e\u6839\u636e\u724c\u578b\u540c\u5e84\u5bb6\u8fdb\u884c\u6bd4\u8f83\uff0c\u4e0d\u540c\u724c\u578b\u500d\u7387\u4e0d\u540c\uff0c\u5e84\u5bb6\u4e0d\u591f\u8d54\u4ed8\u65f6\u4f18\u5148\u8d54\u4ed8\u724c\u578b\u8f83\u5927\u7684\u73a9\u5bb6"},{typ:"title",text:"\u724c\u578b"},{typ:"des",text:"\u6ca1\u725b\uff1a\u4efb\u610f3\u5f20\u724c\u4e0d\u80fd\u7ec4\u621010\u7684\u500d\u6570\n\u725b\u4e00\uff1a\u4efb\u610f3\u5f20\u724c\u4e3a10\u7684\u500d\u6570,\u5269\u4f592\u5f20\u724c\u966410\u4f591\n\u725b\u4e8c\uff1a\u4efb\u610f3\u5f20\u724c\u4e3a10\u7684\u500d\u6570,\u5269\u4f592\u5f20\u724c\u966410\u4f592\n\u725b\u4e09\uff1a\u4efb\u610f3\u5f20\u724c\u4e3a10\u7684\u500d\u6570,\u5269\u4f592\u5f20\u724c\u966410\u4f592\n......\n\u725b\u4e5d\uff1a\u4efb\u610f3\u5f20\u724c\u4e3a10\u7684\u500d\u6570,\u5269\u4f592\u5f20\u724c\u966410\u4f599\n\u725b\u725b\uff1a\u4efb\u610f3\u5f20\u724c\u4e3a10\u7684\u500d\u6570,\u5269\u4f592\u5f20\u724c\u966410\u4f590\n\u65e0\u82b1\u725b\uff1a\u6240\u6709\u724c\u4e0d\u5c0f\u4e8e10\n\u70b8\u5f39\u725b\uff1a\u6709\u56db\u5f20\u540c\u6837\u5927\u5c0f\u7684\u724c\n\u4e94\u5c0f\u725b\uff1a\u6bcf\u5f20\u724c\u5c0f\u4e8e5,\u52a0\u8d77\u6765\u4e0d\u5927\u4e8e10\n"},{typ:"title",text:"\u724c\u578b\u5927\u5c0f"},{typ:"des",text:"\u4e94\u5c0f\u725b-\u70b8\u5f39\u725b-\u65e0\u82b1\u725b-\u725b\u725b-\u725b\u4e5d-\u725b\u516b-\u725b\u4e03-\u725b\u516d-\u725b\u4e94-\u725b\u56db-\u725b\u4e09-\u725b\u4e8c-\u725b\u4e00-\u6ca1\u725b\n\u724c\u578b\u76f8\u540c\u65f6\u4fa7\u7531\u5927\u5230\u5c0f\u6bd4\u70b9\u6570\uff0c\u5982\u5355\u724c\u53cc\u65b9\u5148\u6bd4\u8f83\u6700\u5927\u7684\u5355\u724c\uff0c\u76f8\u540c\u5219\u6bd4\u7b2c\u4e8c\u5f20\uff0c\u82e5\u6240\u6709\u70b9\u6570\u90fd\u76f8\u540c\u5219\u6bd4\u82b1\u8272"},{typ:"title",text:"\u82b1\u8272\u5927\u5c0f"},{typ:"des",text:"\u9ed1\u6843-\u7ea2\u6843-\u6885\u82b1-\u65b9\u5757"},{typ:"title",text:"\u70b9\u6570\u5927\u5c0f"},{typ:"des",text:"K-Q-J-10-9-8-7-6-5-4-3-2-A"},{typ:"title",text:"\u79ef\u5206\u7b97\u6cd5"},{typ:"des",text:"\u4e94\u5c0f\u725b8\u500d, \u70b8\u5f39\u725b6\u500d, \u65e0\u82b1\u725b5\u500d \n\u725b\u725b4\u500d, \u725b\u4e5d3\u500d, \u725b\u516b\u725b\u4e032\u500d, \u5176\u4f591\u500d"}],t=0;t<e.length;t++){var a=cc.instantiate(this.ruleItem);a.parent=this.content,a.getComponent("NNGameRuleItem").updateUI(e[t])}},createScoreContent:function(){Global.CCHelper.updateSpriteFrame("Hall/labelImg_scoreIntroduction",this.titleImg);for(var e=[{typ:"title",text:"\u79ef\u5206\u83b7\u53d6\u9014\u5f84"},{typ:"des",text:Global.Data.getData("couponObtainWayText")},{typ:"title",text:"\u79ef\u5206\u4f7f\u7528\u65b9\u6cd5"},{typ:"des",text:Global.Data.getData("couponObtainUseWayText")}],t=0;t<e.length;t++){var a=cc.instantiate(this.ruleItem);a.parent=this.content,a.getComponent("GameRuleItem").updateUI(e[t])}},onLoad:function(){if(this.dialogParameters){var e=this.dialogParameters.typ;if(e&&"score"===e)return void this.createScoreContent()}this.createContent()},onBtnClk:function(e,t){switch(t){case"close":Global.DialogManager.destroyDialog(this)}}}),cc._RF.pop()},{}],NNGameRuleItem:[function(e,t,a){"use strict";cc._RF.push(t,"0f360oGbFRHGrwOHlqPDHzO","NNGameRuleItem"),cc.Class({extends:cc.Component,properties:{text:cc.Label},onLoad:function(){},updateUI:function(e){this.text.string=e.text,"des"===e.typ&&(this.text.fontSize=24,this.text.node.color=cc.Color.WHITE,this.text.string=e.text)}}),cc._RF.pop()},{}],NNHeadItem:[function(e,t,a){"use strict";cc._RF.push(t,"a5499LX8HFA075K6Ha8dGy6","NNHeadItem");var r=e("NNModel"),i=e("./NNProto"),o=e("../../API/RoomProto");cc.Class({extends:cc.Component,properties:{nameLabel:cc.Label,headSprite:cc.Sprite,bankSprite:cc.Sprite,scoreLabel:cc.Label,winScoreLabel:cc.Label,loseScoreLabel:cc.Label,robRateNode:cc.Node,pourScoreLabel:cc.Label,headEdgSprite:cc.Sprite},onLoad:function(){Global.MessageCallback.addListener("RoomMessagePush",this),Global.MessageCallback.addListener("GameMessagePush",this)},offLineAndClient:function(){var e=r.getGameStatus();this.bankSprite.node.active=!1,this.scoreLabel.string=r.getPlayerByChairId(this.chairId).userInfo.gold.toFixed(2),this.pourScoreLabel.string="",this.winScoreLabel.string="",this.loseScoreLabel.string="",this.bankSprite.node.active=!1,this.robRateNode.active=!1;var t=r.getChairIdIndex(this.chairId);if(e===i.GAME_STATUS_ROBBANK){var a=r.getRobBankArr();-1!==a[this.chairId]&&this.answerRobRateBank(this.chairId,a[this.chairId])}else if(e===i.GAME_STATUS_POURSCORE||e===i.GAME_STATUS_SORTCARD){if(t>=0){var o=r.getPourScoreArr()[t];0!==o&&(this.pourScoreLabel.string=o+"\u500d",this.pourScoreLabel.node.active=!0),this.showRateSprite(r.getRobBankArr())}}else e===i.GAME_STATUS_RESOUT&&t>=0&&this.showRateSprite(r.getRobBankArr());r.getBankChairId()===this.chairId&&(this.bankSprite.node.active=!0)},messageCallbackHandler:function(e,t){this.pos&&("GameMessagePush"===e?t.type===i.POUR_SCORE_PUSH?this.answerPourScorePush(t.data.chairId,t.data.score):t.type===i.CAN_POUR_SCORE_PUSH||(t.type===i.GAME_RESOUT_PUSH?r.getChairIdIndex(this.chairId)>=0&&this.answerGameResoutPush(t.data.finalScoreArr,t.data.bankIndex):t.type===i.GAME_STATUS_PUSH?t.data.gameStatus===i.GAME_STATUS_PREPARE&&this.answerUserReadyPush(this.chairId):t.type===i.ROB_FREE_BANK_PUSH||(t.type===i.ROB_RATE_BANK_PUSH?this.answerRobRateBank(t.data.chairId,t.data.rate):t.type===i.BANK_CHANGE_PUSH&&this.answerBankChangePush(t.data.bankChairId,t.data.robBankArr))):"RoomMessagePush"===e&&(t.type===o.USER_READY_PUSH?this.answerUserReadyPush(t.data.chairId):t.type===o.USER_LEAVE_ROOM_PUSH&&this.answerUserLeavePush(t.data.roomUserInfo.chairId)))},answerPourScorePush:function(e,t){e===this.chairId&&(this.pourScoreLabel.string=t+"\u500d",this.pourScoreLabel.node.active=!0,this.robRateNode.active=!1)},answerGameResoutPush:function(e,t){var a=e[r.getChairIdIndex(this.chairId)];r.getProfitPercentage();a<0?this.loseScoreLabel.string=a.toFixed(2):this.winScoreLabel.string="+"+(a*(1-r.getProfitPercentage())).toFixed(2);var i=this;r.getChairIdByIndex(t)===this.chairId?this.bankSprite.node.active=!0:this.bankSprite.node.active=!1,this.scheduleOnce(function(){i.scoreLabel.string=r.getPlayerByChairId(i.chairId).userInfo.gold.toFixed(2)},3)},answerRobRateBank:function(e,t){e===this.chairId&&(this.robRateNode.active=!0,0===t?(this.robRateNode.getChildByName("BuqiangSprite").active=!0,this.robRateNode.getChildByName("QiangSprite").active=!1,this.robRateNode.getChildByName("RateLabel").active=!1):(this.robRateNode.getChildByName("BuqiangSprite").active=!1,this.robRateNode.getChildByName("QiangSprite").active=!0,this.robRateNode.getChildByName("RateLabel").active=!0,this.robRateNode.getChildByName("RateLabel").getComponent(cc.Label).string=t))},answerBankChangePush:function(e,t){r.getGameRule();var a,i,o=[0,1,2,4];for(a=o.length-1;a>=0;--a){var n=0;for(i=0;i<t.length;++i)t[i]===o[a]&&++n;if(n>0){if(1===n)return this.bankSprite.node.active=this.chairId===e,void this.showRateSprite(t);break}}r.getChairIdIndex(e);var s=r.getChairIdIndex(this.chairId),c=o[a];if(!(t[s]<c)){var l=0,d=this;this.schedule(function a(){for(;r.getChairIdIndex(l%5)<0||t[r.getChairIdIndex(l%5)]<c;)++l;d.headEdgSprite.node.active=l%5===d.chairId,l>=20+e&&(d.bankSprite.node.active=e===d.chairId,d.headEdgSprite.node.active=!1,d.showRateSprite(t),d.unschedule(a)),++l},.1)}},answerUserReadyPush:function(e){e===r.getMyChairId()&&(this.pourScoreLabel.string="",this.winScoreLabel.string="",this.loseScoreLabel.string="",this.bankSprite.node.active=!1,this.robRateNode.active=!1)},answerUserLeavePush:function(e){e===this.chairId&&(this.pourScoreLabel.string="",this.winScoreLabel.string="",this.loseScoreLabel.string="",this.bankSprite.node.active=!1,this.robRateNode.active=!1)},showRateSprite:function(e){if(this.chairId===r.getBankChairId()){var t=e[r.getChairIdIndex(this.chairId)];t<=0&&(t=1),this.robRateNode.active=!0,this.robRateNode.getChildByName("BuqiangSprite").active=!1,this.robRateNode.getChildByName("QiangSprite").active=!0,this.robRateNode.getChildByName("RateLabel").getComponent(cc.Label).string=t,this.robRateNode.getChildByName("RateLabel").active=!0}else this.robRateNode.active=!1},setHeadPosAndChairId:function(e,t){this.pos=e,this.chairId=t;var a=r.getPlayerByChairId(t);a&&(this.nameLabel.string=a.userInfo.nickname,this.scoreLabel.string=a.userInfo.gold.toFixed(2),Global.CCHelper.updateSpriteFrame(a.userInfo.avatar,this.headSprite)),this.chairId===r.getBankChairId()&&(this.bankSprite.node.active=!0)},onDestroy:function(){Global.MessageCallback.removeListener("RoomMessagePush",this),Global.MessageCallback.removeListener("GameMessagePush",this)}}),cc._RF.pop()},{"../../API/RoomProto":"RoomProto","./NNProto":"NNProto",NNModel:"NNModel"}],NNLogic:[function(e,t,a){"use strict";cc._RF.push(t,"d2137+mZvJIJqGN2tGXLODM","NNLogic");var r=t.exports;r.COLOR_FANGKUAI=0,r.COLOR_CAOHUA=1,r.COLOR_HONGTAO=2,r.COLOR_HEITAO=3,r.LOSE=0,r.WIN=1,r.RATE_WUHUA=5,r.RATE_ZHADAN=4,r.RATE_NIUNIU=3,r.RATE_NIUDA=2,r.RATE_NIUXIAO=1,r.getResout=function(e,t,a,r,i,o){i=i||1;var n,s=[];for(n=0;n<e.length;++n)s[n]={normal:this.getNormalCardType(e[n]),special:this.getSpecialCardTypeRate(e[n]),maxCard:this.getMaxCard(e[n])};var c=[];for(n=0;n<t.length;++n)c[n]=0;var l,d,h,u=s[a].special,g=this.getNormalCardTypeRate(s[a].normal);for(n=0;n<e.length;++n)n!==a&&(l=s[n].special,d=this.getNormalCardTypeRate(s[n].normal),this.isCardArrBigger(e[a],e[n])>0?(h=u>0?u:g,c[a]+=t[n]*h*r*i,c[n]-=t[n]*h*r*i):(h=l>0?l:d,c[a]-=t[n]*h*r*i,c[n]+=t[n]*h*r*i));var C,p=o,f=this.getPaySortIndexArr(a,e);for(n=0;n<f.length;++n)c[C=f[n]]>0?c[C]<=o?o-=c[C]:(c[C]=o>0?o:0,o=0):o-=c[C];return 0===o&&(c[a]=-p),{cardsArr:e,finalScoreArr:c,bankIndex:a}},r.getPaySortIndexArr=function(e,t){var a,r,i=[];for(0===e?i.push(1):i.push(0),a=0;a<t.length;++a)if(a!==e&&-1===i.indexOf(a))if(this.isCardArrBigger(t[a],t[e])){for(r=i.length-1;r>=0&&this.isCardArrBigger(t[a],t[i[r]]);--r);-1===r?i.unshift(a):r===i.length-1?i.push(a):i.splice(r+1,0,a)}else i.unshift(a);return i},r.getMaxCard=function(e){var t,a=e[0];for(t=1;t<e.length;++t)this.isCardBigger(a,e[t])||(a=e[t]);return a},r.isCardBigger=function(e,t){if(e%13==t%13){if(e/13<t/13)return!1}else{if(t%13==0)return!1;if(e%13!=0&&t%13>e%13)return!1}return!0},r.isCardArrBigger=function(e,t){var a=this.getNormalCardType(e),i=this.getNormalCardType(t),o=this.getSpecialCardTypeRate(e),n=this.getSpecialCardTypeRate(t);if(o!==n)return o>n;if(o===r.RATE_ZHADAN){var s,c,l;for(s=1;s<e.length;++s)this.getCardCount(e[s])===this.getCardCount(e[s-1])&&(c=e[s]),this.getCardCount(t[s])===this.getCardCount(t[s-1])&&(l=t[s]);return c>l}return o===r.RATE_WUHUA?this.compareCountThenColor(e,t):a!==i?a>i:this.compareCountThenColor(e,t)},r.getNormalCardType=function(e){var t,a,r,i=0,o=0,n=!1,s=[];for(t=0;t<e.length;++t)s[t]=this.getCardCount(e[t]),i+=s[t];for(t=0;t<s.length;++t)for(a=t+1;a<s.length;++a)for(r=a+1;r<s.length;++r)if((s[t]+s[a]+s[r])%10==0){n=!0,o=(i-s[t]-s[a]-s[r])%10;break}return 0===o&&n&&(o=10),o},r.getNormalCardTypeRate=function(e){return 10===e?this.RATE_NIUNIU:e>=7?this.RATE_NIUDA:this.RATE_NIUXIAO},r.getSpecialCardTypeRate=function(e){var t=0;return this.isFiveColorNiu(e)?t=r.RATE_WUHUA:this.isFourSameCard(e)&&(t=r.RATE_ZHADAN),t},r.getCardsArr=function(e){var t,a,r,i,o,n,s,c=[];for(t=0;t<52;++t)c[t]=t;for(a=0;a<c.length;++a)o=Math.floor(Math.random()*c.length),n=Math.floor(Math.random()*c.length),s=c[o],c[o]=c[n],c[n]=s;var l=[];for(r=0;r<e;++r){for(s=[],i=0;i<5;++i)s.push(c.pop());l.push(s)}return l},r.getCardNumber=function(e){return e%13+1},r.getCardCount=function(e){var t=this.getCardNumber(e);return t>10&&(t=10),t},r.getCardColor=function(e){return Math.floor(e%52/13)},r.isFiveColorNiu=function(e){var t;for(t=0;t<e.length;++t)if(this.getCardNumber(e[t])<=10)return!1;return!0},r.isFourSameCard=function(e){var t,a=e[0],r=e[1],i=0,o=0;for(t=0;t<e.length;++t)this.getCardNumber(e[t])===this.getCardNumber(a)&&++i,this.getCardNumber(e[t])===this.getCardNumber(r)&&++o;return i>=4||o>=4},r.compareCountThenColor=function(e,t){var a=this.getMaxCard(e),r=this.getMaxCard(t);return this.isCardBigger(a,r)},cc._RF.pop()},{}],NNMainDialog:[function(e,t,a){"use strict";cc._RF.push(t,"bdf43P2mJlBM72L3ocOccn9","NNMainDialog");var r=e("./NNModel"),i=e("./NNProto"),o=e("../../API/RoomProto"),n=(e("../../API/HallAPI"),"game.gameHandler.roomMessageNotify"),s="game.gameHandler.gameMessageNotify";cc.Class({extends:cc.Component,properties:{cardItem:cc.Prefab,headItem:cc.Prefab,roomIdLabel:cc.Label,pourScoreNode:cc.Node,showCardNode:cc.Node,rateRobNode:cc.Node,audioItem:cc.Prefab,stateItem:cc.Prefab,resoutNode:cc.Node,winSprite:cc.Sprite,loseSprite:cc.Sprite,continueNode:cc.Node},onLoad:function(){var e=cc.instantiate(this.audioItem);e.parent=this.node,this.audioManager=e.getComponent("NNAudioNode"),this.cardItemArr=[],this.headItemArr=[];for(var t=r.getChairCount(),a=1;a<=t;++a)this.cardItemArr.push(this.node.getChildByName("NNCardItem"+a)),this.headItemArr.push(this.node.getChildByName("NNHeadItem"+a));cc.instantiate(this.stateItem).parent=this.node,Global.MessageCallback.addListener("RoomMessagePush",this),Global.MessageCallback.addListener("GameMessagePush",this),Global.MessageCallback.addListener("ReConnectSuccess",this),this.offLineAndClient()},offLineAndClient:function(){for(var e=r.getChairCount(),t=r.getMyChairId(),a=(r.getGameRule(),0);a<e;++a)this.cardItemArr[a].active=!1,this.headItemArr[a].active=!1;for(var n=0;n<e;++n)r.getPlayerByChairId(n)&&this.showHeadAndCardByChairId(n);var s=r.getGameStatus(),c=r.getChairIdIndex(t);if(s===i.GAME_STATUS_PREPARE){r.getPlayerByChairId(t);Global.API.room.roomMessageNotify(o.userReadyNotify(!0))}else if(s===i.GAME_STATUS_POURSCORE){if(t!==r.getBankChairId()){var l=r.getPourScoreArr();c>=0&&0===l[c]&&this.answerCanPourScorePush(s,r.getCanPourScoreArr(),!0)}}else if(s===i.GAME_STATUS_SORTCARD){this.pourScoreNode.active=!1;var d=r.getShowCardArr();c>=0&&1!==d[c]&&(this.showCardNode.active=!0)}else if(s===i.GAME_STATUS_ROBBANK){var h=r.getRobBankArr();c>=0&&-1===h[c]?this.showRateRobButton():this.rateRobNode.active=!1}for(var u=0;u<e;++u)if(r.getPlayerByChairId(u)){var g=(u+e-t)%e;this.headItemArr[g].getComponent("NNHeadItem").offLineAndClient(),this.cardItemArr[g].getComponent("NNCardItem").offLineAndClient()}},messageCallbackHandler:function(e,t){var a=r.getMyChairId();"RoomMessagePush"===e?t.type===o.USER_LEAVE_ROOM_RESPONSE?t.data.chairId===a&&Global.DialogManager.removeLoadingCircle():t.type===o.OTHER_USER_ENTRY_ROOM_PUSH?this.showHeadAndCardByChairId(t.data.roomUserInfo.chairId):t.type===o.USER_LEAVE_ROOM_PUSH?this.hideHeadItemByChairId(t.data.roomUserInfo.chairId):t.type===o.USER_READY_PUSH?this.answerUserReadyPush(t.data.chairId):t.type===o.GAME_END_PUSH||(t.type,o.ROOM_DISMISS_PUSH):"GameMessagePush"===e?t.type===i.CAN_POUR_SCORE_PUSH?this.answerCanPourScorePush(t.data.gameStatus,t.data.scoresArr,!1):t.type===i.POUR_SCORE_PUSH?this.answerPourScorePush(t.data.chairId):t.type===i.RESOUT_CARD_PUSH?this.answerResoutCardPush():t.type===i.SHOW_CARD_PUSH?this.answerShowCardPush(t.data.chairId,t.data.cardArr):t.type===i.GAME_RESOUT_PUSH?this.answerGameResoutPush(t.data.finalScoreArr,t.data.bankIndex):t.type===i.GAME_STATUS_PUSH?this.answerGameStatusPush(t.data.gameStatus):t.type===i.ROB_RATE_BANK_PUSH?this.answerRobRateBank(t.data.chairId):t.type===o.USER_RECONNECT_PUSH&&(Global.DialogManager.destroyDialog("Niuniu/NNMainDialog"),r.setGameData(t.data.gameData),Global.DialogManager.createDialog("Niuniu/NNMainDialog")):"ReConnectSuccess"===e&&(Global.Player.isInRoom()?Global.API.hall.joinRoomRequest(r.getRoomId(),function(){Global.NetworkManager.notify(n,o.getUserReconnectNotifyData())},function(){this.exitGame()}.bind(this)):this.exitGame())},answerCanPourScorePush:function(e,t,a){r.getGameRule();for(var i,o=r.getRobBankArr(),n=(r.getChairIdIndex(r.getMyChairId()),4);n>=0;--n){i=0;for(var s=0;s<o.length;++s)o[s]===n&&++i;if(i>0)break}if(1===i)this.pourScoreNode.active=!0;else{for(var c=4*i*.1,l=0;l<=r.getBankChairId();++l)o[l]===n&&(c+=.1);this.scheduleOnce(function(){this.pourScoreNode.active=!0}.bind(this),c)}},answerPourScorePush:function(e){e===r.getMyChairId()&&(this.pourScoreNode.active=!1)},answerResoutCardPush:function(){this.scheduleOnce(function(){this.showCardNode.active=!0}.bind(this),2)},answerFourCardPush:function(){r.getChairIdIndex(r.getMyChairId())},answerGameResoutPush:function(e,t){r.getGameRule();for(var a=[],i=0;i<this.headItemArr.length;++i){var o=this.headItemArr[i].getPosition();a.push({x:o.x,y:o.y})}for(var n=r.getMyChairId(),s=r.getChairIdIndex(n),c=r.getChairIdByIndex(t),l=r.getChairCount(),d=this,h=0;h<e.length;++h)if(h!==t&&e[h]<0){var u=a[(r.getChairIdByIndex(h)+l-n)%l],g=a[(c+l-n)%l];this.playGoldAnimal(this.node,u,g)}(this.scheduleOnce(function(){for(var i=0;i<e.length;++i)if(i!==t&&e[i]>0){var o=a[(c+l-n)%l],s=a[(r.getChairIdByIndex(i)+l-n)%l];d.playGoldAnimal(d.node,o,s)}},.65),s>=0)&&(this.resoutNode.active=!0,e[s]>=0?(this.winSprite.node.active=!0,this.loseSprite.node.active=!1,Global.AudioManager.playSound("GameCommon/Sound/win_game")):(this.winSprite.node.active=!1,this.loseSprite.node.active=!0,Global.AudioManager.playSound("Niuniu/Audio/losegame")),this.resoutNode.setScale(.01),this.resoutNode.runAction(cc.sequence(cc.scaleTo(.2,1.2,1.2),cc.scaleTo(.1,1,1),cc.delayTime(4),cc.callFunc(function(){this.resoutNode.active=!1,this.continueNode.active=!0}.bind(this)))))},answerShowCardPush:function(e,t){e===r.getMyChairId()&&(this.showCardNode.active=!1)},answerGameStatusPush:function(e){if(e===i.GAME_STATUS_PREPARE);else if(e===i.GAME_STATUS_POURSCORE);else if(e===i.GAME_STATUS_ROBBANK){r.getGameRule();this.showRateRobButton()}else e===i.GAME_STATUS_SORTCARD&&(this.pourScoreNode.active=!1)},answerRobRateBank:function(e){e===r.getMyChairId()&&(this.rateRobNode.active=!1)},answerUserReadyPush:function(e){e===r.getMyChairId()&&this.autoExitCall&&this.unschedule(this.autoExitCall)},showRateRobButton:function(){this.rateRobNode.active=!0},onButtonClick:function(e,t){if("dismiss"===t)Global.DialogManager.addPopDialog("\u786e\u8ba4\u9000\u51fa\u6e38\u620f?",function(){Global.Player.roomID?(Global.NetworkManager.notify(n,o.getAskForDismissNotifyData()),Global.DialogManager.addLoadingCircle()):this.exitGame()}.bind(this),function(){});else if("setting"===t){Global.DialogManager.createDialog("Setting/SettingDialog",{callback:this.audioManager.setVolume.bind(this.audioManager)})}else"rule"===t?Global.DialogManager.createDialog("GameCommon/GameRule/GameRuleDialog",{kind:Global.Enum.gameType.NN}):"ready"===t?Global.NetworkManager.notify(n,o.userReadyNotify(!0)):"free_rob"===t?Global.NetworkManager.notify(s,i.getRobFreeBankNotifyData(!0)):"free_no_rob"===t?Global.NetworkManager.notify(s,i.getRobFreeBankNotifyData(!1)):"rate_no_rob"===t?Global.NetworkManager.notify(s,i.getRobRateBankNotifyData(0)):"rob_1"===t?Global.NetworkManager.notify(s,i.getRobRateBankNotifyData(1)):"rob_2"===t?Global.NetworkManager.notify(s,i.getRobRateBankNotifyData(2)):"rob_4"===t?Global.NetworkManager.notify(s,i.getRobRateBankNotifyData(4)):"pour_1"===t?Global.NetworkManager.notify(s,i.getPourScoreNotifyData(5)):"pour_2"===t?Global.NetworkManager.notify(s,i.getPourScoreNotifyData(10)):"pour_3"===t?Global.NetworkManager.notify(s,i.getPourScoreNotifyData(15)):"pour_4"===t?Global.NetworkManager.notify(s,i.getPourScoreNotifyData(20)):"show_card"===t?Global.NetworkManager.notify(s,i.getShowCardNotifyData()):"continue"===t&&Global.DialogManager.createDialog("Match/MatchGameDialog",{gameTypeID:r.gameTypeInfo.gameTypeID})},showHeadAndCardByChairId:function(e){var t=r.getMyChairId(),a=r.getChairCount(),i=(e+a-t)%a;this.headItemArr[i].active=!0,this.cardItemArr[i].active=!0;var o,n=this.headItemArr[i].getComponent("NNHeadItem"),s=this.cardItemArr[i].getComponent("NNCardItem");o=4===a?["bottom","right","top","left"][i]:["bottom","right","right","top","left","left"][i],n.setHeadPosAndChairId(o,e),s.setCardPosAndChairId(o,e)},hideHeadItemByChairId:function(e){var t=r.getMyChairId(),a=r.getChairCount(),i=(e+a-t)%a;this.headItemArr[i].active=!1,this.cardItemArr[i].active=!1,e===t&&this.exitGame()},exitGame:function(){r.onDestroy(),Global.DialogManager.createDialog("Hall/HallDialog",null,function(){Global.DialogManager.removeLoadingCircle(),Global.DialogManager.destroyDialog("Niuniu/NNMainDialog",!0),Global.CCHelper.releaseRes(["NiuNiu"])})},playSendCardAnimal:function(e){e.active=!0;for(var t,a,r,i,o=e.getPosition(),n=[],s=[],c=1;c<=5;++c)(t=e.getChildByName("CardSprite"+c)).active=!0,a=t.getPosition(),n.push(t),s.push(a),r=cc.v2(-a.x-o.x,-a.y-o.y),i=a,t.setPosition(r),t.runAction(cc.bezierTo(1,this.getBezierPosArr(r,i)))},getBezierPosArr:function(e,t){return[e,cc.v2((e.x+t.x)/2,(e.y+t.y)/2),t]},playGoldAnimal:function(e,t,a,r){for(var i=[],o=[{x:-3,y:3},{x:3,y:3},{x:0,y:-3}],n=0;n<10;++n){i.push(new cc.Node),Global.CCHelper.updateSpriteFrame("Niuniu/Common/nn_gold",i[n].addComponent(cc.Sprite)),i[n].parent=e;var s=cc.v2(t.x+o[n%3].x,t.y+o[n%3].y);i[n].setPosition(s)}n=0;var c=this;this.schedule(function e(){if(n<10){i[n].active=!0;var t=cc.v2(a.x+o[n%3].x,a.y+o[n%3].y);i[n].runAction(cc.moveTo(.5-.03*n,t)),Global.AudioManager.playSound("GameCommon/Sound/win_bet"),++n}else c.unschedule(e)},.03),this.scheduleOnce(function(){for(n=0;n<10;++n)i[n].removeFromParent();r&&r()},.65)},getHeadItemByChairId:function(e){var t=r.getMyChairId(),a=r.getChairCount(),i=(e+a-t)%a;return this.headItemArr[i]},onDestroy:function(){Global.MessageCallback.removeListener("RoomMessagePush",this),Global.MessageCallback.removeListener("GameMessagePush",this),Global.MessageCallback.removeListener("ReConnectSuccess",this)},getAudioManager:function(){return this.audioManager}}),cc._RF.pop()},{"../../API/HallAPI":"HallAPI","../../API/RoomProto":"RoomProto","./NNModel":"NNModel","./NNProto":"NNProto"}],NNModel:[function(e,t,a){"use strict";cc._RF.push(t,"ade2d1SzOxLZKgFWSv9b7yI","NNModel");var r=t.exports,i=e("./NNProto"),o=e("../../API/RoomProto");r.setEntryRoomData=function(e){var t,a=e.gameData;if(this.userArr=e.roomUserInfoArr,this.gameRule=a.gameRule,this.curBureau=a.curBureau,this.roomId=a.roomId,this.gameStatus=a.gameStatus,this.bankChairId=a.bankChairId,this.robBankArr=a.robBankArr,this.gameTypeInfo=a.gameTypeInfo,this.pourScoreArr=a.pourScoreArr,this.canPourScoreArr=a.canPourScoreArr,this.cardArr=a.cardArr,this.showCardArr=a.showCardArr,this.cardsArr=a.cardsArr,this.resout=this.resout,this.gameStartChairIdArr=a.gameStartChairIdArr,this.profitPercentage=a.profitPercentage,!this.showCardArr||0===this.showCardArr.length)for(this.showCardArr=[],t=0;t<this.gameRule.memberCount;++t)this.showCardArr[t]=0;for(this.myUid=Global.Player.getPy("uid"),t=0;t<this.userArr.length;++t)this.userArr[t].userInfo.uid===this.myUid&&(this.myChairId=this.userArr[t].chairId),this.userArr[t].userInfo.nickname=Global.Player.convertNickname(this.userArr[t].userInfo.nickname);Global.MessageCallback.addListener("RoomMessagePush",this),Global.MessageCallback.addListener("GameMessagePush",this)},r.setGameData=function(e){for(var t in e)e.hasOwnProperty(t)&&this.hasOwnProperty(t)&&(this[t]=e[t])},r.clearGameData=function(){var e=this.gameRule.memberCount;this.cardsArr=[],this.pourScoreArr=[],this.showCardArr=[];for(var t=0;t<e;++t)this.pourScoreArr[t]=0,this.showCardArr[t]=0,this.cardsArr[t]=[]},r.messageCallbackHandler=function(e,t){"RoomMessagePush"===e?t.type===o.OTHER_USER_ENTRY_ROOM_PUSH?this.addPlayer(t.data.roomUserInfo):t.type===o.USER_LEAVE_ROOM_PUSH?(this.delPlayer(t.data.roomUserInfo),t.data.roomUserInfo.chairId===this.myChairId&&this.onDestroy()):t.type===o.USER_READY_PUSH?this.answerUserReadyPush(t.data.chairId):(t.type,o.ROOM_DISMISS_PUSH):"GameMessagePush"===e&&(t.type===i.CAN_POUR_SCORE_PUSH?this.answerCanPourScorePush(t.data.gameStatus,t.data.scoresArr):t.type===i.POUR_SCORE_PUSH?this.answerPourScorePush(t.data.chairId,t.data.score):t.type===i.SHOW_CARD_PUSH?this.answerShowCardPush(t.data.chairId,t.data.cardArr):t.type===i.RESOUT_CARD_PUSH?this.answerResoutCardPush(t.data.chairId,t.data.cardArr):t.type===i.GAME_RESOUT_PUSH?this.answerGameResoutPush(t.data.bankIndex,t.data.cardsArr,t.data.finalScoreArr):t.type===i.GAME_STATUS_PUSH?this.answerGameStatusPush(t.data.gameStatus):t.type===i.BANK_CHANGE_PUSH?this.answerBankChangePush(t.data.bankChairId,t.data.gameStatus,t.data.robBankArr):t.type===i.ROB_RATE_BANK_PUSH&&this.answerRobRateBank(t.data.chairId,t.data.rate))},r.answerCanPourScorePush=function(e,t){this.clearGameData(),this.gameStatus=e,this.canPourScoreArr=t},r.answerPourScorePush=function(e,t){this.pourScoreArr[e]=t},r.answerShowCardPush=function(e,t){var a=this.getChairIdIndex(e);this.showCardArr[a]=!0,this.cardsArr[a]=t},r.answerResoutCardPush=function(e,t){e===this.myChairId&&this.setMyCardArr(t)},r.answerGameResoutPush=function(e,t,a){this.bankChairId=this.getChairIdByIndex(e),this.cardsArr=t,++this.curBureau,this.bankChairId=null,console.log("answerGameResoutPush"),console.log(this.gameStartChairIdArr,this.userArr);for(var r=0;r<a.length;++r){var i=this.getPlayerByChairId(this.gameStartChairIdArr[r]);a[r]>0?i.userInfo.gold+=a[r]*(1-this.getProfitPercentage()):i.userInfo.gold+=a[r],(i.userStatus&o.userStatusEnum.READY)>0&&(i.userStatus-=o.userStatusEnum.READY)}},r.answerGameStatusPush=function(e){var t;if(this.gameStatus=e,this.gameStatus===i.GAME_STATUS_ROBBANK){for(this.gameRule.memberCount=this.gameStartChairIdArr.length,t=0;t<this.gameRule.memberCount;++t)this.robBankArr[t]=-1;this.recordGameStartChairId()}else if(this.gameStatus===i.GAME_STATUS_POURSCORE)for(this.pourScoreArr=[],t=0;t<this.gameRule.memberCount;++t)this.pourScoreArr[t]=0;else if(this.gameStatus===i.GAME_STATUS_SORTCARD)for(this.cardsArr=[],t=0;t<this.gameRule.memberCount;++t)this.cardsArr[t]=[]},r.answerBankChangePush=function(e,t,a){this.bankChairId=e,this.robBankArr=a,this.answerGameStatusPush(t)},r.answerRobRateBank=function(e,t){this.robBankArr[this.getChairIdIndex(e)]=t},r.answerUserReadyPush=function(e){var t=this.getPlayerByChairId(e);t&&(t.userStatus|=o.userStatusEnum.READY)},r.answerRoomDismissPush=function(e){this.onDestroy()},r.getProfitPercentage=function(){return this.profitPercentage/100},r.getRobBankArr=function(){return this.robBankArr},r.getCardsArr=function(){return this.cardsArr},r.getPourScoreArr=function(){return this.pourScoreArr},r.getGameRule=function(){return this.gameRule},r.getGameStatus=function(){return this.gameStatus},r.getShowCardArr=function(){return this.showCardArr},r.getCanPourScoreArr=function(){return this.canPourScoreArr},r.onDestroy=function(){Global.MessageCallback.removeListener("RoomMessagePush",this),Global.MessageCallback.removeListener("GameMessagePush",this)},r.getRoomId=function(){return this.roomId},r.getBankChairId=function(){return this.bankChairId},r.getAllChairId=function(){for(var e=[],t=0;t<this.userArr.length;++t)e.push(this.userArr[t].chairId);return e},r.getCurBureau=function(){return this.curBureau},r.getMaxBureau=function(){return this.gameRule.bureau},r.getChairCount=function(){return 5},r.getMyChairId=function(){return this.myChairId},r.getPlayerByChairId=function(e){for(var t=0;t<this.userArr.length;++t)if(this.userArr[t].chairId===e)return this.userArr[t];return null},r.addPlayer=function(e){e.userInfo.nickname=Global.Player.convertNickname(e.userInfo.nickname);for(var t=0;t<this.userArr.length;++t)this.userArr[t].chairId===e.chairId&&this.userArr.splice(t,1);this.userArr.push(e)},r.delPlayer=function(e){for(var t=0;t<this.userArr.length;++t)this.userArr[t].chairId===e.chairId&&this.userArr.splice(t,1)},r.getGameEnd=function(){return!!this.isGameEnd},r.setGameEnd=function(){this.isGameEnd=!0},r.setMyCardArr=function(e){this.cardArr=e},r.getMyCardArr=function(){return this.cardArr},r.recordGameStartChairId=function(){this.gameStartChairIdArr=[];for(var e=0;e<6;++e)this.getPlayerByChairId(e)&&this.gameStartChairIdArr.push(e)},r.getChairIdIndex=function(e){return this.gameStartChairIdArr.indexOf(e)},r.getChairIdByIndex=function(e){return e<0||e>=this.gameStartChairIdArr.length?null:this.gameStartChairIdArr[e]},cc._RF.pop()},{"../../API/RoomProto":"RoomProto","./NNProto":"NNProto"}],NNProto:[function(e,t,a){"use strict";cc._RF.push(t,"5a8683aPTVM9YfvITNJGtdI","NNProto");var r=t.exports;r.ROB_FREE_BANK_NOTIFY=301,r.ROB_FREE_BANK_PUSH=401,r.BANK_CHANGE_PUSH=402,r.CAN_POUR_SCORE_PUSH=403,r.POUR_SCORE_NOTIFY=304,r.POUR_SCORE_PUSH=404,r.RESOUT_CARD_PUSH=405,r.SHOW_CARD_NOTIFY=306,r.SHOW_CARD_PUSH=406,r.GAME_RESOUT_PUSH=407,r.FOUR_CARD_PUSH=408,r.ROB_RATE_BANK_NOTIFY=309,r.ROB_RATE_BANK_PUSH=409,r.FIFTH_CARD_PUSH=410,r.GAME_STATUS_PUSH=411,r.GAME_STATUS_PREPARE=1,r.GAME_STATUS_ROBBANK=2,r.GAME_STATUS_POURSCORE=3,r.GAME_STATUS_SORTCARD=4,r.GAME_STATUS_RESOUT=5,r.AUTO_SHOWCARD_TM=10,r.AUTO_READY_TM=8,r.AUTO_ROBBANK_TM=5,r.AUTO_POURGOLD_TM=7,r.getRobFreeBankNotifyData=function(e){return{type:this.ROB_FREE_BANK_NOTIFY,data:{isRob:e}}},r.getRobFreeBankPushData=function(e,t){return{type:this.ROB_FREE_BANK_PUSH,data:{chairId:e,isRob:t}}},r.getBankChangePushData=function(e,t,a){return{type:this.BANK_CHANGE_PUSH,data:{bankChairId:e,gameStatus:t,robBankArr:a}}},r.getCanPourScorePushData=function(e,t){return{type:this.CAN_POUR_SCORE_PUSH,data:{gameStatus:e,scoresArr:t}}},r.getPourScoreNotifyData=function(e){return{type:this.POUR_SCORE_NOTIFY,data:{score:e}}},r.getPourScorePushData=function(e,t){return{type:this.POUR_SCORE_PUSH,data:{chairId:e,score:t}}},r.getResoutCardPushData=function(e,t,a){return{type:this.RESOUT_CARD_PUSH,data:{chairId:e,cardArr:t,gameStatus:a}}},r.getShowCardNotifyData=function(){return{type:this.SHOW_CARD_NOTIFY,data:{}}},r.getShowCardPushData=function(e,t){return{type:this.SHOW_CARD_PUSH,data:{chairId:e,cardArr:t}}},r.getFourCardPushData=function(e){return{type:this.FOUR_CARD_PUSH,data:{cardArr:e}}},r.getRobRateBankNotifyData=function(e){return{type:this.ROB_RATE_BANK_NOTIFY,data:{rate:e}}},r.getRobRateBankPushData=function(e,t){return{type:this.ROB_RATE_BANK_PUSH,data:{chairId:e,rate:t}}},r.getFiveCardPushData=function(e){return{type:this.FIFTH_CARD_PUSH,data:{cardId:e}}},r.getGameResoutPushData=function(e){return{type:this.GAME_RESOUT_PUSH,data:{bankIndex:e.bankIndex,cardsArr:e.cardsArr,finalScoreArr:e.finalScoreArr}}},r.getGameStatusPushData=function(e){return{type:this.GAME_STATUS_PUSH,data:{gameStatus:e}}},cc._RF.pop()},{}],NNStateItem:[function(e,t,a){"use strict";cc._RF.push(t,"2be25e4UMtDE6sLo9HJfm+b","NNStateItem");var r=e("./NNProto"),i=e("./NNModel");cc.Class({extends:cc.Component,properties:{startGameNode:cc.Node,waitGameNode:cc.Node,clockNode:cc.Node,stateLabel:cc.Label,tickLabel:cc.Label,stateSprite:cc.Sprite},onLoad:function(){this.startGameNode.active=!1,this.waitGameNode.active=!1,this.clockNode.active=!1,Global.MessageCallback.addListener("GameMessagePush",this),this.waitGameNode.active=!this.getIsOnGame()},onDestroy:function(){Global.MessageCallback.removeListener("GameMessagePush",this)},playStartGameAnimal:function(){this.startGameNode.x=-1e3,this.startGameNode.active=!0;var e=this;this.startGameNode.runAction(cc.sequence(cc.moveTo(.3,cc.v2(0,0)).easing(cc.easeIn(3)),cc.delayTime(.5),cc.moveTo(.3,cc.v2(1e3,0)).easing(cc.easeIn(3)),cc.callFunc(function(){e.startGameNode.active=!1,e.clockNode.active=!0})))},getIsOnGame:function(){var e=i.getGameStatus(),t=i.getMyChairId(),a=i.getChairIdIndex(t),o=!0;return e!==r.GAME_STATUS_PREPARE&&a<0&&(o=!1),o},messageCallbackHandler:function(e,t){"GameMessagePush"===e&&t.type===r.GAME_STATUS_PUSH&&this.answerGameStatusPush(t.data.gameStatus)},answerGameStatusPush:function(e){var t,a;this.waitGameNode.active=!this.getIsOnGame(),this.clockNode.active=!0,this.unscheduleAllCallbacks(),e===r.GAME_STATUS_PREPARE?(t=r.AUTO_READY_TM,"\u6e38\u620f\u5373\u5c06\u5f00\u59cb",a="Niuniu/Common/jijiangkaishi",Global.CCHelper.updateSpriteFrame(a,this.stateSprite)):e===r.GAME_STATUS_ROBBANK?(t=r.AUTO_ROBBANK_TM,"\u8bf7\u62a2\u5e84",a="Niuniu/Common/qingqiangzhuang",Global.CCHelper.updateSpriteFrame(a,this.stateSprite)):e===r.GAME_STATUS_POURSCORE?(t=r.AUTO_POURGOLD_TM,"\u7b49\u5f85\u5176\u4ed6\u73a9\u5bb6\u6295\u6ce8",a="Niuniu/Common/qitawanjia",Global.CCHelper.updateSpriteFrame(a,this.stateSprite)):e===r.GAME_STATUS_SORTCARD?(t=r.AUTO_SHOWCARD_TM,"\u8bf7\u644a\u724c",a="Niuniu/Common/qingtanpai",Global.CCHelper.updateSpriteFrame(a,this.stateSprite)):e===r.GAME_STATUS_RESOUT&&(this.clockNode.active=!1);var i=this;i.tickLabel.string=t;this.schedule(function e(){--t,i.tickLabel.string=t,0===t&&(i.clockNode.active=!1,i.unschedule(e))},1),e===r.GAME_STATUS_ROBBANK&&(this.clockNode.active=!1,i.playStartGameAnimal())}}),cc._RF.pop()},{"./NNModel":"NNModel","./NNProto":"NNProto"}],NNWatchCardNode:[function(e,t,a){"use strict";cc._RF.push(t,"74635oJyyJCVpfoOWqmEyPd","NNWatchCardNode");var r=e("./NNModel"),i=e("./NNProto");cc.Class({extends:cc.Component,properties:{cardSprite:cc.Sprite,touchSprite:cc.Sprite,tScrollView:cc.ScrollView,bScrollView:cc.ScrollView,tContent:cc.Node,bContent:cc.Node},onLoad:function(){this.touchSprite.node.on(cc.Node.EventType.TOUCH_START,this.touchStart.bind(this)),this.touchSprite.node.on(cc.Node.EventType.TOUCH_MOVE,this.touchMove.bind(this)),this.touchSprite.node.on(cc.Node.EventType.TOUCH_END,this.touchEnd.bind(this)),this.touchSprite.node.on(cc.Node.EventType.TOUCH_CANCEL,this.touchEnd.bind(this)),this.homeScrollView(),Global.MessageCallback.addListener("GameMessagePush",this)},onDestroy:function(){Global.MessageCallback.removeListener("GameMessagePush",this)},offLineAndClient:function(){var e=r.getMyChairId(),t=r.getChairIdIndex(e);if(!(t<0)){var a=r.getGameStatus();if(this.homeScrollView(),a===i.GAME_STATUS_SORTCARD){var o=r.getShowCardArr(),n=r.getCardsArr()[t];1!==o[t]&&this.answerResoutCardPush(n)}}},messageCallbackHandler:function(e,t){"GameMessagePush"===e&&(t.type===i.RESOUT_CARD_PUSH?this.answerResoutCardPush(t.data.cardArr):t.type===i.SHOW_CARD_PUSH?this.answerShowCardPush(t.data.chairId):t.type===i.GAME_RESOUT_PUSH&&this.answerGameResoutPush())},answerResoutCardPush:function(e){var t=e[e.length-1];this.setCard(t)},answerShowCardPush:function(e){e===r.getMyChairId()&&(this.cardSprite.node.active=!1)},answerGameResoutPush:function(){this.cardSprite.node.active=!1},touchStart:function(e){this.startPos={},this.startPos.x=e.touch._point.x,this.startPos.y=e.touch._point.y,this.scrollDir=null},touchMove:function(e){var t=e.touch._point;if(null===this.scrollDir&&(Math.abs(t.x-this.startPos.x)>=Math.abs(t.y-this.startPos.y)?this.scrollDir="horizontal":this.scrollDir="vertical"),"horizontal"===this.scrollDir){var a=t.x-this.startPos.x;a>=146?a=146:a<=-146&&(a=-146),this.tScrollView.node.x=a,this.tContent.x=a,this.bScrollView.node.x=a,this.bContent.x=-a}else{var r=t.y-this.startPos.y;r>=204?r=204:r<=-204&&(r=-204),this.tScrollView.node.y=r,this.tContent.y=r,this.bScrollView.node.y=r,this.bContent.y=-r}},touchEnd:function(e){var t=e.touch._point;if(this.tScrollView.node.setPosition(cc.v2(0,0)),this.tContent.setPosition(cc.v2(0,0)),this.bScrollView.node.setPosition(cc.v2(0,0)),this.bContent.setPosition(cc.v2(0,0)),"horizontal"===this.scrollDir){var a=t.x-this.startPos.x;Math.abs(a)>=73&&(this.tScrollView.node.active=!1,this.bScrollView.node.active=!1,this.cardSprite.node.x=a,this.cardSprite.node.active=!0,this.touchSprite.node.active=!1,this.cardSprite.node.runAction(cc.moveTo(.2,cc.v2(0,0))),this.scheduleOnce(function(){Global.NetworkManager.notify("game.gameHandler.gameMessageNotify",i.getShowCardNotifyData())},.4))}else{var r=t.y-this.startPos.y;Math.abs(r)>=102&&(this.tScrollView.node.active=!1,this.bScrollView.node.active=!1,this.cardSprite.node.y=r,this.cardSprite.node.active=!0,this.touchSprite.node.active=!1,this.cardSprite.node.runAction(cc.moveTo(.2,cc.v2(0,0))),this.scheduleOnce(function(){Global.NetworkManager.notify("game.gameHandler.gameMessageNotify",i.getShowCardNotifyData())},.4))}this.scrollDir=null},setCard:function(e){for(var t="Niuniu/NNCards/"+e,a=["TSprite","BSprite","LSprite","RSprite"],r=0;r<a.length;++r){var i=this.tContent.getChildByName(a[r]);Global.CCHelper.updateSpriteFrame(t,i.getComponent(cc.Sprite))}Global.CCHelper.updateSpriteFrame(t,this.cardSprite),this.tScrollView.node.setPosition(cc.v2(0,0)),this.tContent.setPosition(cc.v2(0,0)),this.bScrollView.node.setPosition(cc.v2(0,0)),this.bContent.setPosition(cc.v2(0,0)),this.cardSprite.node.active=!1,this.tScrollView.node.active=!0,this.bScrollView.node.active=!0,this.touchSprite.node.active=!0},homeScrollView:function(){this.tScrollView.node.setPosition(cc.v2(0,0)),this.tContent.setPosition(cc.v2(0,0)),this.bScrollView.node.setPosition(cc.v2(0,0)),this.bContent.setPosition(cc.v2(0,0)),this.cardSprite.node.active=!1,this.tScrollView.node.active=!1,this.bScrollView.node.active=!1,this.touchSprite.node.active=!1}}),cc._RF.pop()},{"./NNModel":"NNModel","./NNProto":"NNProto"}],NetworkLogic:[function(e,t,a){"use strict";cc._RF.push(t,"11636g1K+9APLDIVDEV21zV","NetworkLogic");var r=e("./NetworkManager"),i=e("./MessageCallback"),o=e("./DialogManager"),n=e("./Constant"),s=e("./utils"),c=e("./code"),l=t.exports;l.isManualCloseServerConnection=!1,l.init=function(){l.isManualCloseServerConnection=!1,i.addListener("ServerDisconnection",this),i.addListener("ServerMessagePush",this),i.addListener("PopDialogContentPush",this),r.removeAllListeners(),r.addReceiveListen("close","ServerDisconnection"),r.addReceiveListen("ServerMessagePush","ServerMessagePush")},l.deInit=function(){i.removeListener("ServerDisconnection",this),i.removeListener("ServerMessagePush",this),i.removeListener("PopDialogContentPush",this)},l.connectToServer=function(e,t,a){r.init({host:e,port:t},a)},l.disconnect=function(e){l.isManualCloseServerConnection=!e,r.disconnect()},l.login=function(e,t,a){Global.API.account.login(e.account,e.password,e.loginPlatform,function(e){l.connectToServer(e.msg.serverInfo.host,e.msg.serverInfo.port,function(){l.loginHall(e.msg.token,null,t)})},a)},l.register=function(e,t,a,r){Global.API.account.register(e.account,e.password,e.loginPlatform,e.smsCode,function(e){l.connectToServer(e.msg.serverInfo.host,e.msg.serverInfo.port,function(){l.loginHall(e.msg.token,t,a)})},r)},l.loginHall=function(e,t,a){Global.API.hall.entry(e,t,function(e){Global.Data.init(e.msg.publicParameter),Global.Player.init(e.msg.userInfo),Global.GameTypes.init(e.msg.gameTypes),Global.AgentProfit.init(e.msg.agentProfit),Global.DialogManager.removeLoadingCircle(),s.invokeCallback(a,e),Global.MessageCallback.emitMessage("ReConnectSuccess")},function(){l.disconnect(!1),Global.DialogManager.addPopDialog("\u8fdb\u5165\u5927\u5385\u5931\u8d25")})},l.reconnection=function(e){var t=cc.sys.localStorage.getItem("account"),a=cc.sys.localStorage.getItem("password"),r=parseInt(cc.sys.localStorage.getItem("platform"));t&&a&&r?l.login({account:t,password:a,loginPlatform:r},function(t){s.invokeCallback(e,t)},function(){s.invokeCallback(e,{code:1})}):o.addPopDialog("\u4e0e\u670d\u52a1\u5668\u65ad\u5f00\u8fde\u63a5\uff0c\u8bf7\u91cd\u65b0\u767b\u5f55",function(){cc.game.restart()})},l.messageCallbackHandler=function(e,t){if("PopDialogContentPush"===e)Global.Code[t.code]?Global.DialogManager.addPopDialog(Global.Code[t.code]):Global.DialogManager.addPopDialog("\u6e38\u620f\u9519\u8bef\uff0c\u9519\u8bef\u7801\uff1a"+t.code);else if("PopDialogTextPush"===e)Global.DialogManager.addPopDialog(t.text);else if("ServerMessagePush"===e){if(!t.pushRouter)return void console.error("ServerMessagePush push router is invalid:"+t);i.emitMessage(t.pushRouter,t)}else"ServerDisconnection"===e&&(l.isManualCloseServerConnection?l.isManualCloseServerConnection=!1:(Global.DialogManager.addLoadingCircle(),setTimeout(function(){l.reconnection(function(e){e&&0===e.code?l.isManualCloseServerConnection=!1:o.addPopDialog("\u4e0e\u670d\u52a1\u5668\u65ad\u5f00\u8fde\u63a5\uff0c\u8bf7\u91cd\u65b0\u767b\u5f55",function(){cc.game.restart()})})},2e3)))},l.gameServerHttpRequest=function(e,t,a,r,i){var o={url:n.gameServerAddress+e,method:t,data:a,cb:function(e,t){e?i?s.invokeCallback(i):(Global.DialogManager.removeLoadingCircle(),Global.DialogManager.addPopDialog("\u7f51\u7edc\u5f02\u5e38\uff0c\u8bf7\u68c0\u67e5\u7f51\u7edc\u8fde\u63a5")):0!==t.code?i?s.invokeCallback(i,t):(Global.DialogManager.removeLoadingCircle(),Global.DialogManager.addPopDialog(c[t.code]+"")):s.invokeCallback(r,t)}};Global.CCHelper.httpRequest(o)},cc._RF.pop()},{"./Constant":"Constant","./DialogManager":"DialogManager","./MessageCallback":"MessageCallback","./NetworkManager":"NetworkManager","./code":"code","./utils":"utils"}],NetworkManager:[function(e,t,a){"use strict";cc._RF.push(t,"f1c98DIYBFJlrbIZWWIOkAM","NetworkManager");var r=e("./MessageCallback"),i=window.pomelo,o=t.exports={};o.init=function(e,t){i.init({host:e.host,port:e.port,log:!0},t)},o.disconnect=function(){i.disconnect()},o.request=function(e,t,a,o){console.log("Send:"+e),console.log(t),i.request(e,t,function(t){if(console.log("Receive:"+("string"==typeof a?a:e)),console.log(t),t.code!==Global.Code.OK){if(Global.DialogManager.removeLoadingCircle(),o&&"function"==typeof o)return void o(t);Global.Code[t.code]?Global.DialogManager.addPopDialog(Global.Code[t.code]):Global.DialogManager.addPopDialog("\u6e38\u620f\u9519\u8bef\uff0c\u9519\u8bef\u7801\uff1a"+t.code)}else a&&("function"==typeof a?a(t):r.emitMessage(a,t))})},o.send=function(e,t,a,r){this.request(e,t,a,r)},o.notify=function(e,t){console.log("Notify:"+e),console.log(t),i.notify(e,t)},o.addReceiveListen=function(e,t){t=t||e;var a=function(e){t&&(console.log("push:"+t),console.log(e),r.emitMessage(t,e))};return i.on(e,a),a},o.removeListener=function(e,t){i.removeListener(e,t)},o.removeAllListeners=function(){i.removeAllListeners()},cc._RF.pop()},{"./MessageCallback":"MessageCallback"}],NoticeDetailDialog:[function(e,t,a){"use strict";cc._RF.push(t,"7c815TrFIZLfp52jnjfFses","NoticeDetailDialog"),cc.Class({extends:cc.Component,properties:{titleText:cc.Label,desText:cc.Label},start:function(){var e=this.dialogParameters.data;this.titleText.string=e.title,this.desText.string=e.content},onBtnClk:function(e,t){switch(t){case"close":Global.DialogManager.destroyDialog(this)}}}),cc._RF.pop()},{}],NoticeDialog:[function(e,t,a){"use strict";cc._RF.push(t,"7a54dYJn7VIxJgZSy9fvkuG","NoticeDialog"),cc.Class({extends:cc.Component,properties:{content:cc.Label},start:function(){},onBtnClk:function(e,t){switch(t){case"bind":break;case"close":Global.DialogManager.destroyDialog(this)}}}),cc._RF.pop()},{}],NoticeListDialog:[function(e,t,a){"use strict";cc._RF.push(t,"1ab2btItEJNoaBfrIiOj2sd","NoticeListDialog"),cc.Class({extends:cc.Component,properties:{listItem:cc.Prefab,content:cc.Node,noticeListRedPoint:cc.Node},updatePlayerInfo:function(){this.noticeListRedPoint.active=0!==Global.Player.checkUnRead()},start:function(){for(var e=Global.Player.getPy("emailArr"),t=(e=e&&e.length>0?JSON.parse(e):[]).length-1;t>=0;t--){var a=e[t],r=cc.instantiate(this.listItem);r.parent=this.content,r.getComponent("NoticeListItem").updateUI(a)}this.updatePlayerInfo(),Global.MessageCallback.addListener("UpdateUserInfoUI",this)},onDestroy:function(){Global.MessageCallback.removeListener("UpdateUserInfoUI",this)},messageCallbackHandler:function(e,t){switch(e){case"UpdateUserInfoUI":this.updatePlayerInfo()}},onBtnClk:function(e,t){switch(t){case"close":Global.DialogManager.destroyDialog(this)}}}),cc._RF.pop()},{}],NoticeListItem:[function(e,t,a){"use strict";cc._RF.push(t,"95ac7vs9KRPiZlQAngvAWWG","NoticeListItem"),cc.Class({extends:cc.Component,properties:{title:cc.Label,time:cc.Label,redPoint:cc.Node},start:function(){},onBtnClk:function(e,t){switch(t){case"read":Global.DialogManager.createDialog("Notice/NoticeDetailDialog",{data:this.data}),Global.API.hall.readEmailRequest(this.data.id,function(e){this.redPoint.active=!1,Global.Player.setMailRead(this.data.id),Global.MessageCallback.emitMessage("UpdateUserInfoUI",{})}.bind(this))}},updateUI:function(e){this.data=e,this.title.string=e.title,e.title.length>7&&(this.title.string=e.title.substr(0,12)+"..."),this.time.string=new Date(e.createTime).format("yyyy/MM/dd"),this.redPoint.active=!this.data.isRead}}),cc._RF.pop()},{}],PDKAnalyseOutCard:[function(e,t,a){"use strict";cc._RF.push(t,"fd398+CxhJBJrMmwfr2gf6s","PDKAnalyseOutCard");var r=e("./PDKGameLogic"),i=e("./PDKProto"),o=t.exports;o.getAllSingleCard=function(e){for(var t=r.sortCardList(e.slice()),a=e.length,i=[],o=0;o<a;o++){for(var n=1,s=r.getCardLogicValue(t[o]),c=o+1;c<a&&r.getCardLogicValue(t[c])===s&&!(++n>1);c++);1===n&&i.push(t[o]),o+=n-1}return i},o.getAllDoubleCard=function(e){for(var t=r.sortCardList(e.slice()),a=e.length,i=[],o=0;o<a;o++){for(var n=1,s=r.getCardLogicValue(t[o]),c=o+1;c<a&&r.getCardLogicValue(t[c])===s;++c)n++;n>=2&&(i.push(t[o]),i.push(t[o+1])),o+=n-1}return i},o.getAllThreeCard=function(e){for(var t=r.sortCardList(e.slice()),a=e.length,i=[],o=0;o<a-2;o++){for(var n=1,s=r.getCardLogicValue(t[o]),c=o+1;c<=o+3&&c<a&&r.getCardLogicValue(t[c])===s;c++)n++;n>=3&&(i.push(t[o]),i.push(t[o+1]),i.push(t[o+2])),o+=n-1}return i},o.getAllLineCard=function(e){var t=e.length,a=r.sortCardList(e.slice()),i=[];if(t<5)return i;for(var o=0,n=0;n<t;++n)if(r.getCardLogicValue(a[n])<15){o=n;break}for(var s=[],c=!0;a.length+o>=5&&c;){c=!1,s=[a[o]];for(var l=a[o],d=o+1;d<a.length;d++){var h=a[d],u=r.getCardLogicValue(l)-r.getCardLogicValue(h);if(u>0)if(l=h,u>1){if(!(s.length<5))break;s=[l]}else s.push(l)}s.length>=5&&(r.removeCard(s,a),i=i.concat(s),c=!0)}return i},o.getAllBombCard=function(e){var t=e.length,a=r.sortCardList(e.slice()),i=[];if(e.length<4)return i;for(var o=0;o<t-3;o++){for(var n=1,s=r.getCardLogicValue(a[o]),c=o+1;c<=o+3&&c<t&&r.getCardLogicValue(a[c])===s;c++)n++;4===n&&(i.push(a[o]),i.push(a[o+1]),i.push(a[o+2]),i.push(a[o+3]))}return i},o.getAllSingleCardType=function(e,t){for(var a={cardType:i.cardType.SINGLE,cardTypeCount:0,cardDataArr:[],eachHandCardCount:[]},o=e.length,n=0;n<o;++n)if(!(t&&t.length>0&&r.getCardLogicValue(e[n])<=r.getCardLogicValue(t[0]))){var s=a.cardTypeCount;a.cardDataArr[s]=[],a.cardType=i.cardType.SINGLE,a.cardDataArr[s][0]=e[n],a.eachHandCardCount[s]=1,a.cardTypeCount++}return a},o.getAllDoubleCardType=function(e,t){for(var a={cardType:i.cardType.DOUBLE,cardTypeCount:0,cardDataArr:[],eachHandCardCount:[]},o=this.getAllDoubleCard(e),n=0;n<o.length;n+=2)if(!(t&&t.length>0&&r.getCardLogicValue(o[n])<=r.getCardLogicValue(t[0]))){var s=a.cardTypeCount;a.cardDataArr[s]=[],a.cardType=i.cardType.DOUBLE,a.cardDataArr[s][0]=o[n],a.cardDataArr[s][1]=o[n+1],a.eachHandCardCount[s]=2,a.cardTypeCount++}return a},o.getAllThreeCardType=function(e,t){for(var a={cardType:i.cardType.THREE,cardTypeCount:0,cardDataArr:[],eachHandCardCount:[]},o=this.getAllThreeCard(e),n=0;n<o.length;n+=3)if(!(t&&t.length>0&&r.getCardLogicValue(o[n])<=r.getCardLogicValue(t[0]))){var s=a.cardTypeCount;a.cardDataArr[s]=[],a.cardType=i.cardType.THREE,a.cardDataArr[s][0]=o[n],a.cardDataArr[s][1]=o[n+1],a.cardDataArr[s][2]=o[n+2],a.eachHandCardCount[s]=3,a.cardTypeCount++}return a},o.getAllLineCardType=function(e,t){for(var a={cardType:i.cardType.SINGLE_LINE,cardTypeCount:0,cardDataArr:[],eachHandCardCount:[]},o=t?r.getCardLogicValue(t[0]):0,n=e.slice(),s=n.length,c=0,l=0;l<s;++l)if(r.getCardLogicValue(n[l])<15){c=l;break}for(var d=[],h=s,u=!0;h+c>=5&&u;){u=!1;var g=n[c];d=[g];for(var C=c+1;C<h;C++){var p=n[C],f=r.getCardLogicValue(g)-r.getCardLogicValue(p);if(0!==f)if(g=n[C],1!==f){if(!(d.length<5))break;d=[g]}else d.push(g)}if(d.length>=5&&(!t||t.length<=d.length)){for(var m=void 0,A=5,b=0;A<=d.length;){if(t&&t.length>0){if(A!==t.length){++b+A>d.length&&(b=0,A++);continue}if(r.getCardLogicValue(d[b])<=o){b=0,A++;continue}}m=a.cardTypeCount,a.cardDataArr[m]||(a.cardDataArr[m]=[]),a.cardType=i.cardType.SINGLE_LINE,a.cardDataArr[m]=d.slice(b,b+A),a.eachHandCardCount[m]=A,a.cardTypeCount++,++b+A>d.length&&(b=0,A++)}r.removeCard(d,n),h-=d.length,u=!0}}return a},o.getAllDoubleLineCardType=function(e,t){for(var a={cardType:i.cardType.DOUBLE_LINE,cardTypeCount:0,cardDataArr:[],eachHandCardCount:[]},o=t?r.getCardLogicValue(t[0]):0,n=e.slice(),s=n.length,c=!0,l=0,d=[];s>=4&&c;){var h=n[0],u=1;l=0,c=!1;for(var g=1;g<s;++g){for(;r.getCardLogicValue(h)===r.getCardLogicValue(n[g])&&g<s;)++u,++g;var C=0;if(l>0&&(C=r.getCardLogicValue(d[l-1])),(u<2||l>0&&C-r.getCardLogicValue(h)!=1)&&g<=s){if(l>=4)break;u>=2&&(g-=u),h=n[g],l=0}else if(u>=2&&(d[l]=n[g-u],d[l+1]=n[g-u+1],l+=2,g===s-2&&r.getCardLogicValue(h)-r.getCardLogicValue(n[g])==1&&r.getCardLogicValue(n[g])===r.getCardLogicValue(n[g+1]))){d[l]=n[g],d[l+1]=n[g+1],l+=2;break}h=n[g],u=1}if(l>=4){for(var p=void 0,f=4,m=0;f<=l;){if(t&&t.length>0){if(f!==t.length){(m+=2)+f>l&&(m=0,f+=2);continue}if(r.getCardLogicValue(d[m])<=o){m=0,f+=2;continue}}p=a.cardTypeCount,a.cardDataArr[p]||(a.cardDataArr[p]=[]),a.cardType=i.cardType.DOUBLE_LINE,a.cardDataArr[p]=d.slice(m,m+f),a.eachHandCardCount[p]=f,a.cardTypeCount++,(m+=2)+f>l&&(m=0,f+=2)}r.removeCard(d,n),c=!0,s-=l}}return a},o.getAllThreeLineCardType=function(e,t){for(var a={cardType:i.cardType.THREE_LINE,cardTypeCount:0,cardDataArr:[],eachHandCardCount:[]},o=t?r.getCardLogicValue(t[0]):0,n=e.slice(),s=n.length,c=0,l=0;l<s;++l)if(r.getCardLogicValue(n[l])<15){c=l;break}for(var d=s-c,h=!0,u=0,g=[];d>=6&&h;){var C=n[c],p=1;u=0,h=!1;for(var f=c+1;f<d+c;++f){for(;r.getCardLogicValue(C)===r.getCardLogicValue(n[f])&&f<d+c;)++p,++f;var m=void 0;if(u>0&&(m=r.getCardLogicValue(g[u-1])),(p<3||u>0&&m-r.getCardLogicValue(C)!=1)&&f<=d+c){if(u>=6)break;p>=3&&(f-=p),C=n[f],u=0}else if(p>=3&&(g[u]=n[f-p],g[u+1]=n[f-p+1],g[u+2]=n[f-p+2],u+=3,f===d+c-3&&r.getCardLogicValue(C)-r.getCardLogicValue(n[f])==1&&r.getCardLogicValue(n[f])===r.getCardLogicValue(n[f+1])&&r.getCardLogicValue(n[f])===r.getCardLogicValue(n[f+2]))){g[u]=n[f],g[u+1]=n[f+1],g[u+2]=n[f+2],u+=3;break}C=n[f],p=1}if(u>=6){for(var A=void 0,b=6,y=0;b<=u;){if(t&&t.length>0){if(b!==t.length){(y+=3)+b>u&&(y=0,b+=3);continue}if(r.getCardLogicValue(g[y])<=o){y=0,b+=3;continue}}A=a.cardTypeCount,a.cardDataArr[A]||(a.cardDataArr[A]=[]),a.cardType=i.cardType.THREE_LINE,a.cardDataArr[A]=g.slice(y,y+b),a.eachHandCardCount[A]=b,a.cardTypeCount++,(y+=3)+b>u&&(y=0,b+=3)}r.removeCard(g,n),h=!0,d-=u}}return a},o.getAllThreeLineTakeOneCardType=function(e,t){var a={cardType:i.cardType.THREE_LINE_TAKE_ONE,cardTypeCount:0,cardDataArr:[],eachHandCardCount:[]},o=0,n=void 0;t&&(n=this.getAllThreeCard(t),o=r.getCardLogicValue(n[0]));var s=e.slice(),c=this.getAllBombCard(s);r.removeCard(c,s);var l=this.getAllThreeCard(s),d=l.length;if(!t||4===t.length){var h=void 0,u=s.slice();r.removeCard(l,u);for(var g=u.length,C=0;C<d;C+=3)if(!(t&&r.getCardLogicValue(l[C])<=o))for(var p=0;p<g;++p)h=a.cardTypeCount,a.cardDataArr[h]||(a.cardDataArr[h]=[]),a.cbCardType=i.cardType.THREE_LINE_TAKE_ONE,a.cardDataArr[h][0]=l[C],a.cardDataArr[h][1]=l[C+1],a.cardDataArr[h][2]=l[C+2],a.cardDataArr[h][3]=u[p],a.eachHandCardCount[h]=4,a.cardTypeCount++}var f=d,m=!0,A=0;for(15===r.getCardLogicValue(l[0])&&(A=3);f+A>=6&&m;){var b=r.getCardLogicValue(l[A]),y=[],T=3;y[0]=l[A],y[1]=l[A+1],y[2]=l[A+2],m=!1;for(var S=3+A;S<f;S+=3){if(1!=b-r.getCardLogicValue(l[S])){A=S,f-S>=6&&(m=!0);break}b=r.getCardLogicValue(l[S]),y[T]=l[S],y[T+1]=l[S+1],y[T+2]=l[S+2],T+=3}if(T>3){var v=void 0,N=s.slice();r.removeCard(l,N);for(var D=N.length,I=0;I<T-3;I+=3){var R=T-I;if(!n||!(R!==n.length||r.getCardLogicValue(y[0])<=o)){var _=R/3;if(!(D<_)){var G=[];this.combination([],0,G,N,_,_);for(var P=G.length,L=0;L<P;++L){v=a.cardTypeCount,a.cardDataArr[v]||(a.cardDataArr[v]=[]),a.cardType=i.cardType.THREE_LINE_TAKE_ONE;var E=y.slice(I,T);a.cardDataArr[v]=E,a.cardDataArr[v]=E.concat(G[L].slice(0,_)),a.eachHandCardCount[v]=R+_,a.cardTypeCount++}}}}m=!0,r.removeCard(y,l),f-=T}}return a},o.getAllThreeLineTakeTwoCardType=function(e,t){var a={cardType:i.cardType.THREE_LINE_TAKE_TWO,cardTypeCount:0,cardDataArr:[],eachHandCardCount:[]},o=e.slice(),n=0,s=void 0;t&&(s=this.getAllThreeCard(t),n=r.getCardLogicValue(s[0]));var c=this.getAllThreeCard(o),l=c.length,d=o.slice();r.removeCard(c,d);var h=d.length,u=this.getAllDoubleCard(d),g=u.length;if(!t||5===t.length)for(var C=0;C<l;C+=3){var p=void 0;if(!t||!r.getCardLogicValue(c[C]<=n))for(var f=0;f<g;f+=2)p=a.cardTypeCount,a.cardDataArr[p]||(a.cardDataArr[p]=[]),a.cardType=i.cardType.THREE_LINE_TAKE_TWO,a.cardDataArr[p][0]=c[C],a.cardDataArr[p][1]=c[C+1],a.cardDataArr[p][2]=c[C+2],a.cardDataArr[p][3]=u[f],a.cardDataArr[p][4]=u[f+1],a.eachHandCardCount[p]=5,a.cardTypeCount++}var m=l,A=!0,b=0;for(15===r.getCardLogicValue(c[0])&&(b=3);m>=6&&A;){var y=r.getCardLogicValue(c[b]),T=[],S=3;T[0]=c[b],T[1]=c[b+1],T[2]=c[b+2],A=!1;for(var v=3+b;v<m;v+=3){if(1!=y-r.getCardLogicValue(c[v])){b=v,m-v>=6&&(A=!0);break}y=r.getCardLogicValue(c[v]),T[S]=c[v],T[S+1]=c[v+1],T[S+2]=c[v+2],S+=3}if(S>3){for(var N=void 0,D=0;D<S-3;D+=3){var I=S-D;if(t){if(I!==s.length)continue;if(r.getCardLogicValue(T[D])<=n)break}var R=I/3;if(!(h<R)){for(var _=[],G=0,P=0;G<g;G+=2,++P)_[P]=G;var L=[];this.combination([],0,L,_,R,R);for(var E=L.length,M=0;M<E;++M){N=a.cardTypeCount,a.cardDataArr[N]||(a.cardDataArr[N]=[]),a.cardType=i.cardType.THREE_LINE_TAKE_TWO,a.cardDataArr[N]=T.slice(D,S);for(var U=0,B=0;U<R;++U,B+=2)a.cardDataArr[N][I+B]=u[L[M][U]],a.cardDataArr[N][I+B+1]=u[L[M][U]+1];a.eachHandCardCount[N]=I+2*R,a.cardTypeCount++}}}A=!0,r.removeCard(T,c),m-=S}}return a},o.getAllBombCardType=function(e,t){for(var a={cardType:i.cardType.BOMB_CARD,cardTypeCount:0,cardDataArr:[],eachHandCardCount:[]},o=this.getAllBombCard(e),n=0;n<o.length;n+=4)if(!(t&&t.length>0&&r.getCardLogicValue(o[n])<=r.getCardLogicValue(t[0]))){var s=a.cardTypeCount;a.cardDataArr[s]||(a.cardDataArr[s]=[]),a.cardType=i.cardType.BOMB_CARD,a.cardDataArr[s][0]=o[n],a.cardDataArr[s][1]=o[n+1],a.cardDataArr[s][2]=o[n+2],a.cardDataArr[s][3]=o[n+3],a.eachHandCardCount[s]=4,a.cardTypeCount++}return a},o.analyseOutCardTypeActive=function(e,t){for(var a=0;a<=12;++a)t.push({cardTypeCount:0,cardDataArr:[],eachHandCardCount:[],cardType:a});t[i.cardType.SINGLE]=this.getAllSingleCardType(e),t[i.cardType.DOUBLE]=this.getAllDoubleCardType(e),t[i.cardType.BOMB_CARD]=this.getAllBombCardType(e),t[i.cardType.SINGLE_LINE]=this.getAllLineCardType(e),t[i.cardType.DOUBLE_LINE]=this.getAllDoubleLineCardType(e),t[i.cardType.THREE_LINE]=this.getAllThreeLineCardType(e),t[i.cardType.THREE_LINE_TAKE_ONE]=this.getAllThreeLineTakeOneCardType(e),t[i.cardType.THREE_LINE_TAKE_TWO]=this.getAllThreeLineTakeTwoCardType(e)},cc._RF.pop()},{"./PDKGameLogic":"PDKGameLogic","./PDKProto":"PDKProto"}],PDKClockWidgetCtrl:[function(e,t,a){"use strict";cc._RF.push(t,"694a65cPoxB7Lj0jVWJ+t9p","PDKClockWidgetCtrl"),cc.Class({extends:cc.Component,properties:{clockTime:cc.Label},onLoad:function(){},startClock:function(e,t){this.unscheduleAllCallbacks(),this.curTime=e,this.callback=t,this.clockTime.string=this.curTime.toString(),this.schedule(this.updateClock.bind(this),1)},stopClock:function(){this.unscheduleAllCallbacks()},updateClock:function(){this.curTime--,this.curTime<0?(this.unscheduleAllCallbacks(),Global.Utils.invokeCallback(this.callback)):(this.clockTime.string=this.curTime.toString(),5===this.curTime&&Global.AudioManager.playSound("Game/PaoDeKuai/Sound/sound_remind"))},setClockEnd:function(){this.curTime=0}}),cc._RF.pop()},{}],PDKGameLogic:[function(e,t,a){"use strict";cc._RF.push(t,"e5524QtO9ZMlJ7Hkxc3C30N","PDKGameLogic");var r=t.exports,i=e("./PDKProto");r.CARD_DATA_ARRAY=[1,2,3,4,5,6,7,8,9,10,11,12,13,17,19,20,21,22,23,24,25,26,27,28,29,33,35,36,37,38,39,40,41,42,43,44,45,51,52,53,54,55,56,57,58,59,60,61];r.getCardValue=function(e){return 15&e},r.getCardColor=function(e){return 240&e},r.getCardLogicValue=function(e){var t=this.getCardValue(e);return t<=0||t>15?0:t<=2?t+13:t},r.getCardLogicValueArr=function(e){for(var t=[],a=0;a<e.length;++a)t.push(r.getCardLogicValue(e[a]));return t},r.isFirstOut=function(e){for(var t=0;t<e.length;++t)if(3===e[t])return!0;return!1},r.getRandCardList=function(){var e=this.CARD_DATA_ARRAY.slice(),t=[],a=e.length,r=0,i=0;do{i=Math.floor(Math.random()*(a-r)),t[r++]=e[i],e[i]=e[a-r]}while(r<a);return t},r.sortCardList=function(e,t){if(!e||e.length<=1)return e;for(var a=e.length,r=[],i=0;i<e.length;i++)r[i]=this.getCardLogicValue(e[i]);for(var o=0;o<a;++o)for(var n=r[o],s=e[o],c=o+1;c<a;++c)(r[c]>n||n===r[c]&&e[c]>s)&&(r[o]=r[c],r[c]=n,n=r[o],e[o]=e[c],e[c]=s,s=e[o]);if(t){var l=this.analyseCardDataArr(e);e=(e=(e=(e=(e=[]).concat(l.fourCardData)).concat(l.threeCardData)).concat(l.doubleCardData)).concat(l.singleCardData)}return e},r.getCardType=function(e){if(!e)return i.cardType.ERROR;var t=e.length;switch(t){case 0:return i.cardType.ERROR;case 1:return i.cardType.SINGLE;case 2:return this.getCardLogicValue(e[0])===this.getCardLogicValue(e[1])?i.cardType.DOUBLE:i.cardType.ERROR}var a=this.analyseCardDataArr(e);if(!a)return i.cardType.ERROR;if(a.fourCardData.length>0)return 4===a.fourCardData.length&&4===t?i.cardType.BOMB_CARD:4===a.fourCardData.length&&t>=5&&t<=8?i.cardType.FOUR_LINE_TAKE_X:i.cardType.ERROR;if(a.threeCardData.length>0){var r=a.threeCardData.length/3;if(r>1){var o=a.threeCardData[0],n=this.getCardLogicValue(o);if(n>=15)return i.cardType.ERROR;for(var s=1;s<r;s++){var c=a.threeCardData[3*s];if(n!==this.getCardLogicValue(c)+s)return i.cardType.ERROR}}return 3*r===t?i.cardType.THREE_LINE:4*r===t?i.cardType.THREE_LINE_TAKE_ONE:5*r===t?i.cardType.THREE_LINE_TAKE_TWO:i.cardType.ERROR}if(a.doubleCardData.length/2>=2){var l=a.doubleCardData.length/2,d=a.doubleCardData[0],h=this.getCardLogicValue(d);if(h>=15)return i.cardType.ERROR;for(var u=1;u<l;u++){var g=a.doubleCardData[2*u];if(h!==this.getCardLogicValue(g)+u)return i.cardType.ERROR}return 2*l===t?i.cardType.DOUBLE_LINE:i.cardType.ERROR}if(a.singleCardData.length>=5&&a.singleCardData.length===t){var C=a.singleCardData[0],p=this.getCardLogicValue(C);if(p>=15)return i.cardType.ERROR;for(var f=1;f<a.singleCardData.length;f++){var m=a.singleCardData[f];if(p!==this.getCardLogicValue(m)+f)return i.cardType.ERROR}return i.cardType.SINGLE_LINE}return i.cardType.ERROR},r.analyseCardDataArr=function(e){for(var t=e.length,a={fourCardData:[],threeCardData:[],doubleCardData:[],singleCardData:[]},r=0;r<t;r++){var i=1,o=this.getCardLogicValue(e[r]);if(o<=0)return null;for(var n=r+1;n<t&&this.getCardLogicValue(e[n])===o;n++)i++;switch(i){case 1:a.singleCardData.push(e[r]);break;case 2:a.doubleCardData.push(e[r]),a.doubleCardData.push(e[r+1]);break;case 3:a.threeCardData.push(e[r]),a.threeCardData.push(e[r+1]),a.threeCardData.push(e[r+2]);break;case 4:a.fourCardData.push(e[r]),a.fourCardData.push(e[r+1]),a.fourCardData.push(e[r+2]),a.fourCardData.push(e[r+3])}r+=i-1}return a},r.compareCard=function(e,t){var a=this.getCardType(t);if(a===i.cardType.ERROR)return!1;var r=this.getCardType(e);if(r!==i.cardType.BOMB_CARD&&a===i.cardType.BOMB_CARD)return!0;if(r===i.cardType.BOMB_CARD&&a!==i.cardType.BOMB_CARD)return!1;if(r!==a||e.length!==t.length)return!1;switch(a){case i.cardType.SINGLE:case i.cardType.DOUBLE:case i.cardType.SINGLE_LINE:case i.cardType.DOUBLE_LINE:case i.cardType.THREE_LINE:case i.cardType.BOMB_CARD:return this.getCardLogicValue(t[0])>this.getCardLogicValue(e[0]);case i.cardType.THREE_LINE_TAKE_ONE:case i.cardType.THREE_LINE_TAKE_TWO:var o=this.analyseCardDataArr(t),n=this.analyseCardDataArr(e);return this.getCardLogicValue(o.threeCardData[0])>this.getCardLogicValue(n.threeCardData[0]);case i.cardType.FOUR_LINE_TAKE_X:var s=this.analyseCardDataArr(t),c=this.analyseCardDataArr(e);return this.getCardLogicValue(s.fourCardData[0])>this.getCardLogicValue(c.fourCardData[0])}return!1},r.removeCard=function(e,t){if(e.length>t.length)return!1;for(var a=t.slice(),r=0,i=0;i<e.length;i++)for(var o=0;o<t.length;o++)if(e[i]===a[o]){a[o]=0,r++;break}if(r!==e.length)return!1;for(var n=0,s=0;s<a.length;++s)0!==a[s]&&(t[n++]=a[s]);return t.splice(n,t.length-n),!0},r.removeCardByValue=function(e,t){if(e.length>t.length)return!1;for(var a=t.slice(),r=0,i=0;i<e.length;i++){for(var o=!1,n=0;n<t.length;n++)e[i]===this.getCardLogicValue(a[n])&&(a[n]=0,o=!0);o&&r++}if(r!==e.length)return!1;for(var s=0,c=0;c<a.length;++c)0!==a[c]&&(t[s++]=a[c]);return t.splice(s,t.length-s),!0},r.searchOutCard=function(e,t){var a=[],r=e.slice(),o=e.length;r=this.sortCardList(r);var n=t.length,s=this.getCardType(t);switch(s){case i.cardType.ERROR:return a;case i.cardType.SINGLE:case i.cardType.DOUBLE:var c=this.getCardLogicValue(t[0]),l=this.analyseCardDataArr(r);if(n<=1)for(var d=0;d<l.singleCardData.length;d++){var h=l.singleCardData.length-d-1;if(this.getCardLogicValue(l.singleCardData[h])>c)return a.push(l.singleCardData[h]),a}if(n<=2)for(var u=0;u<l.doubleCardData.length;u++){var g=2*(l.doubleCardData.length/2-u-1);if(this.getCardLogicValue(l.doubleCardData[g])>c)return a=l.doubleCardData.slice(g,g+n)}if(n<=3)for(var C=0;C<l.threeCardData.length;C++){var p=3*(l.threeCardData.length/3-C-1);if(this.getCardLogicValue(l.threeCardData[p])>c)return a=l.threeCardData.slice(p,p+n)}break;case i.cardType.SINGLE_LINE:if(o<n)break;for(var f=this.getCardLogicValue(t[0]),m=n-1;m<o;m++){var A=this.getCardLogicValue(r[o-m-1]);if(A>=15)break;if(!(A<=f))for(var b=0,y=o-m-1;y<o;y++)if(this.getCardLogicValue(r[y])+b===A&&(a[b++]=r[y],b===n))return a}break;case i.cardType.DOUBLE_LINE:if(o<n)break;for(var T=this.getCardLogicValue(t[0]),S=n-1;S<o;S++){var v=this.getCardLogicValue(r[o-S-1]);if(!(v<=T)){if(v>=15)break;for(var N=0,D=o-S-1;D<o-1;D++)if(this.getCardLogicValue(r[D])+N===v&&this.getCardLogicValue(r[D+1])+N===v&&(a[2*N]=r[D],a[2*N+1]=r[D+1],2*++N===n))return a}}break;case i.cardType.THREE_LINE:case i.cardType.THREE_LINE_TAKE_ONE:case i.cardType.THREE_LINE_TAKE_TWO:if(o<n)break;for(var I=0,R=0;R<n-2&&(I=this.getCardLogicValue(t[R]),this.getCardLogicValue(t[R+1])!==I||this.getCardLogicValue(t[R+2])!==I);R++);for(var _=0,G=3*(_=s===i.cardType.THREE_LINE_TAKE_ONE?n/4:s===i.cardType.THREE_LINE_TAKE_TWO?n/5:n/3)-1;G<o;G++){var P=this.getCardLogicValue(r[o-G-1]);if(!(P<=I)){if(_>1&&P>=15)break;for(var L=0,E=o-G-1;E<o-2;E++)if(this.getCardLogicValue(r[E])+L===P&&this.getCardLogicValue(r[E+1])+L===P&&this.getCardLogicValue(r[E+2])+L===P&&(a[3*L]=r[E],a[3*L+1]=r[E+1],a[3*L+2]=r[E+2],++L===_)){var M=r.slice();this.removeCard(a,M);for(var U=[],B=0;B<M.length;++B){for(var O=this.getCardLogicValue(M[B]),k=!1,H=0;H<a.length;++H)if(O===this.getCardLogicValue(a[H])){k=!0;break}k&&U.push(M[B])}U.length>0&&this.removeCard(U,M);for(var w=this.analyseCardDataArr(M),x=0;x<w.singleCardData.length&&a.length!==n;x++){var F=w.singleCardData.length-x-1,W=w.singleCardData[F];a.push(W)}for(var Z=0;Z<w.doubleCardData.length&&a.length!==n;Z++){var V=w.doubleCardData.length-Z-1,J=w.doubleCardData[V];a.push(J)}for(var K=0;K<w.threeCardData.length&&a.length!==n;K++){var Y=w.threeCardData.length-K-1,z=w.threeCardData[Y];a.push(z)}for(var q=0;q<w.fourCardData.length&&a.length!==n;q++){var X=w.fourCardData.length-q-1,j=w.fourCardData[X];a.push(j)}if(a.length===n)return a}}}}if(o>=4){var Q=0;s===i.cardType.BOMB_CARD&&(Q=this.getCardLogicValue(t[0]));for(var $=3;$<o;$++){var ee=this.getCardLogicValue(r[o-$-1]);if(!(ee<=Q)){var te=1;for(te=1;te<4&&this.getCardLogicValue(r[o+te-$-1])===ee;te++);if(4===te)return(a=[])[0]=r[o-$-1],a[1]=r[o-$],a[2]=r[o-$+1],a[3]=r[o-$+2],a}}}return[]},cc._RF.pop()},{"./PDKProto":"PDKProto"}],PDKHandCradWidgetCtrl:[function(e,t,a){"use strict";cc._RF.push(t,"2d303X1txpDvIkqL5ubHgus","PDKHandCradWidgetCtrl");var r=e("./PDKGameLogic"),i=e("./PDKProto"),o=e("./PDKAnalyseOutCard");cc.Class({extends:cc.Component,properties:{},onLoad:function(){},initWidget:function(){this.cardNodeArr=[],this.selectedCardArr=[],this.searchOutCardResultArr=[],this.ignoreCardValueArr=[]},resetWidget:function(){this.node.removeAllChildren(),this.removeTouchCardEvent(),this.cardNodeArr=[],this.selectedCardArr=[]},onSendCard:function(e,t,a){for(var r=0;r<e.length;++r)this.addCardNode(e[r],r,t,function(e){Global.Utils.invokeCallback(a,e)}.bind(this))},startGame:function(){this.addTouchCardEvent()},addCardNode:function(e,t,a,r){var i=Global.CCHelper.createSpriteNode("Game/PaoDeKuai/Card/"+e);i.cardData=e,i.cardUp=!1,i.zIndex=t+1,this.cardNodeArr.push(i),a?this.scheduleOnce(function(){i.parent=this.node,Global.Utils.invokeCallback(r,t+1)}.bind(this),.1*(t+1)):(i.parent=this.node,Global.Utils.invokeCallback(r,t+1))},addTouchCardEvent:function(){this.node.on(cc.Node.EventType.TOUCH_START,this.onTouchCardStart,this),this.node.on(cc.Node.EventType.TOUCH_MOVE,this.onTouchMove,this),this.node.on(cc.Node.EventType.TOUCH_END,this.onTouchCardEnd,this),this.node.on(cc.Node.EventType.TOUCH_CANCEL,this.onTouchCardEnd,this)},removeTouchCardEvent:function(){this.node.off(cc.Node.EventType.TOUCH_START,this.onTouchCardStart,this),this.node.off(cc.Node.EventType.TOUCH_MOVE,this.onTouchMove,this),this.node.off(cc.Node.EventType.TOUCH_END,this.onTouchCardEnd,this),this.node.off(cc.Node.EventType.TOUCH_CANCEL,this.onTouchCardEnd,this)},onTouchCard:function(e){if(e)if(e.cardUp=!e.cardUp,e.y=e.cardUp?30:0,e.cardUp)this.selectedCardArr.push(e.cardData);else{var t=this.selectedCardArr.indexOf(e.cardData);t>=0&&this.selectedCardArr.splice(t,1)}},onTouchCardStart:function(e){var t=this.node.convertTouchToNodeSpaceAR(e.touch);this.touchStartCardIndex=this.getTouchPosIndex(t)},onTouchMove:function(e){for(var t=this.node.convertTouchToNodeSpaceAR(e.touch),a=this.getTouchPosIndex(t),r=0;r<this.cardNodeArr.length;++r){this.cardNodeArr[r].color=r>=this.touchStartCardIndex&&r<=a||r>=a&&r<=this.touchStartCardIndex?cc.Color.GRAY:cc.Color.WHITE}},onTouchCardEnd:function(e){for(var t=this.node.convertTouchToNodeSpaceAR(e.touch),a=this.getTouchPosIndex(t),n=0,s=0;s<this.cardNodeArr.length;++s){var c=this.cardNodeArr[s];c.color=cc.Color.WHITE,(s>=this.touchStartCardIndex&&s<=a||s>=a&&s<=this.touchStartCardIndex)&&(this.onTouchCard(c),n++)}if(Global.AudioManager.playSound("Game/PaoDeKuai/Sound/sound_select_card"),!(this.selectedCardArr.length<=4||n<=4)&&r.getCardType(this.selectedCardArr)===i.cardType.ERROR){var l=[];if(o.analyseOutCardTypeActive(this.selectedCardArr,l),l[i.cardType.SINGLE_LINE].cardTypeCount>0){for(var d=l[i.cardType.SINGLE_LINE],h=0,u=1;u<d.cardTypeCount;++u)d.eachHandCardCount[u]>d.eachHandCardCount[h]&&(h=u);var g=d.cardDataArr[h],C=this.selectedCardArr.slice();r.removeCard(g,C),this.setSelectedCard(C)}else if(l[i.cardType.DOUBLE_LINE].cardTypeCount>0){for(var p=l[i.cardType.DOUBLE_LINE],f=0,m=1;m<p.cardTypeCount;++m)p.eachHandCardCount[m]>p.eachHandCardCount[f]&&(f=m);var A=p.cardDataArr[f],b=this.selectedCardArr.slice();r.removeCard(A,b),this.setSelectedCard(b)}else if(l[i.cardType.THREE_LINE_TAKE_TWO].cardTypeCount>0){for(var y=l[i.cardType.THREE_LINE_TAKE_TWO],T=0,S=1;S<y.cardTypeCount;++S)y.eachHandCardCount[S]>y.eachHandCardCount[T]&&(T=S);var v=y.cardDataArr[T],N=this.selectedCardArr.slice();r.removeCard(v,N),this.setSelectedCard(N)}else if(l[i.cardType.THREE_LINE_TAKE_ONE].cardTypeCount>0){for(var D=l[i.cardType.THREE_LINE_TAKE_ONE],I=0,R=1;R<D.cardTypeCount;++R)D.eachHandCardCount[R]>D.eachHandCardCount[I]&&(I=R);var _=D.cardDataArr[I],G=this.selectedCardArr.slice();r.removeCard(_,G),this.setSelectedCard(G)}else if(l[i.cardType.BOMB_CARD].cardTypeCount>0){var P=l[i.cardType.BOMB_CARD].cardDataArr[0],L=this.selectedCardArr.slice();r.removeCard(P,L),this.setSelectedCard(L)}}},getTouchPosIndex:function(e){var t=this.cardNodeArr[this.cardNodeArr.length-1];if(e.x>=t.x-t.width/2)return this.cardNodeArr.length-1;var a=t.x-t.width/2-e.x,r=t.width-105,i=this.cardNodeArr.length-Math.floor(a/r)-2;return i<0&&(i=0),i},getSelectedCard:function(){return this.selectedCardArr},getAllCard:function(){for(var e=[],t=0;t<this.cardNodeArr.length;++t)e.push(this.cardNodeArr[t].cardData);return e},setSelectedCard:function(e){for(var t=0;t<e.length;++t)for(var a=e[t],r=0;r<this.cardNodeArr.length;++r)if(this.cardNodeArr[r].cardData===a){this.onTouchCard(this.cardNodeArr[r]);break}},resetCardPos:function(){for(var e=0;e<this.cardNodeArr.length;++e){var t=this.cardNodeArr[e];t.cardUp&&(t.cardUp=!1,t.y=0)}this.selectedCardArr=[]},addCard:function(e,t){function a(e){e.runAction(cc.sequence([cc.delayTime(1),cc.callFunc(function(){e.cardUp=!1,e.y=0,Global.Utils.invokeCallback(t)})]))}for(var i=0;i<e.length;++i){var o=e[i],n=Global.CCHelper.createSpriteNode("Game/PaoDeKuai/Card/"+o);n.cardData=o,n.cardUp=!0,n.y=30,n.parent=this.node;for(var s=r.getCardLogicValue(o),c=0;c<this.cardNodeArr.length;++c){var l=this.cardNodeArr[c].cardData,d=r.getCardLogicValue(l);if(d<s||d===s&&l<o){this.cardNodeArr.splice(c,0,n);break}if(c===this.cardNodeArr.length-1){this.cardNodeArr.push(n);break}}a(n,e.length)}for(var h=0;h<this.cardNodeArr.length;++h)this.cardNodeArr[h].zIndex=h+1},removeCard:function(e){this.selectedCardArr=[];for(var t=0;t<e.length;++t)for(var a=e[t],r=0;r<this.cardNodeArr.length;++r)if(this.cardNodeArr[r].cardData===a){this.cardNodeArr[r].destroy(),this.cardNodeArr.splice(r,1);break}},searchOutCard:function(e){for(var t=[],a=0;a<this.cardNodeArr.length;++a)t.push(this.cardNodeArr[a].cardData);if(this.searchOutCardResultArr.length>0){var o=this.searchOutCardResultArr[this.searchOutCardResultArr.length-1],n=r.getCardType(o);if(n===i.cardType.THREE_LINE||n===i.cardType.THREE_LINE_TAKE_ONE||n===i.cardType.THREE_LINE_TAKE_TWO){var s=r.analyseCardDataArr(o),c=r.getCardLogicValue(s.threeCardData[s.threeCardData.length-1]);this.ignoreCardValueArr.push(c)}else{var l=r.getCardLogicValue(o[o.length-1]);this.ignoreCardValueArr.push(l)}r.removeCardByValue(this.ignoreCardValueArr,t)}var d=r.searchOutCard(t,e);if(0===d.length){if(0===this.searchOutCardResultArr.length)return!1;d=this.searchOutCardResultArr[0],this.searchOutCardResultArr=[],this.ignoreCardValueArr=[]}return this.resetCardPos(),this.setSelectedCard(d),this.searchOutCardResultArr.push(d),!0},resetSearchOutCardState:function(){this.searchOutCardResultArr=[],this.ignoreCardValueArr=[]}}),cc._RF.pop()},{"./PDKAnalyseOutCard":"PDKAnalyseOutCard","./PDKGameLogic":"PDKGameLogic","./PDKProto":"PDKProto"}],PDKMainDialog:[function(e,t,a){"use strict";cc._RF.push(t,"17d5f22YEVE94TNkZYm+GIE","PDKMainDialog");var r=e("../../API/RoomProto"),i=e("./PDKProto"),o=e("../../API/RoomAPI"),n=e("./PDKGameLogic");cc.Class({extends:cc.Component,properties:{handCardWidgetCtrl:e("PDKHandCradWidgetCtrl"),operationBtnWidgetCtrl:e("PDKOperationBtnWdigetCtrl"),cardCountLabelArr:[cc.Label],showTipNodeArr:[cc.Node],showOutCardNodeArr:[cc.Node],clockPosNodeArr:[cc.Node],alertAnimationNodeArr:[cc.Node],showHandCardNode:[cc.Node],nicknameLabelArr:[cc.Label],goldLabelArr:[cc.Label],userIconSpriteArr:[cc.Sprite],showOutCardWidgetPrefab:cc.Prefab,showHandCardWidgetPrefab:cc.Prefab,clockWidgetPrefab:cc.Prefab,cardNode:cc.Node,shunziAnimationPrefab:cc.Prefab,zhandanAnimationPrefab:cc.Prefab,animationNode:cc.Node,fieldInfoLabel:cc.Label,nextWarnTipNode:cc.Node,winScoreLabelArr:[cc.Label],loseScoreLabelArr:[cc.Label]},onLoad:function(){this.gameInited=!1,this.myChairID=-1,this.roomID="",this.baseScore=1,this.handCardWidgetCtrl.initWidget(),this.turnCardDataArr=[],this.roomUserInfoArr=[null,null,null],Global.MessageCallback.addListener("RoomMessagePush",this),Global.MessageCallback.addListener("GameMessagePush",this),Global.MessageCallback.addListener("ReConnectSuccess",this),this.scheduleOnce(function(){o.roomMessageNotify(r.getRoomSceneInfoNotify())},.2),Global.AudioManager.startPlayBgMusic("Game/PaoDeKuai/Sound/sound_bg")},onDestroy:function(){Global.MessageCallback.removeListener("RoomMessagePush",this),Global.MessageCallback.removeListener("GameMessagePush",this),Global.MessageCallback.removeListener("ReConnectSuccess",this)},messageCallbackHandler:function(e,t){if("RoomMessagePush"===e){if(t.type===r.USER_LEAVE_ROOM_RESPONSE)t.data.chairId===this.myChairID&&Global.DialogManager.removeLoadingCircle();else if(t.type===r.OTHER_USER_ENTRY_ROOM_PUSH){if(!this.gameInited)return;this.onUserEntryRoom(t.data.roomUserInfo)}else if(t.type===r.USER_LEAVE_ROOM_PUSH){if(!this.gameInited)return;this.onUserLeaveRoom(t.data.roomUserInfo)}else if(t.type===r.USER_READY_PUSH){if(!this.gameInited)return;this.onUserReady(t.data.chairId)}else if(t.type===r.GET_ROOM_SCENE_INFO_PUSH)this.gameInit(t.data.roomUserInfoArr,t.data.gameData);else if(t.type===r.ROOM_USER_INFO_CHANGE_PUSH){if(!this.gameInited)return;for(var a=0;a<this.roomUserInfoArr.length;++a)if(this.roomUserInfoArr[a].userInfo.uid===t.data.changeInfo.uid){this.roomUserInfoArr[a].userInfo=t.data.changeInfo;break}}}else if("GameMessagePush"===e){if(!this.gameInited)return;t.type===i.GAME_START_PUSH?this.onGameStart(t.data.curChairID,t.data.selfCardArr):t.type===i.GAME_USER_OUT_CARD_PUSH?this.onUserOutCard(t.data.chairID,t.data.outCardArr,t.data.curChairID,t.data.leftCardCount,t.data.enablePass):t.type===i.GAME_USER_PASS_PUSH?this.onUserPass(t.data.chairID,t.data.curChairID,t.data.isNewTurn,t.data.enablePass):t.type===i.GAME_RESULT_PUSH?this.onGameResult(t.data):t.type===i.GAME_USER_BOMB_WIN_PUSH&&this.onUserBombWin(t.data.chairID,!0)}else"ReConnectSuccess"===e&&(Global.Player.isInRoom()?Global.API.hall.joinRoomRequest(this.roomID,function(){o.roomMessageNotify(r.getRoomSceneInfoNotify())},function(){this.exitGame()}.bind(this)):this.exitGame())},onBtnClick:function(e,t){if(this.gameInited)if(Global.AudioManager.playCommonSoundClickButton(),"ready"===t)this.resetGame(),Global.DialogManager.createDialog("Match/MatchGameDialog",{gameTypeID:this.gameTypeInfo.gameTypeID});else if("pass"===t)this.selfOutCardCallback(null);else if("tip"===t)this.turnCardDataArr&&this.turnCardDataArr.length>0&&(this.handCardWidgetCtrl.searchOutCard(this.turnCardDataArr)||this.selfOutCardCallback(null));else if("outCard"===t){var a=this.handCardWidgetCtrl.getSelectedCard();if(1===parseInt(this.cardCountLabelArr[1].string)&&1===a.length)for(var i=this.handCardWidgetCtrl.getAllCard(),s=n.getCardLogicValue(a[0]),c=0;c<i.length;++c)if(n.getCardLogicValue(i[c])>s)return void Global.DialogManager.addTipDialog("\u4e0b\u5bb6\u5df2\u7ecf\u62a5\u5355\uff0c\u5355\u6392\u5fc5\u987b\u51fa\u6700\u5927\u724c");this.selfOutCardCallback(a)}else if("exit"===t){if(!this.gameInited)return;Global.DialogManager.addPopDialog("\u786e\u8ba4\u9000\u51fa\u6e38\u620f?",function(){Global.Player.getPy("roomID")?(o.roomMessageNotify(r.userLeaveRoomNotify()),Global.DialogManager.addLoadingCircle()):this.exitGame()}.bind(this),function(){})}else"settings"===t?Global.DialogManager.createDialog("Setting/SettingDialog"):"rule"===t&&Global.DialogManager.createDialog("GameCommon/GameRule/GameRuleDialog",{kind:Global.Enum.gameType.PDK})},gameInit:function(e,t){this.gameInited=!0;for(var a=0;a<e.length;++a){var o=e[a];if(o.userInfo.uid===Global.Player.getPy("uid")){this.myChairID=o.chairId;break}}var n="";1===t.gameTypeInfo.level?n="\u521d\u7ea7\u573a":2===t.gameTypeInfo.level?n="\u4e2d\u7ea7\u573a":3===t.gameTypeInfo.level?n="\u9ad8\u7ea7\u573a":4===t.gameTypeInfo.level&&(n="\u5927\u5e08\u573a"),this.fieldInfoLabel.string="\u8dd1\u5f97\u5feb  "+n+"  \u5e95\u5206 "+t.baseScore,this.gameTypeInfo=t.gameTypeInfo;for(var s=0;s<e.length;++s)this.onUserEntryRoom(e[s]);if(this.baseScore=t.baseScore,this.profitPercentage=t.profitPercentage,t.gameStatus===i.gameStatus.NONE)Global.API.room.roomMessageNotify(r.userReadyNotify(!0));else if(t.gameStatus===i.gameStatus.OUT_CARD){this.handCardWidgetCtrl.onSendCard(t.selfCardArr,!1),this.handCardWidgetCtrl.startGame();for(var c=0;c<3;++c){this.updateCardCount(c,t.allUserCardCountArr[c]);var l=this.getUserChairIndex(c);1===t.allUserCardCountArr[c].length&&(this.alertAnimationNodeArr[l].active=!0)}for(var d=0;d<t.userBombTimes.length;++d)for(var h=t.userBombTimes[d],u=0;u<h;++u)this.onUserBombWin(d,!1);this.turnCardDataArr=t.turnCardDataArr,t.curChairID===this.myChairID&&this.operationBtnWidgetCtrl.startOutCard(t.curChairID===t.turnWinerChairID,t.enablePass),this.showClock(t.curChairID,t.enablePass?3:i.OUT_CARD_TIME,this.autoOutCard.bind(this))}},resetGame:function(e){this.handCardWidgetCtrl.resetWidget(),this.clearState(e);for(var t=0;t<3;++t)this.showOutCardNodeArr[t].removeAllChildren();for(var a=0;a<3;++a)if(0===a){var r=this.operationBtnWidgetCtrl.getClockNode();r&&r.destroyAllChildren()}else this.clockPosNodeArr[a].destroyAllChildren();this.operationBtnWidgetCtrl.clearWidget();for(var i=1;i<3;++i)this.cardCountLabelArr[i].node.parent.active=!1,this.alertAnimationNodeArr[i].active=!1;this.turnCardDataArr=[];for(var o=0;o<this.showHandCardNode.length;++o)this.showHandCardNode[o].removeAllChildren();this.nextWarnTipNode.active=!1,this.stopSendCardAnimation()},onReconnection:function(){this.resetGame(),o.roomMessageNotify(r.getRoomSceneInfoNotify())},onUserEntryRoom:function(e){var t=this.getUserChairIndex(e.chairId);this.nicknameLabelArr[t].string=Global.Player.convertNickname(e.userInfo.nickname),this.goldLabelArr[t].string=e.userInfo.gold.toFixed(2),Global.CCHelper.updateSpriteFrame(e.userInfo.avatar,this.userIconSpriteArr[t]),t>0&&(this.nicknameLabelArr[t].node.parent.active=!0),0!=(e.userStatus&r.userStatusEnum.READY)&&0==(e.userStatus&r.userStatusEnum.PLAYING)&&this.onUserReady(e.chairId),this.roomUserInfoArr[e.chairId]=e},onUserLeaveRoom:function(e){if(e.chairId===this.myChairID)this.exitGame();else{var t=this.getUserChairIndex(e.chairId);this.nicknameLabelArr[t].node.parent.active=!1,this.showTipNodeArr[t].getChildByName("ready").active=!1,this.roomUserInfoArr[e.chairId]=null}},updateUserInfo:function(){for(var e=0;e<3;++e){var t=this.roomUserInfoArr[e];if(e===this.myChairID){var a=this.getUserChairIndex(e);this.goldLabelArr[a].string=Global.Player.getPy("gold").toString()}else if(t){var r=this.getUserChairIndex(t.chairId);this.goldLabelArr[r].string=t.userInfo.gold.toFixed(2)}}},onUserReady:function(e){},onGameStart:function(e,t){0!==this.handCardWidgetCtrl.getAllCard().length&&this.handCardWidgetCtrl.resetWidget(),this.clearState(),this.handCardWidgetCtrl.onSendCard(t,!0,function(t){for(var a=0;a<3;++a)this.updateCardCount(a,t);Global.AudioManager.playSound("Game/PaoDeKuai/Sound/sound_send_card"),16===t&&(this.handCardWidgetCtrl.startGame(),this.onUserStartOutCard(e,!0,!1),this.stopSendCardAnimation())}.bind(this)),this.showSendCardAnimation();for(var a=0;a<3;++a)this.updateCardCount(a,16)},onUserStartOutCard:function(e,t,a){var r=this.getUserChairIndex(e);e===this.myChairID&&this.operationBtnWidgetCtrl.startOutCard(t,a);for(var o=this.showTipNodeArr[r],n=0;n<o.children.length;++n)o.children[n].active=!1;this.showOutCardNodeArr[r].removeAllChildren();var s=a?3:i.OUT_CARD_TIME;this.showClock(e,s,this.autoOutCard.bind(this))},selfOutCardCallback:function(e){if(e){if(0===e.length)return;if(e=n.sortCardList(e),n.getCardType(e)===i.cardType.ERROR)return void Global.DialogManager.addTipDialog("\u51fa\u724c\u4e0d\u7b26\u5408\u89c4\u5219");if(this.turnCardDataArr.length>0&&!n.compareCard(this.turnCardDataArr,e))return void Global.DialogManager.addTipDialog("\u51fa\u724c\u5fc5\u987b\u5927\u8fc7\u4e0a\u8f6e");var t=this.operationBtnWidgetCtrl.getClockNode();t?t.destroyAllChildren():console.error("selfOutCardCallback"),this.operationBtnWidgetCtrl.clearWidget(),o.gameMessageNotify(i.gameUserOutCardNotify(e)),this.handCardWidgetCtrl.removeCard(e),this.handCardWidgetCtrl.resetSearchOutCardState();var a=this.getUserChairIndex(this.myChairID);this.playOutCardSound(!this.turnCardDataArr||0===this.turnCardDataArr.length,e),this.turnCardDataArr=e;var r=cc.instantiate(this.showOutCardWidgetPrefab);r.parent=this.showOutCardNodeArr[a];var s=r.getComponent("PDKShowOutCardWidgetCtrl");s.initWidget(e,a),this.playOutCardAnimation(e,s)}else{var c=this.operationBtnWidgetCtrl.getClockNode();c?c.destroyAllChildren():console.error("selfOutCardCallback"),this.operationBtnWidgetCtrl.clearWidget(),this.handCardWidgetCtrl.resetCardPos(),this.handCardWidgetCtrl.resetSearchOutCardState();var l=this.getUserChairIndex(this.myChairID);this.showTipNodeArr[l].getChildByName("pass").active=!0,o.gameMessageNotify(i.gameUserPassNotify())}},onUserOutCard:function(e,t,a,r,i){var o=this.getUserChairIndex(e);if(e!==this.myChairID){this.playOutCardSound(!this.turnCardDataArr||0===this.turnCardDataArr.length,t),this.turnCardDataArr=t;var n=cc.instantiate(this.showOutCardWidgetPrefab);n.parent=this.showOutCardNodeArr[o];var s=n.getComponent("PDKShowOutCardWidgetCtrl");s.initWidget(t,o),this.playOutCardAnimation(t,s)}this.clockPosNodeArr[o].destroyAllChildren(),this.updateCardCount(e,r),1===r&&(this.alertAnimationNodeArr[o].active=!0),a>=0&&this.onUserStartOutCard(a,!1,i)},playOutCardSound:function(e,t){var a=n.getCardType(t);if(a===i.cardType.SINGLE){var r=n.getCardValue(t[0]);Global.AudioManager.playSound("Game/PaoDeKuai/Sound/Man/Man_"+r)}else if(a===i.cardType.DOUBLE){var o=n.getCardValue(t[0]);Global.AudioManager.playSound("Game/PaoDeKuai/Sound/Man/Man_dui"+o)}else if(a===i.cardType.THREE){var s=n.getCardValue(t[0]);Global.AudioManager.playSound("Game/PaoDeKuai/Sound/Man/Man_tuple"+s)}else a===i.cardType.SINGLE_LINE?e?Global.AudioManager.playSound("Game/PaoDeKuai/Sound/Man/Man_shunzi"):Global.AudioManager.playSound("Game/PaoDeKuai/Sound/Man/Man_dani"+Global.Utils.getRandomNum(1,3)):a===i.cardType.DOUBLE_LINE?e?Global.AudioManager.playSound("Game/PaoDeKuai/Sound/Man/Man_liandui"):Global.AudioManager.playSound("Game/PaoDeKuai/Sound/Man/Man_dani"+Global.Utils.getRandomNum(1,3)):a===i.cardType.THREE_LINE?e?Global.AudioManager.playSound("Game/PaoDeKuai/Sound/Man/Man_feiji"):Global.AudioManager.playSound("Game/PaoDeKuai/Sound/Man/Man_dani"+Global.Utils.getRandomNum(1,3)):a===i.cardType.THREE_LINE_TAKE_ONE?e?4===t.length?Global.AudioManager.playSound("Game/PaoDeKuai/Sound/Man/Man_sandaiyi"):Global.AudioManager.playSound("Game/PaoDeKuai/Sound/Man/Man_feiji"):Global.AudioManager.playSound("Game/PaoDeKuai/Sound/Man/Man_dani"+Global.Utils.getRandomNum(1,3)):a===i.cardType.THREE_LINE_TAKE_TWO?e?5===t.length?Global.AudioManager.playSound("Game/PaoDeKuai/Sound/Man/Man_sandaiyidui"):Global.AudioManager.playSound("Game/PaoDeKuai/Sound/Man/Man_feiji"):Global.AudioManager.playSound("Game/PaoDeKuai/Sound/Man/Man_dani"+Global.Utils.getRandomNum(1,3)):a===i.cardType.BOMB_CARD?Global.AudioManager.playSound("Game/PaoDeKuai/Sound/Man/Man_zhadan"):a===i.cardType.FOUR_LINE_TAKE_ONE?Global.AudioManager.playSound("Game/PaoDeKuai/Sound/Man/Man_sidaier"):a===i.cardType.FOUR_LINE_TAKE_TWO&&Global.AudioManager.playSound("Game/PaoDeKuai/Sound/Man/Man_sidailiangdui")},playOutCardAnimation:function(e,t){var a=n.getCardType(e);a===i.cardType.BOMB_CARD?this.showZhadanAnimation():a===i.cardType.THREE_LINE_TAKE_ONE?e.length>4&&this.showFeijiAnimation():a===i.cardType.THREE_LINE_TAKE_TWO?e.length>5&&this.showFeijiAnimation():a===i.cardType.SINGLE_LINE?this.showShunziAnimation(null,t):a===i.cardType.DOUBLE_LINE&&this.showLianduiAnimation(null,t)},onUserPass:function(e,t,a,r){var i=this.getUserChairIndex(e);e!==this.myChairID&&(this.showTipNodeArr[i].getChildByName("pass").active=!0),a&&(this.turnCardDataArr=[]),0!==i&&this.clockPosNodeArr[i].destroyAllChildren(),t>=0&&this.onUserStartOutCard(t,a,r),Global.AudioManager.playSound("Game/PaoDeKuai/Sound/Man/Man_buyao1")},onUserBombWin:function(e,t){for(var a=0;a<3;++a){var r=this.getUserChairIndex(a);if(e===a){t&&(this.winScoreLabelArr[r].node.active=!0,this.winScoreLabelArr[r].string="+"+Global.Utils.formatNumberToString(10*this.gameTypeInfo.baseScore,2)+"\u5143",this.winScoreLabelArr[r].node.position=cc.v2(0,-50),this.winScoreLabelArr[r].node.runAction(cc.sequence([cc.show(),cc.moveTo(.2,cc.v2(0,0)),cc.delayTime(2),cc.hide()])));var i=parseFloat(this.goldLabelArr[r].string)+10*this.gameTypeInfo.baseScore;this.goldLabelArr[r].string=Global.Utils.formatNumberToString(i,2)}else{t&&(this.loseScoreLabelArr[r].node.active=!0,this.loseScoreLabelArr[r].string=Global.Utils.formatNumberToString(-5*this.gameTypeInfo.baseScore,2)+"\u5143",this.loseScoreLabelArr[r].node.position=cc.v2(0,-50),this.loseScoreLabelArr[r].node.runAction(cc.sequence([cc.show(),cc.moveTo(.2,cc.v2(0,0)),cc.delayTime(2),cc.hide()])));var o=parseFloat(this.goldLabelArr[r].string)-5*this.gameTypeInfo.baseScore;this.goldLabelArr[r].string=Global.Utils.formatNumberToString(o,2)}}},onGameResult:function(e){for(var t=0;t<3;++t){var a=this.getUserChairIndex(t);if(0!==a){var r=e.allCardArr[t];if(r.length>0)for(var i=0;i<r.length;i+=10){var o=cc.instantiate(this.showHandCardWidgetPrefab);o.getComponent("PDKShowHandCardWidgetCtrl").initWidget(r.slice(i,i+10),a),o.parent=this.showHandCardNode[a]}}}e.winChairID===this.myChairID?Global.AudioManager.playSound("Game/PaoDeKuai/Sound/sound_win"):Global.AudioManager.playSound("Game/PaoDeKuai/Sound/sound_lose"),this.scheduleOnce(function(){var t={resultData:e,myChairID:this.myChairID,baseScore:this.baseScore,profitPercentage:this.profitPercentage,buttonEventCallback:this.onBtnClick.bind(this)};Global.DialogManager.createDialog("Game/PaoDeKuai/PDKResultDialog",t,function(){}.bind(this)),this.updateUserInfo()}.bind(this),3)},autoOutCard:function(){var e=null;if(0===this.turnCardDataArr.length){var t=this.handCardWidgetCtrl.getAllCard();e=n.getCardType(t)?t.slice():[t[t.length-1]]}else this.handCardWidgetCtrl.searchOutCard(this.turnCardDataArr)&&(e=this.handCardWidgetCtrl.getSelectedCard());this.selfOutCardCallback(e)},showClock:function(e,t,a){var r=cc.instantiate(this.clockWidgetPrefab),i=r.getComponent("PDKClockWidgetCtrl"),o=this.getUserChairIndex(e);r.parent=0===o?this.operationBtnWidgetCtrl.getClockNode():this.clockPosNodeArr[o],i.startClock(t,this.myChairID===e?a:null)},updateCardCount:function(e,t){if(e!==this.myChairID){var a=this.getUserChairIndex(e);this.cardCountLabelArr[a].node.parent.active=!0,this.cardCountLabelArr[a].string=t.toString()}},getUserChairIndex:function(e){return(e-this.myChairID+3)%3},clearState:function(e){for(var t=0;t<this.showTipNodeArr.length;++t)for(var a=this.showTipNodeArr[t],r=0;r<a.children.length;++r)e&&"ready"===a.children[r].name&&a.children[r].active||(a.children[r].active=!1)},exitGame:function(){Global.DialogManager.createDialog("Hall/HallDialog",null,function(){Global.DialogManager.destroyDialog(this,!0),Global.DialogManager.isDialogExit("Game/PaoDeKuai/PDKResultDialog")&&Global.DialogManager.destroyDialog("Game/PaoDeKuai/PDKResultDialog",!0),Global.CCHelper.releaseRes(["Game/PaoDeKuai"])}.bind(this))},showSendCardAnimation:function(){this.cardNode.active=!0,this.schedule(this.createCard,.1)},stopSendCardAnimation:function(){this.cardNode.active=!1,this.unschedule(this.createCard)},createCard:function(){var e=cc.instantiate(this.cardNode);e.active=!0,e.parent=this.cardNode.parent,e.runAction(cc.sequence([cc.moveBy(.2,cc.v2(0,-300)),cc.removeSelf()]));var t=cc.instantiate(this.cardNode);t.active=!0,t.parent=this.cardNode.parent,t.runAction(cc.sequence([cc.moveBy(.2,cc.v2(400,-100)),cc.removeSelf()]));var a=cc.instantiate(this.cardNode);a.active=!0,a.parent=this.cardNode.parent,a.runAction(cc.sequence([cc.moveBy(.2,cc.v2(-400,-100)),cc.removeSelf()]))},showShunziAnimation:function(e,t){e||(e=t.getCenterPos());var a=cc.instantiate(this.shunziAnimationPrefab);a.parent=this.animationNode,a.position=this.animationNode.convertToNodeSpaceAR(t.node.convertToWorldSpaceAR(e));var r=a.getComponent("SpriteFrameAnimationWidgetCtrl");r.startAnimation(!1,1,function(){r.node.removeFromParent()});var i=Global.CCHelper.createSpriteNode("Game/PaoDeKuai/Animation/shunzi/shunzi");i.parent=a,i.x=-200;var o=cc.moveTo(.3,cc.v2(0,0));o.easing(cc.easeOut(3)),i.runAction(cc.sequence([o,cc.fadeOut(.4),cc.removeSelf()]))},showLianduiAnimation:function(e,t){e||(e=t.getCenterPos());var a=cc.instantiate(this.shunziAnimationPrefab);a.parent=this.animationNode,a.position=this.animationNode.convertToNodeSpaceAR(t.node.convertToWorldSpaceAR(e));var r=a.getComponent("SpriteFrameAnimationWidgetCtrl");r.startAnimation(!1,1,function(){r.node.removeFromParent()});var i=Global.CCHelper.createSpriteNode("Game/PaoDeKuai/Animation/shunzi/liandui");i.parent=a,i.x=-200;var o=cc.moveTo(.3,cc.v2(0,0));o.easing(cc.easeOut(3)),i.runAction(cc.sequence([o,cc.fadeOut(.4),cc.removeSelf()]))},showFeijiAnimation:function(){var e=Global.CCHelper.createSpriteNode("Game/PaoDeKuai/Animation/feiji/1q");e.parent=this.animationNode,e.x=-800,e.y=0;var t=cc.moveTo(.6,cc.v2(0,0));t.easing(cc.easeOut(2));var a=cc.moveTo(.6,cc.v2(800,0));a.easing(cc.easeIn(2)),e.runAction(cc.sequence([t,a,cc.removeSelf()])),this.scheduleOnce(function(){var e=cc.instantiate(this.shunziAnimationPrefab);e.parent=this.animationNode,e.x=0,e.y=-100;var t=e.getComponent("SpriteFrameAnimationWidgetCtrl");t.startAnimation(!1,1,function(){t.node.removeFromParent()});var a=Global.CCHelper.createSpriteNode("Game/PaoDeKuai/Animation/feiji/1w");a.parent=e,a.x=-200,a.y=0;var r=cc.moveTo(.3,cc.v2(0,0));r.easing(cc.easeOut(2)),a.runAction(cc.sequence([r,cc.fadeOut(.4),cc.removeSelf()]))}.bind(this),1)},showZhadanAnimation:function(){var e=Global.CCHelper.createSpriteNode("Game/PaoDeKuai/Animation/zhadan/o");e.x=-200,e.parent=this.animationNode,e.runAction(cc.sequence([cc.jumpTo(.3,cc.v2(0,0),100,1),cc.callFunc(function(){var t=cc.instantiate(this.zhandanAnimationPrefab);t.parent=this.animationNode;var a=t.getComponent("SpriteFrameAnimationWidgetCtrl");a.startAnimation(!1,1,function(){a.node.removeFromParent()}),e.removeFromParent();var r=Global.CCHelper.createSpriteNode("Game/PaoDeKuai/Animation/zhadan/1");r.scale=.6;var i=cc.scaleTo(.5,1);i.easing(cc.easeBackOut()),r.runAction(cc.sequence([i,cc.delayTime(.2),cc.fadeOut(.3),cc.removeSelf()])),r.parent=this.animationNode}.bind(this))]))}}),cc._RF.pop()},{"../../API/RoomAPI":"RoomAPI","../../API/RoomProto":"RoomProto","./PDKGameLogic":"PDKGameLogic","./PDKProto":"PDKProto",PDKHandCradWidgetCtrl:"PDKHandCradWidgetCtrl",PDKOperationBtnWdigetCtrl:"PDKOperationBtnWdigetCtrl"}],PDKOperationBtnWdigetCtrl:[function(e,t,a){"use strict";cc._RF.push(t,"a2cee9i/I9F6Yz86w34TQgg","PDKOperationBtnWdigetCtrl"),cc.Class({extends:cc.Component,properties:{outCardNode:cc.Node,readyNode:cc.Node},onLoad:function(){},startReady:function(){this.outCardNode.active=!1,this.readyNode.active=!0},startOutCard:function(e,t){this.outCardNode.active=!0,this.readyNode.active=!1,this.outCardNode.getChildByName("buchu").active=!e&&t,this.outCardNode.getChildByName("tip").active=!e&&!t,this.outCardNode.getChildByName("outCard").active=!t},clearWidget:function(){this.outCardNode.active=!1,this.readyNode.active=!1},getClockNode:function(){return this.outCardNode.active?this.outCardNode.getChildByName("selfClockNode"):this.readyNode.active?this.readyNode.getChildByName("selfClockNode"):null}}),cc._RF.pop()},{}],PDKProto:[function(e,t,a){"use strict";cc._RF.push(t,"4adbdZ2EkJCLabA4Xb4MgPo","PDKProto");var r=t.exports;r.GAME_USER_OUT_CARD_NOTIFY=302,r.GAME_USER_OUT_CARD_PUSH=402,r.GAME_USER_PASS_NOTIFY=303,r.GAME_USER_PASS_PUSH=403,r.GAME_USER_BOMB_WIN_PUSH=407,r.GAME_START_PUSH=405,r.GAME_RESULT_PUSH=406,r.gameStatus={NONE:0,OUT_CARD:1,GAME_END:2},r.OPREATION_TIME=15,r.OUT_CARD_TIME=15,r.cardType={ERROR:0,SINGLE:1,DOUBLE:2,SINGLE_LINE:3,DOUBLE_LINE:4,THREE_LINE:5,THREE_LINE_TAKE_ONE:6,THREE_LINE_TAKE_TWO:7,FOUR_LINE_TAKE_X:8,BOMB_CARD:9},r.gameStartPush=function(e,t){return{type:this.GAME_START_PUSH,data:{curChairID:e,selfCardArr:t}}},r.gameUserOutCardNotify=function(e){return{type:this.GAME_USER_OUT_CARD_NOTIFY,data:{outCardArr:e}}},r.gameUserOutCardPush=function(e,t,a,r,i){return{type:this.GAME_USER_OUT_CARD_PUSH,data:{chairID:e,curChairID:t,outCardArr:a,leftCardCount:r,enablePass:i}}},r.gameUserPassNotify=function(){return{type:this.GAME_USER_PASS_NOTIFY,data:{}}},r.gameUserPassPush=function(e,t,a,r){return{type:this.GAME_USER_PASS_PUSH,data:{chairID:e,curChairID:t,enablePass:a,isNewTurn:r}}},r.gameResultPush=function(e,t,a,r,i){return{type:this.GAME_RESULT_PUSH,data:{allCardArr:e,scoreChangeArr:t,bombScoreChangeArr:a,winChairID:r,nicknameArr:i}}},r.gameUserBombWinPush=function(e){return{type:this.GAME_USER_BOMB_WIN_PUSH,data:{chairID:e}}},cc._RF.pop()},{}],PDKResultDialog:[function(e,t,a){"use strict";cc._RF.push(t,"9be27DjX3NB+bBMM8HA/nK3","PDKResultDialog"),cc.Class({extends:cc.Component,properties:{rowTitleNode:cc.Node,resultInfoItemArr:[cc.Node],lostNode:cc.Node,winNode:cc.Node,frameBg:cc.Node,btnNode:cc.Node,rowTitleGold:cc.Label,profitPercentageLabel:cc.Label},onLoad:function(){var e=this.dialogParameters.resultData,t=this.dialogParameters.baseScore,a=this.dialogParameters.myChairID;this.buttonEventCallback=this.dialogParameters.buttonEventCallback,this.dialogParameters.profitPercentage>0?this.profitPercentageLabel.string="\u62bd\u53d6\u8d62\u5f97\u91d1\u5e01\u7684{0}%\u4f5c\u4e3a\u53f0\u8d39".format(this.dialogParameters.profitPercentage):this.profitPercentageLabel.node.active=!1,e.winChairID===a?(this.lostNode.active=!1,this.winNode.active=!0):(this.lostNode.active=!0,this.winNode.active=!1);for(var r=0;r<3;++r){var i=this.resultInfoItemArr[r],o=i.getChildByName("nickname").getComponent(cc.Label);o.string=Global.Player.convertNickname(e.nicknameArr[r]);var n=i.getChildByName("baseScore").getComponent(cc.Label);n.string=t.toString();var s=i.getChildByName("gold").getComponent(cc.Label),c=e.scoreChangeArr[r],l=Global.Utils.formatNumberToString(c,2);s.string=c>=0?"+"+l:l.toString();var d=i.getChildByName("bombGold").getComponent(cc.Label),h=e.bombScoreChangeArr[r],u=Global.Utils.formatNumberToString(h,2);d.string=h>0?"+"+u:u.toString();var g=i.getChildByName("cardCount").getComponent(cc.Label),C=e.allCardArr[r].length;if(g.string=C.toString(),r===a){var p=new cc.Color(255,180,0);o.node.color=p,n.node.color=p,s.node.color=p,d.node.color=p,g.node.color=p}}this.showAnimation(e.winChairID===a)},onBtnClick:function(e,t){Global.AudioManager.playCommonSoundClickButton(),"ready"===t?(Global.DialogManager.destroyDialog(this,!0),Global.Utils.invokeCallback(this.buttonEventCallback,e,t)):"exit"===t&&Global.Utils.invokeCallback(this.buttonEventCallback,e,t)},showAnimation:function(e){var t=null;(t=e?this.winNode.getChildByName("titleBg"):this.lostNode.getChildByName("titleBg")).scale=3;var a=cc.scaleTo(.3,1);a.easing(cc.easeIn(3)),t.runAction(a),this.frameBg.opacity=0,this.frameBg.runAction(cc.sequence([cc.delayTime(.3),cc.fadeTo(.3,100)])),this.rowTitleNode.runAction(cc.sequence([cc.hide(),cc.delayTime(.4),cc.show()]));for(var r=0;r<3;++r){var i=this.resultInfoItemArr[r];i.opacity=0,i.runAction(cc.sequence([cc.delayTime(.7+.2*r),cc.fadeIn(.2)]))}}}),cc._RF.pop()},{}],PDKShowHandCardWidgetCtrl:[function(e,t,a){"use strict";cc._RF.push(t,"75df4hfPrhEYpFq8A6bIcgW","PDKShowHandCardWidgetCtrl"),cc.Class({extends:cc.Component,properties:{},onLoad:function(){},initWidget:function(e,t){for(var a=0;a<e.length;++a){Global.CCHelper.createSpriteNode("Game/PaoDeKuai/CardSmall/"+e[a]).parent=this.node}1===t?this.node.anchorX=1:2===t&&(this.node.anchorX=0)}}),cc._RF.pop()},{}],PDKShowOutCardWidgetCtrl:[function(e,t,a){"use strict";cc._RF.push(t,"8c2d3p70ZBC7KN1dxDgBg02","PDKShowOutCardWidgetCtrl"),cc.Class({extends:cc.Component,properties:{},onLoad:function(){},initWidget:function(e,t){for(var a=0;a<e.length;++a){Global.CCHelper.createSpriteNode("Game/PaoDeKuai/Card/"+e[a]).parent=this.node}1===t?this.node.anchorX=1:2===t&&(this.node.anchorX=0),this.node.scale=.45;var r=cc.scaleTo(.15,.5);r.easing(cc.easeBackOut()),this.node.runAction(r)},getCenterPos:function(){return 1===this.node.anchorX?cc.v2(-30*this.node.childrenCount,0):0===this.node.anchorX?cc.v2(30*this.node.childrenCount,0):cc.v2(0,0)}}),cc._RF.pop()},{}],PlayerWechat:[function(e,t,a){"use strict";cc._RF.push(t,"a25e1rApGtDtYaawMC8NcGD","PlayerWechat");var r=t.exports={};r.init=function(e){this.setProperties(e)},r.setProperties=function(e){for(var t in e)e.hasOwnProperty(t)&&(this[t]=e[t])},r.getPy=function(e){return this[e]},r.setPy=function(e,t){this[e]=t},cc._RF.pop()},{}],Player:[function(e,t,a){"use strict";cc._RF.push(t,"893ce6wbIdOjondiAnR7u8U","Player");var r=t.exports={};r.init=function(e){this.setProperties(e),Global.MessageCallback.addListener("UpdateUserInfoPush",this),Global.MessageCallback.addListener("UpdateTradeRecordDetailPush",this)},r.messageCallbackHandler=function(e,t){switch(e){case"UpdateUserInfoPush":delete t.pushRouter,this.setProperties(t),Global.MessageCallback.emitMessage("UpdateUserInfoUI")}},r.setProperties=function(e){for(var t in e)e.hasOwnProperty(t)&&(this[t]=e[t])},r.getPy=function(e){if(Global.CCHelper.isWechatBrowser()){if("avatar"===e)return Global.PlayerWechat.getPy("headimgurl");if("nickname"===e)return Global.PlayerWechat.getPy("nickname")}return"gold"===e?this[e].toFixed(2):"account"===e&&11===this[e].length?this[e].substring(0,3)+"****"+this[e].substring(7,11):"nickname"===e&&this.nickname===this.account?this.getPy("account"):this[e]},r.setPy=function(e,t){this[e]=t},r.isInRoom=function(){return!!this.getPy("roomID")&&this.getPy("roomID")>0},r.checkCanGet=function(){return!1},r.checkUnRead=function(){return 0},r.setMailRead=function(e){for(var t=Global.Player.getPy("emailArr"),a=(t=t&&t.length>0?JSON.parse(t):[]).length-1;a>=0;a--){var r=t[a];r.id+""==e+""&&(r.isRead=!0,t[a]=r)}},r.convertNickname=function(e){var t=!0,a=e;if(e.length>7){for(var r=0;r<e.length;r++)isNaN(e[r])&&(t=!1);t&&(a=e.substring(0,3)+"****"+e.substring(e.length-4,e.length))}return a},cc._RF.pop()},{}],PopDialog:[function(e,t,a){"use strict";cc._RF.push(t,"fd9cei7RbJAlIi0nUgneaxh","PopDialog"),cc.Class({extends:cc.Component,properties:{contentLabel:cc.Label,okBtn:cc.Node,cancelBtn:cc.Node},onLoad:function(){this.originalPositionX=Math.abs(this.okBtn.x),this.popDialogArr=[]},onBtnClk:function(e,t){switch(t){case"ok":this.popDialogArr[0]&&this.popDialogArr[0].cbOK&&this.popDialogArr[0].cbOK(),this.removeLastPopDialog();break;case"cancel":this.popDialogArr[0]&&this.popDialogArr[0].cbCancel&&this.popDialogArr[0].cbCancel(),this.removeLastPopDialog()}},addPopDialog:function(e,t,a,r){e&&(this.popDialogArr.splice(0,0,{content:e,cbOK:t,cbCancel:a,isRotate:!!r}),this.showNextPopDialog())},showNextPopDialog:function(){if(this.popDialogArr.length>0){var e=this.popDialogArr[0];this.node.active=!0,this.contentLabel.string=e.content,this.cancelBtn.active=!!e.cbCancel,this.okBtn.active=!!e.cbOK,e.cbCancel&&e.cbOK?(this.cancelBtn.x=-1*this.originalPositionX,this.okBtn.x=this.originalPositionX):(this.cancelBtn.x=0,this.okBtn.x=0,e.cbOK||e.cbCancel||(this.okBtn.active=!0))}},removeLastPopDialog:function(){this.popDialogArr.length>0&&(this.popDialogArr.splice(0,1),this.node.active=!1,this.showNextPopDialog())}}),cc._RF.pop()},{}],RankDialog:[function(e,t,a){"use strict";cc._RF.push(t,"74ca8775yNLmoXzKj3+VGyV","RankDialog"),cc.Class({extends:cc.Component,properties:{rankItem:cc.Prefab,content:cc.Node,myAvatar:cc.Sprite,myGold:cc.Label,myNickname:cc.Label},onScrollEvent:function(e,t){switch(t){case cc.ScrollView.EventType.SCROLL_TO_BOTTOM:this.updateList()}},updateList:function(){Global.DialogManager.addLoadingCircle(),Global.API.hall.getTodayWinGoldCountRankRequest(this.startIndex,this.perCount,function(e){for(var t=e.msg.rankList,a=0;a<t.length;a++){var r=cc.instantiate(this.rankItem);r.parent=this.content,r.getComponent("RankItem").updateUI(t[a],this.startIndex+a+1)}t.length>0&&(this.startIndex+=this.perCount),Global.DialogManager.removeLoadingCircle()}.bind(this))},start:function(){Global.CCHelper.updateSpriteFrame(Global.Player.getPy("avatar"),this.myAvatar),this.myGold.string=Global.Player.getPy("todayWinGoldCount").toFixed(2),this.myNickname.string=Global.Player.convertNickname(Global.Player.getPy("nickname")),this.startIndex=0,this.perCount=10,this.maxCount=!1,this.updateList()},onBtnClk:function(e,t){switch(t){case"close":Global.DialogManager.destroyDialog(this)}}}),cc._RF.pop()},{}],RankItem:[function(e,t,a){"use strict";cc._RF.push(t,"5d5c6xaM3JEs6v9ju0JZKT0","RankItem"),cc.Class({extends:cc.Component,properties:{nickname:cc.Label,avatar:cc.Sprite,goldNum:cc.Label,rankIcon:cc.Sprite,rankLabel:cc.Label},start:function(){},updateUI:function(e,t){""!==e.avatar&&Global.CCHelper.updateSpriteFrame(e.avatar,this.avatar),t<=3?(Global.CCHelper.updateSpriteFrame("Rank/icon_rank_"+t,this.rankIcon),this.rankLabel.node.active=!1):(this.rankIcon.node.active=!1,this.rankLabel.string=t),this.nickname.string=Global.Player.convertNickname(e.nickname),this.goldNum.string=e.gold.toFixed(2)}}),cc._RF.pop()},{}],RechargeDialog:[function(e,t,a){"use strict";cc._RF.push(t,"0ff4ej04ZJB56o7/KP0+233","RechargeDialog"),cc.Class({extends:cc.Component,properties:{wxBg:cc.Node,aliBg:cc.Node,qqBg:cc.Node,unionBg:cc.Node,alipayBtnNode:cc.Node,wxBtnNode:cc.Node,qqBtnNode:cc.Node,unionBtnNode:cc.Node,rechargeNum:[cc.Label],rechargeNumEdit:cc.EditBox},showBg:function(e){this.rechargeType=e,this.wxBg.active="wx"===e,this.aliBg.active="alipay"===e,this.qqBg.active="qq"===e,this.unionBg.active="union"===e;var t=this.rechargeConfig[e];if(t){this.rechargeNumDefine=t.list;for(var a=0;a<8;a++)this.rechargeNumDefine[a]?(this.rechargeNum[a].string=this.rechargeNumDefine[a]+"\u5143",this.rechargeNum[a].node.parent.active=!0):this.rechargeNum[a].node.parent.active=!1}},start:function(){var e=void 0;this.rechargeNumDefine=null;var t=JSON.parse(Global.Data.getData("rechargeConfig"));for(var a in t)if(t.hasOwnProperty(a)){var r=t[a];r.enable?e&&this.rechargeNumDefine||(e=a,this.rechargeNumDefine=r.list):this[a+"BtnNode"].active=!1}this.rechargeConfig=t,this.showBg(e);for(var i=0;i<8;i++)this.rechargeNumDefine[i]?this.rechargeNum[i].string=this.rechargeNumDefine[i]+"\u5143":this.rechargeNum[i].node.parent.active=!1},onBtnClk:function(e,t){switch(t){case"close":Global.DialogManager.destroyDialog(this);break;case"wx":case"qq":case"union":case"alipay":this.showBg(t);break;case"rechargeNow":var a=this.rechargeNumEdit.string;if(""===a)return void Global.DialogManager.addTipDialog("\u8bf7\u8f93\u5165\u5145\u503c\u91d1\u989d\uff01");var r=parseInt(Global.Data.getData("minRechargeCount"));if((a=parseInt(a))<r)return void Global.DialogManager.addPopDialog("\u5355\u7b14\u5145\u503c\u4e0d\u5f97\u4f4e\u4e8e"+r);var i={count:a};i.payType=Global.Enum.PAY_TYPE.ALI_PAY,"wx"===this.rechargeType?i.payType=Global.Enum.PAY_TYPE.WE_CHAT:"qq"===this.rechargeType?i.payType=Global.Enum.PAY_TYPE.QQ_PAY:"union"===this.rechargeType&&(i.payType=Global.Enum.PAY_TYPE.UNION_PAY),Global.API.hall.purchaseRechargeItemRequest(null,Global.Enum.RechargePlatform.ANXEN_PAY,i,function(e){e.msg.url&&cc.sys.openURL(e.msg.url)});break;case"clear":this.rechargeNumEdit.string="";break;case"recharge_0":case"recharge_1":case"recharge_2":case"recharge_3":case"recharge_4":case"recharge_5":case"recharge_6":case"recharge_7":var o=parseInt(t.split("_")[1]);this.rechargeNumEdit.string=this.rechargeNumDefine[o],this.rechargeLevel=o}}}),cc._RF.pop()},{}],RegisterDialog:[function(e,t,a){"use strict";cc._RF.push(t,"63200zp9/tEWr6YZm2bGC2y","RegisterDialog"),cc.Class({extends:cc.Component,properties:{reAccountEdit:cc.EditBox,reCodeEdit:cc.EditBox,rePwdEdit:cc.EditBox,reConfirmPwdEdit:cc.EditBox,countDown:cc.Label,getCodeBtn:cc.Button},start:function(){},onDestroy:function(){this.countDownInterval&&(clearInterval(this.countDownInterval),this.countDownInterval=null)},onBtnClk:function(e,t){var a=this.reAccountEdit.string,r=this.rePwdEdit.string,i=this.reConfirmPwdEdit.string;switch(t){case"register":if(""===a)return void Global.DialogManager.addTipDialog("\u8bf7\u8f93\u5165\u624b\u673a\u53f7\uff01");if(a.length<11)return void Global.DialogManager.addTipDialog("\u8bf7\u8f93\u5165\u6b63\u786e\u7684\u624b\u673a\u53f7\uff01");if(""===r||""===i)return void Global.DialogManager.addTipDialog("\u8bf7\u8f93\u5165\u5bc6\u7801\uff01");if(r!==i)return void Global.DialogManager.addTipDialog("\u4e24\u6b21\u8f93\u5165\u7684\u5bc6\u7801\u4e0d\u4e00\u81f4\uff01");var o={account:a,password:r,loginPlatform:Global.Enum.loginPlatform.ACCOUNT,smsCode:"1111"};if(!a||!r)return void Global.DialogManager.addTipDialog("\u8bf7\u8f93\u5165\u6709\u6548\u5e10\u53f7\u5bc6\u7801");Global.DialogManager.addLoadingCircle(),Global.NetworkLogic.register(o,{avatar:"Common/head_icon_default"},function(){Global.DialogManager.removeLoadingCircle(),this.saveAccount(o.account,o.password,o.loginPlatform),this.enterGame()}.bind(this));break;case"getCode":if(""===a)return void Global.DialogManager.addTipDialog("\u8bf7\u8f93\u5165\u624b\u673a\u53f7\uff01");if(a.length<11)return void Global.DialogManager.addTipDialog("\u8bf7\u8f93\u5165\u6b63\u786e\u7684\u624b\u673a\u53f7\uff01");Global.API.http.getPhoneCode(a);var n=60;this.getCodeBtn.node.active=!1,this.countDown.string="60s",this.countDownInterval=setInterval(function(){--n<0&&(clearInterval(this.countDownInterval),this.countDownInterval=null,this.getCodeBtn.node.active=!0),this.countDown.string=n+"s"}.bind(this),1e3);break;case"close":Global.DialogManager.destroyDialog(this)}},enterGame:function(){Global.DialogManager.createDialog("Hall/HallDialog",null,function(){Global.DialogManager.removeLoadingCircle(),Global.DialogManager.destroyDialog(this),Global.DialogManager.destroyDialog("Login/LoginDialog")}.bind(this))},saveAccount:function(e,t,a){cc.sys.localStorage.setItem("account",e),cc.sys.localStorage.setItem("password",t),cc.sys.localStorage.setItem("platform",a.toString())}}),cc._RF.pop()},{}],ResetPwdDialog:[function(e,t,a){"use strict";cc._RF.push(t,"2d6f7d8/gBOPabuR56R5Al1","ResetPwdDialog"),cc.Class({extends:cc.Component,properties:{accountEdit:cc.EditBox,codeEdit:cc.EditBox,pwdEdit:cc.EditBox,confirmPwdEdit:cc.EditBox,getCodeBtn:cc.Button,countDown:cc.Label},start:function(){},onDestroy:function(){this.countDownInterval&&(clearInterval(this.countDownInterval),this.countDownInterval=null)},onBtnClk:function(e,t){var a=this.accountEdit.string,r=this.codeEdit.string,i=this.pwdEdit.string,o=this.confirmPwdEdit.string;switch(t){case"close":Global.DialogManager.destroyDialog(this);break;case"getCode":if(""===a)return void Global.DialogManager.addTipDialog("\u8bf7\u8f93\u5165\u624b\u673a\u53f7\uff01");if(a.length<11)return void Global.DialogManager.addTipDialog("\u8bf7\u8f93\u5165\u6b63\u786e\u7684\u624b\u673a\u53f7\uff01");Global.API.http.getPhoneCode(a);var n=60;this.getCodeBtn.node.active=!1,this.countDown.string="60s",this.countDownInterval=setInterval(function(){--n<0&&(clearInterval(this.countDownInterval),this.countDownInterval=null,this.getCodeBtn.node.active=!0),this.countDown.string=n+"s"}.bind(this),1e3);break;case"confirm":if(""===a)return void Global.DialogManager.addTipDialog("\u8bf7\u8f93\u5165\u624b\u673a\u53f7\uff01");if(a.length<11)return void Global.DialogManager.addTipDialog("\u8bf7\u8f93\u5165\u6b63\u786e\u7684\u624b\u673a\u53f7\uff01");if(""===r)return void Global.DialogManager.addTipDialog("\u8bf7\u8f93\u5165\u624b\u673a\u9a8c\u8bc1\u7801\uff01");if(""===i||""===o)return void Global.DialogManager.addTipDialog("\u8bf7\u8f93\u5165\u5bc6\u7801\uff01");if(i!==o)return void Global.DialogManager.addTipDialog("\u4e24\u6b21\u8f93\u5165\u7684\u5bc6\u7801\u4e0d\u4e00\u81f4\uff01");Global.API.http.resetPasswordByPhoneRequest(a,i,r,{},function(e){e.code===Global.Code.OK&&(Global.DialogManager.destroyDialog(this),Global.DialogManager.addTipDialog("\u5bc6\u7801\u91cd\u7f6e\u6210\u529f\uff01"))}.bind(this))}}}),cc._RF.pop()},{}],RoomAPI:[function(e,t,a){"use strict";cc._RF.push(t,"7cb9dtAOTBNnbGwPAFeTfTL","RoomAPI");var r=t.exports;r.roomMessageNotify=function(e){Global.NetworkManager.notify("game.gameHandler.roomMessageNotify",e)},r.gameMessageNotify=function(e){Global.NetworkManager.notify("game.gameHandler.gameMessageNotify",e)},cc._RF.pop()},{}],RoomItem:[function(e,t,a){"use strict";cc._RF.push(t,"a89ecFbyIVOg5JHtK11l89s","RoomItem"),cc.Class({extends:cc.Component,properties:{bgImg:cc.Sprite,minGold:cc.Label,dizhu:cc.Label},start:function(){},onBtnClk:function(e,t){switch(t){case"enterRoom":Global.DialogManager.createDialog("Match/MatchGameDialog",{gameTypeID:this.data.gameTypeID})}},updateUI:function(e){this.data=e,this.node.active=!1,e.kind===Global.Enum.gameType.NN?Global.CCHelper.updateSpriteFrame("Hall/item_bg"+e.level+"_nn",this.bgImg,function(){this.node.active=!0}.bind(this)):Global.CCHelper.updateSpriteFrame("Hall/item_bg"+e.level,this.bgImg,function(){this.node.active=!0}.bind(this)),this.minGold.string="\u5165\u573a\u9650\u5236{0}\u5143".format(e.goldLowerLimit),this.dizhu.string="{0}\u5143\u5e95\u5206".format(e.baseScore)}}),cc._RF.pop()},{}],RoomProto:[function(e,t,a){"use strict";cc._RF.push(t,"f282ed81TBBN6LNoo9Q5wnx","RoomProto");var r=t.exports;r.GAME_STATUS_PLAYING=1,r.USER_READY_NOTIFY=301,r.USER_READY_PUSH=401,r.OTHER_USER_ENTRY_ROOM_PUSH=402,r.USER_LEAVE_ROOM_NOTIFY=303,r.USER_LEAVE_ROOM_RESPONSE=403,r.USER_LEAVE_ROOM_PUSH=404,r.ROOM_DISMISS_PUSH=405,r.ROOM_USER_INFO_CHANGE_PUSH=406,r.USER_CHAT_NOTIFY=307,r.USER_CHAT_PUSH=407,r.USER_OFF_LINE_PUSH=408,r.ROOM_DRAW_FINISHED_PUSH=409,r.ROOM_NOTICE_PUSH=410,r.GAME_WIN_RATE_NOTIFY=311,r.GAME_WIN_RATE_PUSH=411,r.USER_RECONNECT_NOTIFY=312,r.USER_RECONNECT_PUSH=412,r.ASK_FOR_DISMISS_NOTIFY=313,r.ASK_FOR_DISMISS_PUSH=413,r.GAME_END_PUSH=414,r.SORRY_I_WILL_WIN_NOTIFY=415,r.ASK_FOR_DISMISS_STATUS_NOTIFY=316,r.ASK_FOR_DISMISS_STATUS_PUSH=416,r.GET_ROOM_SHOW_USER_INFO_NOTIFY=317,r.GET_ROOM_SHOW_USER_INFO_PUSH=417,r.GET_ROOM_SCENE_INFO_NOTIFY=318,r.GET_ROOM_SCENE_INFO_PUSH=418,r.GET_ROOM_ONLINE_USER_INFO_NOTIFY=319,r.GET_ROOM_ONLINE_USER_INFO_PUSH=419,r.EXIT_WAIT_SECOND=30,r.NOANSWER_WAIT_SECOND=120,r.ANSWER_EXIT_SECOND=30,r.userStatusEnum={NONE:0,READY:1,PLAYING:2,OFFLINE:4},r.IWillWinNotify=function(){return{type:r.SORRY_I_WILL_WIN_NOTIFY,data:{}}},r.selfEntryRoomPush=function(e,t,a){return{roomUserInfoArr:e,gameData:t,kindId:a}},r.roomMessagePush=function(e){return e},r.userChatNotify=function(e){return{type:r.USER_CHAT_NOTIFY,data:{chatData:e}}},r.userChatPush=function(e,t){return{type:r.USER_CHAT_PUSH,data:{chairId:e,chatData:t}}},r.userReadyNotify=function(e){return{type:r.USER_READY_NOTIFY,data:{isReady:e}}},r.userReadyPush=function(e){return{type:r.USER_READY_PUSH,data:{chairId:e}}},r.otherUserEntryRoomPush=function(e){return{type:r.OTHER_USER_ENTRY_ROOM_PUSH,data:{roomUserInfo:e}}},r.userLeaveRoomNotify=function(){return{type:r.USER_LEAVE_ROOM_NOTIFY,data:{}}},r.userLeaveRoomResponse=function(e){return{type:r.USER_LEAVE_ROOM_RESPONSE,data:{chairId:e}}},r.userLeaveRoomPush=function(e){return{type:r.USER_LEAVE_ROOM_PUSH,data:{roomUserInfo:e}}},r.roomDismissReason={RDR_NONE:0,RDR_OWENER_ASK:1,RDR_USER_ASK:2,RDR_TIME_OUT:4},r.roomDismissPush=function(e){return{type:r.ROOM_DISMISS_PUSH,data:{reason:e}}},r.userInfoChangePush=function(e){return{type:r.ROOM_USER_INFO_CHANGE_PUSH,data:{changeInfo:e}}},r.userOffLinePush=function(e){return{type:r.USER_OFF_LINE_PUSH,data:{chairId:e}}},r.roomDrawFinished=function(e){return{type:r.ROOM_DRAW_FINISHED_PUSH,data:{allDrawScoreRecord:e}}},r.getGameWinRateNotifyData=function(e){return{type:this.GAME_WIN_RATE_NOTIFY,data:{rate:e}}},r.getGameWinRatePushData=function(){return{type:this.GAME_WIN_RATE_PUSH,data:{}}},r.getGameRule=function(e,t,a,r,i,o){return{bureau:e,isOwnerPay:t,memberCount:a,diamondCost:r,gameType:i,otherRule:o}},r.getUserReconnectNotifyData=function(){return{type:this.USER_RECONNECT_NOTIFY,data:{}}},r.getUserReconnectPushData=function(e){return{type:this.USER_RECONNECT_PUSH,data:{gameData:e}}},r.getAskForDismissNotifyData=function(e){return{type:this.ASK_FOR_DISMISS_NOTIFY,data:{isExit:e}}},r.getAskForDismissPushData=function(e,t,a,r,i){return{type:this.ASK_FOR_DISMISS_PUSH,data:{nameArr:t,scoreArr:a,chairIdArr:e,tm:r,askChairId:i}}},r.getGameEndPushData=function(e){return{type:this.GAME_END_PUSH,data:{resout:e}}},r.getAskDismissStatusNotifyData=function(){return{type:this.ASK_FOR_DISMISS_STATUS_NOTIFY,data:{}}},r.getAskDismissStatusPushData=function(e){return{type:this.ASK_FOR_DISMISS_STATUS_PUSH,data:{isOnDismiss:e}}},r.getRoomShowUserInfoNotify=function(){return{type:r.GET_ROOM_SHOW_USER_INFO_NOTIFY,data:{}}},r.getRoomShowUserInfoPush=function(e,t,a){return{type:r.GET_ROOM_SHOW_USER_INFO_PUSH,data:{selfUserInfo:e,shenSuanZiInfo:t,fuHaoUserInfoArr:a}}},r.getRoomSceneInfoNotify=function(){return{type:r.GET_ROOM_SCENE_INFO_NOTIFY,data:{}}},r.getRoomSceneInfoPush=function(e,t){return{type:r.GET_ROOM_SCENE_INFO_PUSH,data:{roomUserInfoArr:e,gameData:t}}},r.getRoomOnlineUserInfoNotify=function(){return{type:r.GET_ROOM_ONLINE_USER_INFO_NOTIFY,data:{}}},r.getRoomOnlineUserInfoPush=function(e,t){return{type:r.GET_ROOM_ONLINE_USER_INFO_PUSH,data:{shenSuanZiInfo:e,fuHaoUserInfoArr:t}}},cc._RF.pop()},{}],SceneInit:[function(e,t,a){"use strict";cc._RF.push(t,"529c6eYf91GTrmAnY593uqa","SceneInit"),cc.Class({extends:cc.Component,properties:{sceneType:"",initText:cc.Label,initGroup:cc.Node},initGlobal:function(){this.initText.string="\u521d\u59cb\u5316\u4e2d",Global.Constant=e("./Constant"),Global.MessageCallback=e("./MessageCallback"),Global.DialogManager=e("./DialogManager"),Global.AudioManager=e("./AudioManager"),Global.NetworkManager=e("./NetworkManager"),Global.CCHelper=e("./CCHelper"),Global.Utils=e("./utils"),Global.NetworkLogic=e("./NetworkLogic"),Global.Enum=e("./enumeration"),Global.Code=e("./code"),Global.API=e("./Api"),Global.Player=e("../Models/Player"),Global.PlayerWechat=e("../Models/PlayerWechat"),Global.GameTypes=e("../Models/GameTypes"),Global.Data=e("../Models/Data"),Global.Animation=e("./Animation"),Global.AgentProfit=e("../Models/AgentProfit")},onLoad:function(){cc.debug.setDisplayStats(!0),this.initGlobal(),Global.CCHelper.screenAdaptation(new cc.Size(1280,720),this.node.getComponent(cc.Canvas)),Global.DialogManager.init(this.node),Global.AudioManager.init(),Global.NetworkLogic.init(),cc.game.on(cc.game.EVENT_HIDE,this.onEventHide.bind(this)),cc.game.on(cc.game.EVENT_HIDE,this.onEventShow.bind(this)),this.enterGame()},onDestroy:function(){cc.game.off(cc.game.EVENT_HIDE,this.onEventHide.bind(this)),cc.game.off(cc.game.EVENT_HIDE,this.onEventShow.bind(this)),Global.NetworkLogic.deInit()},onEventHide:function(){Global.MessageCallback.emitMessage("GAME_EVENT",cc.game.EVENT_HIDE)},onEventShow:function(){Global.MessageCallback.emitMessage("GAME_EVENT",cc.game.EVENT_SHOW)},enterGame:function(){var e=function(){this.initGroup.destroy()}.bind(this);Global.CCHelper.isWechatBrowser()?(Global.GameTypes.setState(this.locationParams.state),Global.DialogManager.createDialog("Login/LoginDialog",null,e)):(Global.GameTypes.setState(this.sceneType),Global.DialogManager.createDialog("Login/LoginDialog",null,e))}}),cc._RF.pop()},{"../Models/AgentProfit":"AgentProfit","../Models/Data":"Data","../Models/GameTypes":"GameTypes","../Models/Player":"Player","../Models/PlayerWechat":"PlayerWechat","./Animation":"Animation","./Api":"Api","./AudioManager":"AudioManager","./CCHelper":"CCHelper","./Constant":"Constant","./DialogManager":"DialogManager","./MessageCallback":"MessageCallback","./NetworkLogic":"NetworkLogic","./NetworkManager":"NetworkManager","./code":"code","./enumeration":"enumeration","./utils":"utils"}],SettingDialog:[function(e,t,a){"use strict";cc._RF.push(t,"28e4dkHE1FOqYgUz5UV+R0m","SettingDialog"),cc.Class({extends:cc.Component,properties:{progressMusic:cc.ProgressBar,sliderMusic:cc.Slider,progressSound:cc.ProgressBar,sliderSound:cc.Slider},onLoad:function(){var e=cc.sys.localStorage.getItem("MusicVolume"),t=cc.sys.localStorage.getItem("SoundVolume");this.dialogParameters&&(this.callback=this.dialogParameters.callback,this.dialogParameters.rotate&&(this.node.getChildByName("mask").rotation=90,this.node.rotation=90)),this.progressMusic.progress=e,this.sliderMusic.progress=e,this.progressSound.progress=t,this.sliderSound.progress=t},onBtnClk:function(e,t){switch(t){case"close":case"confirm":Global.DialogManager.destroyDialog(this);break;case"music_slider":this.progressMusic.progress=e.progress,Global.AudioManager.setMusicVolume(this.progressMusic.progress),this.callback&&this.callback();break;case"sound_slider":this.progressSound.progress=e.progress,Global.AudioManager.setSoundVolume(this.progressSound.progress),this.callback&&this.callback()}}}),cc._RF.pop()},{}],ShowItem:[function(e,t,a){"use strict";cc._RF.push(t,"50ba33WobVM6qAaQIXQ2lV0","ShowItem"),cc.Class({extends:cc.Component,properties:{qrCtrl:e("ShowQRWidgetCtrl")},onLoad:function(){var e=Global.Constant.gameServerAddress+"/getQRCodeImgWithUrl?uid="+Global.Player.getPy("uid");this.qrCtrl.setUrl(e)}}),cc._RF.pop()},{ShowQRWidgetCtrl:"ShowQRWidgetCtrl"}],ShowQRWidgetCtrl:[function(e,t,a){"use strict";cc._RF.push(t,"3d35bncLTpOwKTGDqWGkiYx","ShowQRWidgetCtrl"),cc.Class({extends:cc.Component,properties:{},setUrl:function(e){var t=this.node.addComponent(cc.Graphics);this.QRCreate(t,e)},QRCreate:function(e,t){var a=new QRCode(-1,QRErrorCorrectLevel.H);a.addData(t),a.make(),e.fillColor=cc.Color.BLACK;for(var r=this.node.width/a.getModuleCount(),i=this.node.height/a.getModuleCount(),o=0;o<a.getModuleCount();o++)for(var n=0;n<a.getModuleCount();n++)if(a.isDark(o,n)){var s=Math.ceil((n+1)*r)-Math.floor(n*r),c=Math.ceil((o+1)*r)-Math.floor(o*r);e.rect(Math.round(n*r),Math.round(o*i),s,c),e.fill()}}}),cc._RF.pop()},{}],SpriteAtlasAnimationWidgetCtrl:[function(e,t,a){"use strict";cc._RF.push(t,"724c6Guv+RJPbR/VuC5AQ50","SpriteAtlasAnimationWidgetCtrl"),cc.Class({extends:cc.Component,properties:{intervalTime:0,spriteAtlas:cc.SpriteAtlas,baseSprite:cc.Sprite,playOnLoad:!0,startIndex:0,loop:!0},onLoad:function(){this.curFrameIndex=this.startIndex,this.spriteFrameArr=this.spriteAtlas.getSpriteFrames(),this.count=this.spriteFrameArr.length,this.setCurFrameIndex(this.curFrameIndex),this.playOnLoad&&(this.initAnimation(),this.startAnimation(this.loop,1))},initAnimation:function(e,t,a){this.intervalTime=t||this.intervalTime,this.spriteFrameArr=e||this.spriteFrameArr,this.startIndex=a||0,e&&(this.count=e.length)},setCurFrameIndex:function(e){this.curFrameIndex=e%this.count,this.baseSprite.spriteFrame=this.spriteFrameArr[this.curFrameIndex]},startAnimation:function(e,t,a){this.count||this.initAnimation(),(!t||t<=0)&&(t=1);var r=this.intervalTime/t;this.node.stopAllActions(),this.setCurFrameIndex(0);var i=this;function o(){var e=++i.curFrameIndex%i.count;i.curFrameIndex=e,i.baseSprite.spriteFrame=i.spriteFrameArr[i.curFrameIndex],a&&e===i.count-1&&a()}e?this.node.runAction(cc.repeatForever(cc.sequence([cc.delayTime(r),cc.callFunc(o)]))):this.node.runAction(cc.repeat(cc.sequence([cc.delayTime(r),cc.callFunc(o)]),this.count-1))},stopAnimation:function(){this.node.stopAllActions()}}),cc._RF.pop()},{}],SpriteFrameAnimationWidgetCtrl:[function(e,t,a){"use strict";cc._RF.push(t,"c7cdfqqIndFsJdKLWAeMrh9","SpriteFrameAnimationWidgetCtrl"),cc.Class({extends:cc.Component,properties:{intervalTime:0,spriteFrameArr:[cc.SpriteFrame],startIndex:0,baseSprite:cc.Sprite},start:function(){this.curFrameIndex=this.startIndex,this.count=this.spriteFrameArr.length,this.setCurFrameIndex(this.curFrameIndex)},initAnimation:function(e,t,a){this.intervalTime=t||this.intervalTime,this.spriteFrameArr=e||this.spriteFrameArr,this.startIndex=a||0,this.count=this.spriteFrameArr.length},setCurFrameIndex:function(e){this.curFrameIndex=e%this.count,this.baseSprite.spriteFrame=this.spriteFrameArr[this.curFrameIndex]},startAnimation:function(e,t,a){this.count||this.initAnimation(),(!t||t<=0)&&(t=1);var r=this.intervalTime/t;this.node.stopAllActions(),this.setCurFrameIndex(0);var i=this;function o(){var e=++i.curFrameIndex%i.count;i.curFrameIndex=e,i.baseSprite.spriteFrame=i.spriteFrameArr[i.curFrameIndex],a&&e===i.count-1&&a()}e?this.node.runAction(cc.repeatForever(cc.sequence([cc.delayTime(r),cc.callFunc(o)]))):this.node.runAction(cc.repeat(cc.sequence([cc.delayTime(r),cc.callFunc(o)]),this.count))},stopAnimation:function(){this.node.stopAllActions()}}),cc._RF.pop()},{}],TTZAudioNode:[function(e,t,a){"use strict";cc._RF.push(t,"636a92sDA5Ptb0sw27VL4sZ","TTZAudioNode"),cc.Class({extends:cc.Component,properties:{dian0:cc.AudioSource,dian1:cc.AudioSource,dian2:cc.AudioSource,dian3:cc.AudioSource,dian4:cc.AudioSource,dian5:cc.AudioSource,dian6:cc.AudioSource,dian7:cc.AudioSource,dian8:cc.AudioSource,dian9:cc.AudioSource,backMusic:cc.AudioSource,startGame:cc.AudioSource,flipCard:cc.AudioSource,winAll:cc.AudioSource,loseAll:cc.AudioSource,baozi:cc.AudioSource,dice:cc.AudioSource},start:function(){this.setVolume(),Global.AudioManager.startPlayBgMusic("TuiTongZi/Audio/BackMusic")},onDestroy:function(){Global.AudioManager.stopBgMusic()},playDot:function(e){[this.dian0,this.dian1,this.dian2,this.dian3,this.dian4,this.dian5,this.dian6,this.dian7,this.dian8,this.dian9][e].play()},playBaozi:function(){this.baozi.play()},playStartGame:function(){this.startGame.play()},playFlipCard:function(){this.flipCard.play()},playWinAll:function(){this.winAll.play()},playLoseAll:function(){this.loseAll.play()},playDice:function(){this.dice.play()},setVolume:function(){for(var e=Global.AudioManager.getSoundVolume(),t=[this.dian0,this.dian1,this.dian2,this.dian3,this.dian4,this.dian5,this.dian6,this.dian7,this.dian8,this.dian9,this.startGame,this.flipCard,this.winAll,this.loseAll,this.baozi,this.dice],a=0;a<t.length;++a)t[a].volume=e}}),cc._RF.pop()},{}],TTZBankerItem:[function(e,t,a){"use strict";cc._RF.push(t,"9dd40IZNElIOYUBunKnimrT","TTZBankerItem"),cc.Class({extends:cc.Component,properties:{bankerBg:cc.Node,nameLabel:cc.Label,goldLabel:cc.Label},start:function(){},setNameAndGold:function(e,t,a){this.bankerBg.active=a,this.nameLabel.string=e,this.goldLabel.string=t}}),cc._RF.pop()},{}],TTZBankerList:[function(e,t,a){"use strict";cc._RF.push(t,"59dceHztYZLmZ5rSX0V0Hrg","TTZBankerList");var r=e("./TTZProto"),i=e("./TTZModel"),o="game.gameHandler.gameMessageNotify";cc.Class({extends:cc.Component,properties:{content:cc.Node,bankerListItem:cc.Prefab},start:function(){this.isOut=!1,this.originPos=this.node.getPosition()},onDestroy:function(){},messageCallbackHandler:function(e,t){var a=i.getMyUid();"GameMessagePush"===e&&(t.type===r.GAME_BANKERCHANGE_PUSH||t.type===r.GAME_ASKTOBEBANKER_PUSH&&t.data.bankerUid===a&&this.isOut&&this.pullMenu())},onButtonClick:function(e,t){var a=i.getMe().userInfo.gold;"banker"!==t&&a<parseInt(t)?console.log("error: gold not enough"):"3000"===t?(Global.NetworkManager.notify(o,r.askToBeBankerRequestData(3e3)),this.pullMenu()):"2000"===t?(Global.NetworkManager.notify(o,r.askToBeBankerRequestData(2e3)),this.pullMenu()):"1000"===t?(Global.NetworkManager.notify(o,r.askToBeBankerRequestData(1e3)),this.pullMenu()):"banker"===t&&this.pullMenu()},pullMenu:function(){this.isOut?(this.isOut=!1,this.node.stopAllActions(),this.node.runAction(cc.moveTo(.2,cc.v2(this.originPos.x,this.originPos.y)))):(this.isOut=!0,this.node.stopAllActions(),this.node.runAction(cc.moveTo(.2,cc.v2(this.originPos.x+640,this.originPos.y))),this.fillScrollView())},fillScrollView:function(){this.content.removeAllChildren();var e,t,a=i.getBankerPool(),r=["3000","2000","1000"];for(t=0;t<r.length;++t)e+=a[r[t]].length;var o=i.getBanker();o&&(e+=1);var n,s,c,l=80*e;l<490&&(l=490),this.content.height=l;var d=0;if(o){d=.5,(n=cc.instantiate(this.bankerListItem)).parent=this.content,n.setPosition(cc.v2(0,-80*d)),s=n.getComponent("TTZBankerItem");var h=i.getBankerPourPool();s.setNameAndGold(o.userInfo.nickname,h.pourGold,!0)}for(t=0;t<r.length;++t)for(var u=0;u<a[r[t]].length;++u)(c=i.getUserByUid(a[r[t]][u]))?(++d,(s=(n=cc.instantiate(this.bankerListItem)).getComponent("TTZBankerItem")).setNameAndGold(c.userInfo.nickname,r[t],!1),n.parent=this.content,n.setPosition(cc.v2(0,-80*d))):console.log("error can not find user",a[r[t]][u])}}),cc._RF.pop()},{"./TTZModel":"TTZModel","./TTZProto":"TTZProto"}],TTZBankerOpNode:[function(e,t,a){"use strict";cc._RF.push(t,"62d41gENbdC2JoKDom5sxZZ","TTZBankerOpNode");var r=e("./TTZProto"),i=e("../../API/RoomProto"),o=e("./TTZModel"),n="game.gameHandler.gameMessageNotify";cc.Class({extends:cc.Component,properties:{bankerDownButton:cc.Button,twoThousandButton:cc.Button,threeThousandButton:cc.Button},start:function(){Global.MessageCallback.addListener("GameMessagePush",this),Global.MessageCallback.addListener("RoomMessagePush",this)},reconnect:function(){this.gameStatusChange()},onDestroy:function(){Global.MessageCallback.removeListener("GameMessagePush",this),Global.MessageCallback.removeListener("RoomMessagePush",this)},messageCallbackHandler:function(e,t){"GameMessagePush"===e?t.type===r.GAME_STATUSCHANGE_PUSH||(t.type,r.GAME_CONTINUEBANKER_PUSH):"RoomMessagePush"===e&&(t.type,i.USER_RECONNECT_PUSH)},answerContinueBanker:function(){this.bankerDownButton.node.active=!1,this.twoThousandButton.node.active=!1,this.threeThousandButton.node.active=!1},gameStatusChange:function(e){if(o.getMyUid()===o.getBankerUid()&&e===r.GAME_STATUS_SETTLE){var t=o.getBankGold(),a=o.getBankerPourPool(),i=o.getBanker().userInfo.gold;this.bankerDownButton.node.active=!0,this.twoThousandButton.node.active=!0,this.threeThousandButton.node.active=!0,3e3===t||i<t+1e3?(this.twoThousandButton.interactable=!1,this.threeThousandButton.interactable=!1):2e3===t?(this.twoThousandButton.interactable=!1,this.threeThousandButton.interactable=i>=t+1e3):(this.twoThousandButton.interactable=i>=t+1e3,this.threeThousandButton.interactable=i>=t+2e3),this.bankerDownButton.interactable=o.getBureau()>=3,a.curGold<t&&(this.bankerDownButton.interactable=!0)}else this.bankerDownButton.node.active=!1,this.twoThousandButton.node.active=!1,this.threeThousandButton.node.active=!1},onButtonClick:function(e,t){"down"===t?Global.NetworkManager.notify(n,r.askToBePlayerRequestData()):"2000"===t?Global.NetworkManager.notify(n,r.continueBankerRequestData(2e3)):"3000"===t&&Global.NetworkManager.notify(n,r.continueBankerRequestData(3e3))}}),cc._RF.pop()},{"../../API/RoomProto":"RoomProto","./TTZModel":"TTZModel","./TTZProto":"TTZProto"}],TTZCards:[function(e,t,a){"use strict";cc._RF.push(t,"28da3vJELRO6JOg1Y76XL29","TTZCards");var r=e("./TTZProto"),i=e("../../API/RoomProto"),o=e("./TTZModel"),n=e("./TTZLogic");cc.Class({extends:cc.Component,properties:{sortCardNode:cc.Node,tianmenNode:cc.Node,zhongmenNode:cc.Node,dimenNode:cc.Node,zhuangNode:cc.Node,handNode:cc.Node,sendCardNode:cc.Node},start:function(){this.audioManager=this.node.parent.getComponent("TTZMainDialog").getAudioManager(),this.initSortCard(),Global.MessageCallback.addListener("RoomMessagePush",this),Global.MessageCallback.addListener("GameMessagePush",this),this.reconnect()},reconnect:function(){for(var e=o.getGameStatus(),t=o.getBureau(),a=0;a<this.cardNodeArr.length;++a)this.cardNodeArr[a].stopAllActions(),e===r.GAME_STATUS_WAITING||e===r.GAME_STATUS_START||e===r.GAME_STATUS_POUR?this.cardNodeArr[a].active=a>=8*(t-1):e!==r.GAME_STATUS_RESOUT&&e!==r.GAME_STATUS_SETTLE||(this.cardNodeArr[a].active=a>=8*t);e!==r.GAME_STATUS_RESOUT?this.recoveryCards():this.showResout()},onDestroy:function(){this.unscheduleAllCallbacks(),Global.MessageCallback.removeListener("RoomMessagePush",this),Global.MessageCallback.removeListener("GameMessagePush",this)},messageCallbackHandler:function(e,t){"GameMessagePush"===e?t.type===r.GAME_STATUSCHANGE_PUSH?this.gameStatusChange(t.data.gameStatus):t.type===r.GAME_RESOUT_PUSH&&(this.cardsArr=t.data.resout.cardsArr):"RoomMessagePush"===e&&t.type===i.USER_RECONNECT_PUSH&&this.reconnect()},gameStatusChange:function(e){e||(e=o.getGameStatus()),e===r.GAME_STATUS_WAITING||(e===r.GAME_STATUS_SORTCARD?(this.playSortCardAnimal(),this.audioManager.playStartGame()):e===r.GAME_STATUS_POUR||(e===r.GAME_STATUS_RESOUT?this.scheduleOnce(function(){this.playSendCardAnimal()}.bind(this),2):e===r.GAME_STATUS_SETTLE?this.recoveryCards():e===r.GAME_STATUS_START&&this.audioManager.playStartGame()))},initSortCard:function(){var e,t;for(this.cardNodeArr=[],this.cardNodePosArr=[],this.sendCardPosArr=[],e=0;e<40;++e)(t=this.getCardNode()).parent=this.sortCardNode,e%2==0?this.cardNodePosArr.push(cc.v2(10*(19.5-e/2),0)):this.cardNodePosArr.push(cc.v2(10*(19.5-Math.floor(e/2)),4)),t.setPosition(this.cardNodePosArr[e]),this.cardNodeArr.push(t);for(e=0;e<8;++e)t=this.sendCardNode.getChildByName("Card"+(e+1)),this.sendCardPosArr.push(t.getPosition())},playSortCardAnimal:function(){for(var e=this,t=0;t<this.cardNodeArr.length;++t)this.cardNodeArr[t].active=!0;var a=function(){for(var t,a,r=[3,6,9,12,-3,-6,-9,-12],i=0;i<e.cardNodeArr.length;++i)t=cc.v2(e.cardNodePosArr[i].x+r[Math.floor(Math.random()*r.length)],e.cardNodePosArr[i].y+r[Math.floor(Math.random()*r.length)]),e.cardNodeArr[i].runAction(cc.moveTo(.2,t)),a=.2*Math.random(),e.cardNodeArr[i].runAction(cc.fadeOut(a)),e.cardNodeArr[i].runAction(cc.fadeIn(.2-a))};this.schedule(a,.2),this.scheduleOnce(function(){e.unschedule(a);for(var t=0;t<e.cardNodeArr.length;++t)e.cardNodeArr[t].stopAllActions(),e.cardNodeArr[t].opacity=255,e.cardNodeArr[t].setPosition(e.cardNodePosArr[t])},4)},playSendCardAnimal:function(){var e=o.getTouzi(),t=e.touzi1+e.touzi2,a=o.getBureau(),r=0,i=this.handNode.getPosition(),n=this.sortCardNode.getPosition(),s=this.sendCardNode.getPosition(),c=this.sendCardPosArr,l=this,d=function e(){var a=[l.zhuangNode,l.tianmenNode,l.zhongmenNode,l.dimenNode],i=a[(t-1+Math.floor(r/2))%4];if(r>0){i.getChildByName("Card1").active=!0,i.getChildByName("Card2").active=!0;var o=l.sendCardNode.getChildByName("Card"+(r-1)),n=l.sendCardNode.getChildByName("Card"+r);o.setPosition(c[r-2]),n.setPosition(c[r-1]),o.active=!1,n.active=!1}if(8===r)return l.unschedule(e),void l.playFlipAnimal(t);var d=a[(t+Math.floor(r/2))%4],h=d.getChildByName("Card1").getPosition(),u=d.getChildByName("Card2").getPosition(),g=l.sendCardNode.getChildByName("Card"+(r+1)),C=l.sendCardNode.getChildByName("Card"+(r+2));g.runAction(cc.moveTo(.05,cc.v2(h.x-s.x,h.y-s.y))),C.runAction(cc.moveTo(.05,cc.v2(u.x-s.x,u.y-s.y))),r+=2},h=function e(){var t=r+8*(a-1);if(r>0&&(l.cardNodeArr[t-2].active=!1,l.cardNodeArr[t-1].active=!1,l.cardNodeArr[t-2].setPosition(l.cardNodePosArr[t-2]),l.cardNodeArr[t-1].setPosition(l.cardNodePosArr[t-1]),l.sendCardNode.getChildByName("Card"+(r-1)).active=!0,l.sendCardNode.getChildByName("Card"+r).active=!0),8===r)return l.unschedule(e),r=0,void l.scheduleOnce(function(){l.schedule(d,.1)},.5);var i=l.cardNodeArr[t],o=l.cardNodeArr[t+1],s=l.sendCardNode.getChildByName("Card"+(r+1)).getPosition(),c=l.sendCardNode.getChildByName("Card"+(r+2)).getPosition();i.runAction(cc.moveTo(.1,cc.v2(s.x-n.x,s.y-n.y))),o.runAction(cc.moveTo(.1,cc.v2(c.x-n.x,c.y-n.y))),r+=2};this.schedule(function e(){var t,o=r+8*(a-1);if(8===r)return l.unschedule(e),r=0,void l.schedule(h,.1);t=o%2==0?l.cardNodeArr[o+1]:l.cardNodeArr[o-1];var s=cc.v2(i.x-n.x,i.y-n.y);t.runAction(cc.moveTo(.1,s)),++r},.1)},playFlipAnimal:function(e){var t=this,a=0,r=[t.zhuangNode,t.tianmenNode,t.zhongmenNode,t.dimenNode];this.schedule(function i(){var n=r[(e+a)%4],s=t.cardsArr[(e+a)%4];n.getChildByName("Card1").getComponent(cc.Animation).play("FlipCardAnimation"),t.audioManager.playFlipCard();var c=n.getChildByName("Word1"),l=n.getChildByName("Word2");if(t.scheduleOnce(function(){n.getChildByName("Card2").getComponent(cc.Animation).play("FlipCardAnimation"),t.audioManager.playFlipCard(),t.updateNodeFrame(t.getCardUrl(s[0]),c),c.active=!0},.2),t.scheduleOnce(function(){t.updateNodeFrame(t.getCardUrl(s[1]),l),l.active=!0,t.setCardType(n,s)},.4),t.scheduleOnce(function(){var e=t.getCardType(s);10===e?t.audioManager.playBaozi():t.audioManager.playDot(e)},.6),4==++a){t.unschedule(i);var d=o.getResout().winArr;d[0]&&d[1]&&d[2]?t.scheduleOnce(function(){t.audioManager.playWinAll()},1):d[0]||d[1]||d[2]||t.scheduleOnce(function(){t.audioManager.playLoseAll()},1)}},.8)},showResout:function(){for(var e=this,t=o.getResout(),a=[e.zhuangNode,e.tianmenNode,e.zhongmenNode,e.dimenNode],i=[r.ZHUANGJIA,r.TIANMEN,r.ZHONGMEN,r.DIMEN],n=function(t,a){var r=["Card1","Card2","Word1","Word2"],i=["TuiTongZi/Common/mj5","TuiTongZi/Common/mj5",e.getCardUrl(a[0]),e.getCardUrl(a[1])];cc.loader.loadResArray(i,cc.SpriteFrame,function(e,a){if(!e)for(var i=0;i<r.length;++i){var o=t.getChildByName(r[i]);o.getComponent(cc.Sprite).spriteFrame=a[i],o.active=!0}})},s=0;s<a.length;++s){var c=a[s],l=t.cardsArr[i[s]];n(c,l),this.setCardType(c,l)}},getCardUrl:function(e){var t="TuiTongZi/Common/img_mj_0"+(e%10+1);return e%10+1==10&&(t="TuiTongZi/Common/img_mj_10"),t},setCardType:function(e,t){for(var a=["Baozi","Count","Dot","Ban"],r=0;r<a.length;++r)e.getChildByName(a[r]).active=!1;if(n.verifyCardsIsBaozi(t))e.getChildByName("Baozi").active=!0;else{var i=n.getCardNumber(t[0])+n.getCardNumber(t[1]),o=e.getChildByName("Count");o.active=!0,o.getComponent(cc.Label).string=Math.floor(i%10),e.getChildByName("Dot").active=!0,e.getChildByName("Ban").active=i%1>0}},recoveryCards:function(){this.unscheduleAllCallbacks();for(var e=[this.zhuangNode,this.tianmenNode,this.zhongmenNode,this.dimenNode],t=["Card1","Card2","Word1","Word2","Baozi","Count","Dot","Ban"],a=0;a<e.length;++a){for(var r=0;r<t.length;++r)e[a].getChildByName(t[r]).active=!1;this.updateNodeFrame("TuiTongZi/Common/mj1",e[a].getChildByName("Card1")),this.updateNodeFrame("TuiTongZi/Common/mj1",e[a].getChildByName("Card2"))}},getCardNode:function(){var e=new cc.Node,t=e.addComponent(cc.Sprite);return cc.loader.loadRes("TuiTongZi/Common/mj1",cc.SpriteFrame,function(a,r){a?console.log("error getCardNode",a.message):(t.spriteFrame=r,e.width=10,e.height=15)}),e},updateNodeFrame:function(e,t){cc.loader.loadRes(e,cc.SpriteFrame,function(e,a){e?console.log("error updateNodeFrame",e.message):t.getComponent(cc.Sprite).spriteFrame=a})},getCardType:function(e){return e[0]%10==e[1]%10?10:Math.floor((e[0]+e[1])%10)}}),cc._RF.pop()},{"../../API/RoomProto":"RoomProto","./TTZLogic":"TTZLogic","./TTZModel":"TTZModel","./TTZProto":"TTZProto"}],TTZCoinButtons:[function(e,t,a){"use strict";cc._RF.push(t,"c1bcen3UcxK0q8hg/rOPeqK","TTZCoinButtons");var r=e("./TTZProto"),i=e("../../API/RoomProto"),o=e("./TTZModel");cc.Class({extends:cc.Component,properties:{rootNode:cc.Node,button1:cc.Node,button2:cc.Node,button3:cc.Node,button4:cc.Node,button5:cc.Node},start:function(){Global.MessageCallback.addListener("RoomMessagePush",this),Global.MessageCallback.addListener("GameMessagePush",this),this.button1.getComponent(cc.Button).interactable=!1},onDestroy:function(){Global.MessageCallback.removeListener("RoomMessagePush",this),Global.MessageCallback.removeListener("GameMessagePush",this)},messageCallbackHandler:function(e,t){"GameMessagePush"===e?t.type===r.GAME_STATUSCHANGE_PUSH||t.type===r.GAME_BANKERCHANGE_PUSH&&this.bankerChange(t.data.bankerUid):"RoomMessagePush"===e&&t.type===i.USER_RECONNECT_PUSH&&this.bankerChange(t.data.gameData.bankerUid)},bankerChange:function(e){e||(e=o.getBankerUid()),this.rootNode.active=e!==o.getMyUid()},onButtonClick:function(e,t){for(var a=[this.button1,this.button2,this.button3,this.button4,this.button5],r=[1,10,50,100,500],i=0;i<a.length;++i)parseInt(t)===r[i]?(a[i].getComponent(cc.Button).interactable=!1,o.setChooseCoin(r[i])):a[i].getComponent(cc.Button).interactable=!0}}),cc._RF.pop()},{"../../API/RoomProto":"RoomProto","./TTZModel":"TTZModel","./TTZProto":"TTZProto"}],TTZDirItem:[function(e,t,a){"use strict";cc._RF.push(t,"14e564/9l9P6obyRg1VpGBc","TTZDirItem"),cc.Class({extends:cc.Component,properties:{labelZhuang:cc.Label,labelTian:cc.Label,labelZhong:cc.Label,labelDi:cc.Label},start:function(){},setLabel:function(e){for(var t=[this.labelZhuang,this.labelTian,this.labelZhong,this.labelDi],a=0;a<t.length;++a)t[a].string=e[a]}}),cc._RF.pop()},{}],TTZDirection:[function(e,t,a){"use strict";cc._RF.push(t,"edf2dex0hdG5pkl+r6bqbe0","TTZDirection");var r=e("TTZModel");e("TTZLogic");cc.Class({extends:cc.Component,properties:{content:cc.Node,item:cc.Prefab},start:function(){this.isOut=!1},fillScrollView:function(){this.content.removeAllChildren();var e=r.getGameDirRecord(),t=40*e.length;t<396&&(t=396);for(var a=0;a<e.length;++a){var i=cc.instantiate(this.item);i.parent=this.content,i.setPosition(cc.v2(0,-40*(a+.5))),i.getComponent("TTZDirItem").setLabel(this.getLabelStrByCards(e[e.length-a-1]))}},getLabelStrByCards:function(e){for(var t=[],a=0;a<e.length;++a)if(e[a][0]%10==e[a][1]%10)t.push("\u8c79\u5b50");else{var r=(e[a][0]+e[a][1])%10;r%1>0?t.push(Math.floor(r)+"\u70b9\u534a"):t.push(r+"\u70b9")}return t},onButtonClick:function(e,t){this.originPos||(this.originPos=this.node.getPosition()),"zoushi"===t&&(this.isOut?(this.node.stopAllActions(),this.isOut=!this.isOut,this.node.runAction(cc.moveTo(.2,this.originPos))):(this.isOut=!this.isOut,this.node.stopAllActions(),this.node.runAction(cc.moveTo(.2,cc.v2(this.originPos.x+445,this.originPos.y))),this.fillScrollView()))}}),cc._RF.pop()},{TTZLogic:"TTZLogic",TTZModel:"TTZModel"}],TTZHead:[function(e,t,a){"use strict";cc._RF.push(t,"99555d/vZJFaZM7L/Qj8xu6","TTZHead");var r=e("./TTZProto"),i=e("../../API/RoomProto"),o=e("./TTZModel");cc.Class({extends:cc.Component,properties:{nameLabel:cc.Label,goldLabel:cc.Label,headSprite:cc.Sprite},start:function(){Global.MessageCallback.addListener("GameMessagePush",this),Global.MessageCallback.addListener("RoomMessagePush",this)},reconnect:function(){this.setHeadMsg(this.headUid,this.isTop)},onDestroy:function(){Global.MessageCallback.removeListener("GameMessagePush",this),Global.MessageCallback.removeListener("RoomMessagePush",this)},messageCallbackHandler:function(e,t){var a=o.getMyUid();"GameMessagePush"===e?t.type===r.GAME_BANKERCHANGE_PUSH?this.isTop&&this.setHeadMsg(t.data.bankerUid,this.isTop):t.type===r.GAME_CONTINUEBANKER_PUSH?this.isTop?t.data.bankerUid!==a&&this.setHeadMsg(t.data.bankerUid,this.isTop):t.data.bankerUid===a&&this.setHeadMsg(t.data.bankerUid,this.isTop):t.type===r.GAME_STATUSCHANGE_PUSH?this.gameStatusChange(t.data.gameStatus):t.type===r.GAME_ASKTOBEPLAYER_PUSH?this.bankerAskToBePlayer(t.data.bankerUid):t.type===r.GAME_POURGOLD_PUSH&&t.data.uid===this.headUid&&this.headUid===a&&this.refrushHead():"RoomMessagePush"===e&&t.type===i.USER_RECONNECT_PUSH&&this.reconnect()},bankerAskToBePlayer:function(e){this.isTop?this.setHeadMsg(null,this.isTop):e===this.headUid&&this.setHeadMsg(e,this.isTop)},gameStatusChange:function(e){e||(e=o.getGameStatus()),e===r.GAME_STATUS_WAITING||e===r.GAME_STATUS_SORTCARD||e===r.GAME_STATUS_POUR||e===r.GAME_STATUS_RESOUT||(e===r.GAME_STATUS_SETTLE?this.setHeadMsg(this.headUid,this.isTop):r.GAME_STATUS_START)},setHeadMsg:function(e,t){this.headUid=e,this.isTop=t,this.refrushHead();var a=o.getUserByUid(e);a&&Global.CCHelper.updateSpriteFrame(a.userInfo.avatar,this.headSprite)},refrushHead:function(){var e=o.getMe(),t=o.getMyPourGold();this.nameLabel.string=e.userInfo.nickname,this.goldLabel.string=(e.userInfo.gold-t).toFixed(2)}}),cc._RF.pop()},{"../../API/RoomProto":"RoomProto","./TTZModel":"TTZModel","./TTZProto":"TTZProto"}],TTZLogic:[function(e,t,a){"use strict";cc._RF.push(t,"c10232+YSdAWaS639WVNmD4","TTZLogic");var r=t.exports,i=e("./TTZProto");r.CARDS_COUNT=40,r.CARDS_BUREAU_COUNT=8,r.getCards=function(){var e,t,a,r,i=[];for(e=0;e<this.CARDS_COUNT;++e)i[e]=e;for(e=0;e<100;++e)t=Math.floor(Math.random()*this.CARDS_COUNT),a=Math.floor(Math.random()*this.CARDS_COUNT),r=i[t],i[t]=i[a],i[a]=r;return i},r.getCardsArrByBureau=function(e,t){var a,r=[[],[],[],[]],i=8*(t-1);for(a=0;a<8;++a)r[Math.floor(a/2)][a%2]=e[i+a];return r},r.getCardNumber=function(e){return e%10==0?.5:e%10},r.verifyCardsIsBaozi=function(e){return e[0]%10==e[1]%10},r.compareCards=function(e,t){var a=this.verifyCardsIsBaozi(e),r=this.verifyCardsIsBaozi(t),i=this.getCardNumber(e[0]),o=this.getCardNumber(e[1]),n=this.getCardNumber(t[0]),s=this.getCardNumber(t[1]);if(a&&!r)return 1;if(!a&&r)return-1;if(a&&r)return i===n?0:.5===i?1:.5===n?-1:i>n?1:-1;var c=(i+o)%10,l=(n+s)%10;return c===l?(i=i>o?i:o)===(n=n>s?n:s)?0:i>n?1:-1:c>l?1:-1},r.getResout=function(e,t){var a,r,o,n,s=0,c={},l=[],d=[i.TIANMEN,i.ZHONGMEN,i.DIMEN];for(a=0;a<3;++a)for(o=d[a],0===(n=this.compareCards(e[i.ZHUANGJIA],e[o]))&&(n=1),l.push(1===n),r=0;r<t[o].length;++r)s+=n*t[o][r].pourGold,c[t[o][r].uid]?c[t[o][r].uid]-=n*t[o][r].pourGold:c[t[o][r].uid]=-n*t[o][r].pourGold;return{cardsArr:e,winArr:l,bankerWin:s,usersWin:c}},cc._RF.pop()},{"./TTZProto":"TTZProto"}],TTZMainDialog:[function(e,t,a){"use strict";cc._RF.push(t,"3e85cjwMPdF+bgA1MQnktjc","TTZMainDialog");var r=e("../../API/RoomProto"),i=e("./TTZProto"),o=e("./TTZModel");cc.Class({extends:cc.Component,properties:{myHeadNode:cc.Node,cardsNode:cc.Node,touziNode:cc.Node,onLineMenu:cc.Node,deskLabel:cc.Label,cardLabel:cc.Label,coinButtons:cc.Node,tianmenAreaNode:cc.Node,zhongmenAreaNode:cc.Node,dimenAreaNode:cc.Node,audioItem:cc.Prefab},start:function(){this.speed=1500,this.pourCoinNodeArr=[],this.myHeadNode.getComponent("TTZHead").setHeadMsg(o.getMyUid(),!1),this.setCardLabel(),this.reconnect();var e=cc.instantiate(this.audioItem);e.parent=this.node,this.audioManager=e.getComponent("TTZAudioNode"),Global.MessageCallback.addListener("RoomMessagePush",this),Global.MessageCallback.addListener("GameMessagePush",this),Global.MessageCallback.addListener("ReConnectSuccess",this)},reconnect:function(){for(var e=o.getGameStatus(),t=this.pourCoinNodeArr.length-1;t>=0;--t)this.pourCoinNodeArr[t]&&(this.pourCoinNodeArr[t].removeFromParent(),this.pourCoinNodeArr.pop());if(e===i.GAME_STATUS_POUR){var a=[i.TIANMEN,i.DIMEN,i.ZHONGMEN];for(t=0;t<a.length;++t){var r=o.getPourGoldOnDir(a[t]);this.playerPourGold(null,a[t],r)}}else e===i.GAME_STATUS_RESOUT&&Global.DialogManager.createDialog("TuiTongZi/TTZResoutDialog",o.getResout())},onDestroy:function(){Global.MessageCallback.removeListener("RoomMessagePush",this),Global.MessageCallback.removeListener("GameMessagePush",this),Global.MessageCallback.removeListener("ReConnectSuccess",this)},messageCallbackHandler:function(e,t){var a=o.getMyUid();"RoomMessagePush"===e?t.type===r.USER_LEAVE_ROOM_RESPONSE?t.data.chairId===o.getMyChairId()&&Global.DialogManager.removeLoadingCircle():t.type===r.USER_LEAVE_ROOM_PUSH&&t.data.roomUserInfo.userInfo.uid===a&&this.exitGame():"GameMessagePush"===e?t.type===i.GAME_BANKERCHANGE_PUSH?this.setCardLabel(t.data.bureau):t.type===i.GAME_POURGOLD_PUSH?this.playerPourGold(t.data.uid,t.data.direction,t.data.pourGold):t.type===i.GAME_RESOUT_PUSH?this.scheduleOnce(function(){this.answerGameResout(t.data.resout)}.bind(this),10):t.type===i.GAME_BUREAU_PUSH?this.setCardLabel(t.data.bureau):t.type===r.USER_RECONNECT_PUSH&&(Global.DialogManager.destroyDialog("TuiTongZi/TTZMainDialog"),o.setGameData(t.data.gameData),Global.DialogManager.createDialog("TuiTongZi/TTZMainDialog")):"ReConnectSuccess"===e&&(Global.Player.isInRoom()?Global.API.hall.joinRoomRequest(o.getRoomId(),function(){Global.NetworkManager.notify("game.gameHandler.roomMessageNotify",r.getUserReconnectNotifyData())}):Global.DialogManager.addPopDialog("\u5f53\u524d\u623f\u95f4\u5df2\u89e3\u6563\uff01",function(){this.exitGame()}.bind(this),null,!0))},onButtonClick:function(e,t){if("tianmen"===t||"zhongmen"===t||"dimen"===t)this.tempToPourGold(t);else if("rule"===t)Global.DialogManager.createDialog("GameCommon/GameRule/GameRuleDialog",{kind:Global.Enum.gameType.TTZ});else if("close"===t)Global.DialogManager.addPopDialog("\u786e\u8ba4\u9000\u51fa\u6e38\u620f?",function(){Global.NetworkManager.notify("game.gameHandler.roomMessageNotify",r.userLeaveRoomNotify()),Global.DialogManager.addLoadingCircle()},function(){});else if("setting"===t){Global.DialogManager.createDialog("Setting/SettingDialog",{callback:this.audioManager.setVolume.bind(this.audioManager)})}else"on_line"===t&&Global.DialogManager.createDialog("GameCommon/GameOnlineUser/GameOnlineUserDialog")},tempToPourGold:function(e){var t=i.DIMEN;if("tianmen"===e?t=i.TIANMEN:"zhongmen"===e&&(t=i.ZHONGMEN),o.getGameStatus()===i.GAME_STATUS_POUR)if(o.getMyUid()!==o.getBankerUid()){var a=o.getChooseCoin(),r=o.getMe(),n=o.getMyPourGold();a>r.userInfo.gold-n?console.log("error: not enough gold"):Global.NetworkManager.notify("game.gameHandler.gameMessageNotify",i.pourGoldRequestData(a,t))}else console.log("banker can not pour gold");else console.log("can not pour gold")},playerPourGold:function(e,t,a){for(var r,n,s,c=[],l=[500,100,50,10,1],d=0;d<l.length;++d)r=Math.floor(a/l[d])%10,c.push(r),a-=r*l[d];for(e===o.getMyUid()?(n=this.myHeadNode.getPosition(),e===o.getBankerUid()&&(n=this.node.getChildByName("ReturnButton").getPosition())):n=e===o.getBankerUid()?this.node.getChildByName("WomanNode").getPosition():this.onLineMenu.getPosition(),d=0;d<c.length;++d)for(var h=0;h<c[d];++h)(s=this.getCoinNode(l[d])).coin=l[d],this.pourGoldAnimal(s,n,t);a=o.getPourGoldOnDir(t);var u=o.getMyPourGoldOnDir(t);t===i.TIANMEN?(this.tianmenAreaNode.getChildByName("PourLabel").getComponent(cc.Label).string=a,this.tianmenAreaNode.getChildByName("MyPourLabel").getComponent(cc.Label).string=u):t===i.ZHONGMEN?(this.zhongmenAreaNode.getChildByName("PourLabel").getComponent(cc.Label).string=a,this.zhongmenAreaNode.getChildByName("MyPourLabel").getComponent(cc.Label).string=u):t===i.DIMEN&&(this.dimenAreaNode.getChildByName("PourLabel").getComponent(cc.Label).string=a,this.dimenAreaNode.getChildByName("MyPourLabel").getComponent(cc.Label).string=u)},myWinGold:function(e,t){console.log("myWinGold",e,t);for(var a,r,o,n,s,c=[this.tianmenAreaNode,this.zhongmenAreaNode,this.dimenAreaNode][e],l=c.getPosition(),d=[1e3,500,100,50,10],h=[],u=0;u<d.length;++u)a=Math.floor(t/d[u]),h.push(a),t-=a*d[u];n=this.myHeadNode.getPosition(),n=cc.v2(n.x-l.x,n.y-l.y);var g=[],C=[i.TIANMEN,i.ZHONGMEN,i.DIMEN];for(u=0;u<h.length;++u)for(var p=this.pourCoinNodeArr.length-1;p>=0&&h[u]>0;--p)(r=this.pourCoinNodeArr[p]).coin===d[u]&&h[u]>0&&C[e]===r.dir&&(this.pourCoinNodeArr.splice(p,1),g.push(r),--h[u],o=r.getPosition(),s=Global.Utils.getDist(o,n)/this.speed,r.runAction(cc.moveTo(s,n)));this.scheduleOnce(function(){for(var e=g.length-1;e>=0;--e)g[e].removeFromParent(),g[e]=null},s),c.getChildByName("MyPourLabel").getComponent(cc.Label).string="0"},othersWinGold:function(e){var t,a,r,o=[this.tianmenAreaNode,this.zhongmenAreaNode,this.dimenAreaNode][e],n=o.getPosition();a=this.onLineMenu.getPosition(),a=cc.v2(a.x-n.x,a.y-n.y);for(var s=[],c=[i.TIANMEN,i.ZHONGMEN,i.DIMEN],l=this.pourCoinNodeArr.length-1;l>=0;--l)if((t=this.pourCoinNodeArr[l])&&t.dir===c[e]){this.pourCoinNodeArr.splice(l,1),s.push(t);var d=t.getPosition();r=Global.Utils.getDist(d,a)/this.speed,t.runAction(cc.moveTo(r,a))}this.scheduleOnce(function(){for(var e=s.length-1;e>=0;--e)s[e].removeFromParent(),s[e]=null},r),o.getChildByName("PourLabel").getComponent(cc.Label).string="0"},bankerWinGold:function(e){var t,a,r,o,n=[this.tianmenAreaNode,this.zhongmenAreaNode,this.dimenAreaNode][e],s=n.getPosition();r=this.node.getChildByName("WomanNode").getPosition(),r=cc.v2(r.x-s.x,r.y-s.y);for(var c=[],l=[i.TIANMEN,i.ZHONGMEN,i.DIMEN],d=this.pourCoinNodeArr.length-1;d>=0;--d)(t=this.pourCoinNodeArr[d])&&t.dir===l[e]&&(this.pourCoinNodeArr.splice(d,1),c.push(t),a=t.getPosition(),o=Global.Utils.getDist(a,r)/this.speed,t.runAction(cc.moveTo(o,r)));this.scheduleOnce(function(){for(var e=c.length-1;e>=0;--e)c[e].removeFromParent(),c[e]=null},o),n.getChildByName("PourLabel").getComponent(cc.Label).string="0",n.getChildByName("MyPourLabel").getComponent(cc.Label).string="0"},getCoinNode:function(e){var t="GameCommon/chip_"+e,a=new cc.Node;return cc.loader.loadRes(t,cc.SpriteFrame,function(e,t){e?console.log("error getCoinNode",e.message):(a.addComponent(cc.Sprite).spriteFrame=t,a.width=50,a.height=50)}),a},pourGoldAnimal:function(e,t,a){this.pourCoinNodeArr.push(e),e.dir=a;var r=[0,this.tianmenAreaNode,this.zhongmenAreaNode,this.dimenAreaNode][a],i=r.getPosition();t=cc.v2(t.x-i.x,t.y-i.y);var o=cc.v2(r.width*(Math.random()-.5),r.height*(Math.random()-.5));e.parent=r,e.setPosition(t);var n=Global.Utils.getDist(t,o)/this.speed;e.runAction(cc.moveTo(n,o))},setCardLabel:function(e){e||(e=o.getBureau());var t=40-8*e;this.cardLabel.string=e+"/"+o.getMaxBureau()+"("+t+")"},answerGameResout:function(e){for(var t=[i.TIANMEN,i.ZHONGMEN,i.DIMEN],a=1,r=o.getBankerUid(),n=o.getMyUid(),s=0;s<e.winArr.length;++s)if(!0===e.winArr[s])this.bankerWinGold(s);else{var c=o.getPourGoldOnDir(t[s]);this.playerPourGoldDelay(r,t[s],c,1),a=2}for(s=0;s<t.length;++s)if(!1===e.winArr[s])if(n===r)this.othersWinGoldDelay(s,a);else{var l=o.getMyPourGoldOnDir(t[s]);l>0&&this.myWinGoldDelay(s,2*l,a),this.othersWinGoldDelay(s,a)}var d=[this.tianmenAreaNode,this.zhongmenAreaNode,this.dimenAreaNode];for(this.scheduleOnce(function(){Global.DialogManager.createDialog("TuiTongZi/TTZResoutDialog",e);for(var t=0;t<d.length;++t)d[t].getChildByName("WinSprite").active=!1},3),s=0;s<d.length;++s)if(!e.winArr[s]){var h=d[s].getChildByName("WinSprite");h.active=!0,h.runAction(cc.sequence(cc.fadeIn(.3),cc.fadeOut(.3),cc.fadeIn(.3),cc.fadeOut(.3),cc.fadeIn(.3),cc.fadeOut(.3),cc.fadeIn(.3),cc.fadeOut(.3)))}},myWinGoldDelay:function(e,t,a){var r=this;this.scheduleOnce(function(){r.myWinGold(e,t)},a)},othersWinGoldDelay:function(e,t){var a=this;this.scheduleOnce(function(){a.othersWinGold(e)},t)},playerPourGoldDelay:function(e,t,a,r){var i=this;this.scheduleOnce(function(){i.playerPourGold(e,t,a)},r)},getAudioManager:function(){return this.audioManager},exitGame:function(){Global.DialogManager.removeLoadingCircle(),Global.DialogManager.createDialog("Hall/HallDialog",null,function(){Global.DialogManager.destroyDialog(this,!0),Global.CCHelper.releaseRes(["TuiTongZi"])}.bind(this))}}),cc._RF.pop()},{"../../API/RoomProto":"RoomProto","./TTZModel":"TTZModel","./TTZProto":"TTZProto"}],TTZModel:[function(e,t,a){"use strict";cc._RF.push(t,"07931qQloNEdqErIE/F0BMH","TTZModel");var r=t.exports,i=e("./TTZProto"),o=e("../../API/RoomProto");r.setEntryRoomData=function(e){console.log("setEntryRoomData",e);var t=e.gameData;this.userArr=e.roomUserInfoArr||this.userArr,this.bankerUid=t.bankerUid,this.bureau=t.bureau,this.maxBureau=t.maxBureau,this.gameStatus=t.gameStatus,this.pourPool=t.pourPool,this.bankerPool=t.bankerPool,this.touzi1=t.touzi1,this.touzi2=t.touzi2,this.bankGold=t.bankGold,this.dirRecord=t.dirRecord,this.resout=t.resout,this.profitPercentage=t.profitPercentage,this.roomId=t.roomId,this.myUid=Global.Player.getPy("uid");for(var a=0;a<this.userArr.length;++a)this.userArr[a].userInfo.uid===this.myUid&&(this.myChairId=this.userArr[a].chairId),this.userArr[a].userInfo.nickname=Global.Player.convertNickname(this.userArr[a].userInfo.nickname);Global.MessageCallback.addListener("RoomMessagePush",this),Global.MessageCallback.addListener("GameMessagePush",this)},r.setGameData=function(e){for(var t in e)e.hasOwnProperty(t)&&this.hasOwnProperty(t)&&(this[t]=e[t])},r.onDestroy=function(){Global.MessageCallback.removeListener("RoomMessagePush",this),Global.MessageCallback.removeListener("GameMessagePush",this)},r.messageCallbackHandler=function(e,t){"RoomMessagePush"===e?t.type===o.OTHER_USER_ENTRY_ROOM_PUSH?this.addUser(t.data.roomUserInfo):t.type===o.USER_LEAVE_ROOM_PUSH&&this.delUser(t.data.roomUserInfo):"GameMessagePush"===e&&(t.type===i.GAME_ASKTOBEBANKER_PUSH?this.answerTobeBanker(t.data.bankerUid,t.data.bankGold):t.type===i.GAME_BANKERCHANGE_PUSH?this.answerBankerChange(t.data.bankerUid,t.data.bankGold):t.type===i.GAME_CONTINUEBANKER_PUSH?this.answerContinueBanker(t.data.bankerUid,t.data.bankGold):t.type===i.GAME_STATUSCHANGE_PUSH?(this.gameStatus=t.data.gameStatus,this.gameStatus===i.GAME_STATUS_SETTLE&&this.gameEndClearData()):t.type===i.GAME_POURGOLD_PUSH?this.answerPourGold(t.data.uid,t.data.direction,t.data.pourGold):t.type===i.GAME_TOUZI_PUSH?this.answerTouziPush(t.data.touzi1,t.data.touzi2):t.type===i.GAME_RESOUT_PUSH?this.answerResoutPush(t.data.resout):t.type===i.GAME_BUREAU_PUSH?(this.setBureau(t.data.bureau),this.gameEndClearData()):t.type===i.GAME_ASKTOBEPLAYER_PUSH&&this.answerAskToBePlayer())},r.gameEndClearData=function(){this.pourPool[i.TIANMEN]=[],this.pourPool[i.ZHONGMEN]=[],this.pourPool[i.DIMEN]=[]},r.getRoomId=function(){return this.roomId},r.setBureau=function(e){this.bureau=e},r.getBureau=function(){return this.bureau},r.getProfitPercentage=function(){return this.profitPercentage/100},r.getMaxBureau=function(){return this.maxBureau},r.getUsers=function(){return this.userArr},r.getMyChairId=function(){return this.myChairId},r.getMyUid=function(){return this.myUid},r.getBankerUid=function(){return this.bankerUid},r.getMe=function(){for(var e=0;e<this.userArr.length;++e)if(this.userArr[e].userInfo.uid===this.myUid)return this.userArr[e];return null},r.getBanker=function(){for(var e=0;e<this.userArr.length;++e)if(this.userArr[e].userInfo.uid===this.bankerUid)return this.userArr[e];return null},r.getUserByUid=function(e){for(var t=0;t<this.userArr.length;++t)if(this.userArr[t].userInfo.uid===e)return this.userArr[t];return null},r.getUsersCount=function(){return this.userArr.length},r.getUsers=function(){return this.userArr},r.addUser=function(e){e.userInfo.nickname=Global.Player.convertNickname(e.userInfo.nickname);for(var t=this.userArr.length-1;t>=0;--t)this.userArr[t].chairId===e.chairId&&this.userArr.splice(t,1);this.userArr.push(e)},r.delUser=function(e){for(var t=this.userArr.length-1;t>=0;--t)this.userArr[t].chairId===e.chairId&&this.userArr.splice(t,1);for(var a in this.bankerPool)if(this.bankerPool.hasOwnProperty(a)){var r=this.bankerPool[a].indexOf(e.userInfo.uid);r>=0&&this.bankerPool[a].splice(r,1)}e.userInfo.uid===this.myUid&&this.onDestroy()},r.getGameStatus=function(){return this.gameStatus},r.getBankerPourPool=function(){return this.pourPool[i.ZHUANGJIA]},r.getMyPourGold=function(){var e=0;for(var t in this.pourPool)if(this.pourPool.hasOwnProperty(t)&&parseInt(t)!==i.ZHUANGJIA)for(var a=0;a<this.pourPool[t].length;++a)this.pourPool[t][a].uid===this.myUid&&(e+=this.pourPool[t][a].pourGold);return e},r.getPourGoldOnDir=function(e){for(var t=0,a=0;a<this.pourPool[e].length;++a)t+=this.pourPool[e][a].pourGold;return t},r.getAllPourGold=function(){var e=0;for(var t in this.pourPool)if(this.pourPool.hasOwnProperty(t)&&parseInt(t)!==i.ZHUANGJIA)for(var a=0;a<this.pourPool[t].length;++a)e+=this.pourPool[t][a].pourGold;return e},r.getMyPourGoldOnDir=function(e){for(var t=0,a=0;a<this.pourPool[e].length;++a)this.pourPool[e][a].uid===this.myUid&&(t+=this.pourPool[e][a].pourGold);return t},r.getTouzi=function(){return{touzi1:this.touzi1,touzi2:this.touzi2}},r.getGameDirRecord=function(){return this.dirRecord},r.setChooseCoin=function(e){this.chooseCoin=e},r.getChooseCoin=function(){return this.chooseCoin||1},r.getCardsArr=function(){return this.cardsArr},r.getBankGold=function(){return this.bankGold},r.answerTobeBanker=function(e,t){-1===this.bankerPool[t].indexOf(e)&&this.bankerPool[t].push(e)},r.getBankerPool=function(){return this.bankerPool},r.getResout=function(){return this.resout},r.answerBankerChange=function(e,t){this.bankGold=t,this.bankerUid=e,this.pourPool[i.ZHUANGJIA].curGold=t,this.pourPool[i.ZHUANGJIA].pourGold=t},r.answerContinueBanker=function(e,t){this.bankGold=t,this.pourPool[i.ZHUANGJIA].curGold+=t,this.pourPool[i.ZHUANGJIA].pourGold+=t},r.answerTouziPush=function(e,t){this.touzi1=e,this.touzi2=t},r.answerPourGold=function(e,t,a){for(var r=!1,i=0;i<this.pourPool[t].length;++i)if(this.pourPool[t][i].uid===e){this.pourPool[t][i].pourGold+=a,r=!0;break}r||this.pourPool[t].push({uid:e,pourGold:a})},r.answerResoutPush=function(e){var t;for(var a in this.resout=e,this.cardsArr=e.cardsArr,this.usersWin=e.usersWin,this.winArr=e.winArr,this.usersWin)for(t=0;t<this.userArr.length;++t)if(this.userArr[t].userInfo.uid===a){this.usersWin[a]>0?this.userArr[t].userInfo.gold+=this.usersWin[a]*(1-this.getProfitPercentage()):this.userArr[t].userInfo.gold+=this.usersWin[a],this.userArr[t].userInfo.robot&&this.userArr[t].userInfo.gold<=0&&(this.userArr[t].userInfo.gold=10*Math.floor(1e3*Math.random()));break}var r=this.getBanker();if(r&&(e.bankerWin>0?(r.userInfo.gold+=e.bankerWin*(1-this.getProfitPercentage()),this.pourPool[i.ZHUANGJIA].curGold+=e.bankerWin*(1-this.getProfitPercentage())):(r.userInfo.gold+=e.bankerWin,this.pourPool[i.ZHUANGJIA].curGold+=e.bankerWin)),this.dirRecord.length>9)for(t=this.dirRecord.length-9;t>0;--t)this.dirRecord.shift();this.dirRecord.push(this.cardsArr)},r.answerAskToBePlayer=function(){this.bankerUid=null},cc._RF.pop()},{"../../API/RoomProto":"RoomProto","./TTZProto":"TTZProto"}],TTZOnLineItem:[function(e,t,a){"use strict";cc._RF.push(t,"f2bc5877/5Js4M0Ys42v1gm","TTZOnLineItem"),cc.Class({extends:cc.Component,properties:{nameLabel:cc.Label,goldLabel:cc.Label},start:function(){},setNameAndGold:function(e,t){this.nameLabel.string=e,this.goldLabel.string=t.toFixed(2)}}),cc._RF.pop()},{}],TTZOnLine:[function(e,t,a){"use strict";cc._RF.push(t,"2df59ebFD9FOa3e+V+7S4Vw","TTZOnLine");var r=e("./TTZModel"),i=e("../../API/RoomProto");cc.Class({extends:cc.Component,properties:{content:cc.Node,item:cc.Prefab,panel:cc.Node,userCountLabel:cc.Label},start:function(){this.isOut=!1,this.initScrollView();var e=r.getUsers();this.userCountLabel.string=5*e.length+Math.floor(10*Math.random()),Global.MessageCallback.addListener("RoomMessagePush",this),this.setOnLineCount(),this.schedule(this.setOnLineCount.bind(this),10)},setOnLineCount:function(){var e=r.getUsers();this.userCountLabel.string=5*e.length+Math.floor(10*Math.random())},onDestroy:function(){Global.MessageCallback.removeListener("RoomMessagePush",this)},messageCallbackHandler:function(e,t){if("RoomMessagePush"===e){var a=r.getUsers();t.type===i.OTHER_USER_ENTRY_ROOM_PUSH?this.userCountLabel.string=5*a.length+Math.floor(10*Math.random()):t.type===i.USER_LEAVE_ROOM_PUSH&&t.data.roomUserInfo.userInfo.uid!==r.getMyUid()&&(this.userCountLabel.string=5*a.length+Math.floor(10*Math.random()))}},initScrollView:function(){var e=r.getUsers(),t=40*e.length;t<400&&(t=400),this.content.removeAllChildren(),this.content.height=t;for(var a=0;a<e.length;++a){var i=cc.instantiate(this.item);i.parent=this.content,i.setPosition(cc.v2(0,40*(-.5-a))),i.getComponent("TTZOnLineItem").setNameAndGold(e[a].userInfo.nickname,e[a].userInfo.gold)}},onButtonClick:function(e,t){}}),cc._RF.pop()},{"../../API/RoomProto":"RoomProto","./TTZModel":"TTZModel"}],TTZProto:[function(e,t,a){"use strict";cc._RF.push(t,"0fe220j2wlFuZrDQmVtbc/s","TTZProto");var r=t.exports;r.GAME_ASKTOBEBANKER_REQUEST=301,r.GAME_ASKTOBEBANKER_PUSH=401,r.GAME_ASKTOBEPLAYER_REQUEST=302,r.GAME_ASKTOBEPLAYER_PUSH=402,r.GAME_BANKERCHANGE_PUSH=403,r.GAME_POURGOLD_REQUEST=304,r.GAME_POURGOLD_PUSH=404,r.GAME_STATUSCHANGE_PUSH=405,r.GAME_RESOUT_PUSH=406,r.GAME_BUREAU_PUSH=407,r.GAME_CONTINUEBANKER_REQUEST=308,r.GAME_CONTINUEBANKER_PUSH=408,r.GAME_TOUZI_PUSH=409,r.GAME_STATUS_WAITING=0,r.GAME_STATUS_SORTCARD=1,r.GAME_STATUS_POUR=2,r.GAME_STATUS_RESOUT=3,r.GAME_STATUS_SETTLE=4,r.GAME_STATUS_START=5,r.SORTCARD_SECOND=5,r.POURGOLD_SECOND=9,r.SHOWRESOUT_SECOND=15,r.SETTLE_SECOND=5,r.GAMESTART_SECOND=3,r.ZHUANGJIA=0,r.TIANMEN=1,r.ZHONGMEN=2,r.DIMEN=3,r.askToBeBankerRequestData=function(e){return{type:this.GAME_ASKTOBEBANKER_REQUEST,data:{bankGold:e}}},r.askToBeBankerPushData=function(e,t){return{type:this.GAME_ASKTOBEBANKER_PUSH,data:{bankerUid:e,bankGold:t}}},r.askToBePlayerRequestData=function(){return{type:this.GAME_ASKTOBEPLAYER_REQUEST,data:{}}},r.askToBePlayerPushData=function(e,t){return{type:this.GAME_ASKTOBEPLAYER_PUSH,data:{bankerUid:e,goldChange:t}}},r.changeBankerPushData=function(e,t){return{type:this.GAME_BANKERCHANGE_PUSH,data:{bankerUid:e,bankGold:t}}},r.pourGoldRequestData=function(e,t){return{type:this.GAME_POURGOLD_REQUEST,data:{pourGold:e,direction:t}}},r.pourGoldPushData=function(e,t,a,r){return{type:this.GAME_POURGOLD_PUSH,data:{uid:e,pourGold:t,direction:a,allPourGold:r}}},r.gameStatusChangePushData=function(e){return{type:this.GAME_STATUSCHANGE_PUSH,data:{gameStatus:e}}},r.gameResoutPushData=function(e){return{type:this.GAME_RESOUT_PUSH,data:{resout:e}}},r.gameBureauPushData=function(e){return{type:this.GAME_BUREAU_PUSH,data:{bureau:e}}},r.continueBankerRequestData=function(e){return{type:this.GAME_CONTINUEBANKER_REQUEST,data:{bankGold:e}}},r.continueBankerPushData=function(e,t){return{type:this.GAME_CONTINUEBANKER_PUSH,data:{bankerUid:e,bankGold:t}}},r.touziPushData=function(e,t){return{type:this.GAME_TOUZI_PUSH,data:{touzi1:e,touzi2:t}}},cc._RF.pop()},{}],TTZResoutDialog:[function(e,t,a){"use strict";cc._RF.push(t,"27aactH7bRHToAa8+ndjG/Q","TTZResoutDialog");var r=e("./TTZProto"),i=e("./TTZModel");cc.Class({extends:cc.Component,properties:{titleWinNode:cc.Node,titleLoseNode:cc.Node,zhuangNode:cc.Node,tianmenNode:cc.Node,zhongmenNode:cc.Node,dimenNode:cc.Node,bankerScoreLabel:cc.Label,myScoreLabel:cc.Label,tickLabel:cc.Label},start:function(){var e=this.dialogParameters;this.showResout(e),this.setTickLabel();var t,a=i.getMyUid(),r=i.getBankerUid(),o=e.usersWin[a],n=i.getProfitPercentage();o>=0&&(o=(o*(1-n)).toFixed(2)),t=!0===e.winArr[0]&&!0===e.winArr[1]&&!0===e.winArr[2]?r===a:!1===e.winArr[0]&&!1===e.winArr[1]&&!1===e.winArr[2]?r!==a:o&&o>=0,this.myScoreLabel.string=o||"\u672a\u6295\u6ce8",this.bankerScoreLabel.string=e.bankerWin,this.titleWinNode.active=t,this.titleLoseNode.active=!t},showResout:function(e){for(var t=[r.TIANMEN,r.ZHONGMEN,r.DIMEN],a=[this.tianmenNode,this.zhongmenNode,this.dimenNode],i=0;i<t.length;++i)this.showCard(a[i],e.cardsArr[t[i]],!e.winArr[i]);this.showCard(this.zhuangNode,e.cardsArr[0],e.bankerWin>0)},showCard:function(e,t,a){var r,i,o=e.getChildByName("Card1").getChildByName("Word"),n=e.getChildByName("Card2").getChildByName("Word");r=t[0]%10==0?"TuiTongZi/Common/img_mj_01":"TuiTongZi/Common/img_mj_0"+(t[0]%10+1),i=t[1]%10==0?"TuiTongZi/Common/img_mj_01":"TuiTongZi/Common/img_mj_0"+(t[1]%10+1),cc.loader.loadRes(r,cc.SpriteFrame,function(e,t){e?console.log("error showCard",e.message):o.getComponent(cc.Sprite).spriteFrame=t}),cc.loader.loadRes(i,cc.SpriteFrame,function(e,t){e?console.log("error showCard",e.message):n.getComponent(cc.Sprite).spriteFrame=t});for(var s=["BaoziSprite","NumLabel","DotSprite","BanSprite"],c=0;c<s.length;++c)e.getChildByName(s[c]).active=!1;if(t[0]%10==t[1]%10)e.getChildByName("BaoziSprite").active=!0;else{var l=(t[0]+t[1])%10,d=e.getChildByName("NumLabel");d.active=!0,d.getComponent(cc.Label).string=Math.floor(l%10),e.getChildByName("DotSprite").active=!0,t[0]%10!=0&&t[1]%10!=0||(e.getChildByName("BanSprite").active=!0)}var h=e.getChildByName("ResoutSprite"),u="TuiTongZi/Common/clip_loseWin0";a||(u="TuiTongZi/Common/clip_loseWin1"),cc.loader.loadRes(u,cc.SpriteFrame,function(e,t){e?console.log("error showCard",e.message):h.getComponent(cc.Sprite).spriteFrame=t})},onButtonClick:function(e,t){"close"===t&&(this.unscheduleAllCallbacks(),Global.DialogManager.destroyDialog(this,!0))},setTickLabel:function(){var e=3;this.tickLabel.string=e;var t=this;this.schedule(function a(){--e,t.tickLabel.string=e,0===e&&(Global.DialogManager.destroyDialog(t,!0),t.unschedule(a))},1)}}),cc._RF.pop()},{"./TTZModel":"TTZModel","./TTZProto":"TTZProto"}],TTZRuleDialog:[function(e,t,a){"use strict";cc._RF.push(t,"6bc6cxKBv9Fq4ydrwXyAmoF","TTZRuleDialog"),cc.Class({extends:cc.Component,properties:{},start:function(){},onButtonClick:function(e,t){"close"===t&&Global.DialogManager.destroyDialog(this,!0)}}),cc._RF.pop()},{}],TTZStatus:[function(e,t,a){"use strict";cc._RF.push(t,"e1082Y5d5FGiJv+11mGYNsL","TTZStatus");var r=e("./TTZModel"),i=e("../../API/RoomProto"),o=e("./TTZProto");cc.Class({extends:cc.Component,properties:{settleNode:cc.Node,startNode:cc.Node,pourNode:cc.Node,sortCardNode:cc.Node,pourLabel:cc.Label,tickLabel:cc.Label},start:function(){this.showStatus(),Global.MessageCallback.addListener("RoomMessagePush",this),Global.MessageCallback.addListener("GameMessagePush",this)},onDestroy:function(){Global.MessageCallback.removeListener("RoomMessagePush",this),Global.MessageCallback.removeListener("GameMessagePush",this)},messageCallbackHandler:function(e,t){"GameMessagePush"===e?t.type===o.GAME_STATUSCHANGE_PUSH?this.showStatus(t.data.gameStatus):t.type===o.GAME_POURGOLD_PUSH&&this.setPourLabel():"RoomMessagePush"===e&&t.type===i.USER_RECONNECT_PUSH&&this.showStatus()},showStatus:function(e){e||(e=r.getGameStatus()),this.unscheduleAllCallbacks(),e===o.GAME_STATUS_WAITING?this.unShowAllNode():e===o.GAME_STATUS_SORTCARD?this.setStatusSortCard():e===o.GAME_STATUS_POUR?this.setStatusPourGold():e===o.GAME_STATUS_RESOUT?this.unShowAllNode():e===o.GAME_STATUS_SETTLE?this.setStatusSettle():e===o.GAME_STATUS_START&&this.showStartGame()},unShowAllNode:function(){this.settleNode.active=!1,this.startNode.active=!1,this.pourNode.active=!1,this.sortCardNode.active=!1},showStartGame:function(){this.unShowAllNode();var e=r.getBureau();this.startNode.active=!0;var t="TuiTongZi/Common/clip_huihe"+(e-1),a=this;cc.loader.loadRes(t,cc.SpriteFrame,function(e,t){e?console.log("error showStartGame",e.message):a.startNode.getChildByName("BureauSprite").getComponent(cc.Sprite).spriteFrame=t});var i=o.GAMESTART_SECOND;this.startNode.getChildByName("Label").getComponent(cc.Label).string=i;this.schedule(function e(){--i,a.startNode.getChildByName("Label").getComponent(cc.Label).string=i,0===i&&(a.startNode.active=!1,a.unschedule(e))},1)},setStatusSortCard:function(){this.unShowAllNode(),this.sortCardNode.active=!0;var e=this.sortCardNode.getChildByName("Label"),t=o.SORTCARD_SECOND;e.getComponent(cc.Label).string=t;var a=this;this.schedule(function r(){t<0?a.unschedule(r):(--t,e.getComponent(cc.Label).string=t)},1)},setStatusPourGold:function(){this.unShowAllNode(),this.pourNode.active=!0,this.setPourLabel();var e=this,t=o.POURGOLD_SECOND;this.tickLabel.string=t;this.schedule(function a(){--t,e.tickLabel.string=t,t<0&&(e.tickLabel.string="",e.unschedule(a))},1)},setPourLabel:function(){var e=r.getAllPourGold();this.pourLabel.string=e},setStatusSettle:function(){this.unShowAllNode(),this.settleNode.active=!0;var e=this.settleNode.getChildByName("Label"),t=o.SETTLE_SECOND;e.getComponent(cc.Label).string=t;var a=this;this.schedule(function r(){t<0?a.unschedule(r):(--t,e.getComponent(cc.Label).string=t)},1)}}),cc._RF.pop()},{"../../API/RoomProto":"RoomProto","./TTZModel":"TTZModel","./TTZProto":"TTZProto"}],TTZTouzi:[function(e,t,a){"use strict";cc._RF.push(t,"6c9d6sMZ5JEsopg3uN/FMI1","TTZTouzi");var r=e("./TTZProto"),i=e("../../API/RoomProto");e("./TTZModel");cc.Class({extends:cc.Component,properties:{touziNode1:cc.Node,touziNode2:cc.Node,touziNode3:cc.Node,touziNode4:cc.Node},start:function(){this.audioManager=this.node.parent.getComponent("TTZMainDialog").getAudioManager(),Global.MessageCallback.addListener("GameMessagePush",this)},reconnect:function(){this.stopAnimal()},onDestroy:function(){Global.MessageCallback.removeListener("GameMessagePush",this)},messageCallbackHandler:function(e,t){"GameMessagePush"===e?t.type===r.GAME_TOUZI_PUSH&&this.startAnimal(t.data.touzi1,t.data.touzi2):"GameMessagePush"===e&&t.type===i.USER_RECONNECT_PUSH&&this.reconnect()},stopAnimal:function(){this.isOnAnimal=!1,this.touziNode1.getComponent(cc.Animation).stop(),this.touziNode2.getComponent(cc.Animation).stop(),this.touziNode1.active=!1,this.touziNode2.active=!1,this.touziNode3.active=!1,this.touziNode4.active=!1},startAnimal:function(e,t){this.touziNode1.active=!0,this.touziNode2.active=!0;var a=this.touziNode1.getComponent(cc.Animation);a.play("TouziAnimation");var r=this.touziNode2.getComponent(cc.Animation);r.play("TouziAnimation");var i=this;this.isOnAnimal=!0,this.audioManager.playDice(),this.scheduleOnce(function(){if(i.isOnAnimal){a.stop(),r.stop(),i.touziNode1.active=!1,i.touziNode2.active=!1,i.touziNode3.active=!0,i.touziNode4.active=!0;var o="TuiTongZi/Common/09-"+e,n="TuiTongZi/Common/09-"+t;cc.loader.loadRes(o,cc.SpriteFrame,function(e,t){e?console.log("error startAnimal",e.message):i.touziNode3.getComponent(cc.Sprite).spriteFrame=t}),cc.loader.loadRes(n,cc.SpriteFrame,function(e,t){e?console.log("error startAnimal",e.message):i.touziNode4.getComponent(cc.Sprite).spriteFrame=t}),i.scheduleOnce(function(){i.isOnAnimal&&(i.touziNode3.active=!1,i.touziNode4.active=!1)},3)}},1)}}),cc._RF.pop()},{"../../API/RoomProto":"RoomProto","./TTZModel":"TTZModel","./TTZProto":"TTZProto"}],TWCardItem:[function(e,t,a){"use strict";cc._RF.push(t,"4a913t9v8BBP6NogmBTeN0d","TWCardItem");var r=e("./TWModel"),i=e("./TWLogic"),o=e("./TWProto");cc.Class({extends:cc.Component,properties:{guaiLabel:cc.Label,toudaoLabel:cc.Label,zhongdaoLabel:cc.Label,weidaoLabel:cc.Label,zongfenLabel:cc.Label,typeSprite:cc.Sprite,gameTypeSprite:cc.Sprite,gunSprite:cc.Sprite,holesNode:cc.Node,cardsNode:cc.Node,itemId:cc.Integer},onLoad:function(){this.cardNodeArr=[],this.gunSecond=1.2,this.showTypeSecond=.5,this.turnSecond=1,this.itemId=parseInt(this.itemId);for(var e=0;e<13;++e){var t=new cc.Node;t.parent=this.cardsNode,t.addComponent(cc.Sprite),t.zIndex=e+1,this.cardNodeArr.push(t),t.on(cc.Node.EventType.TOUCH_START,function(e){2===this.cardType?this.setCardType7():7===this.cardType&&this.setCardType8()}.bind(this))}for(var a=0;a<5;++a)this.holesNode.getChildByName("HoleSprite"+(a+1)).active=!1},onTouchCard:function(){},offLineAndClient:function(){if(r.isCurChairPlaying(this.chairId)){this.unscheduleAllCallbacks(),this.holesNode.active=!1;var e=r.gameStatus,t=r.getResout();e===o.GAME_STATUS_GAMEING?(this.node.active=!0,r.hasSortCard(this.chairId)?(this.setCardType1(),this.setCardType2()):this.setCardType1()):e===o.GAME_STATUS_SETTLE&&(this.node.active=!0,this.setCardType1(),this.setCardType2(),this.setCardType3(t),this.setCardType4(t),this.setCardType5(t),this.scheduleOnce(function(){this.setCardType6(t)}.bind(this),.1))}},onDestroy:function(){},setChairId:function(e){this.chairId=e,-1!==r.playingChairArr.indexOf(e)?(this.node.active=!0,this.offLineAndClient()):this.node.active=!1},onSendCardPush:function(){r.isCurChairPlaying(this.chairId)&&(this.node.active=!0,this.unscheduleAllCallbacks(),this.holesNode.active=!1,this.setCardType1(!0))},onShowGuaiPai:function(){this.setNodeSpriteFrame("ThirteenWater/TWCommon/TW_guaipai",this.gameTypeSprite.node),this.gameTypeSprite.node.y=7,this.gameTypeSprite.node.active=!0},onSortCardsPush:function(){this.sendCardCallback&&(this.unschedule(this.sendCardCallback),this.sendCardCallback=null,this.setCardType1()),this.setCardType2()},showCard:function(e,t){var a=r.getMyChairId(),i=r.playingChairArr.indexOf(a),o=r.playingChairArr.indexOf(this.chairId);this.isOnAniaml=!0,this.showResultFinishedCallback=t;var n=e.cardsArr.length,s=(o+n-i)%n+1;this.setCardType8(),this.canFanpai=!1,this.gameTypeSprite.node.active=!1;for(var c=0,l=0,d=0;d<n;++d)r.getMianbai(d)&&(++c,d<=o&&++l);this.scheduleOnce(function(){this.setCardType3(e,!0)}.bind(this),(s-l)*this.turnSecond),this.scheduleOnce(function(){this.setCardType4(e,!0)}.bind(this),(1*(n-c)+s-l)*this.turnSecond+this.showTypeSecond),this.scheduleOnce(function(){this.setCardType5(e,!0)}.bind(this),(2*(n-c)+s-l)*this.turnSecond+2*this.showTypeSecond),this.scheduleOnce(function(){this.daqiangAnimal(e)}.bind(this),(1+3*(n-c))*this.turnSecond+3*this.showTypeSecond)},onHide:function(){this.guaiLabel.node.active=!1,this.toudaoLabel.node.active=!1,this.zhongdaoLabel.node.active=!1,this.weidaoLabel.node.active=!1,this.zongfenLabel.node.active=!1,this.typeSprite.node.active=!1,this.cardsNode.active=!1},setCardType1:function(e){this.cardsNode.active=!0,this.cardType=1;var t=[{x:-126,y:-105},{x:-97,y:-54},{x:-165,y:128},{x:-280,y:-54}];this.cardsNode.setPosition(0,0),this.cardsNode.setScale(1,1);for(var a=0;a<this.cardNodeArr.length;++a)e?(this.cardNodeArr[a].x=t[this.itemId].x+540,this.cardNodeArr[a].active=!1):this.cardNodeArr[a].x=t[this.itemId].x+30*a,this.cardNodeArr[a].y=t[this.itemId].y,this.cardNodeArr[a].rotation=0,this.setNodeSpriteFrame("ThirteenWater/TWCard/card_back",this.cardNodeArr[a]),this.cardNodeArr[a].setScale(1.1,1.1);if(e){Global.AudioManager.playSound("ThirteenWater/TWSound/tw_fapai1");var i=0,o=this;this.sendCardCallback=function(){if(13===i)return o.unschedule(o.sendCardCallback),o.sendCardCallback=null,o.setNodeSpriteFrame("ThirteenWater/TWCommon/TW_lipaizhong",o.gameTypeSprite.node),void(o.gameTypeSprite.node.active=!0);o.cardNodeArr[i].active=!0,o.cardNodeArr[i].runAction(cc.moveTo(.1,cc.v2(t[o.itemId].x+30*i,t[o.itemId].y))),++i},this.schedule(this.sendCardCallback,.05)}else this.setNodeSpriteFrame("ThirteenWater/TWCommon/TW_lipaizhong",this.gameTypeSprite.node),this.gameTypeSprite.node.active=!0;this.chairId===r.getMyChairId()&&this.gameTypeSprite.node.setPosition(24,-110),this.guaiLabel.node.active=!1,this.toudaoLabel.node.active=!1,this.zhongdaoLabel.node.active=!1,this.weidaoLabel.node.active=!1,this.zongfenLabel.node.active=!1,this.typeSprite.node.active=!1},setCardType2:function(){this.canFanpai=!0,this.cardType=2,this.gameTypeSprite.node.active=!1;var e=[{x:-50,y:172},{x:25,y:173},{x:96,y:154},{x:-123,y:-16},{x:-54,y:11},{x:27,y:8},{x:98,y:-4},{x:165,y:-46},{x:-123,y:-203},{x:-49,y:-178},{x:27,y:-175},{x:95,y:-190},{x:170,y:-221}],t=[-23,-8,10,-40,-22,-7,12,28,-40,-22,-5,13,28],a=[{x:0,y:66},{x:120,y:-72},{x:16,y:70},{x:-172,y:-68}];this.cardsNode.setPosition(a[this.itemId].x,a[this.itemId].y),0!==this.itemId?this.cardsNode.setScale(.8,.8):this.cardsNode.setScale(1,1);for(var i=0;i<this.cardNodeArr.length;++i)this.cardNodeArr[i].active=!0,this.cardNodeArr[i].setPosition(e[i].x,e[i].y),this.cardNodeArr[i].rotation=t[i],this.cardNodeArr[i].setScale(1.2,1.2);r.getMianbai(this.chairId)&&this.chairId===r.getMyChairId()?(this.setNodeSpriteFrame("ThirteenWater/TWCommon/TW_guaipai",this.gameTypeSprite.node),this.gameTypeSprite.node.y=7,this.gameTypeSprite.node.active=!0):this.gameTypeSprite.node.active=!1},setCardType3:function(e,t){this.cardType=3;for(var a=r.getMyChairId(),o=r.playingChairArr.indexOf(a),n=r.playingChairArr.indexOf(this.chairId),s=r.playingChairArr.length,c=(n+s-o)%s,l=e.cardsArr[n],d=0,h=0;h<s;++h)r.getMianbai(h)&&r.playingChairArr[h]>this.chairId&&++d;var u=(s-c-d)*this.turnSecond;t||(u=0);var g=this;if(!r.getMianbai(n))for(var C=0;C<3;++C)this.setNodeSpriteFrame("ThirteenWater/TWCard/"+l[C],this.cardNodeArr[C]);if(o>=0){var p="",f="";if(this.chairId!==a){var m=e.scoresArr[o][n][0];m>=0?(f="\u8d62+"+parseFloat(m.toFixed(2)),p="ThirteenWater/TWCommon/fnt_game2"):(f="\u8f93"+parseFloat(m.toFixed(2)),p="ThirteenWater/TWCommon/fnt_game1")}else{for(var A=0,b="",y=0;y<e.scoresArr[o].length;++y)A+=e.scoresArr[o][y][0];A>=0?(f="\u5934\u9053+"+parseFloat(A.toFixed(2)),b="\u603b\u5206+"+parseFloat(A.toFixed(2)),p="ThirteenWater/TWCommon/fnt_game4"):(f="\u5934\u9053"+parseFloat(A.toFixed(2)),b="\u603b\u5206"+parseFloat(A.toFixed(2)),p="ThirteenWater/TWCommon/fnt_game3"),this.scheduleOnce(function(){cc.loader.loadRes(p,cc.Font,function(e,t){e||(g.zongfenLabel.font=t,g.zongfenLabel.string=b,g.zongfenLabel.node.active=!0)})},u)}this.scheduleOnce(function(){cc.loader.loadRes(p,cc.Font,function(e,t){e||(g.toudaoLabel.font=t,g.toudaoLabel.string=f,g.toudaoLabel.node.active=!0)})},u)}if(t){var T=i.getTouArr(e.cardsArr[r.playingChairArr.indexOf(this.chairId)]);r.getMianbai(this.chairId)||(Global.AudioManager.playSound(this.getSoundUrlByCardArr(T,"tou")),this.setNodeSpriteFrame(this.getTypeUrlByCardArr(T,"tou"),this.typeSprite.node),this.typeSprite.node.active=!0,this.scheduleOnce(function(){this.typeSprite.node.active=!1}.bind(this),1))}this.gameTypeSprite.node.active=!1},setCardType4:function(e,t){this.cardType=4;for(var a=r.getMyChairId(),o=r.playingChairArr.indexOf(a),n=r.playingChairArr.indexOf(this.chairId),s=e.cardsArr.length,c=(n+s-o)%s,l=0,d=0;d<s;++d)r.getMianbai(d)&&r.playingChairArr[d]>this.chairId&&++l;var h=e.cardsArr[n],u=(s-c-l)*this.turnSecond;t||(u=0);var g=this;if(!r.getMianbai(n))for(var C=3;C<8;++C)this.setNodeSpriteFrame("ThirteenWater/TWCard/"+h[C],this.cardNodeArr[C]);if(o>=0){var p="",f="";if(this.chairId!==a){var m=e.scoresArr[o][n][1];m>=0?(f="\u8d62+"+parseFloat(m.toFixed(2)),p="ThirteenWater/TWCommon/fnt_game2"):(f="\u8f93"+m,p="ThirteenWater/TWCommon/fnt_game1")}else{for(var A=0,b=void 0,y=0,T=void 0,S=0;S<e.daqiangArr[o].length;++S)A+=e.scoresArr[o][S][1],y+=e.scoresArr[o][S][0]+e.scoresArr[o][S][1];A>=0?(f="\u4e2d\u9053+"+parseFloat(A.toFixed(2)),p="ThirteenWater/TWCommon/fnt_game4"):(f="\u4e2d\u9053"+parseFloat(A.toFixed(2)),p="ThirteenWater/TWCommon/fnt_game3"),y>=0?(b="\u603b\u5206+"+parseFloat(y.toFixed(2)),T="ThirteenWater/TWCommon/fnt_game4"):(b="\u603b\u5206"+parseFloat(y.toFixed(2)),T="ThirteenWater/TWCommon/fnt_game3"),this.scheduleOnce(function(){cc.loader.loadRes(T,cc.Font,function(e,t){e||(g.zongfenLabel.font=t,g.zongfenLabel.string=b,g.zongfenLabel.node.active=!0)})},u)}this.scheduleOnce(function(){cc.loader.loadRes(p,cc.Font,function(e,t){e||(g.zhongdaoLabel.font=t,g.zhongdaoLabel.string=f,g.zhongdaoLabel.node.active=!0)})},u)}if(t){var v=i.getZhongArr(e.cardsArr[r.playingChairArr.indexOf(this.chairId)]);r.getMianbai(this.chairId)||(this.setNodeSpriteFrame(this.getTypeUrlByCardArr(v),this.typeSprite.node),Global.AudioManager.playSound(this.getSoundUrlByCardArr(v)),this.typeSprite.node.active=!0,this.scheduleOnce(function(){this.typeSprite.node.active=!1}.bind(this),1))}},setCardType5:function(e,t){for(var a=r.getMyChairId(),o=r.playingChairArr.indexOf(a),n=r.playingChairArr.indexOf(this.chairId),s=e.cardsArr.length,c=(n+s-o)%s,l=0,d=0;d<s;++d)r.getMianbai(d)&&r.playingChairArr[d]>this.chairId&&++l;var h=e.cardsArr[n],u=(s-c-l)*this.turnSecond;t||(u=0);var g=this;if(!r.getMianbai(n))for(var C=8;C<13;++C)this.setNodeSpriteFrame("ThirteenWater/TWCard/"+h[C],this.cardNodeArr[C]);if(o>=0){var p="",f="";if(this.chairId!==a){var m=e.scoresArr[o][n][2];m>=0?(p="\u8d62+"+parseFloat(m.toFixed(2)),f="ThirteenWater/TWCommon/fnt_game2"):(p="\u8f93"+parseFloat(m.toFixed(2)),f="ThirteenWater/TWCommon/fnt_game1")}else{for(var A=0,b=0,y=void 0,T=void 0,S=0;S<e.daqiangArr[o].length;++S)A+=e.scoresArr[o][S][2],b+=e.scoresArr[o][S][0]+e.scoresArr[o][S][1]+e.scoresArr[o][S][2];A>=0?(p="\u5c3e\u9053+"+parseFloat(A.toFixed(2)),f="ThirteenWater/TWCommon/fnt_game4"):(p="\u5c3e\u9053"+parseFloat(A.toFixed(2)),f="ThirteenWater/TWCommon/fnt_game3"),b>=0?(T="\u603b\u5206+"+parseFloat(b.toFixed(2)),y="ThirteenWater/TWCommon/fnt_game4"):(T="\u603b\u5206"+parseFloat(b.toFixed(2)),y="ThirteenWater/TWCommon/fnt_game3"),this.scheduleOnce(function(){cc.loader.loadRes(y,cc.Font,function(e,t){e||(g.zongfenLabel.font=t,g.zongfenLabel.string=T,g.zongfenLabel.node.active=!0)})},u)}this.scheduleOnce(function(){cc.loader.loadRes(f,cc.Font,function(e,t){e||(g.weidaoLabel.font=t,g.weidaoLabel.string=p,g.weidaoLabel.node.active=!0)}),g.showMianbai(e)},u)}if(t){var v=i.getWeiArr(e.cardsArr[n]);r.getMianbai(this.chairId)||(Global.AudioManager.playSound(this.getSoundUrlByCardArr(v)),this.setNodeSpriteFrame(this.getTypeUrlByCardArr(v),this.typeSprite),this.typeSprite.node.active=!0,this.scheduleOnce(function(){this.typeSprite.node.active=!1}.bind(this),1))}},showMianbai:function(e){var t=r.playingChairArr.indexOf(this.chairId);if(r.getMianbai(t))for(var a=e.cardsArr[t],i=0;i<13;++i)this.setNodeSpriteFrame("ThirteenWater/TWCard/"+a[i],this.cardNodeArr[i])},setCardType6:function(e,t){var a=r.getMyChairId(),o=r.playingChairArr.indexOf(a);if(!(o<0)){var n=r.playingChairArr.indexOf(this.chairId);if(r.getMianbai(n)){t&&(this.typeSprite.node.active=!0,this.setNodeSpriteFrame(this.getTypeUrlByCardArr(e.cardsArr[n]),this.typeSprite.node),this.scheduleOnce(function(){this.typeSprite.node.active=!1}.bind(this),1),Global.AudioManager.playSound(this.getSoundUrlByCardArr(e.cardsArr[n])));var s=e.cardsArr[n];for(S=0;S<13;++S)this.setNodeSpriteFrame("ThirteenWater/TWCard/"+s[S],this.cardNodeArr[S])}var c="",l="";if(this.chairId===a){(y=i.getScoreArrByResout(e)[n])>=0?(l="\u603b\u5206:+"+parseFloat(y.toFixed(2)),c="ThirteenWater/TWCommon/fnt_game4"):(l="\u603b\u5206:"+parseFloat(y.toFixed(2)),c="ThirteenWater/TWCommon/fnt_game3");var d,h,u=i.getTouScoreArrByResout(e)[o];u>=0?(h="\u5934\u9053+"+parseFloat(u.toFixed(2)),d="ThirteenWater/TWCommon/fnt_game4"):(h="\u5934\u9053"+parseFloat(u.toFixed(2)),d="ThirteenWater/TWCommon/fnt_game3"),cc.loader.loadRes(d,cc.Font,function(e,t){e||(this.toudaoLabel.font=t,this.toudaoLabel.string=h,this.toudaoLabel.node.active=!0)}.bind(this));var g,C,p=i.getZhongScoreArrByResout(e)[o];p>=0?(C="\u4e2d\u9053+"+parseFloat(p.toFixed(2)),g="ThirteenWater/TWCommon/fnt_game4"):(C="\u4e2d\u9053"+parseFloat(p.toFixed(2)),g="ThirteenWater/TWCommon/fnt_game3"),cc.loader.loadRes(g,cc.Font,function(e,t){e||(this.zhongdaoLabel.font=t,this.zhongdaoLabel.string=C,this.zhongdaoLabel.node.active=!0)}.bind(this));var f,m,A=i.getWeiScoreArrByResout(e)[o];A>=0?(m="\u5c3e\u9053+"+parseFloat(A.toFixed(2)),f="ThirteenWater/TWCommon/fnt_game4"):(m="\u5c3e\u9053"+parseFloat(A.toFixed(2)),f="ThirteenWater/TWCommon/fnt_game3"),cc.loader.loadRes(f,cc.Font,function(e,t){e||(this.weidaoLabel.font=t,this.weidaoLabel.string=m,this.weidaoLabel.node.active=!0)}.bind(this))}else{var b=Math.abs(e.daqiangArr[o][n]),y=0;b>1&&(y=e.scoresArr[o][n][0],this.toudaoLabel.string=y>0?"\u8d62+"+parseFloat(y.toFixed(2))+"x"+b:"\u8f93"+parseFloat(y.toFixed(2))+"x"+b,y=e.scoresArr[o][n][1],this.zhongdaoLabel.string=y>0?"\u8d62+"+parseFloat(y.toFixed(2))+"x"+b:"\u8f93"+parseFloat(y.toFixed(2))+"x"+b,y=e.scoresArr[o][n][2],this.weidaoLabel.string=y>0?"\u8d62+"+parseFloat(y.toFixed(2))+"x"+b:"\u8f93"+parseFloat(y.toFixed(2))+"x"+b);var T=e.rateArr[n]*e.rateArr[o];l="\u7ffb\u500d",1===T&&(l="\u4e0d\u7ffb\u500d");for(var S=0;S<3;++S)y+=e.scoresArr[o][n][S];if(c=y>=0?"ThirteenWater/TWCommon/fnt_game2":"ThirteenWater/TWCommon/fnt_game1",e.guaipaiScoreArr[a]+e.guaipaiScoreArr[n]>0){var v=e.guaipaiScoreArr[a]-e.guaipaiScoreArr[n],N="\u602a\u724c+"+parseFloat(v.toFixed(2)),D="ThirteenWater/TWCommon/fnt_game2";v<0&&(D="ThirteenWater/TWCommon/fnt_game1",N="\u602a\u724c"+parseFloat(v.toFixed(2))),cc.loader.loadRes(D,cc.Font,function(e,t){this.guaiLabel.font=t,this.guaiLabel.string=N,this.guaiLabel.node.active=!0}.bind(this))}}cc.loader.loadRes(c,cc.Font,function(e,t){e||(this.zongfenLabel.font=t,this.zongfenLabel.string=l,this.zongfenLabel.node.active=!0)}.bind(this))}},setCardType7:function(e){if(this.chairId===r.getMyChairId()&&this.canFanpai){var t=r.getCardsArr();this.cardType=7;for(var a=t[r.playingChairArr.indexOf(this.chairId)],i=0;i<13;++i)this.setNodeSpriteFrame("ThirteenWater/TWCard/"+a[i],this.cardNodeArr[i]);this.gameTypeSprite.node.active=!1}},setCardType8:function(){if(this.chairId===r.getMyChairId()&&this.canFanpai){this.cardType=2;for(var e=0;e<13;++e)this.setNodeSpriteFrame("ThirteenWater/TWCard/card_back",this.cardNodeArr[e]);this.gameTypeSprite.node.active=r.getMianbai(r.playingChairArr.indexOf(this.chairId))}},daqiangAnimal:function(e,t){for(var a=e.cardsArr.length,i=[],o=0;o<e.daqiangArr.length;++o){i[o]=[];for(var n=0;n<e.daqiangArr[o].length;++n)i[o][n]=e.daqiangArr[o][n]}var s=0;t&&(s=t);var c=this,l=c.hasSanChuan(e.daqiangArr);r.getGameRule().otherRule.youSanChuan||(l=!1);var d=function e(){for(;s<a*a&&i[Math.floor(s/a)][s%a]<=1;)++s;if(s>=a*a){l?(c.node.parent.getComponent("TWMainDialog").glassAnimal(function(){c.createSettleDialog()}),c.unschedule(e)):(c.createSettleDialog(),c.unschedule(e))}else{var t=Math.floor(s/a),o=s%a;c.chairId===r.playingChairArr[t]?(c.gunSprite.node.active=!0,c.gunSprite.node.opacity=255,c.threeGunAnimal(c.gunSprite.node,s,a)):c.chairId===r.playingChairArr[o]?(c.holesNode.active=!0,c.holesNode.opacity=255,c.threeHoleAnimal(c.holesNode)):c.gunSprite.node.active=!1,++s}};d(),s<a*a&&this.schedule(d,this.gunSecond)},createSettleDialog:function(){var e=this,t=r.getResout(),a=r.playingChairArr.indexOf(this.chairId);this.scheduleOnce(function(){e.setCardType6(t,!0)},this.turnSecond/2),this.scheduleOnce(function(){e.gunSprite.node.active=!1,e.holesNode.active=!1,0===a&&e.showResultFinishedCallback&&e.showResultFinishedCallback();for(var t=0;t<5;++t)e.holesNode.getChildByName("HoleSprite"+(t+1)).active=!1;e.isOnAniaml=!1},1.5*this.turnSecond)},hasSanChuan:function(e){var t,a,r;for(t=0;t<e.length;++t){for(r=0,a=0;a<e[t].length;++a)e[t][a]>1&&++r;if(3===r)return!0}return!1},threeGunAnimal:function(e,t,a){Global.AudioManager.playSound("ThirteenWater/TWSound/tw_sanqiang2"),e||(e=this.gunSprite.node);var i=r.getMyChairId(),o=["bottom","right","top","left"],n=o[(this.chairId-i+4)%4],s=o[(t%a+4-i)%4],c=14,l=16;"bottom"===n?"right"===s?(e.scaleX=-2.5,c=-c,l=-l):"top"===s&&(e.rotation=40):"right"===n?"left"===s?e.rotation=-50:"bottom"===s&&(e.rotation=-110):"top"===n?"left"===s?e.rotation=-105:"bottom"===s?e.rotation=-140:"right"===s&&(e.rotation=-180):"left"===n&&(c=-c,l=-l,"right"===s?e.rotation=50:"right"===s?e.rotation=50:"bottom"===s&&(e.rotation=105)),e.runAction(cc.sequence(cc.spawn(cc.moveBy(.1,cc.v2(c,0)),cc.rotateBy(.1,l)),cc.spawn(cc.moveBy(.1,cc.v2(-c,0)),cc.rotateBy(.1,-l)),cc.delayTime(.1),cc.spawn(cc.moveBy(.1,cc.v2(c,0)),cc.rotateBy(.1,l)),cc.spawn(cc.moveBy(.1,cc.v2(-c,0)),cc.rotateBy(.1,-l)),cc.delayTime(.1),cc.spawn(cc.moveBy(.1,cc.v2(c,0)),cc.rotateBy(.1,l)),cc.spawn(cc.moveBy(.1,cc.v2(-c,0)),cc.rotateBy(.1,-l)),cc.callFunc(function(){e.opacity=0,e.rotation=0,"bottom"===n&&(e.scaleX=2.5)})))},oneGunAnimal:function(e){Global.AudioManager.playSound("ThirteenWater/TWSound/tw_yiqiang"),e||(e=this.gunSprite.node),e.runAction(cc.sequence(cc.moveBy(.2,cc.v2(8,8)),cc.moveBy(.2,cc.v2(-8,-8)))),e.runAction(cc.sequence(cc.rotateBy(.2,3),cc.rotateBy(.2,-3)))},threeHoleAnimal:function(e){e||(e=this.holesNode);var t=["HoleSprite1","HoleSprite2","HoleSprite3","HoleSprite4","HoleSprite5"];!0===e.getChildByName(t[1]).active?e.runAction(cc.sequence(cc.callFunc(function(){e.getChildByName(t[0]).active=!0}),cc.delayTime(.3),cc.callFunc(function(){e.getChildByName(t[3]).active=!0}))):e.runAction(cc.sequence(cc.callFunc(function(){e.getChildByName(t[1]).active=!0}),cc.delayTime(.3),cc.callFunc(function(){e.getChildByName(t[2]).active=!0}),cc.delayTime(.3),cc.callFunc(function(){e.getChildByName(t[4]).active=!0})))},oneHoleAnimal:function(e){e||(e=this.holesNode);var t,a=["HoleSprite1","HoleSprite2","HoleSprite3","HoleSprite4","HoleSprite5"],r=Math.floor(5*Math.random());for(t=0;t<a.length;++t)e.getChildByName(a[t]).active=!1;e.runAction(cc.sequence(cc.delayTime(.2),cc.callFunc(function(){e.getChildByName(a[r]).active=!0})))},setNodeSpriteFrame:function(e,t){cc.loader.loadRes(e,cc.SpriteFrame,function(e,a){e||(t.getComponent(cc.Sprite).spriteFrame=a)})},getTypeUrlByCardArr:function(e,t){var a="ThirteenWater/TWSort/danpai";return i.hasYitiaolong(e)?a="ThirteenWater/TWSort/yitiaolong":i.hasLiuduiban(e)?a="ThirteenWater/TWSort/liuduiban":i.hasSanhua(e)?a="ThirteenWater/TWSort/sanhua":i.hasSanshun(e)?a="ThirteenWater/TWSort/sanshun":i.hasTonghuashun(e)?a="ThirteenWater/TWSort/tonghuashun":i.hasSitiao(e)?a="ThirteenWater/TWSort/sitiao":i.hasHulu(e)?a="ThirteenWater/TWSort/hulu":i.hasTonghua(e)?a="ThirteenWater/TWSort/tonghua":i.hasShunzi(e)?a="ThirteenWater/TWSort/shunzi":i.hasSantiao(e)?(a="ThirteenWater/TWSort/santiao",t&&"tou"===t&&(a="ThirteenWater/TWSort/jingang")):i.hasLiangdui(e)?a="ThirteenWater/TWSort/liangdui":i.hasDuizi(e)&&(a="ThirteenWater/TWSort/duizi"),a},getSoundUrlByCardArr:function(e,t){var a="ThirteenWater/TWSound/tw_danpai";return i.hasYitiaolong(e)?a="ThirteenWater/TWSound/tw_yitiaolong":i.hasLiuduiban(e)?a="ThirteenWater/TWSound/tw_liuduiban":i.hasSanhua(e)?a="ThirteenWater/TWSound/tw_sanhua":i.hasSanshun(e)?a="ThirteenWater/TWSound/tw_shanshun":i.hasTonghuashun(e)?a="ThirteenWater/TWSound/tw_tonghuashun":i.hasSitiao(e)?a="ThirteenWater/TWSound/tw_sitiao":i.hasHulu(e)?a="ThirteenWater/TWSound/tw_hulu":i.hasTonghua(e)?a="ThirteenWater/TWSound/tw_tonghua":i.hasShunzi(e)?a="ThirteenWater/TWSound/tw_shunzi":i.hasSantiao(e)?(a="ThirteenWater/TWSound/tw_santiao",t&&"tou"===t&&(a="ThirteenWater/TWSound/tw_jingang")):i.hasLiangdui(e)?a="ThirteenWater/TWSound/tw_liangdui":i.hasDuizi(e)&&(a="ThirteenWater/TWSound/tw_duizi"),a},showMainContinueButton:function(){var e=this.node.parent;null!==r.getGameEndData()?e.getChildByName("ExitButton").active=!0:e.getChildByName("ContinueButton").active=!0},getIsOnAnimal:function(){return this.isOnAniaml}}),cc._RF.pop()},{"./TWLogic":"TWLogic","./TWModel":"TWModel","./TWProto":"TWProto"}],TWCommonFunction:[function(e,t,a){"use strict";cc._RF.push(t,"52da6TMuvNLOayR3PYVyRv+","TWCommonFunction"),t.exports.numberToTimeMS=function(e){var t,a;return e=parseInt(e),t=Math.floor(e/60),a=Math.floor(e%60),t<10&&(t="0"+t),a<10&&(a="0"+a),t+":"+a},cc._RF.pop()},{}],TWGuaipaiTipWidgetCtrl:[function(e,t,a){"use strict";cc._RF.push(t,"a9e97CuxBxAs5zmI228Ste+","TWGuaipaiTipWidgetCtrl");var r=e("TWLogic"),i=(e("TWModel"),e("./TWProto"));e("../../API/RoomProto");cc.Class({extends:cc.Component,properties:{richLabel:cc.RichText},onLoad:function(){},onDestroy:function(){},setLabel:function(e){this.cardArr=e;var t="";r.hasYitiaolong(e)?t="\u4e00\u6761\u9f99":r.hasSanhua(e)?t="\u4e09\u82b1":r.hasSanshun(e)?t="\u4e09\u987a":r.hasLiuduiban(e)&&(t="\u516d\u5bf9\u534a"),this.richLabel.string="\u83b7\u5f97\u7279\u6b8a\u514d\u6446\u724c\u578b(<color=#ffe35f>"+t+"</color>) \u662f\u5426\u9009\u62e9\u514d\u6446"},onButtonClick:function(e,t){"confirm"===t?(Global.NetworkManager.notify("game.gameHandler.gameMessageNotify",i.getGameNosortRequestData(!0),Date.now()),this.node.destroy()):"cancel"===t&&(Global.NetworkManager.notify("game.gameHandler.gameMessageNotify",i.getGameNosortRequestData(!1),Date.now()),this.node.destroy())}}),cc._RF.pop()},{"../../API/RoomProto":"RoomProto","./TWProto":"TWProto",TWLogic:"TWLogic",TWModel:"TWModel"}],TWHeadItem:[function(e,t,a){"use strict";cc._RF.push(t,"0df4d4dXGxELYCENF3vWcg3","TWHeadItem");var r=e("./TWModel"),i=e("../../API/RoomProto"),o=e("./TWProto");cc.Class({extends:cc.Component,properties:{nameLabel:cc.Label,scoreLabel:cc.Label,typeSprite:cc.Node},onLoad:function(){this.nameLabel.string="",this.scoreLabel.string=""},setChairId:function(e){this.chairId=e;var t=r.getPlayerByChairId(e);t?(this.node.active=!0,this.uid=t.userInfo.uid,this.unscheduleAllCallbacks(),this.updateUserInfo(),0!=(t.userStatus&i.userStatusEnum.READY)&&r.gameStatus===o.GAME_STATUS_NOTSTART&&this.setReady(!0)):this.node.active=!1},setReady:function(e){},onGameStart:function(){var e=r.getPlayerByChairId(this.chairId);e&&(e.userStatus=i.userStatusEnum.PLAYING,this.setReady(!1))},updateUserInfo:function(){var e=r.getPlayerByChairId(this.chairId);if(e){this.nameLabel.string=Global.Player.convertNickname(e.userInfo.nickname),this.scoreLabel.string=parseFloat(e.userInfo.gold.toFixed(2)).toString();var t=this.node.getChildByName("HeadSprite");Global.CCHelper.updateSpriteFrame(e.userInfo.avatar,t.getComponent(cc.Sprite))}},getDaqiangCount:function(e){e.cardsArr.length;for(var t=[],a=0;a<e.daqiangArr.length;++a){t[a]=[];for(var i=0;i<e.daqiangArr[a].length;++i)t[a][i]=e.daqiangArr[a][i]}for(var o=0;o<t.length;++o)if(r.getMianbai(o))for(var n=0;n<t.length;++n)n===o||r.getMianbai(n)||(t[o][n]=2);var s=0;for(a=0;a<t.length;++a)for(i=0;i<t[a].length;++i)t[a][i]>1&&++s;return s}}),cc._RF.pop()},{"../../API/RoomProto":"RoomProto","./TWModel":"TWModel","./TWProto":"TWProto"}],TWLogic:[function(e,t,a){"use strict";cc._RF.push(t,"2118bA4DhNEqp/+VLYlOYsr","TWLogic");var r=t.exports;r.cardType={danpai:{type:0,name:"danpai",rate:0},duizi:{type:1,name:"duizi",rate:0},liangdui:{type:2,name:"liangdui",rate:0},santiao:{type:4,name:"santiao",rate:0},shunzi:{type:8,name:"shunzi",rate:0},tonghua:{type:16,name:"tonghua",rate:0},hulu:{type:32,name:"hulu",rate:0},sitiao:{type:64,name:"sitiao",rate:0},tonghuashun:{type:128,name:"tonghuashun",rate:0},jingang:{type:256,name:"jingang",rate:0},guaipai:{type:512,name:"guaipai",rate:0}},r.getCardsArr=function(e){if(e>4)return null;var t,a,r,i,o=[[],[],[],[]],n=[];for(t=0;t<52;++t)n[t]=t;for(t=0;t<100;++t)a=Math.floor(52*Math.random()),r=Math.floor(52*Math.random()),i=n[a],n[a]=n[r],n[r]=i;for(t=0;t<52;++t)o[Math.floor(t/13)].push(n[t]);for(t=e;t<4;++t)o.pop();return o},r.getResout=function(e,t,a){var r,i;if(!t)for(t=[],r=0;r<a.memberCount;++r)t[r]=!1;var o=[];for(r=0;r<a.memberCount;++r)for(o[r]=[],i=0;i<a.memberCount;++i)o[r][i]=[0,0,0];var n=[],s=[],c=[];for(r=0;r<a.memberCount;++r)for(s[r]=1,c[r]=0,n[r]=[],i=0;i<a.memberCount;++i)n[r][i]=r===i?0:1;for(r=0;r<t.length;++r)t[r]&&(c[r]=this.hasYitiaolong(e[r])?26:3);if(a.otherRule.heiTaoA)for(r=0;r<e.length;++r)-1!==e[r].indexOf(39)&&(s[r]=2);for(r=0;r<e.length;++r)if(!t[r])for(i=0;i<e.length;++i)if(i!==r&&!t[i]){var l=0,d=this.getTouArr(e[r]),h=this.getTouArr(e[i]);this.compareCards(d,h,this.getTouZhongWeiCardType(d),this.getTouZhongWeiCardType(h))?(l=1,this.hasSantiao(d)&&(l=3)):(l=-1,this.hasSantiao(h)&&(l=-3)),o[r][i][0]=l;var u=this.getZhongArr(e[r]),g=this.getZhongArr(e[i]);this.compareCards(u,g,this.getTouZhongWeiCardType(u),this.getTouZhongWeiCardType(g))?(l=1,this.hasHulu(u)?l=2:this.hasSitiao(u)?l=8:this.hasTonghuashun(u)&&(l=10)):(l=-1,this.hasHulu(g)?l=-2:this.hasSitiao(g)?l=-8:this.hasTonghuashun(g)&&(l=-10)),o[r][i][1]=l;var C=this.getWeiArr(e[r]),p=this.getWeiArr(e[i]);this.compareCards(C,p,this.getTouZhongWeiCardType(C),this.getTouZhongWeiCardType(p))?(l=1,this.hasSitiao(C)?l=4:this.hasTonghuashun(C)&&(l=5)):(l=-1,this.hasSitiao(p)?l=-4:this.hasTonghuashun(p)&&(l=-5)),o[r][i][2]=l}for(r=0;r<o.length;++r)for(i=0;i<o[r].length;++i)o[r][i][0]>0&&o[r][i][1]>0&&o[r][i][2]>0&&(n[r][i]=2),o[r][i][0]<0&&o[r][i][1]<0&&o[r][i][2]<0&&(n[r][i]=-2);var f=function(e){if(!a.otherRule.youSanChuan)return!1;var t,r=0;for(t=0;t<n[e].length;++t)n[e][t]>1&&++r;return 3===r};for(r=0;r<a.memberCount;++r)for(i=0;i<a.memberCount;++i)r!==i&&(f(r)?n[r][i]=4:f(i)&&(n[r][i]=-4));return{cardsArr:e,scoresArr:o,guaipaiScoreArr:c,daqiangArr:n,rateArr:s}},r.getUserScore=function(e,t){var a,r,i=t.scoresArr[e],o=0;for(a=0;a<i.length;++a)if(a!==e)for(r=0;r<i[a].length;++r)o+=i[a][r];return o+=t.guaipaiScoreArr[e]},r.getCardColor=function(e){return["fangkuai","meihua","hongtao","heitao"][Math.floor(e/13)]},r.getCardsType=function(e){if(13!==e.length)return null;var t=this.getTouArr(e),a=this.getZhongArr(e),r=this.getWeiArr(e),i=0,o=0,n=0;return this.hasGuaipai(e)?{type1:i=this.cardType.guaipai.type,type2:o=this.cardType.guaipai.type,type3:n=this.cardType.guaipai.type}:(i=this.getTouZhongWeiCardType(t),o=this.getTouZhongWeiCardType(a),n=this.getTouZhongWeiCardType(r),this.compareCards(r,a,n,o)&&this.compareCards(a,t,o,i)?{type1:i,type2:o,type3:n}:null)},r.autoSortCards=function(e){var t,a,r,i,o=[];for(i=0;i<e.length;++i)o[i]=e[i];if(this.hasGuaipai(e))return o;for(r=this.getMaxCardArr(o),i=0;i<r.length;++i)o.splice(o.indexOf(r[i]),1);for(a=this.getMaxCardArr(o),i=0;i<a.length;++i)o.splice(o.indexOf(a[i]),1);t=o;var n=[];for(i=0;i<t.length;++i)n.push(t[i]);for(i=0;i<a.length;++i)n.push(a[i]);for(i=0;i<r.length;++i)n.push(r[i]);return n},r.compareCards=function(e,t,a,r){var i,o,n,s,c,l;for(i=256;i>0&&!((a&i)>0&&(r&i)>0);i/=2){if((a&i)>0&&0==(r&i))return!0;if(0==(a&i)&&(r&i)>0)return!1}if(i===this.cardType.tonghuashun.type||i===this.cardType.shunzi.type||i===this.cardType.tonghua.type||i===this.cardType.danpai.type)return 0!==(l=this.compareDanpai(e,t))?l<0:(l=this.compareHuase(e,t))<0;if(i===this.cardType.sitiao.type||i===this.cardType.santiao.type||i===this.cardType.duizi.type||i===this.cardType.liangdui.type){var d=[],h=[],u=i;for(i=0;i<e.length;++i)for(o=i+1;o<e.length;++o)e[i]%13==e[o]%13&&(-1===d.indexOf(e[i])&&d.push(e[i]),-1===d.indexOf(e[o])&&d.push(e[o]));for(i=0;i<t.length;++i)for(o=i+1;o<t.length;++o)t[i]%13==t[o]%13&&(-1===h.indexOf(t[i])&&h.push(t[i]),-1===h.indexOf(t[o])&&h.push(t[o]));if(0!==(l=this.compareDanpai(d,h)))return l<0;if(3===e.length&&3===t.length&&u===this.cardType.duizi.type){var g,C;for(i=0;i<3;++i)e[i]%13!=d[0]%13&&(g=e[i]),t[i]%13!=h[0]%13&&(C=t[i]);l=g%13==C%13?C-g:g%13==0?-1:C%13==0?1:C%13-g%13}else l=this.compareDanpai(e,t);return 0!==l?l<0:(l=this.compareHuase(e,t))<0}if(i===this.cardType.hulu.type){for(i=0;i<e.length;++i){for(c=0,o=i+1;o<e.length;++o)e[o]%13==e[i]%13&&++c;if(2===c){n=e[i];break}}for(i=0;i<t.length;++i){for(c=0,o=i+1;o<t.length;++o)t[o]%13==t[i]%13&&++c;if(2===c){s=t[i];break}}return(l=this.cardSortFunc(n,s))<0}},r.compareDanpai=function(e,t){var a,r;for(e=this.sortCardByCountThenColor(e),t=this.sortCardByCountThenColor(t),a=0;a<e.length&&a<t.length;++a)if(0!==(r=this.cardSortFunc(e[a],t[a])))return r;return 0},r.compareHuase=function(e,t){return e=this.sortCardByCountThenColor(e),(t=this.sortCardByCountThenColor(t))[0]-e[0]},r.hasDuizi=function(e){var t,a,r=this.removeCardColor(e);for(t=0;t<r.length;++t){var i=0;for(a=0;a<r.length;++a)r[t]===r[a]&&++i;if(i>=2)return!0}return!1},r.hasLiangdui=function(e){if(e.length<4)return!1;var t,a,r=this.removeCardColor(e),i=[];for(t=0;t<r.length;++t)if(-1===i.indexOf(r[t])){var o=0;for(a=0;a<r.length;++a)r[t]===r[a]&&++o;if(o>=2&&(i.push(r[t]),i.length>1))return!0}return!1},r.hasSantiao=function(e){for(var t=this.removeCardColor(e),a=0;a<t.length;++a){for(var r=0,i=0;i<t.length;++i)t[a]===t[i]&&++r;if(r>=3)return!0}return!1},r.hasShunzi=function(e){if(e.length<5)return!1;e=e.sort(this.cardSortFunc);for(var t=[],a=0;a<e.length;++a)t[a]=e[a];t[0]%13==0&&t.push(t[0]);var r=0;for(a=1;a<t.length;++a)if((t[a-1]+13-1)%13==t[a]%13||(t[a-1]-1)%13==t[a]%13?++r:t[a]%13!=t[a-1]%13&&(r=0),4===r)return!0;return!1},r.hasTonghua=function(e){if(e.length<5)return!1;for(var t=0;t<4;++t){for(var a=0,r=0;r<e.length;++r)Math.floor(e[r]/13)===t&&++a;if(a>=5)return!0}return!1},r.hasHulu=function(e){if(e.length<5)return!1;for(var t=this.removeCardColor(e),a=[],r=[],i=0;i<t.length;++i)if(-1===r.indexOf(t[i])&&-1===a.indexOf(t[i])){for(var o=0,n=0;n<t.length;++n)t[n]===t[i]&&++o;2===o&&-1===r.indexOf(t[i])&&r.push(t[i]),o>=3&&-1===a.indexOf(t[i])&&a.push(t[i])}return a.length>=2||a.length>=1&&r.length>=1},r.hasSitiao=function(e){if(e.length<5)return!1;for(var t=this.removeCardColor(e),a=0;a<t.length;++a){for(var r=0,i=0;i<t.length;++i)t[i]===t[a]&&++r;if(4===r)return!0}return!1},r.hasTonghuashun=function(e){if(e.length<5)return!1;for(var t=0;t<4;++t){for(var a=[],r=0;r<e.length;++r)Math.floor(e[r]/13)===t&&a.push(e[r]);if(this.hasShunzi(a))return!0}return!1},r.hasSanhua=function(e){if(13!==e.length)return!1;var t,a,r,i=0;for(t=0;t<4;++t){for(r=0,a=0;a<e.length;++a)Math.floor(e[a]/13)===t&&++r;if(0!==r&&3!==r&&5!==r&&8!==r&&10!==r&&13!==r)return!1;i+=r}return 13===i},r.hasYitiaolong=function(e){if(13!==e.length)return!1;var t,a=this.removeCardColor(e);for(a.sort(function(e,t){return e-t}),t=1;t<a.length;++t)if(a[t]===a[t-1])return!1;return!0},r.hasLiuduiban=function(e){if(13!==e.length)return!1;for(var t,a=this.removeCardColor(e),r=0;r<a.length;)-1!==(t=a.indexOf(a[r],r+1))?(a.splice(t,1),a.splice(r,1)):++r;return 1===a.length},r.hasGuaipai=function(e){return this.hasLiuduiban(e)||this.hasYitiaolong(e)||this.hasSanhua(e)||this.hasSanshun(e)},r.getDuizi=function(e){if(3===(e=this.sortCardByCountThenColor(e)).length)return[[e[0],e[1],e[2]]];if(5===e.length)return[[e[0],e[1],e[2],e[3],e[4]]];var t,a,r,i,o,n,s,c,l=this.removeCardColor(e),d=[],h=[],u=[];for(t=0;t<l.length;++t){var g=0;for(a=0;a<l.length;++a)l[t]===l[a]&&++g;g>=2&&-1===h.indexOf(l[t])&&h.push(l[t]),1===g&&u.unshift(e[t])}if(u.length<3)for(t=h.length-1;t>=0;--t)u.push(e[l.indexOf(h[t])]);for(a=0;a<u.length;++a)for(r=a+1;r<u.length;++r)for(i=r+1;i<u.length;++i)for(t=0;t<h.length;++t)u[a]%13!==h[t]&&u[r]%13!==h[t]&&u[i]%13!==h[t]&&(s=e[n=l.indexOf(h[t])],c=e[n=l.indexOf(h[t],n+1)],(o=[]).push(s),o.push(c),o.push(u[a]),o.push(u[r]),o.push(u[i]),d.push(o));return d},r.getLiangdui=function(e){var t=[];if(e.length<5)return t;if(5===e.length)return[[e[0],e[1],e[2],e[3],e[4]]];e=this.sortCardByCountThenColor(e);var a,r,i,o,n,s=this.removeCardColor(e),c=[],l=[],d=[];for(a=0;a<s.length;++a)if(-1===c.indexOf(s[a])){var h=0;for(r=0;r<s.length;++r)s[a]===s[r]&&++h;2===h&&-1===c.indexOf(s[a])?c.push(s[a]):h>2&&-1===d.indexOf(s[a])?d.push(s[a]):1===h&&l.unshift(e[a])}if(0===l.length)if(c.length>2)for(a=c.length-1;a>=0;--a)l.push(e[s.indexOf(c[a])]);else for(a=d.length-1;a>=0;--a)l.push(e[s.indexOf(d[a])]);if(c.length<2)for(a=d.length-1;a>=0;--a)c.push(d[a]);for(i=0;i<l.length;++i)for(a=0;a<c.length;++a)for(r=a+1;r<c.length;++r)l[i]%13!==c[a]&&l[i]%13!==c[r]&&(o=[],n=s.indexOf(c[a]),o.push(e[n]),n=s.indexOf(c[a],n+1),o.push(e[n]),n=s.indexOf(c[r]),o.push(e[n]),n=s.indexOf(c[r],n+1),o.push(e[n]),o.push(l[i]),t.push(o));return t},r.getSantiao=function(e){var t=[];if(3===e.length)return[[e[0],e[1],e[2]]];if(5===e.length)return[[e[0],e[1],e[2],e[3],e[4]]];if(e.length<5)return t;e=this.sortCardByCountThenColor(e);var a,r,i,o,n,s,c=this.removeCardColor(e),l=[],d=[];for(a=0;a<c.length;++a)if(-1===l.indexOf(c[a])){for(o=0,r=0;r<c.length;++r)c[a]===c[r]&&++o;o>=3&&l.push(c[a]),1===o&&d.push(e[a])}for(d.length<2&&(d=e),a=0;a<l.length;++a)for(r=d.length-1;r>=0;--r)if(d[r]%13!==l[a])for(i=r-1;i>=0;--i)d[i]%13!==l[a]&&(s=[],n=c.indexOf(l[a]),s.push(e[n]),n=c.indexOf(l[a],n+1),s.push(e[n]),n=c.indexOf(l[a],n+1),s.push(e[n]),s.push(d[r]),s.push(d[i]),t.push(s));return t},r.getShunzi=function(e){var t=[];if(e.length<5)return t;if(5===e.length)return[[e[0],e[1],e[2],e[3],e[4]]];var a,r,i,o=this.sortCardByCountThenColor(e),n=o.length;for(a=0;a<n&&o[a]%13==0;++a)o.push(o[a]);var s,c=[];for(a=1;a<o.length;++a)for(i=1,r=a;r<o.length;++r)if((13+o[r-1]-1)%13==o[r]%13||o[r-1]%13-1==o[r]%13){if(5===++i){-1===c.indexOf(a-1)&&c.push(a-1);break}}else if(o[r]%13!=o[r-1]%13)break;for(a=0;a<c.length;++a){for(s=[],r=c[a];s.length<5;)0===s.length?s.push(o[r]):s.length>0&&o[r]%13!=o[r-1]%13&&s.push(o[r]),++r;t.push(s)}return this.sortResoutArr(t)},r.getTonghua=function(e){var t=[];if(e.length<5)return t;if(5===e.length)return[[e[0],e[1],e[2],e[3],e[4]]];for(var a=0;a<4;++a){for(var r=[],i=0;i<e.length;++i)Math.floor(e[i]/13)===a&&r.push(i);if(r.length>=5)for(var o=0;o<r.length;++o)for(var n=o+1;n<r.length;++n)for(var s=n+1;s<r.length;++s)for(var c=s+1;c<r.length;++c)for(var l=c+1;l<r.length;++l)t.push([e[r[o]],e[r[n]],e[r[s]],e[r[c]],e[r[l]]])}return t},r.getHulu=function(e){var t=[];if(5===e.length)return[[e[0],e[1],e[2],e[3],e[4]]];if(e.length<5)return t;e=this.sortCardByCountThenColor(e);var a,r,i,o,n,s,c=this.removeCardColor(e),l=[],d=[];for(a=0;a<c.length;++a){for(o=0,r=0;r<c.length;++r)c[r]===c[a]&&++o;o>=3&&-1===d.indexOf(c[a])&&d.push(c[a]),2===o&&-1===l.indexOf(c[a])&&l.push(c[a])}if(0===l.length)for(a=d.length-1;a>=0;--a)l.push(d[a]);for(a=0;a<d.length;++a)for(r=l.length-1;r>=0;--r)if(d[a]!==l[r]){for(n=[],s=-1,i=0;i<3;++i)s=c.indexOf(d[a],s+1),n.push(e[s]);s=c.indexOf(l[r]),n.push(e[s]),s=c.indexOf(l[r],s+1),n.push(e[s]),t.push(n)}return t},r.getSitiao=function(e){var t=[];if(e.length<5)return t;if(5===e.length)return[[e[0],e[1],e[2],e[3],e[4]]];var a,r,i,o,n,s,c=this.removeCardColor(e),l=[],d=[];for(a=0;a<c.length;++a)if(o=0,-1===l.indexOf(c[a])){for(r=0;r<c.length;++r)c[r]===c[a]&&++o;4===o&&l.push(c[a]),1===o&&d.push(e[a])}for(0===d.length&&(d=e),a=0;a<l.length;++a)for(r=d.length-1;r>=0;--r)if(d[r]%13!==l[a]){for(s=[],n=-1,i=0;i<4;++i)n=c.indexOf(l[a],n+1),s.push(e[n]);s.push(d[r]),t.push(s)}return t},r.getTonghuashun=function(e){for(var t=this.getTonghua(e),a=[],r=0;r<t.length;++r)this.hasShunzi(t[r])&&a.push(t[r]);return a.length,a},r.fillDuizi=function(e,t,a){var r,i,o,n=[],s=[];for(r=0;r<e.length;++r)e[r]%13!==t&&s.push(e[r]);if(s.sort(function(e,t){return e%13-t%13}),3===a)for(r=0;r<s.length;++r)n.push([e[r]]);else if(5===a)for(r=0;r<s.length;++r)for(i=r+1;i<s.length;++i)for(o=i+1;o<s.length;++o)n.push([e[r],e[i],e[o]]);return n},r.removeCardColor=function(e){var t,a=[];for(t=0;t<e.length;++t)a.push(e[t]%13);return a},r.getCardInArr=function(e,t,a){var r;for(r=a||0;r<e.length;++r)if(e[r]%13===t)return r;if(r===e.length)return-1},r.getMaxCardArr=function(e){if(5===e.length||3===e.length)return e;var t,a,r,i,o;if(this.hasTonghuashun(e)?(t=this.getTonghuashun(e),i=this.cardType.tonghuashun.type):this.hasSitiao(e)?(t=this.getSitiao(e),i=this.cardType.sitiao.type):this.hasHulu(e)?(t=this.getHulu(e),i=this.cardType.hulu.type):this.hasTonghua(e)?(t=this.getTonghua(e),i=this.cardType.tonghua.type):this.hasShunzi(e)?(t=this.getShunzi(e),i=this.cardType.shunzi.type):this.hasSantiao(e)?(t=this.getSantiao(e),i=this.cardType.santiao.type):this.hasLiangdui(e)?(t=this.getLiangdui(e),i=this.cardType.liangdui.type):this.hasDuizi(e)&&(t=this.getDuizi(e),i=this.cardType.duizi.type),t&&t.length>0){for(a=0,r=0;a<t.length-1;++a)this.compareCards(t[r],t[a+1],i,i)||(r=a+1);return t[r]}o=this.sortCardByCountThenColor(e);var n=[];for(a=0;a<5;++a)n.push(o[a]);return n},r.getTouArr=function(e){return[e[0],e[1],e[2]]},r.getZhongArr=function(e){return[e[3],e[4],e[5],e[6],e[7]]},r.getWeiArr=function(e){return[e[8],e[9],e[10],e[11],e[12]]},r.compareCardType=function(e,t){if(e===this.cardType.guaipai.type&&t===this.cardType.guaipai.type)return-1;if(e===this.cardType.guaipai.type)return 1;if(t===this.cardType.guaipai.type)return-1;var a;for(a=512;a>0;a/=2){if((e&a)>0&&0==(t&a))return 1;if(0==(e&a)&&(t&a)>0)return-1}return 0},r.getTouZhongWeiCardType=function(e){var t=0;return this.hasDuizi(e)&&(t|=this.cardType.duizi.type),this.hasLiangdui(e)&&(t|=this.cardType.liangdui.type),this.hasSantiao(e)&&(t|=this.cardType.santiao.type),this.hasShunzi(e)&&(t|=this.cardType.shunzi.type),this.hasTonghua(e)&&(t|=this.cardType.tonghua.type),this.hasHulu(e)&&(t|=this.cardType.hulu.type),this.hasSitiao(e)&&(t|=this.cardType.sitiao.type),this.hasTonghuashun(e)&&(t|=this.cardType.tonghuashun.type),t},r.sortCardByCountThenColor=function(e){var t,a,r,i=[];for(a=0;a<e.length;++a)for(t=[],e[a]%13==0&&t.push(e[a]),t.sort(function(e,t){return t-e}),r=0;r<t.length;++r)i.push(t[r]);for(a=12;a>0;--a){for(t=[],r=0;r<e.length;++r)e[r]%13===a&&t.push(e[r]);for(t.sort(function(e,t){return t-e}),r=0;r<t.length;++r)i.push(t[r])}return i},r.sortResoutArr=function(e){if(e.length<=1)return e;for(var t=this.getTouZhongWeiCardType(e[0]),a=0;a<e.length;++a){for(var r=a,i=a+1;i<e.length;++i)this.compareCards(e[r],e[i],t,t)||(r=i);var o=e[a];e[a]=e[r],e[r]=o}return e},r.kickArrFromArr=function(e,t){var a,r,i=[];for(a=0;a<e.length;++a)i[a]=e[a];for(a=0;a<t.length;++a)for(r=i.indexOf(t[a]);-1!==r;)i.splice(r,1),r=i.indexOf(t[a],r+1);return i},r.getScoreArrByResout=function(e){var t,a,r,i,o,n,s=e.cardsArr.length,c=[];for(t=0;t<s;++t)c[t]=0;for(t=0;t<s;++t){for(o=0,a=0;a<s;++a){for(n=e.rateArr[t]*e.rateArr[a],i=Math.abs(e.daqiangArr[t][a]),r=0;r<3;++r)c[t]+=e.scoresArr[t][a][r]*i*n;0!==e.guaipaiScoreArr[t]&&0===e.guaipaiScoreArr[a]?o+=e.guaipaiScoreArr[t]*n:0===e.guaipaiScoreArr[t]&&0!==e.guaipaiScoreArr[a]&&(o-=e.guaipaiScoreArr[a]*n)}c[t]+=o}return c},r.getTouScoreArrByResout=function(e){var t,a,r,i,o=e.cardsArr.length,n=[];for(t=0;t<o;++t)n[t]=0;for(t=0;t<o;++t)for(a=0;a<o;++a)r=Math.abs(e.daqiangArr[t][a]),i=e.rateArr[t]*e.rateArr[a],n[t]+=e.scoresArr[t][a][0]*r*i;return n},r.getZhongScoreArrByResout=function(e){var t,a,r,i,o=e.cardsArr.length,n=[];for(t=0;t<o;++t)n[t]=0;for(t=0;t<o;++t)for(a=0;a<o;++a)r=Math.abs(e.daqiangArr[t][a]),i=e.rateArr[t]*e.rateArr[a],n[t]+=e.scoresArr[t][a][1]*r*i;return n},r.getWeiScoreArrByResout=function(e){var t,a,r,i,o=e.cardsArr.length,n=[];for(t=0;t<o;++t)n[t]=0;for(t=0;t<o;++t)for(a=0;a<o;++a)r=Math.abs(e.daqiangArr[t][a]),i=e.rateArr[t]*e.rateArr[a],n[t]+=e.scoresArr[t][a][2]*r*i;return n},r.changeToMongoData=function(e){var t,a,r,i=[];for(t=0;t<e.cardsArr.length;++t)for(a=0;a<e.cardsArr[t].length;++a)for(r=0;r<e.cardsArr[t][a].length;++r)i.push(e.cardsArr[t][a][r]);e.cardsArr=i;var o=[];for(t=0;t<e.guaiArr.length;++t)for(a=0;a<e.guaiArr[t].length;++a)o.push(e.guaiArr[t][a]);e.guaiArr=o;var n=[];for(t=0;t<e.scoresArr.length;++t)for(a=0;a<e.scoresArr[t].length;++a)n.push(e.scoresArr[t][a]);return e.scoresArr=n,e.gameRule=JSON.stringify(e.gameRule),e},r.changeToServerData=function(e){e.gameRule=JSON.parse(e.gameRule);var t,a,r,i,o=e.gameRule.memberCount,n=[];for(t=0;t<e.cardsArr.length;t+=13*o){for(i=[],a=0;a<o;++a)for(i[a]=[],r=0;r<13;++r)i[a][r]=e.cardsArr[t+13*a+r];n.push(i)}e.cardsArr=n;var s=[];for(t=0;t<e.guaiArr.length;t+=o){for(i=[],a=0;a<o;++a)i[a]=e.guaiArr[t+a];s.push(i)}e.guaiArr=s;var c=[];for(t=0;t<e.scoresArr.length;t+=o){for(i=[],a=0;a<o;++a)i[a]=e.scoresArr[t+a];c.push(i)}return e.scoresArr=c,e},r.cardSortFunc=function(e,t){e>=13&&(e%=13),t>=13&&(t%=13);var a=[1,2,3,4,5,6,7,8,9,10,11,12,0];return a.indexOf(t)-a.indexOf(e)},r.sortSpecialCard=function(e){return this.hasYitiaolong(e)?this.sortCardByCountThenColor(e):this.hasLiuduiban(e)?this.sortLiuduibanCard(e):this.hasSanhua(e)?this.sortSanhuaCard(e):this.hasSanshun(e)?this.sortSanshunCard(e):void 0},r.sortLiuduibanCard=function(e){for(var t=[],a=0;a<e.length;++a)if(-1===t.indexOf(e[a])){for(var r=a+1;r<e.length;++r)if(e[a]%13==e[r]%13){t.push(e[a]),t.push(e[r]);break}if(r===e.length)var i=e[a]}return t.push(i),t},r.sortSanhuaCard=function(e){for(var t=[],a=0;a<e.length;++a)t[a]=e[a];t=this.sortCardByCountThenColor(t);var r=this.getTonghua(t)[0];for(a=0;a<r.length;++a)t.splice(t.indexOf(r[a]),1);var i=this.getTonghua(t)[0];for(a=0;a<i.length;++a)t.splice(t.indexOf(i[a]),1);var o=[];for(a=0;a<t.length;++a)o.push(t[a]);for(a=0;a<i.length;++a)o.push(i[a]);for(a=0;a<r.length;++a)o.push(r[a]);return o},r.hasSanshun=function(e){var t,a,r,i,o,n,s,c,l,d=[];for(l=0;l<e.length;++l)d[l]=e[l]%13;for(t=1;t<=12;++t)if(i=[t-1,t,(t+1)%13],this.isContainArray(d,i))for(n=this.getNotContainArray(d,i),a=2;a<=11;++a)if(o=[a-2,a-1,a,a+1,(a+2)%13],this.isContainArray(n,o))for(c=this.getNotContainArray(n,o),r=2;r<=11;++r)if(s=[r-2,r-1,r,r+1,(r+2)%13],this.isContainArray(c,s))return!0;return!1},r.sortSanshunCard=function(e){var t,a,r,i,o,n,s,c,l,d,h=[],u=!1;for(l=0;l<e.length;++l)h[l]=e[l]%13;for(t=1;t<=12&&!u;++t)if(i=[t-1,t,(t+1)%13],this.isContainArray(h,i))for(n=this.getNotContainArray(h,i),a=2;a<=11&&!u;++a)if(o=[a-2,a-1,a,a+1,(a+2)%13],this.isContainArray(n,o))for(s=this.getNotContainArray(n,o),r=2;r<=11&&!u;++r)if(c=[r-2,r-1,r,r+1,(r+2)%13],this.isContainArray(s,c)){u=!0;break}for(l=0;l<e.length;++l)h[l]=e[l];var g=[];for(i=this.sortCardByCountThenColor(i),o=this.sortCardByCountThenColor(o),c=this.sortCardByCountThenColor(c),l=0;l<i.length;++l)for(d=0;d<h.length;++d)if(h[d]%13===i[l]){g.push(h[d]),h.splice(d,1);break}for(l=0;l<o.length;++l)for(d=0;d<h.length;++d)if(h[d]%13===o[l]){g.push(h[d]),h.splice(d,1);break}for(l=0;l<c.length;++l)for(d=0;d<h.length;++d)if(h[d]%13===c[l]){g.push(h[d]),h.splice(d,1);break}return g},r.isContainArray=function(e,t){var a;for(a=0;a<t.length&&!(e.indexOf(t[a])<0);++a);return a===t.length},r.getNotContainArray=function(e,t){var a,r=[];for(a=0;a<e.length;++a)r.push(e[a]);for(a=0;a<t.length;++a)r.splice(r.indexOf(t[a]),1);return r},cc._RF.pop()},{}],TWMainDialog:[function(e,t,a){"use strict";cc._RF.push(t,"e42c0C9RoRLVbT+IGzFKtfz","TWMainDialog");var r=e("./TWModel"),i=e("./TWLogic"),o=e("../../API/RoomAPI"),n=e("../../API/RoomProto"),s=e("./TWProto");cc.Class({extends:cc.Component,properties:{headItemArr:[e("TWHeadItem")],cardItemArr:[e("TWCardItem")],glassSprite:cc.Sprite,readyBtn:cc.Node,continueNode:cc.Node,sortCardWidgetPrefab:cc.Prefab,guaiPaiTipWidgetPrefab:cc.Prefab,waitNextTip:cc.Node},onLoad:function(){this.gameInited=!1,this.sortCardWidgetCtrl=null,this.readyScheduler=null,Global.MessageCallback.addListener("RoomMessagePush",this),Global.MessageCallback.addListener("GameMessagePush",this),Global.MessageCallback.addListener("ReConnectSuccess",this),Global.MessageCallback.addListener("SelfEntryRoomPush",this)},start:function(){o.roomMessageNotify(n.getRoomSceneInfoNotify())},onDestroy:function(){r.onDestroy(),Global.MessageCallback.removeListener("RoomMessagePush",this),Global.MessageCallback.removeListener("GameMessagePush",this),Global.MessageCallback.removeListener("ReConnectSuccess",this),Global.MessageCallback.removeListener("SelfEntryRoomPush",this)},onButtonClick:function(e,t){if("rule"===t)Global.DialogManager.createDialog("GameCommon/GameRule/GameRuleDialog",{kind:Global.Enum.gameType.SSS});else if("setting"===t)Global.DialogManager.createDialog("Setting/SettingDialog");else if("exit_room"===t){if(!this.gameInited)return;Global.DialogManager.addPopDialog("\u786e\u8ba4\u9000\u51fa\u6e38\u620f?",function(){Global.Player.getPy("roomID")?(o.roomMessageNotify(n.userLeaveRoomNotify()),Global.DialogManager.addLoadingCircle()):this.exitGame()}.bind(this),function(){})}else if("continue_game"===t){o.roomMessageNotify(n.userReadyNotify(!0)),this.readyBtn.active=!1,this.onUserReady(r.myChairId);for(var a=0;a<this.cardItemArr.length;++a)this.cardItemArr[a].node.active=!1;this.readyScheduler&&(this.unschedule(this.readyScheduler),this.readyScheduler=null)}else"continue"===t&&Global.DialogManager.createDialog("Match/MatchGameDialog",{gameTypeID:r.gameTypeInfo.gameTypeID})},messageCallbackHandler:function(e,t){if("RoomMessagePush"===e){if(t.type===n.USER_LEAVE_ROOM_RESPONSE)t.data.chairId===r.myChairId&&Global.DialogManager.removeLoadingCircle();else if(t.type===n.OTHER_USER_ENTRY_ROOM_PUSH){if(!this.gameInited)return;this.onUserEntry(t.data.roomUserInfo)}else if(t.type===n.USER_LEAVE_ROOM_PUSH){if(!this.gameInited)return;this.onUserLeave(t.data.roomUserInfo.chairId)}else if(t.type===n.USER_READY_PUSH){if(!this.gameInited)return;this.onUserReady(t.data.chairId)}else if(t.type===n.GET_ROOM_SCENE_INFO_PUSH)this.gameInit(t.data);else if(t.type===n.ROOM_USER_INFO_CHANGE_PUSH){if(!this.gameInited)return;r.updatePlayer(t.data.changeInfo)}}else if("GameMessagePush"===e){if(!this.gameInited)return;t.type===s.GAME_CARDS_PUSH?this.onSendCards(t.data):t.type===s.GAME_CARDS_SORT_PUSH?this.onCardSort(t.data):t.type===s.GAME_RESOUT_PUSH?this.onGameResult(t.data):t.type===s.GAME_CARDS_NOSORT_PUSH&&this.onCardNoSort(t.data)}else"ReConnectSuccess"===e&&(Global.Player.isInRoom()?Global.API.hall.joinRoomRequest(r.roomID,function(){this.onReconnection()},function(){this.exitGame()}.bind(this)):this.exitGame())},gameInit:function(e){this.gameInited=!0,r.init(e);for(var t=0;t<4;++t)this.cardItemArr[r.getIndexByChairId(t)].setChairId(t);for(var a=0;a<4;++a)this.headItemArr[r.getIndexByChairId(a)].setChairId(a);if(r.gameStatus===s.GAME_STATUS_NOTSTART&&Global.API.room.roomMessageNotify(n.userReadyNotify(!0)),r.gameStatus===s.GAME_STATUS_GAMEING){if(!r.hasSortCard(r.myChairId)){var o=r.playingChairArr.indexOf(r.myChairId);if(o<0)return void(this.waitNextTip.active=!0);var c=r.getCardsArr()[o],l=cc.instantiate(this.sortCardWidgetPrefab);if(l.parent=this.node,this.sortCardWidgetCtrl=l.getComponent("TWSortCardWidgetCtrl"),this.sortCardWidgetCtrl.setCardArr(c),i.hasGuaipai(c)){var d=cc.instantiate(this.guaiPaiTipWidgetPrefab);d.parent=this.node,d.getComponent("TWGuaipaiTipWidgetCtrl").setLabel(c)}}}else r.gameStatus===s.GAME_STATUS_SETTLE&&(this.scheduleOnce(this.onShowGameResultFinished.bind(this),e.gameData.leftGameEndTime/1e3+2),this.waitNextTip.active=!0)},onReconnection:function(){o.roomMessageNotify(n.getRoomSceneInfoNotify())},onUserEntry:function(e){r.addPlayer(e);var t=this.headItemArr[r.getIndexByChairId(e.chairId)];t.node.active=!0,t.setChairId(e.chairId)},onUserLeave:function(e){e!==r.myChairId?(r.delPlayer(e),this.headItemArr[r.getIndexByChairId(e)].node.active=!1):this.exitGame()},onUserReady:function(e){r.setPlayerReady(e);var t=this.headItemArr[r.getIndexByChairId(e)];t&&t.setReady(!0)},onSendCards:function(e){r.setCardsPushData(e.cardsArr,e.playingChairArr);var t=e.cardsArr[e.playingChairArr.indexOf(r.getMyChairId())];this.scheduleOnce(function(){var e=cc.instantiate(this.sortCardWidgetPrefab);if(e.parent=this.node,this.sortCardWidgetCtrl=e.getComponent("TWSortCardWidgetCtrl"),this.sortCardWidgetCtrl.setCardArr(t),i.hasGuaipai(t)){var a=cc.instantiate(this.guaiPaiTipWidgetPrefab);a.parent=this.node,a.getComponent("TWGuaipaiTipWidgetCtrl").setLabel(t)}}.bind(this),2.5);for(var a=0;a<this.cardItemArr.length;++a)this.cardItemArr[a].onSendCardPush();for(var o=0;o<this.headItemArr.length;++o)this.headItemArr[o].onGameStart()},onCardSort:function(e){r.insertSortChairArr(e.chairId),r.cardsArr[e.chairId]=e.cardArr,e.chairId===r.myChairId&&(e.isNosort||this.sortCardWidgetCtrl.setCardArr(e.cardArr)),e.chairId===r.myChairId&&this.sortCardWidgetCtrl.node.destroy();var t=this.cardItemArr[r.getIndexByChairId(e.chairId)];t&&t.onSortCardsPush()},onCardNoSort:function(e){r.setMianbai(e.chairId),this.cardItemArr[(e.chairId+4-r.myChairId)%4].getComponent("TWCardItem").onShowGuaiPai()},onGameResult:function(e){Global.AudioManager.playSound("ThirteenWater/TWSound/tw_kaiju"),r.setResoutData(e.resout);for(var t=0;t<r.playingChairArr.length;++t){this.cardItemArr[r.getIndexByChairId(r.playingChairArr[t])].showCard(e.resout,this.onShowGameResultFinished.bind(this))}},onShowGameResultFinished:function(){this.waitNextTip.active=!1,this.continueNode.active=!0;for(var e=0;e<this.headItemArr.length;++e)this.headItemArr[e].updateUserInfo()},answerRoomDismisssPush:function(e){Global.Player.setPy("roomID",0),e===n.roomDismissReason.NONE||(e===n.roomDismissReason.RDR_OWENER_ASK?0!==r.getMyChairId()?Global.DialogManager.addPopDialog("\u56e0\u623f\u4e3b\u9000\u51fa\u623f\u95f4,\u623f\u95f4\u89e3\u6563",function(){this.destroyMainDialog()}.bind(this)):this.destroyMainDialog():e===n.roomDismissReason.RDR_USER_ASK?this.node.getChildByName("ExitButton").active=!0:n.roomDismissReason.RDR_TIME_OUT)},answerExitRoomPush:function(e){var t=e.chairIdArr,a=r.getMyChairId(),i=0,o=void 0;for(o=0;o<t.length;++o)null!==t[o]&&++i;1===i&&null===t[a]&&Global.DialogManager.createDialog("ThirteenWater/TWDismissDialog")},answerNosortPush:function(e,t){t&&r.setMianbai(e)},answerGameResoutPush:function(e){},answerGameEndPush:function(e){this.cardItemArr[0].getComponent("TWCardItem").getIsOnAnimal()||Global.DialogManager.createDialog("ThirteenWater/TWSettleAllDialog",null,function(e,t){t.getComponent("TWSettleAllDialog").showResout(r.getGameEndData())})},answerGamePreparePush:function(e){},answerGameCardSortPush:function(e){e===r.getMyChairId()&&Global.DialogManager.destroyDialog("ThirteenWater/TWSortCardDialog",!0)},destroyMainDialog:function(){this.exitGame()},getHeadItemByChairId:function(e){var t=r.getMyChairId();return this.headItemArr[(e+4-t)%4].getChildByName("chatPos")},glassAnimal:function(e){Global.AudioManager.playSound("ThirteenWater/TWSound/tw_suiboli"),this.scheduleOnce(function(){Global.AudioManager.playSound("ThirteenWater/TWSound/tw_sanchuan")},.5),this.glassSprite.node.active=!0,this.scheduleOnce(function(){this.glassSprite.node.active=!1,e&&e()}.bind(this),1.5)},exitGame:function(){Global.DialogManager.createDialog("Hall/HallDialog",null,function(){Global.DialogManager.removeLoadingCircle(),Global.DialogManager.destroyDialog(this,!0),Global.CCHelper.releaseRes(["ThirteenWater"])}.bind(this))}}),cc._RF.pop()},{"../../API/RoomAPI":"RoomAPI","../../API/RoomProto":"RoomProto","./TWLogic":"TWLogic","./TWModel":"TWModel","./TWProto":"TWProto",TWCardItem:"TWCardItem",TWHeadItem:"TWHeadItem"}],TWModel:[function(e,t,a){"use strict";cc._RF.push(t,"cc4323PLVhJgK1jhgaXR5B7","TWModel");var r=t.exports,i=(e("./TWLogic"),e("./TWProto"),e("../../API/RoomProto"));r.init=function(e){this.userArr=e.roomUserInfoArr;var t=e.gameData;this.roomID=t.roomID,this.cardsArr=t.cardsArr,this.sortCardChairArr=t.sortCardChairArr,this.mianbaiArr=t.mianbaiArr,this.gameStatus=t.gameStatus,this.playingChairArr=t.playingChairArr,this.gameRule=t.gameRule,this.resout=t.resout,this.gameTypeInfo=t.gameTypeInfo,this.myUid=Global.Player.getPy("uid");for(var a=0;a<this.userArr.length;++a)if(this.userArr[a].userInfo.uid===this.myUid){this.myChairId=this.userArr[a].chairId;break}},r.onDestroy=function(){},r.getIndexByChairId=function(e){return(e+4-this.myChairId)%4},r.getMyChairId=function(){return this.myChairId},r.getMyUid=function(){return this.myUid},r.getGameRule=function(){return this.gameRule},r.getPlayerById=function(e){for(var t=0;t<this.userArr.length;++t)if(this.userArr[t].userInfo.uid===e)return this.userArr[t];return null},r.getPlayerByChairId=function(e){for(var t=0;t<this.userArr.length;++t)if(this.userArr[t].chairId===e)return this.userArr[t];return null},r.getPlayerCount=function(){return this.userArr.length},r.getPlayers=function(){return this.userArr},r.addPlayer=function(e){for(var t=0;t<this.userArr.length;++t)if(this.userArr[t].chairId===e.chairId){this.userArr.splice(t,1);break}this.userArr.push(e)},r.delPlayer=function(e){for(var t=0;t<this.userArr.length;++t)if(this.userArr[t].chairId===e){this.userArr.splice(t,1);break}},r.updatePlayer=function(e){for(var t=0;t<this.userArr.length;++t)if(this.userArr[t].userInfo.uid===e.uid){this.userArr[t].userInfo=e;break}},r.setResoutData=function(e){this.resout=e},r.getResout=function(){return this.resout},r.setCardsPushData=function(e,t){for(var a=0;a<this.mianbaiArr.length;++a)this.mianbaiArr[a]=!1;this.cardsArr=e,this.playingChairArr=t,this.sortCardChairArr=[]},r.getCardsArr=function(){return this.cardsArr},r.setPlayerReady=function(e){this.getPlayerByChairId(e).userStatus|=i.userStatusEnum.READY},r.getPlayerReady=function(e){return(this.getPlayerByChairId(e).userStatus&i.userStatusEnum.READY)>0},r.insertSortChairArr=function(e){this.sortCardChairArr.push(e)},r.hasSortCard=function(e){return-1!==this.sortCardChairArr.indexOf(e)},r.resetGameData=function(){var e;for(this.resout=null,this.sortCardChairArr=[],e=0;e<this.userArr.length;++e)(this.userArr[e].userStatus&i.userStatusEnum.READY)>0&&(this.userArr[e].userStatus-=i.userStatusEnum.READY)},r.setMianbai=function(e){this.mianbaiArr[e]=!0},r.getMianbai=function(e){return this.mianbaiArr[e]},r.isCurChairPlaying=function(e){return-1!==this.playingChairArr.indexOf(e)},cc._RF.pop()},{"../../API/RoomProto":"RoomProto","./TWLogic":"TWLogic","./TWProto":"TWProto"}],TWProto:[function(e,t,a){"use strict";cc._RF.push(t,"6775d6Tz3RFya526h+nC4y1","TWProto");var r=t.exports;r.enumRule={youSanChuan:1,heiTaoA:2,caoShi:4,roomOwnerPay:8,allPlayerPay:16,bureau6:32,bureau12:64,bureau18:128},r.gameStatus={NOT_START:0,PLAYING:1},r.code={1:"\u975e\u6cd5\u8bf7\u6c42\u6570\u636e"},r.GAME_PREPARE_PUSH=402,r.GAME_CARDS_PUSH=403,r.GAME_CARDS_SORT_REQUEST=304,r.GAME_CARDS_SORT_PUSH=404,r.GAME_RESOUT_PUSH=405,r.GAME_END_PUSH=406,r.GAME_CARDS_NOSORT_REQUEST=307,r.GAME_CARDS_NOSORT_PUSH=407,r.GAME_STATUS_NOTSTART=0,r.GAME_STATUS_GAMEING=1,r.GAME_STATUS_SETTLE=2,r.SORT_CARDS_TM=100,r.getGamePreparePushData=function(e,t){return{type:this.GAME_PREPARE_PUSH,data:{gameStatus:e,gamePrepareTm:t}}},r.getGameStatusPushData=function(e){return{type:r.GAME_STATUS_PUSH,data:{gameStatus:e,tm:Date.now()}}},r.getGameCardsPushData=function(e,t,a,r){return{type:this.GAME_CARDS_PUSH,data:{cardsArr:e,gameStatus:t,gameStartTm:a,curDureau:r}}},r.getGameCardsSortRequestData=function(e,t){return{type:this.GAME_CARDS_SORT_REQUEST,data:{cardArr:e,tm:t}}},r.getGameCardsSortPushData=function(e,t,a){return{type:this.GAME_CARDS_SORT_PUSH,code:e,data:{chairId:t,cardArr:a}}},r.getGameResoutPushData=function(e,t,a){return{type:this.GAME_RESOUT_PUSH,data:{resout:e,gameStatus:t,gameSettleTm:a}}},r.getGameEndPushData=function(e){return{type:this.GAME_END_PUSH,data:{resout:e}}},r.getGameNosortRequestData=function(e,t){return{type:this.GAME_CARDS_NOSORT_REQUEST,data:{isNosort:e,tm:t}}},r.getGameNosortPushData=function(e,t){return{type:this.GAME_CARDS_NOSORT_PUSH,data:{chairId:e,isNosort:t}}},cc._RF.pop()},{}],TWSortCardWidgetCtrl:[function(e,t,a){"use strict";cc._RF.push(t,"7b039sH0z1M+7DV2kLcEqbc","TWSortCardWidgetCtrl");var r=e("./TWLogic"),i=e("./TWProto"),o=e("../../API/RoomAPI");cc.Class({extends:cc.Component,properties:{touCancelButton:cc.Button,zhongCancelButton:cc.Button,weiCancelButton:cc.Button,touButton:cc.Button,zhongButton:cc.Button,weiButton:cc.Button,duiziButton:cc.Button,liangduiButton:cc.Button,santiaoButton:cc.Button,shunziButton:cc.Button,tonghuaButton:cc.Button,huluButton:cc.Button,sitiaoButton:cc.Button,tonghuashunButton:cc.Button,confirmButton:cc.Button,cardsNode:cc.Node,buttonsNode:cc.Node,touTypeSprite:cc.Sprite,zhongTypeSprite:cc.Sprite,weiTypeSprite:cc.Sprite,clockTimeLabel:cc.Label},onLoad:function(){},onDestroy:function(){},initWidget:function(){this.cardNodeArr=[],this.zhongCardArr=[],this.touCardArr=[],this.weiCardArr=[],this.resoutIndex=0,this.upY=20;var e,t=this.node.getChildByName("CardsNode");for(e=0;e<13;++e)this.cardNodeArr.push(t.getChildByName("Sprite"+e));this.confirmButton.interactable=!1,this.touCancelButton.node.active=!1,this.zhongCancelButton.node.active=!1,this.weiCancelButton.node.active=!1,this.touTypeSprite.node.active=!1,this.zhongTypeSprite.node.active=!1,this.weiTypeSprite.node.active=!1},setCardArr:function(e){var t;for(this.initWidget(),this.cardArr=r.sortCardByCountThenColor(e),this.cardUpArr=[],t=0;t<this.cardArr.length;++t)Global.CCHelper.updateSpriteFrame("ThirteenWater/TWCard/"+this.cardArr[t],this.cardNodeArr[t].getComponent(cc.Sprite)),this.cardUpArr[t]=!1,this.addMoveAndEndEvent(this.cardNodeArr[t],t);this.setTypeButton(),this.unscheduleAllCallbacks(),this.clockTime=20,this.clockTimeLabel.string=this.clockTime.toString(),this.schedule(this.clockScheduler.bind(this),1)},clockScheduler:function(){this.clockTime--,this.clockTime<0?(o.gameMessageNotify(i.getGameCardsSortRequestData(r.autoSortCards(this.cardArr),Date.now())),this.unscheduleAllCallbacks(),this.node.active=!1):this.clockTimeLabel.string=this.clockTime.toString()},addMoveAndEndEvent:function(e,t){e.on(cc.Node.EventType.TOUCH_END,function(e){this.onTouchCardEnd(e,t)}.bind(this)),e.on(cc.Node.EventType.TOUCH_START,function(e){this.onTouchCardStart(e,t)}.bind(this)),e.on(cc.Node.EventType.TOUCH_MOVE,function(e){this.onTouchMove(e,t)}.bind(this)),e.on(cc.Node.EventType.TOUCH_CANCEL,function(e){this.onTouchCardEnd(e,t)}.bind(this))},onTouchCard:function(e,t){var a=parseInt(t);t<0||t>=13||(this.cardUpArr[a]?this.cardNodeArr[a].y-=this.upY:this.cardNodeArr[a].y+=this.upY,this.cardUpArr[a]=!this.cardUpArr[a])},onTouchCardStart:function(e,t){this.startX=e.currentTouch._point.x,this.startY=e.currentTouch._point.y},onTouchMove:function(e,t){var a=e.currentTouch._point.x,r=e.currentTouch._point.y;a=this.node.getChildByName("CardsNode").convertToNodeSpace(cc.v2(a,r)).x;var i,o=this.getRestCardArr(),n=this.cardsNode.width,s=this.cardNodeArr[0].width,c=this.cardNodeArr[this.cardArr.indexOf(o[0])],l=this.cardNodeArr[this.cardArr.indexOf(o[1])].x-c.x,d=n/2+c.x-s/2,h=Math.floor((a-d)/l),u=o.indexOf(this.cardArr[t]);if(h>=u)for(;u<=h;)(i=this.cardArr.indexOf(o[u]))>=0&&i<13&&(this.cardNodeArr[i].color=new cc.Color(200,200,200)),++u;else for(;u>=h;)(i=this.cardArr.indexOf(o[u]))>=0&&i<13&&(this.cardNodeArr[i].color=new cc.Color(200,200,200)),--u},onTouchCardEnd:function(e,t){var a=e.currentTouch._point.x,r=e.currentTouch._point.y;a=this.node.getChildByName("CardsNode").convertToNodeSpace(cc.v2(a,r)).x;var i=this.getRestCardArr(),o=this.cardsNode.width,n=this.cardNodeArr[0].width,s=this.cardNodeArr[this.cardArr.indexOf(i[0])],c=this.cardNodeArr[this.cardArr.indexOf(i[1])].x-s.x,l=o/2+s.x-n/2,d=Math.floor((a-l)/c),h=i.indexOf(this.cardArr[t]);if(d>=h)for(;h<=d;)this.onTouchCard(null,this.cardArr.indexOf(i[h])),++h;else for(;h>=d;)this.onTouchCard(null,this.cardArr.indexOf(i[h])),--h;for(h=0;h<this.cardNodeArr.length;++h)this.cardNodeArr[h].color=new cc.Color(255,255,255)},sortRestCard:function(){var e,t=this.getRestCardArr(),a=this.cardsNode.width,r=this.cardNodeArr[0].width;for(a=r+47*(t.length-1),e=0;e<t.length;++e)this.cardNodeArr[this.cardArr.indexOf(t[e])].x=r/2+47*e-a/2;for(e=0;e<this.cardUpArr.length;++e)this.cardUpArr[e]&&(this.cardUpArr[e]=!1,this.cardNodeArr[e].y-=this.upY)},setTypeButton:function(){var e=this.getRestCardArr();this.duiziButton.interactable=r.hasDuizi(e),this.liangduiButton.interactable=r.hasLiangdui(e),this.santiaoButton.interactable=r.hasSantiao(e),this.shunziButton.interactable=r.hasShunzi(e),this.tonghuaButton.interactable=r.hasTonghua(e),this.huluButton.interactable=r.hasHulu(e),this.sitiaoButton.interactable=r.hasSitiao(e),this.tonghuashunButton.interactable=r.hasTonghuashun(e)},onButtonClick:function(e,t){Global.isStartBgMusic||(Global.isStartBgMusic=!0,Global.AudioManager.startPlayBgMusic()),"confirm"===t?this.sendSortCard():"toudao"===t?this.onClickToudao():"toudao_cancel"===t?this.onClickToudaoCancel():"zhongdao"===t?this.onClickZhongdao():"zhongdao_cancel"===t?this.onClickZhongdaoCancel():"weidao"===t?this.onClickWeidao():"weidao_cancel"===t?this.onClickWeidaoCancel():this.onTouchType(t)},onClickToudao:function(){var e,t=0;for(e=0;e<this.cardUpArr.length;++e)this.cardUpArr[e]&&-1===this.zhongCardArr.indexOf(e)&&-1===this.weiCardArr.indexOf(e)&&(++t,this.touCardArr.push(e));if(3!==t)Global.DialogManager.addTipDialog("\u5934\u9053\u5fc5\u987b\u662f3\u5f20\u724c"),this.touCardArr=[];else{if(!this.verifySortCard())return void(this.touCardArr=[]);this.touButton.interactable=!1;var a,r=this.touButton.node.width,i=this.touCardArr.length,o=(r-87)/(i-1);for(e=0;e<i;++e)this.cardNodeArr[this.touCardArr[e]].active=!1,(a=this.getCardNode(this.cardArr[this.touCardArr[e]])).parent=this.touButton.node,a.x=43.5+e*o-r/2;this.sortRestCard(),this.confirmButton.interactable=this.touCardArr.length+this.zhongCardArr.length+this.weiCardArr.length===13,this.touCancelButton.node.active=!0,this.setTypeButton(),this.restCardAutoFill(),this.setTypeNameByCards(this.touCardArr,this.touTypeSprite),this.resoutIndex=0}},onClickToudaoCancel:function(){var e;for(this.touButton.interactable=!0,this.touCancelButton.node.active=!1,this.touButton.node.removeAllChildren(),e=0;e<this.touCardArr.length;++e)this.cardNodeArr[this.touCardArr[e]].active=!0;this.touCardArr=[],this.sortRestCard(),this.setTypeButton(),this.confirmButton.interactable=!1,this.touTypeSprite.node.active=!1},onClickZhongdao:function(){var e,t=0;for(e=0;e<this.cardUpArr.length;++e)this.cardUpArr[e]&&-1===this.touCardArr.indexOf(e)&&-1===this.weiCardArr.indexOf(e)&&(++t,this.zhongCardArr.push(e));if(5!==t)Global.DialogManager.addTipDialog("\u4e2d\u9053\u5fc5\u987b\u662f5\u5f20\u724c"),this.zhongCardArr=[];else{if(!this.verifySortCard())return void(this.zhongCardArr=[]);this.zhongButton.interactable=!1;var a,r=this.zhongButton.node.width,i=this.zhongCardArr.length,o=(r-87)/(i-1);for(e=0;e<i;++e)this.cardNodeArr[this.zhongCardArr[e]].active=!1,(a=this.getCardNode(this.cardArr[this.zhongCardArr[e]])).parent=this.zhongButton.node,a.x=43.5+e*o-r/2;this.sortRestCard(),this.confirmButton.interactable=this.touCardArr.length+this.zhongCardArr.length+this.weiCardArr.length===13,this.zhongCancelButton.node.active=!0,this.setTypeButton(),this.restCardAutoFill(),this.setTypeNameByCards(this.zhongCardArr,this.zhongTypeSprite),this.resoutIndex=0}},onClickZhongdaoCancel:function(){var e;for(this.zhongButton.interactable=!0,this.zhongCancelButton.node.active=!1,this.zhongButton.node.removeAllChildren(),e=0;e<this.zhongCardArr.length;++e)this.cardNodeArr[this.zhongCardArr[e]].active=!0;this.zhongCardArr=[],this.sortRestCard(),this.setTypeButton(),this.confirmButton.interactable=!1,this.zhongTypeSprite.node.active=!1},onClickWeidao:function(){var e,t=0;for(e=0;e<this.cardUpArr.length;++e)this.cardUpArr[e]&&-1===this.touCardArr.indexOf(e)&&-1===this.zhongCardArr.indexOf(e)&&(++t,this.weiCardArr.push(e));if(5!==t)Global.DialogManager.addTipDialog("\u5c3e\u9053\u5fc5\u987b\u662f5\u5f20\u724c"),this.weiCardArr=[];else{if(!this.verifySortCard())return void(this.weiCardArr=[]);var a=this.weiButton.node.width;this.weiButton.interactable=!1;var r,i=this.weiCardArr.length,o=(a-87)/(i-1);for(e=0;e<i;++e)this.cardNodeArr[this.weiCardArr[e]].active=!1,(r=this.getCardNode(this.cardArr[this.weiCardArr[e]])).parent=this.weiButton.node,r.x=43.5+e*o-a/2;this.sortRestCard(),this.confirmButton.interactable=this.touCardArr.length+this.zhongCardArr.length+this.weiCardArr.length===13,this.weiCancelButton.node.active=!0,this.setTypeButton(),this.restCardAutoFill(),this.setTypeNameByCards(this.weiCardArr,this.weiTypeSprite),this.resoutIndex=0}},onClickWeidaoCancel:function(){var e;for(this.weiButton.interactable=!0,this.weiCancelButton.node.active=!1,this.weiCancelButton.node.active=!1,this.weiButton.node.removeAllChildren(),e=0;e<this.weiCardArr.length;++e)this.cardNodeArr[this.weiCardArr[e]].active=!0;this.weiCardArr=[],this.sortRestCard(),this.setTypeButton(),this.confirmButton.interactable=!1,this.weiTypeSprite.node.active=!1},verifySortCard:function(){var e,t=[],a=[],i=[];for(e=0;e<this.touCardArr.length;++e)t.push(this.cardArr[this.touCardArr[e]]);for(e=0;e<this.zhongCardArr.length;++e)a.push(this.cardArr[this.zhongCardArr[e]]);for(e=0;e<this.weiCardArr.length;++e)i.push(this.cardArr[this.weiCardArr[e]]);return 0!==t.length&&0!==a.length&&r.compareCards(t,a,r.getTouZhongWeiCardType(t),r.getTouZhongWeiCardType(a))?(Global.DialogManager.addTipDialog("\u4e2d\u9053\u5fc5\u987b\u5927\u4e8e\u5934\u9053"),!1):0!==i.length&&0!==a.length&&r.compareCards(a,i,r.getTouZhongWeiCardType(a),r.getTouZhongWeiCardType(i))?(Global.DialogManager.addTipDialog("\u5c3e\u9053\u5fc5\u987b\u5927\u4e8e\u4e2d\u9053"),!1):0===i.length||0===t.length||!r.compareCards(t,i,r.getTouZhongWeiCardType(t),r.getTouZhongWeiCardType(i))||(Global.DialogManager.addTipDialog("\u5c3e\u9053\u5fc5\u987b\u5927\u4e8e\u5934\u9053"),!1)},restCardAutoFill:function(){var e,t,a,r=!1;if(this.touCardArr.length>0&&this.zhongCardArr.length>0&&(r=!0,a=this.onClickWeidao.bind(this)),this.touCardArr.length>0&&this.weiCardArr.length>0&&(r=!0,a=this.onClickZhongdao.bind(this)),this.zhongCardArr.length>0&&this.weiCardArr.length>0&&(r=!0,a=this.onClickToudao.bind(this)),this.touCardArr.length+this.zhongCardArr.length+this.weiCardArr.length===13&&(r=!1),r){for(e=this.getRestCardArr(),t=0;t<this.cardArr.length;++t)-1!==e.indexOf(this.cardArr[t])&&(this.cardNodeArr[t].y+=this.upY,this.cardUpArr[t]=!0);a()}},onTouchType:function(e){var t,a,i,o,n=this.getRestCardArr();for("duizi"===e?t=r.getDuizi(n):"liangdui"===e?t=r.getLiangdui(n):"santiao"===e?t=r.getSantiao(n):"shunzi"===e?(t=r.getShunzi(n),t=r.sortResoutArr(t)):"tonghua"===e?(t=r.getTonghua(n),t=r.sortResoutArr(t)):"hulu"===e?t=r.getHulu(n):"sitiao"===e?t=r.getSitiao(n):"tonghuashun"===e&&(t=r.getTonghuashun(n),t=r.sortResoutArr(t)),this.preName&&e!==this.preName&&(this.resoutIndex=0),this.resoutIndex>=t.length&&(this.resoutIndex=this.resoutIndex%t.length),o=t[this.resoutIndex],++this.resoutIndex,a=0;a<this.cardUpArr.length;++a)this.cardUpArr[a]&&-1===o.indexOf(this.cardArr[a])&&(this.cardUpArr[a]=!1,this.cardNodeArr[a].y-=this.upY);for(a=0;a<o.length;++a)i=this.cardArr.indexOf(o[a]),this.cardUpArr[i]||(this.cardUpArr[i]=!0,this.cardNodeArr[i].y+=this.upY);this.preName=e},getRestCardArr:function(){var e,t,a=[];for(e=0;e<this.cardArr.length;++e)t=!0,this.touCardArr.length>0&&-1!==this.touCardArr.indexOf(e)&&(t=!1),this.zhongCardArr.length>0&&-1!==this.zhongCardArr.indexOf(e)&&(t=!1),this.weiCardArr.length>0&&-1!==this.weiCardArr.indexOf(e)&&(t=!1),t&&a.push(this.cardArr[e]);return a},getCardNode:function(e){var t=new cc.Node,a=t.addComponent(cc.Sprite);return cc.loader.loadRes("ThirteenWater/TWCard/"+e,cc.SpriteFrame,function(e,t){e||(a.spriteFrame=t)}),t.scaleX=.6,t.scaleY=.6,t},sendSortCard:function(){var e,t=[];for(e=0;e<this.touCardArr.length;++e)t.push(this.cardArr[this.touCardArr[e]]);for(e=0;e<this.zhongCardArr.length;++e)t.push(this.cardArr[this.zhongCardArr[e]]);for(e=0;e<this.weiCardArr.length;++e)t.push(this.cardArr[this.weiCardArr[e]]);Global.NetworkManager.notify("game.gameHandler.gameMessageNotify",i.getGameCardsSortRequestData(t,Date.now())),this.unscheduleAllCallbacks(),this.node.active=!1},setTypeNameByCards:function(e,t){for(var a=[],r=0;r<e.length;++r)a.push(this.cardArr[e[r]]);var i=this.getTypeUrlByCardArr(a);Global.CCHelper.updateSpriteFrame(i,t),t.node.active=!0},getTypeUrlByCardArr:function(e){var t="ThirteenWater/TWSort/danpai";return r.hasTonghuashun(e)?t="ThirteenWater/TWSort/tonghuashun":r.hasSitiao(e)?t="ThirteenWater/TWSort/sitiao":r.hasHulu(e)?t="ThirteenWater/TWSort/hulu":r.hasTonghua(e)?t="ThirteenWater/TWSort/tonghua":r.hasShunzi(e)?t="ThirteenWater/TWSort/shunzi":r.hasSantiao(e)?t="ThirteenWater/TWSort/santiao":r.hasLiangdui(e)?t="ThirteenWater/TWSort/liangdui":r.hasDuizi(e)&&(t="ThirteenWater/TWSort/duizi"),t}}),cc._RF.pop()},{"../../API/RoomAPI":"RoomAPI","./TWLogic":"TWLogic","./TWProto":"TWProto"}],TiXianDetailDialog:[function(e,t,a){"use strict";cc._RF.push(t,"a9be4yhgdtBQZYYjqqiMPL7","TiXianDetailDialog"),cc.Class({extends:cc.Component,properties:{recordItem:cc.Prefab,recordContent:cc.Node},onScrollEvent:function(e,t){switch(t){case cc.ScrollView.EventType.SCROLL_TO_BOTTOM:if(this.maxCount)return void cc.log("\u5df2\u52a0\u8f7d\u6240\u6709\u6570\u636e");cc.log("\u8bf7\u6c42\u65b0\u6570\u636e"),this.updateList()}},updateList:function(){Global.DialogManager.addLoadingCircle(),Global.API.hall.getRecordDataRequest(Global.Enum.recordType.EXTRACT_COMMISSION,this.startIndex,this.perCount,function(e){for(var t=e.msg.totalCount,a=e.msg.recordArr,r=0;r<a.length;r++){var i=cc.instantiate(this.recordItem);i.parent=this.recordContent,i.getComponent("TiXianRecordItem").updateUI(a[r])}this.startIndex+=this.perCount,this.startIndex>t&&(this.maxCount=!0),Global.DialogManager.removeLoadingCircle()}.bind(this))},start:function(){this.startIndex=0,this.perCount=10,this.maxCount=!1,this.updateList()},onBtnClk:function(e,t){switch(t){case"close":Global.DialogManager.destroyDialog(this)}}}),cc._RF.pop()},{}],TiXianDetailItem:[function(e,t,a){"use strict";cc._RF.push(t,"f4647q3XO5B96f90gKqbTxC","TiXianDetailItem"),cc.Class({extends:cc.Component,properties:{num:cc.Label,time:cc.Label,goldNum:cc.Label},start:function(){},updateUI:function(e){this.num.string=e.index,this.time.string=new Date(e.createTime).format("yyyy-MM-dd hh:mm:ss"),this.goldNum.string=e.count.toFixed(2)}}),cc._RF.pop()},{}],TiXianDialog:[function(e,t,a){"use strict";cc._RF.push(t,"6d3ebwQPShKPqnQdlKr2ILl","TiXianDialog"),cc.Class({extends:cc.Component,properties:{goldText:cc.Label,outTip:cc.Label,outNumEdit:cc.EditBox,outProgress:cc.ProgressBar,outSlider:cc.Slider,zbfGroup:cc.Node,zbfAccountText:cc.Label,wxGroup:cc.Node,wxAccountText:cc.Label,bankCardGroup:cc.Node,bankCardText:cc.Label},showBindGroup:function(e){this.zbfGroup.active="ali"===e,this.wxGroup.active="wx"===e,this.bankCardGroup.active="bankCard"===e},updatePlayerInfoUI:function(){this.goldText.string=Global.Player.getPy("gold");var e=JSON.parse(Global.Player.getPy("aliPayInfo")||"{}");e&&e.aliPayAccount&&""!==e.aliPayAccount&&(this.zbfAccountText.string=e.aliPayAccount);var t=JSON.parse(Global.Player.getPy("bankCardInfo")||"{}");t&&t.cardNumber&&""!==t.cardNumber&&(this.bankCardText.string=t.cardNumber)},updateEditText:function(){var e=this.outSlider.progress;this.outNumEdit.string=Math.floor(e*Global.Player.getPy("gold"))},updateProgress:function(){var e=this.outNumEdit.string;if(""===e)return this.outSlider.progress=0,void(this.outProgress.progress=0);e=parseInt(e),this.outSlider.progress=e/parseInt(Global.Player.getPy("gold")),this.outProgress.progress=e/parseInt(Global.Player.getPy("gold"))},start:function(){this.outProgress.progress=0,this.outTip.string="\u63d0\u73b03-5\u5206\u949f\u5230\u8d26\uff0c\u63d0\u73b0\u524d\u786e\u8ba4\u7ed1\u5b9a\u7684\u652f\u4ed8\u5b9d\u8d26\u53f7\u51c6\u786e\u65e0\u8bef\uff0c\u63d0\u73b0\u6536\u53d6\u63d0\u73b0\u91d1\u989d{0}%\u7684\u624b\u7eed\u8d39".format(Global.Data.getData("withdrawCashBillPercentage")),this.updatePlayerInfoUI(),this.showBindGroup("ali"),Global.MessageCallback.addListener("UpdateUserInfoUI",this)},onDestroy:function(){Global.MessageCallback.removeListener("UpdateUserInfoUI",this)},messageCallbackHandler:function(e,t){switch(e){case"UpdateUserInfoUI":this.updatePlayerInfoUI()}},editEnd:function(e){var t=this.outNumEdit.string;""===t||(t=parseInt(t))>Global.Player.getPy("gold")&&(this.outNumEdit.string=Global.Player.getPy("gold")),this.updateProgress()},onBtnClk:function(e,t){switch(t){case"close":Global.DialogManager.destroyDialog(this);break;case"bindZFB":Global.DialogManager.createDialog("Bank/BindDialog",{showType:"zfb"});break;case"bindWX":Global.DialogManager.createDialog("Bank/BindDialog",{showType:"wx"});break;case"bindBankCard":Global.DialogManager.createDialog("Bank/BindDialog",{showType:"bankCard"});break;case"clear":this.outNumEdit.string="",this.outSlider.progress=0,this.outProgress.progress=0;break;case"max":this.outSlider.progress=1,this.outProgress.progress=1,this.updateEditText();break;case"slider":this.outProgress.progress=e.progress,this.updateEditText();break;case"record":Global.DialogManager.createDialog("Bank/TiXianRecordDialog");break;case"ali":case"wx":case"bankCard":this.showBindGroup(t);break;case"exchange":var a=this.outNumEdit.string;if(""===a)return void Global.DialogManager.addTipDialog("\u8bf7\u8f93\u5165\uff01");if((a=parseInt(a))<=0)return void Global.DialogManager.addTipDialog("\u8bf7\u8f93\u51650\u4ee5\u4e0a\u7684\u6570\u5b57\uff01");if(a>Global.Player.getPy("gold"))return void Global.DialogManager.addTipDialog("\u91d1\u989d\u4e0d\u8db3\uff01");var r=Global.Enum.withdrawCashType.ALI_PAY;if(this.bankCardGroup.active&&(r=Global.Enum.withdrawCashType.BANK_CARD),r===Global.Enum.withdrawCashType.ALI_PAY){var i=JSON.parse(Global.Player.getPy("aliPayInfo")||"{}");if(!i||!i.aliPayAccount||""===i.aliPayAccount)return void Global.DialogManager.addTipDialog("\u672a\u7ed1\u5b9a\u652f\u4ed8\u5b9d\u8d26\u53f7\uff0c\u8bf7\u5148\u7ed1\u5b9a\uff01")}else if(r===Global.Enum.withdrawCashType.BANK_CARD){var o=JSON.parse(Global.Player.getPy("bankCardInfo")||"{}");if(!o||!o.cardNumber||""===o.cardNumber)return void Global.DialogManager.addTipDialog("\u672a\u7ed1\u5b9a\u94f6\u884c\u5361\uff0c\u8bf7\u5148\u7ed1\u5b9a\uff01")}Global.DialogManager.addLoadingCircle(),Global.API.hall.withdrawCashRequest(a,r,function(e){Global.DialogManager.removeLoadingCircle(),Global.DialogManager.addPopDialog("\u63d0\u6b3e\u7533\u8bf7\u6210\u529f\uff01\u8bf7\u8010\u5fc3\u7b49\u5f85\uff01")})}}}),cc._RF.pop()},{}],TiXianRecordDialog:[function(e,t,a){"use strict";cc._RF.push(t,"6cfb9SXPr1Lard331vrytSo","TiXianRecordDialog"),cc.Class({extends:cc.Component,properties:{recordContent:cc.Node,recordItem:cc.Prefab},onScrollEvent:function(e,t){switch(t){case cc.ScrollView.EventType.SCROLL_TO_BOTTOM:if(this.maxCount)return void cc.log("\u5df2\u52a0\u8f7d\u6240\u6709\u6570\u636e");cc.log("\u8bf7\u6c42\u65b0\u6570\u636e"),this.updateList()}},updateList:function(){Global.DialogManager.addLoadingCircle(),Global.API.hall.getRecordDataRequest(Global.Enum.recordType.WITHDRAWALS,this.startIndex,this.perCount,function(e){for(var t=e.msg.totalCount,a=e.msg.recordArr,r=0;r<a.length;r++){var i=cc.instantiate(this.recordItem);i.parent=this.recordContent,i.getComponent("TiXianRecordItem").updateUI(a[r])}this.startIndex+=this.perCount,this.startIndex>t&&(this.maxCount=!0),Global.DialogManager.removeLoadingCircle()}.bind(this))},start:function(){this.startIndex=0,this.perCount=10,this.maxCount=!1,this.updateList()},onBtnClk:function(e,t){switch(t){case"close":Global.DialogManager.destroyDialog(this)}}}),cc._RF.pop()},{}],TiXianRecordItem:[function(e,t,a){"use strict";cc._RF.push(t,"c94dbew769DXpj7+PaRvbsg","TiXianRecordItem"),cc.Class({extends:cc.Component,properties:{num:cc.Label,goldNum:cc.Label,time:cc.Label,statusDoing:cc.Node,statusDone:cc.Node},start:function(){},updateUI:function(e){this.num.string=e.index,this.goldNum.string=e.count.toFixed(2),this.time.string=new Date(e.createTime).format("yyyy-MM-dd hh:mm:ss"),this.statusDoing.active=e.status===Global.Enum.orderStatus.WAIT_HANDLE,this.statusDone.active=e.status===Global.Enum.orderStatus.ALREADY_HANDLE}}),cc._RF.pop()},{}],TipDialog:[function(e,t,a){"use strict";cc._RF.push(t,"585a173xR5Dtrm02qR+R1wc","TipDialog"),cc.Class({extends:cc.Component,properties:{rootNode:cc.Node,tipWidget:cc.Node},onLoad:function(){},addTip:function(e){for(var t=0;t<this.rootNode.childrenCount;++t){this.rootNode.children[t].runAction(cc.moveBy(.1,cc.v2(0,55)))}var a=cc.instantiate(this.tipWidget);a.getChildByName("content").getComponent(cc.Label).string=e,a.active=!0,a.scale=1.05,a.parent=this.rootNode;var r=cc.scaleTo(.2,1);r.easing(cc.easeBackIn()),a.runAction(cc.sequence([r,cc.delayTime(1.5),cc.fadeOut(.3),cc.removeSelf()]))}}),cc._RF.pop()},{}],TrendHelper:[function(e,t,a){"use strict";cc._RF.push(t,"ee059TzNZJNCrsCy9YW1tfz","TrendHelper");var r=t.exports;r.TYPE_DUI=1,r.TYPE_XIAN=2,r.TYPE_ZHUANG=4,r.TYPE_HU=8,r.HONG=1,r.LAN=2,r.getZhupanArr=function(){return[[2,4,3,4,4,4],[9,3,4,2,4,2],[5,2,4,2,4,8],[2,2,4,8,2,2],[2,2,2,2,5,2],[3,2,2,4,2]]},r.getDaluArr=function(e){var t,a,r=[],i=0,o=0;for(t=0;t<e.length;++t)for(a=0;a<e[t].length;++a)(e[t][a]&this.TYPE_HU)>0?r[i]&&r[i][o]&&(r[i][o]+=this.TYPE_HU):r[i]&&r[i][o]?((e[t][a]&this.TYPE_ZHUANG)>0&&(r[i][o]&this.TYPE_ZHUANG)>0?++o:(e[t][a]&this.TYPE_XIAN)>0&&(r[i][o]&this.TYPE_XIAN)>0?++o:(r[++i]=[],o=0),r[i][o]=e[t][a]):(r[i]=[],r[i][o]=e[t][a]);return r},r.getDayanArr=function(e){var t,a,r=[];for(t=1;t<e.length;++t)for(a=1===t?1:0;a<e[t].length;){var i;if(i=0===a?e[t-1].length===e[t-2].length?this.HONG:this.LAN:e[t-1][a]?this.HONG:e[t-1][a-1]?this.LAN:this.HONG,0===r.length)r.push([i]);else{var o=r[r.length-1];0===o.length?o.push(i):o[o.length-1]!==i?r.push([i]):o.push(i)}++a}return r},r.getXiaoluArr=function(e){var t,a,r=[];for(t=2;t<e.length;++t)for(a=2===t?1:0;a<e[t].length;){var i;if(i=0===a?e[t-1].length===e[t-3].length?this.HONG:this.LAN:e[t-2][a]?this.HONG:e[t-2][a-1]?this.LAN:this.HONG,0===r.length)r.push([i]);else{var o=r[r.length-1];0===o.length?o.push(i):o[o.length-1]!==i?r.push([i]):o.push(i)}++a}return r},r.getTanglangArr=function(e){var t,a,r=[];for(t=3;t<e.length;++t)for(a=3===t?1:0;a<e[t].length;){var i;if(i=0===a?e[t-1].length===e[t-4].length?this.HONG:this.LAN:e[t-3][a]?this.HONG:e[t-3][a-1]?this.LAN:this.HONG,0===r.length)r.push([i]);else{var o=r[r.length-1];0===o.length?o.push(i):o[o.length-1]!==i?r.push([i]):o.push(i)}++a}return r},r.getFormatArr=function(e){var t,a,r=0,i=0,o=[];for(t=0;t<e.length;++t)for(o[r=t]||(o[r]=[null,null,null,null,null,null]),a=0;a<e[t].length;++a)0===a?(i=0,o[r][i]=e[t][a]):null!==o[r][i+1]||5===i||null===o[r][i-1]?(o[++r]||(o[r]=[null,null,null,null,null,null]),o[r][i]=e[t][a]):(++i,o[r][i]=e[t][a]);return o},cc._RF.pop()},{}],UpdateDialog:[function(e,t,a){"use strict";cc._RF.push(t,"6ef4dAB18NFM4G3B14kGRta","UpdateDialog"),cc.Class({extends:cc.Component,properties:{updateInfo:cc.Label,updateUI:cc.Node,manifestUrl:{type:cc.Asset,default:null},progress:cc.ProgressBar,progressText:cc.Label},checkCb:function(e){switch(cc.log("checkCb",e.getEventCode()),this._updating=!1,e.getEventCode()){case jsb.EventAssetsManager.ERROR_NO_LOCAL_MANIFEST:this.updateInfo.string="No local manifest file found, hot update skipped.";break;case jsb.EventAssetsManager.ERROR_DOWNLOAD_MANIFEST:case jsb.EventAssetsManager.ERROR_PARSE_MANIFEST:this.updateInfo.string="Fail to download manifest file, hot update skipped.";break;case jsb.EventAssetsManager.ALREADY_UP_TO_DATE:this.updateInfo.string="\u5df2\u662f\u6700\u65b0\u7248\u672c\uff0c\u6b63\u5728\u8fdb\u5165\u6e38\u620f...",this.enterGame();break;case jsb.EventAssetsManager.NEW_VERSION_FOUND:this.updateInfo.string="\u53d1\u73b0\u66f4\u65b0\uff0c\u5f00\u59cb\u4e0b\u8f7d\u66f4\u65b0",this.needBigUpdate?(cc.log("this is a big version, please update!"),this.updateControl.bigUpdate&&this.updateControl.forceBigUpdate?Global.DialogManager.addPopDialog("\u9700\u8981\u4e0b\u8f7d\u6700\u65b0\u7248\u672c\u624d\u80fd\u8fdb\u884c\u6e38\u620f\uff01\u70b9\u51fb\u786e\u5b9a\u5373\u53ef\u4e0b\u8f7d\uff01",function(){this.downloadGame()}.bind(this)):this.hotUpdate()):this.hotUpdate();break;default:return}this._am.setEventCallback(null),this._checkListener=null,this._updating=!1},updateCb:function(e){cc.log("updateCb",e.getEventCode());var t=!1,a=!1;switch(e.getEventCode()){case jsb.EventAssetsManager.ERROR_NO_LOCAL_MANIFEST:this.updateInfo.string="No local manifest file found, hot update skipped.",a=!0;break;case jsb.EventAssetsManager.UPDATE_PROGRESSION:cc.log("\u4e0b\u8f7d\u66f4\u65b0\u4e2d\u2026\u2026",e.getPercent(),e.getDownloadedBytes(),e.getTotalBytes(),parseFloat(e.getDownloadedBytes())/parseFloat(e.getTotalBytes()));var r=parseFloat(e.getDownloadedBytes())/parseFloat(e.getTotalBytes());this.updateInfo.string="\u4e0b\u8f7d\u66f4\u65b0\u4e2d\uff0c\u8bf7\u7a0d\u540e...",this.progress.progress=r,this.progressText.string=parseInt(100*r)+"%";break;case jsb.EventAssetsManager.ERROR_DOWNLOAD_MANIFEST:case jsb.EventAssetsManager.ERROR_PARSE_MANIFEST:this.updateInfo.string="Fail to download manifest file, hot update skipped.",a=!0;break;case jsb.EventAssetsManager.ALREADY_UP_TO_DATE:this.updateInfo.string="Already up to date with the latest remote version.",a=!0;break;case jsb.EventAssetsManager.UPDATE_FINISHED:this.updateInfo.string="Update finished. "+e.getMessage(),t=!0;break;case jsb.EventAssetsManager.UPDATE_FAILED:this.updateInfo.string="Update failed. "+e.getMessage(),this._updating=!1,this._canRetry=!0,this._am.downloadFailedAssets();break;case jsb.EventAssetsManager.ERROR_UPDATING:this.updateInfo.string="Asset update error: "+e.getAssetId()+", "+e.getMessage();break;case jsb.EventAssetsManager.ERROR_DECOMPRESS:this.updateInfo.string=e.getMessage()}if(a&&(this._am.setEventCallback(null),this._updateListener=null,this._updating=!1),t){this._am.setEventCallback(null),this._updateListener=null;var i=jsb.fileUtils.getSearchPaths(),o=this._am.getLocalManifest().getSearchPaths();console.log(JSON.stringify(o)),Array.prototype.unshift(i,o),cc.sys.localStorage.setItem("HotUpdateSearchPaths",JSON.stringify(i)),jsb.fileUtils.setSearchPaths(i),cc.audioEngine.stopAll(),cc.game.restart()}},retry:function(){!this._updating&&this._canRetry&&(this._canRetry=!1,this.updateInfo.string="Retry failed Assets...",this._am.downloadFailedAssets())},hotUpdate:function(){this._am&&!this._updating&&(this._am.setEventCallback(this.updateCb.bind(this)),this._am.getState()===jsb.AssetsManager.State.UNINITED&&this._am.loadLocalManifest(this.manifestUrl.nativeUrl),this.updateUI.active=!0,this._am.update(),this._updating=!0)},checkUpdate:function(){this._updating?this.updateInfo.string="Checking or updating ...":(this._am.getState()===jsb.AssetsManager.State.UNINITED&&this._am.loadLocalManifest(this.manifestUrl.nativeUrl),this._am.getLocalManifest()&&this._am.getLocalManifest().isLoaded()?(this._am.setEventCallback(this.checkCb.bind(this)),this._am.checkUpdate(),this._updating=!0):this.updateInfo.string="Failed to load local manifest ...")},goCheck:function(){console.log("goCheck()"),this.updateInfo.string="\u68c0\u67e5\u66f4\u65b0\u4e2d\uff0c\u8bf7\u7a0d\u540e...";var e=(jsb.fileUtils?jsb.fileUtils.getWritablePath():"/")+"test-remote-asset";cc.log("Storage path for remote asset : "+e),this.versionCompareHandle=function(e,t){cc.log("JS Custom Version Compare: version A is "+e+", version B is "+t);var a=e.split("."),r=t.split(".");a[0]<r[0]&&(this.needBigUpdate=!0);for(var i=0;i<a.length;++i){var o=parseInt(a[i]),n=parseInt(r[i]||0);if(o!==n)return o-n}return r.length>a.length?-1:0}.bind(this),this._am=new jsb.AssetsManager(this.manifestUrl.nativeUrl,e,this.versionCompareHandle),this._am.setVerifyCallback(function(e,t){t.compressed,t.md5,t.path,t.size;return!0}),cc.sys.os===cc.sys.OS_ANDROID&&this._am.setMaxConcurrentTask(2),this.checkUpdate()},closeGame:function(){cc.game.end()},enterGame:function(){this.dialogParameters&&this.dialogParameters.cb&&this.dialogParameters.cb(),Global.DialogManager.destroyDialog(this)},downloadGame:function(){cc.sys.openURL(this.updateControl.bigUpdateDownloadUrl)},onLoad:function(){this.updateInfo.string="\u6e38\u620f\u521d\u59cb\u5316\u4e2d...",this._updating=!1,this._canRetry=!1,this.needBigUpdate=!1,this.updateControl={},this.updateUI.active=!1;var e=new XMLHttpRequest;e.onreadystatechange=function(){if(4===e.readyState&&e.status>=200&&e.status<400){var t=e.responseText;this.updateControl=JSON.parse(t),cc.log(t),this.updateControl.hotUpdate?this.goCheck():this.enterGame()}}.bind(this),e.open("GET",Global.Constant.webServerAddress+"/hot-update/updateControl.json",!0),e.send(),cc.log(Global.Constant.webServerAddress+"/hot-update/updateControl.json")},onDestroy:function(){this._updateListener&&(this._am.setEventCallback(null),this._updateListener=null)}}),cc._RF.pop()},{}],UserInfoDialog:[function(e,t,a){"use strict";cc._RF.push(t,"4d512ONhOFIJ5DROe+snMgN","UserInfoDialog"),cc.Class({extends:cc.Component,properties:{avatar:cc.Sprite,nicknameText:cc.Label,idText:cc.Label,goldNumText:cc.Label},updatePlayerInfo:function(){this.avatar.node.active=!1,Global.CCHelper.updateSpriteFrame(Global.Player.getPy("avatar"),this.avatar,function(){this.avatar.node.active=!0}.bind(this)),this.nicknameText.string=Global.Player.convertNickname(Global.Player.getPy("nickname")),this.idText.string="\u8d26\u53f7ID\uff1a"+Global.Player.getPy("uid"),this.goldNumText.string=Global.Player.getPy("gold")},start:function(){this.updatePlayerInfo(),Global.MessageCallback.addListener("UpdateUserInfoUI",this)},onDestroy:function(){Global.MessageCallback.removeListener("UpdateUserInfoUI",this)},messageCallbackHandler:function(e,t){switch(e){case"UpdateUserInfoUI":this.updatePlayerInfo()}},onBtnClk:function(e,t){switch(t){case"close":Global.DialogManager.destroyDialog(this);break;case"changeAvatar":Global.DialogManager.createDialog("UserInfo/ChangeAvatarDialog");break;case"setting":Global.DialogManager.createDialog("Setting/SettingDialog");break;case"register":Global.DialogManager.createDialog("Login/RegisterDialog");break;case"logout":Global.NetworkLogic.disconnect(!1),Global.DialogManager.destroyAllDialog(),Global.DialogManager.createDialog("Login/LoginDialog",{logoutEvent:!0})}}}),cc._RF.pop()},{}],WeChatHelper:[function(e,t,a){"use strict";cc._RF.push(t,"3e87cR2dtNFYIPPf/HEr5wt","WeChatHelper");var r=e("./utils"),i=t.exports={};i.setShareTimeline=function(e){if(Global.wx){var t=e||{},a=t.imgUrl||Global.Data.getData("share_game_timeline_img_url");Global.wx.onMenuShareTimeline({title:t.title||Global.Data.getData("share_game_timeline_title"),link:t.link||Global.Data.getData("share_game_link")+"?state="+t.roomID,imgUrl:Global.Constant.storeImgIP+a+"?ver="+(new Date).valueOf(),success:function(){alert("\u5206\u4eab\u6210\u529f"),t.cb&&t.cb("success")},cancel:function(){alert("\u53d6\u6d88\u5206\u4eab"),t.cb&&t.cb("cancel")},fail:function(){alert("\u5206\u4eab\u5931\u8d25"),t.cb&&t.cb("fail")}})}},i.setShareFriend=function(e){if(Global.wx){var t=e||{},a=t.imgUrl||Global.Data.getData("share_game_friend_img_url");Global.wx.onMenuShareAppMessage({title:t.title||Global.Data.getData("share_game_friend_title"),desc:t.desc||Global.Data.getData("share_game_friend_desc").format(t.roomID),link:t.link||Global.Data.getData("share_game_link")+"?state="+t.roomID,imgUrl:Global.Constant.storeImgIP+a+"?ver="+(new Date).valueOf(),type:t.type||"",dataUrl:t.dataUrl||"",success:function(){alert("\u5206\u4eab\u6210\u529f"),t.cb&&t.cb("success")},cancel:function(){alert("\u53d6\u6d88\u5206\u4eab"),t.cb&&t.cb("cancel")},fail:function(){alert("\u5206\u4eab\u5931\u8d25"),t.cb&&t.cb("fail")}})}},i.initJSSDK=function(e,t){var a=document.createElement("script");a.async=!0,a.src="http://res.wx.qq.com/open/js/jweixin-1.2.0.js",document.body.appendChild(a),a.addEventListener("load",function(){Global.wx=wx,wx.config(e),wx.ready(function(){wx.hideAllNonBaseMenuItem(),wx.showMenuItems({menuList:["menuItem:share:appMessage"]}),r.invokeCallback(t)}.bind(this)),wx.error(function(){r.invokeCallback(t,"ssdk\u6743\u9650\u9a8c\u8bc1\u4e0d\u901a\u8fc7\uff0c\u8bf7\u91cd\u8bd5\uff01")})}.bind(this))},cc._RF.pop()},{"./utils":"utils"}],ZJHAddStake:[function(e,t,a){"use strict";cc._RF.push(t,"de177oFcBNIm4wCtyQuPD11","ZJHAddStake");var r=e("./GameProtoZJH"),i=e("./ZJHAudio");cc.Class({extends:cc.Component,properties:{stakeLevelLabel:{type:[cc.Label],default:[]},addStakeBtn:{type:[cc.Button],default:[]}},onBtnClk:function(e,t){switch(this.currentStakeLevel<parseInt(t[t.length-1])?4===parseInt(t[t.length-1])?i.jiaZhuMax():i.jiaZhu():i.genZhu(),t){case"stakeLevel1":Global.Utils.invokeCallback(this.stakeCallback,1);break;case"stakeLevel2":Global.Utils.invokeCallback(this.stakeCallback,2);break;case"stakeLevel3":Global.Utils.invokeCallback(this.stakeCallback,3);break;case"stakeLevel4":Global.Utils.invokeCallback(this.stakeCallback,4)}},startSelectStake:function(e,t,a){this.currentStakeLevel=e;for(var i=0;i<this.stakeLevelLabel.length;i++)this.stakeLevelLabel[i].string=r.STAKE_LEVEL[i+1]*t,i<e-1&&(this.addStakeBtn[i].interactable=!1),r.STAKE_LEVEL[i+1]*t>=Global.Player.gold&&(this.addStakeBtn[i].interactable=!1);this.stakeCallback=a},onLoad:function(){}}),cc._RF.pop()},{"./GameProtoZJH":"GameProtoZJH","./ZJHAudio":"ZJHAudio"}],ZJHAudio:[function(e,t,a){"use strict";cc._RF.push(t,"5e2098AvtNPOqMcWzRfoeGi","ZJHAudio");var r=e("../../Shared/AudioManager"),i=t.exports={};i.DIR_URL="Game/ZhaJinHua/audio/",i.SEX="f_",i.randomNum=function(e){return Math.floor(100*Math.random())%e},i.play=function(e,t,a){var o=i.DIR_URL+e,n=t;return r.playSound(o,!!n)},i.chip=function(){this.play("chip")},i.compareDian=function(){this.play("compare_dian")},i.compareFailure=function(){this.play("compare_failure")},i.compareVictory=function(){this.play("compare_victory")},i.faPai=function(){this.play("fapai")},i.foldPai=function(){this.play("foldpai")},i.shouJi=function(){this.play("shouji")},i.compare=function(){var e="compare"+this.randomNum(2);this.play(i.SEX+e)},i.genZhu=function(){var e="genzhu"+this.randomNum(2);this.play(i.SEX+e)},i.giveUp=function(){this.play(i.SEX+"giveup")},i.jiaZhu=function(){var e="jiazhu"+this.randomNum(2);this.play(i.SEX+e)},i.jiaZhuMax=function(){this.play(i.SEX+"jiazhumax")},i.kanPai=function(){var e="kanpai"+this.randomNum(2);this.play(i.SEX+e)},i.xiaZhu=function(){var e="xiazhu"+this.randomNum(2);this.play(i.SEX+e)},i.xuePin=function(){this.play(i.SEX+"xuepin")},i.gameBg=function(){return r.startPlayBgMusic(i.DIR_URL+"gamebg")},cc._RF.pop()},{"../../Shared/AudioManager":"AudioManager"}],ZJHCards:[function(e,t,a){"use strict";cc._RF.push(t,"9e1114cpB5BFaELFa++/SIQ","ZJHCards");var r=e("./ZJHAudio"),i=e("./GameProtoZJH");cc.Class({extends:cc.Component,properties:{card:cc.Prefab,lookCardBtn:cc.Button,showCardBtn:cc.Button,cardTypeSprite:cc.Sprite},hideAllBtns:function(){this.lookCardBtn.node.active=!1,this.showCardBtn.node.active=!1},showLookBtn:function(){},showShowBtn:function(){},showCards:function(e,t,a){if("showdown"===e){this.node.opacity=255,this.node.x=0,this.node.y=20,this.setCardsPos(25);for(var o=0;o<this.cards.length;o++)this.cards[o].scale=.95;Global.CCHelper.updateSpriteFrame("GameCommon/ZJHCardType/labelImg_cardType_"+t,this.cardTypeSprite,function(){this.cardTypeSprite.node.active=!0}.bind(this))}else if(this.alreadyShowCardsStatus)return;if(a)for(var n=0;n<a.length;n++)this.cards[n].getComponent("ZJHCard").showKaBei(),this.cardAnimation(this.cards[n],a[n]),this.alreadyShowCardsStatus=!0;this.scheduleOnce(function(){0===this.posIndex&&t&&(r.foldPai(),this.cardTypeSprite.node.active=!0,t===i.CARD_TYPE_ZASE_235?Global.CCHelper.updateSpriteFrame("GameCommon/ZJHCardType/labelImg_cardType_"+i.CARD_TYPE_DAN_ZHANG,this.cardTypeSprite):Global.CCHelper.updateSpriteFrame("GameCommon/ZJHCardType/labelImg_cardType_"+t,this.cardTypeSprite))}.bind(this),.5)},cardAnimation:function(e,t){var a={x:e.x,y:e.y},r={x:e.scaleX,y:e.scaleY},i=[];i[i.length]=cc.moveTo(.2,-this.cardOffsetX,a.y),i[i.length]=cc.spawn([cc.scaleTo(.1,.1,r.y),cc.moveTo(.1,-this.cardOffsetX,a.y+10)]),i[i.length]=cc.callFunc(function(){e.getComponent("ZJHCard").setData(t)}.bind(this)),i[i.length]=cc.spawn([cc.scaleTo(.1,r.x,r.y),cc.moveTo(.1,-this.cardOffsetX,a.y)]),i[i.length]=cc.moveTo(.3,a.x,a.y).easing(cc.easeBackOut()),e.runAction(cc.sequence(i))},setPos:function(e,t,a,i){this.posIndex=e,this.chairPos=a,this.cardDataArr=t;var o=.7;0===e?(this.setCardsPos(42),o=1):this.hideAllBtns();switch(e){case 0:this.node.x=180,this.node.y=-10;break;case 1:case 2:this.node.x=-135,this.node.y=-50;break;case 5:case 3:case 4:this.node.x=135,this.node.y=-50}if(i)for(var n=0;n<this.cards.length;n++){var s=this.cards[n].x,c=this.cards[n].y;this.cards[n].x=-a.x-this.node.x,this.cards[n].y=-a.y-this.node.y;var l=[];l[l.length]=cc.delayTime(.3*n),l[l.length]=cc.callFunc(function(){0===this.posIndex&&r.faPai()}.bind(this)),l[l.length]=cc.spawn([cc.delayTime(.1*e),cc.moveTo(.3,s,c),cc.scaleTo(.3,o,o),cc.rotateBy(.3,360,360)]),this.cards[n].runAction(cc.sequence(l))}else{for(var d=0;d<this.cards.length;d++)this.cards[d].scale=o;t&&this.showCards(null,null,t)}this.node.active=!0},giveUpCardAnimation:function(e,t,a){var r={x:e.scaleX,y:e.scaleY},i={x:e.x,y:e.y},o=[];o[o.length]=cc.delayTime(.1*t),o[o.length]=cc.spawn([cc.rotateBy(.5,360,360),cc.moveTo(.5,0,-2*a.y).easing(cc.easeSineOut()),cc.scaleTo(.5,.5,.5)]),o[o.length]=cc.callFunc(function(){e.scale=r.x,e.y=i.y-200,e.x=i.x}),o[o.length]=cc.delayTime(.1*(2-t)),o[o.length]=cc.moveTo(.5,i.x,i.y),t===this.cards.length-1&&(o[o.length]=cc.callFunc(function(){this.giveUpCardAnimationCb()}.bind(this))),e.runAction(cc.sequence(o))},giveUpCardAnimationCb:function(){this.giveUpCb&&this.giveUpCb()},giveUpCards:function(e,t){if(t&&(this.giveUpCb=t),e)for(var a=0;a<this.cards.length;a++)this.giveUpCardAnimation(this.cards[a],a,this.chairPos);else{var r=[];r[r.length]=cc.spawn([cc.fadeOut(.5),cc.moveTo(.5,-this.chairPos.x,-this.chairPos.y).easing(cc.easeSineOut())]),r[r.length]=cc.callFunc(function(){this.giveUpCardAnimationCb()}.bind(this)),this.node.runAction(cc.sequence(r))}},createCards:function(){this.cards=[];for(var e=0;e<3;e++){var t=cc.instantiate(this.card);t.parent=this.node,t.x=25*(e-1),t.scale=.5,t.zIndex=-1,this.cards[e]=t}},setCardsPos:function(e){this.cardOffsetX=e;for(var t=0;t<this.cards.length;t++)this.cards[t].x=(t-1)*e},onLoad:function(){this.createCards(),this.hideAllBtns(),this.node.active=!1,this.alreadyShowCardsStatus=!1}}),cc._RF.pop()},{"./GameProtoZJH":"GameProtoZJH","./ZJHAudio":"ZJHAudio"}],ZJHCard:[function(e,t,a){"use strict";cc._RF.push(t,"1e084z+TrVEIZTP0yciTgOg","ZJHCard"),cc.Class({extends:cc.Component,properties:{contentBg:cc.Sprite,cardBg:cc.Sprite,value:cc.Sprite,color:cc.Sprite,other:cc.Sprite},getCardColorValue:function(e){return(240&e)/16},getCardLogicValue:function(e){return 15&e},getColorImg:function(e){return"Game/ZhaJinHua/CardImg/c"+this.getCardColorValue(e)},getColor:function(e){var t=this.getCardColorValue(e);return 2===t||0===t?new cc.Color(173,27,27,255):new cc.Color(32,27,27,255)},getOtherImg:function(e){var t=this.getCardLogicValue(e),a=this.getCardColorValue(e);return t>10?"Game/ZhaJinHua/CardImg/v"+t+"c"+a:"Game/ZhaJinHua/CardImg/c"+a},getValueImg:function(e){return"Game/ZhaJinHua/CardImg/v"+this.getCardLogicValue(e)},showKaBei:function(){this.contentBg.node.active=!1,this.cardBg.node.active=!0},setData:function(e){this.contentBg.node.active=!0,this.value.node.color=this.getColor(e),Global.CCHelper.updateSpriteFrame(this.getValueImg(e),this.value),Global.CCHelper.updateSpriteFrame(this.getColorImg(e),this.color),Global.CCHelper.updateSpriteFrame(this.getOtherImg(e),this.other),this.cardBg.node.active=!1},onLoad:function(){}}),cc._RF.pop()},{}],ZJHChair:[function(e,t,a){"use strict";cc._RF.push(t,"2f25a9F3+xE7rL8SIIKe7cQ","ZJHChair");var r=e("./GameProtoZJH");cc.Class({extends:cc.Component,properties:{avatarImg:cc.Sprite,nameLabel:cc.Label,goldNum:cc.Label,statusBg:cc.Sprite,statusLabel:cc.Label,firstXiaZhuUI:cc.Sprite,loseMask:cc.Sprite,winResultPrefab:cc.Prefab,cardGroup:cc.Node,readyGroup:cc.Node,lookCardFlag:cc.Node,giveUpFlag:cc.Node,statusGroup:cc.Node,stakeGoldGroup:cc.Node,stakeGoldNum:cc.Label,addGoldEff:cc.Label,minusGoldEff:cc.Label},onLoad:function(){this.lookCardFlag.active=!1,this.giveUpFlag.active=!1,this.firstXiaZhuFlag=!1},updateUI:function(e,t,a,r){this.parentNode=r||this.parentNode,this.userInfo=e,this.profitPercentage=a,this.posIndex=0,Global.CCHelper.updateSpriteFrame(this.userInfo.avatar,this.avatarImg.node.getComponent(cc.Sprite)),this.nameLabel.string=Global.Player.convertNickname(this.userInfo.nickname),this.goldNum.string=this.userInfo.gold.toFixed(2),this.stakeGoldNum.string="0";2===t||1===t?(this.statusBg.node.scaleX=-1,this.statusBg.node.x=-100,this.statusLabel.node.x=-100,this.firstXiaZhuUI.node.x=-60,this.statusGroup.x=-135,this.statusGroup.y=-120,this.stakeGoldGroup.x=-135,this.stakeGoldGroup.y=10):5===t?(this.statusGroup.x=135,this.statusGroup.y=-120,this.stakeGoldGroup.x=135,this.stakeGoldGroup.y=10):0===t?(this.statusGroup.x=180,this.statusGroup.y=-90,this.stakeGoldGroup.y=60):3!==t&&4!==t||(this.statusGroup.x=135,this.statusGroup.y=-120,this.stakeGoldGroup.x=135,this.stakeGoldGroup.y=10)},clearWidget:function(){this.giveUpStatus=!1,this.loseStatus=!1,this.lookCardStatus=!1,this.statusLabel.node.active=!1,this.firstXiaZhuFlag=!1,this.firstXiaZhuUI.node.active=!1,this.statusBg.node.active=!1,this.loseMask.node.active=!1,this.cardGroup.active=!1,this.lookCardFlag.active=!1,this.giveUpFlag.active=!1,this.winResultUI&&(this.winResultUI.destroy(),this.winResultUI=null),this.hideReadyGroup(),this.stakeGoldNum.string=0},showGoldChangeEff:function(e){var t=this.minusGoldEff;t.string=e+"\u5143",e>0&&((t=this.addGoldEff).string="+"+(e*(100-parseInt(this.profitPercentage))/100).toFixed(2)+"\u5143"),0!==e&&(t.node.active=!0,e>0?(t.node.y=70,t.node.runAction(cc.moveBy(.5,0,20))):t.node.runAction(cc.moveBy(.5,0,50)),this.scheduleOnce(function(){t.node.active=!1,t.node.y=0}.bind(this),3e3))},showCardGroup:function(e){this.cardGroup.active=!0,this.loseMask.node.active=!1,e&&(this.cardGroup.getChildByName("frame").active=!0),this.hideOther()},onUserStake:function(e,t){this.userInfo.gold-=e,this.stakeGoldNum.string=Math.abs(t).toFixed(2),this.goldNum.string=this.userInfo.gold.toFixed(2)},updateUserInfo:function(e){this.userInfo=e,Global.CCHelper.updateSpriteFrame(this.userInfo.avatar,this.avatarImg.node.getComponent(cc.Sprite)),this.nameLabel.string=Global.Player.convertNickname(this.userInfo.nickname),this.goldNum.string=this.userInfo.gold.toFixed(2)},showReady:function(){this.readyGroup.getChildByName("readyLabel").active=!0},showStatus:function(e){e!==r.LOOK_CARD||this.giveUpStatus||this.loseStatus?e===r.GIVE_UP?(this.giveUpStatus=!0,this.lookCardFlag.active=!1,this.giveUpFlag.active=!0):e===r.LOSE&&(this.statusBg.node.active=!0,this.statusLabel.node.active=!0,this.loseStatus=!0,Global.CCHelper.updateSpriteFrame("Game/ZhaJinHua/UIImg/pop_mask",this.statusBg),this.statusLabel.string="\u8f93",this.statusLabel.node.color=cc.Color.WHITE):(this.lookCardStatus=!0,this.lookCardFlag.active=!0)},showFirstXiaZhu:function(){this.firstXiaZhuFlag=!0,this.firstXiaZhuUI.node.active=!0},showResult:function(e,t){e?(this.winResultUI=cc.instantiate(this.winResultPrefab),this.winResultUI.parent=this.node,this.winResultUI.y=100,t===r.CARD_TYPE_ZASE_235?this.winResultUI.getComponent("ZJHResultUI").showWinType(r.CARD_TYPE_DAN_ZHANG):this.winResultUI.getComponent("ZJHResultUI").showWinType(t)):this.showStatus(r.LOSE)},showLoseEff:function(){this.node.getComponent(cc.Animation).play("loseEff"),this.scheduleOnce(function(){this.loseMask.node.active=!0,this.loseMask.node.opacity=0,this.loseMask.node.runAction(cc.fadeTo(.3,200))},1)},hideOther:function(){this.statusBg.node.active=!1,this.statusLabel.node.active=!1,this.firstXiaZhuUI.node.active=!1},showOther:function(){this.loseStatus&&(this.statusBg.node.active=!0,this.statusLabel.node.active=!0),this.firstXiaZhuFlag&&(this.firstXiaZhuUI.node.active=!0)},canCompare:function(){return this.lookCardStatus&&this.userInfo&&!this.loseStatus&&!this.giveUpStatus},isPlayingGame:function(){return this.userInfo&&!(this.loseStatus||this.giveUpStatus)},isLookedCard:function(){return this.lookCardStatus}}),cc._RF.pop()},{"./GameProtoZJH":"GameProtoZJH"}],ZJHChipPool:[function(e,t,a){"use strict";cc._RF.push(t,"ec6b18y51RL1q1fYjMIq6pv","ZJHChipPool");var r=e("./GameProtoZJH"),i=e("./ZJHAudio");cc.Class({extends:cc.Component,properties:{chip:cc.Prefab,chipSumAmountLabel:cc.Label,roundLabel:cc.Label,poolInfoGroup:cc.Node},onLoad:function(){this.hidePoolInfoGroup(),this.chips=[]},setChips:function(e,t,a){for(var i=0;i<r.MAX_ROUND;i++)for(var o=0;o<a.length;o++)if(a[o]&&a[o][i]){var n=cc.instantiate(this.chip);n.parent=this.node,n.getComponent("ZJHChip").setStakeNum(0,a[o][i]),n.x=-this.node.width/2+Math.random()*this.node.width,n.y=-this.node.height/2+Math.random()*this.node.height,this.chips[this.chips.length]=n}this.chipSumAmountLabel.string=e.toFixed(2),this.roundLabel.string=Global.Utils.stringFormat("\u7b2c{0}/{1}\u8f6e",t,r.MAX_ROUND)},addChip:function(e,t,a,i,o){var n=cc.instantiate(this.chip);n.parent=this.node,n.getComponent("ZJHChip").setStakeNum(e,t),n.x=o.x-this.node.x,n.y=o.y-this.node.y;var s=-this.node.width/2+Math.random()*this.node.width,c=-this.node.height/2+Math.random()*this.node.height;n.runAction(cc.moveTo(.7,s,c).easing(cc.easeQuinticActionOut())),this.chips[this.chips.length]=n,this.chipSumAmountLabel.string=a.toFixed(2),this.roundLabel.string=Global.Utils.stringFormat("\u7b2c{0}/{1}\u8f6e",i,r.MAX_ROUND)},collectChips:function(e){for(var t=0;t<this.chips.length;t++){var a=cc.delayTime(.2+.02*t),r=cc.moveTo(.5,e.x-this.node.x,e.y-this.node.y).easing(cc.easeQuinticActionOut()),o=cc.fadeOut(.1),n=cc.sequence([a,r,o]);this.chips[t].runAction(n)}i.shouJi()},showPoolInfoGroup:function(){this.poolInfoGroup.active=!0},hidePoolInfoGroup:function(){this.poolInfoGroup.active=!1},removeAllChips:function(){for(var e=0;e<this.chips.length;e++)this.chips[e].destroy();this.chips=[],this.chipSumAmountLabel.string="0",this.roundLabel.string=Global.Utils.stringFormat("\u7b2c{0}/{1}\u8f6e",0,r.MAX_ROUND)}}),cc._RF.pop()},{"./GameProtoZJH":"GameProtoZJH","./ZJHAudio":"ZJHAudio"}],ZJHChip:[function(e,t,a){"use strict";cc._RF.push(t,"a4555CDscNAEpGg5ojrGl/7","ZJHChip");var r=e("./GameProtoZJH");cc.Class({extends:cc.Component,properties:{numLabel:cc.Label,chipBg:cc.Sprite},onLoad:function(){},setStakeNum:function(e,t){var a=r.STAKE_LEVEL[e]*t;this.numLabel.string=a.toString(),Global.CCHelper.updateSpriteFrame("Game/ZhaJinHua/ImgNew/ZJHChipBg",this.chipBg)}}),cc._RF.pop()},{"./GameProtoZJH":"GameProtoZJH"}],ZJHCompare:[function(e,t,a){"use strict";cc._RF.push(t,"d88dd/yIM5FdZyukbG1QX9+","ZJHCompare");var r=e("./ZJHAudio");cc.Class({extends:cc.Component,properties:{chairPos:cc.Node,comparePos:cc.Node,pkUIGroup:cc.Node,mask:cc.Node},startCompare:function(e,t,a,r){this.callback=a,this.mask.runAction(cc.fadeTo(.3,153)),this.chairAnimation(e,!1,r),this.chairAnimation(t,!0,!r)},chairAnimation:function(e,t,a){var i=e.node.parent,o={x:e.node.x,y:e.node.y},n=e;n.node.getChildByName("otherGroup").active=!1;var s=[];s[s.length]=cc.callFunc(function(){n.node.parent=this.node,n.node.x=i.x,n.node.y=i.y}.bind(this)),s[s.length]=cc.scaleTo(.2,1.5,1.5),s[s.length]=cc.delayTime(.2),s[s.length]=cc.scaleTo(.2,1,1),s[s.length]=cc.callFunc(function(){t&&(this.node.getComponent(cc.Animation).play("compare"),this.pkUIGroup.active=!0)}.bind(this));var c={x:this.chairPos.x,y:this.chairPos.y};t&&(c={x:this.comparePos.x,y:this.comparePos.y}),s[s.length]=cc.moveTo(.2,c.x,c.y).easing(cc.easeBackIn()),s[s.length]=cc.delayTime(.2),a&&(s[s.length]=cc.callFunc(function(){r.compareDian(),n.showLoseEff()}.bind(this))),s[s.length]=cc.delayTime(2),s[s.length]=cc.callFunc(function(){n.node.parent=i,n.node.x-=i.x,n.node.y-=i.y,t&&(this.node.active=!1)}.bind(this)),s[s.length]=cc.moveTo(.2,o.x,o.y),s[s.length]=cc.callFunc(function(){n.node.getChildByName("otherGroup").active=!0,t&&Global.Utils.invokeCallback(this.callback)}.bind(this));var l=cc.sequence(s);n.node.runAction(l)},onLoad:function(){this.pkUIGroup.active=!1}}),cc._RF.pop()},{"./ZJHAudio":"ZJHAudio"}],ZJHModel:[function(e,t,a){"use strict";cc._RF.push(t,"94fadD033ZCXq3PmiewP7WP","ZJHModel");var r=e("../../Models/Player"),i=e("./GameProtoZJH"),o=t.exports={},n=e("../../API/RoomProto"),s=e("../../Models/GameTypes");o.COLOR_LABEL=["\u65b9","\u6885","\u7ea2","\u9ed1"],o.COLOR={red:new cc.Color(173,27,27,255),black:new cc.Color(32,27,27,255)},o.POS_BOTTOM=0,o.POS_RIGHT_BOTTOM=1,o.POS_RIGHT_TOP=2,o.POS_LEFT_TOP=3,o.POS_LEFT_BOTTOM=4,o.POS_TOP=5,o.chairPos=[],o.LOGIC_MASK_COLOR=240,o.LOGIC_MASK_VALUE=15,o.init=function(e){this.data=e,this.profitPercentage=e.gameData.profitPercentage,this.msg=[],this.gameTypeInfo=e.gameData.gameTypeInfo,this.setStakeLevel(),this.sortRoomUser(),this.setCurDureau(this.data.gameData.curDureau),Global.MessageCallback.addListener("GameMessagePush",this),Global.MessageCallback.addListener("RoomMessagePush",this)},o.getGameStartedOnce=function(){return this.data.gameData.gameStartedOnce},o.setGameStartedOnce=function(){this.data.gameData.gameStartedOnce=!0},o.isGameStarted=function(){return this.data.gameData.gameStarted},o.getGameRule=function(){return this.data.gameData.gameRule},o.setStakeLevel=function(){if(this.isFangKa())for(var e=0;e<i.STAKE_LEVEL.length;e++)i.STAKE_LEVEL[e]=i.STAKE_LEVEL_BASE[e]*this.data.gameData.gameTypeInfo.baseScore;else i.STAKE_LEVEL=s.getGameInfoByGameTypeID(this.data.gameTypeID).stakeLevel,i.STAKE_XUE_PIN=s.getGameInfoByGameTypeID(this.data.gameTypeID).stakeXuePin},o.gameIsPlaying=function(){return this.data.gameStatus===n.GAME_STATUS_PLAYING},o.setGameIsPlaying=function(){this.data.gameStatus=n.GAME_STATUS_PLAYING},o.setGameOver=function(){this.data.gameStatus=null},o.isFangKa=function(){return!0},o.setCurDureau=function(e){this.curDureau=e},o.getJuShu=function(){return this.curDureau},o.getRoomID=function(){var e=this.data.gameData.roomId+"",t=6-e.length;if(t>0)for(var a=0;a<t;a++)e="0"+e;return e},o.sortRoomUser=function(){this.data.roomUserInfoArr.sort(function(e,t){return e.chairId>t.chairId})},o.removeRoomUserInfo=function(e){for(var t=0;this.data.roomUserInfoArr.length;t++)if(this.data.roomUserInfoArr[t].chairId===e.chairId){this.data.roomUserInfoArr.splice(t,1);break}},o.isUserInRoom=function(e){for(var t=0;t<this.data.roomUserInfoArr.length;t++)if(e.userInfo.uid+""==this.data.roomUserInfoArr[t].userInfo.uid+"")return!0;return!1},o.addRoomUserInfo=function(e){this.data.roomUserInfoArr.push(e),this.sortRoomUser()},o.getUsers=function(){return this.data.roomUserInfoArr},o.clearData=function(){this.data=null,this.fangKa=!1,this.msg=[]},o.getSelfchairId=function(){for(var e=0;e<this.data.roomUserInfoArr.length;e++)if(this.data.roomUserInfoArr[e].userInfo.uid===r.getPy("uid"))return parseInt(this.data.roomUserInfoArr[e].chairId)},o.getChairIdByUid=function(e){for(var t=0;t<this.data.roomUserInfoArr.length;t++)if(this.data.roomUserInfoArr[t].userInfo.uid===e)return this.data.roomUserInfoArr[t].chairId},o.getCardDesNormal=function(e){return this.COLOR_LABEL[this.getCardColorValue(e)]+this.getCardLogicValue(e)},o.getCardLogicValue=function(e){return e&this.LOGIC_MASK_VALUE},o.getCardColorValue=function(e){return(e&this.LOGIC_MASK_COLOR)/16},o.getCardTypeStr=function(e){switch(e){case i.CARD_TYPE_DAN_ZHANG:return"\u9ad8\u724c";case i.CARD_TYPE_DUI_ZI:return"\u5bf9\u5b50";case i.CARD_TYPE_SHUN_ZI:return"\u987a\u5b50";case i.CARD_TYPE_TONG_HUA:return"\u540c\u82b1";case i.CARD_TYPE_TONG_HUA_SHUN:return"\u540c\u82b1\u987a";case i.CARD_TYPE_BAO_ZI:return"\u8c79\u5b50"}},o.messageCallbackHandler=function(e,t){this.msg||(this.msg=[]),this.msg.push({route:e,msg:t})},o.checkHaveMsg=function(){if(Global.MessageCallback.removeListener("GameMessagePush",this),Global.MessageCallback.removeListener("RoomMessagePush",this),this.msg&&this.msg.length>0)for(var e=0;e<this.msg.length;e++)Global.MessageCallback.emitMessage(this.msg[e].route,this.msg[e].msg)},cc._RF.pop()},{"../../API/RoomProto":"RoomProto","../../Models/GameTypes":"GameTypes","../../Models/Player":"Player","./GameProtoZJH":"GameProtoZJH"}],ZJHOperation:[function(e,t,a){"use strict";cc._RF.push(t,"506e7ObcG5EkbkyqKP7BbwU","ZJHOperation");var r=e("./GameProtoZJH");cc.Class({extends:cc.Component,properties:{timeBg:cc.Node,timeText:cc.Label,stakeBtn:cc.Node,autoStakeBtn:cc.Node,cancelAutoStakeBtn:cc.Node,lookCardBtn:cc.Node,compareBtn:cc.Node,addStakeBtn:cc.Node},setEventCallback:function(e){this.callback=e},hideAutoEff:function(){this.autoStakeBtn.active=!0,this.cancelAutoStakeBtn.active=!1,this.autoStake=!1},showAutoEff:function(){this.autoStakeBtn.active=!1,this.cancelAutoStakeBtn.active=!0,this.autoStake=!0},showSpecialOperationUI:function(){this.node.active=!0,this.autoStake?this.scheduleOnce(function(){Global.Utils.invokeCallback(this.callback(null,"stake"))}.bind(this),1):(this.startCountDown(),this.addStakeBtn.active=!0,this.stakeBtn.active=!0,this.lookCardBtn.active=!0,this.compareBtn.active=!0,this.autoStakeBtn.active=!1,this.cancelAutoStakeBtn.active=!1)},showNormalOperationUI:function(){if(this.node.active=!0,this.addStakeBtn.active=!1,this.stakeBtn.active=!1,this.lookCardBtn.active=!1,this.compareBtn.active=!1,this.autoStakeBtn.active=!0,this.stopCountDown(),this.autoStake)return this.autoStakeBtn.active=!1,void(this.cancelAutoStakeBtn.active=!0)},updateStakeLevel:function(e,t){this.currentStakeLevel=e||this.currentStakeLevel,this.currentMultiple=t||this.currentMultiple},startCountDown:function(){cc.log("\u5f00\u59cb\u4e0b\u6ce8\u5012\u8ba1\u65f6"),this.stopCountDown(),this.timeBg.active=!0;var e=r.OPERATION_TIME;this.timeText.string=e,this.schedule(function(){(e-=1)>=0?this.timeText.string=e:(this.timeBg.active&&Global.Utils.invokeCallback(this.callback(null,"giveUp")),this.stopCountDown())}.bind(this),1)},stopCountDown:function(){cc.log("\u505c\u6b62\u4e0b\u6ce8\u5012\u8ba1\u65f6"),this.timeBg.active=!1,this.unscheduleAllCallbacks()},onLoad:function(){this.reSet()},onDestroy:function(){this.stopCountDown()},reSet:function(){this.currentStakeLevel=0,this.currentMultiple=1,this.autoStake=!1,this.timeBg.active=!1,this.stopCountDown(),this.hideAutoEff()}}),cc._RF.pop()},{"./GameProtoZJH":"GameProtoZJH"}],ZJHResultUI:[function(e,t,a){"use strict";cc._RF.push(t,"718cdg1MQhM357AvHOtPrSx","ZJHResultUI");var r=e("./GameProtoZJH");cc.Class({extends:cc.Component,properties:{fonts:{type:[cc.Sprite],default:[]}},showWinType:function(e){this.fonts[this.fonts.length-1].node.active=!1;var t=["","","","card_type_font_ying"];switch(e){case r.CARD_TYPE_BAO_ZI:t[0]="card_type_font_bao",t[1]="card_type_font_zi",t[2]="card_type_font_ying";break;case r.CARD_TYPE_TONG_HUA_SHUN:t[0]="card_type_font_tong",t[1]="card_type_font_hua",t[2]="card_type_font_shun",this.fonts[this.fonts.length-1].node.active=!0,-45;break;case r.CARD_TYPE_TONG_HUA:t[0]="card_type_font_tong",t[1]="card_type_font_hua",t[2]="card_type_font_ying";break;case r.CARD_TYPE_SHUN_ZI:t[0]="card_type_font_shun",t[1]="card_type_font_zi",t[2]="card_type_font_ying";break;case r.CARD_TYPE_DUI_ZI:t[0]="card_type_font_dui",t[1]="card_type_font_zi",t[2]="card_type_font_ying";break;case r.CARD_TYPE_DAN_ZHANG:t[0]="card_type_font_gao",t[1]="card_type_font_pai",t[2]="card_type_font_ying"}for(var a=0;a<this.fonts.length;a++)this.fonts[a].node.active=!1},onLoad:function(){}}),cc._RF.pop()},{"./GameProtoZJH":"GameProtoZJH"}],ZJHSelectChair:[function(e,t,a){"use strict";cc._RF.push(t,"dcb773QDjdHXpsqBYza+O+w","ZJHSelectChair");var r=e("./ZJHAudio");cc.Class({extends:cc.Component,properties:{touchFrame:cc.Prefab},clearWidget:function(){if(this.touchWidgetArr){for(var e=0;e<this.touchWidgetArr.length;++e)this.touchWidgetArr[e].destroy();this.touchWidgetArr=[]}this.node.active=!1},addSelectEff:function(e,t,a,i){var o=cc.instantiate(this.touchFrame);o.parent=this.node,o.getComponent(cc.Animation).play("selectEff"),o.x=t.x,o.y=t.y-30,this.touchWidgetArr.push(o),1!==e&&2!==e||(o.getChildByName("anmi").x=-o.getChildByName("anmi").x,o.getChildByName("anmi").scaleX=-1),o.once(cc.Node.EventType.TOUCH_START,function(){r.compare(),Global.Utils.invokeCallback(i,a)})},onLoad:function(){this.touchWidgetArr=[]}}),cc._RF.pop()},{"./ZJHAudio":"ZJHAudio"}],ZhaJinHuaDialog:[function(e,t,a){"use strict";cc._RF.push(t,"3405eIjFPBFEL2YuJ9sQ5tK","ZhaJinHuaDialog");var r=e("./GameProtoZJH"),i=e("../../API/RoomProto"),o=e("../../API/RoomAPI"),n=e("./ZJHAudio");cc.Class({extends:cc.Component,properties:{chairPos:[cc.Node],chairPrefab:cc.Prefab,cardsPrefab:cc.Prefab,selectChairPrefab:cc.Prefab,addStakePrefab:cc.Prefab,comparePrefab:cc.Prefab,chipPool:e("ZJHChipPool"),operationWidgetCtrl:e("ZJHOperation"),addStakeWidgetCtrl:e("ZJHAddStake"),selectChairWidgetCtrl:e("ZJHSelectChair"),continueNode:cc.Node},onLoad:function(){Global.AudioManager.startPlayBgMusic("Game/ZhaJinHua/audio/zjh_bg"),Global.MessageCallback.addListener("GameMessagePush",this),Global.MessageCallback.addListener("RoomMessagePush",this),Global.MessageCallback.addListener("ReConnectSuccess",this),this.myChairID=-1,this.gameTypeInfo=null,this.profitPercentage=0,this.giveUping=!1,this.roomUserInfoArr=[null,null,null,null,null],this.chairCtrlArr=[null,null,null,null,null],this.cardCtrlArr=[null,null,null,null,null],this.gameInited=!1,this.reMatchGame=!1,this.operationWidgetCtrl.setEventCallback(this.onBtnClk.bind(this)),this.scheduleOnce(function(){o.roomMessageNotify(i.getRoomSceneInfoNotify())},.2)},onDestroy:function(){Global.MessageCallback.removeListener("GameMessagePush",this),Global.MessageCallback.removeListener("RoomMessagePush",this),Global.MessageCallback.removeListener("ReConnectSuccess",this)},onBtnClk:function(e,t){switch(t){case"dissRoom":if(!this.gameInited)return;this.leaveRoom();break;case"roomRule":Global.DialogManager.createDialog("GameCommon/GameRule/GameRuleDialog",{kind:Global.Enum.gameType.ZJH});break;case"setting":Global.DialogManager.createDialog("Setting/SettingDialog");break;case"continue":if(Global.Player.isInRoom())return this.reMatchGame=!0,Global.API.room.roomMessageNotify(i.userLeaveRoomNotify()),void Global.DialogManager.addLoadingCircle();Global.DialogManager.createDialog("Match/MatchGameDialog",{gameTypeID:this.gameTypeInfo.gameTypeID});break;case"lookCard":if(this.chairCtrlArr[0].isLookedCard())return void Global.DialogManager.addTipDialog("\u5df2\u7ecf\u770b\u724c\uff0c\u65e0\u6cd5\u91cd\u590d\u770b\u724c");n.kanPai(),o.gameMessageNotify(r.userLookCardNotify());break;case"giveUp":n.giveUp(),o.gameMessageNotify(r.userGiveUpNotify()),this.operationWidgetCtrl.node.active=!1;break;case"stake":var a=this.operationWidgetCtrl.currentStakeLevel,s=this.operationWidgetCtrl.currentMultiple;if(Global.Player.gold<=r.STAKE_LEVEL[a]*s)return void o.gameMessageNotify(r.guzhuyizhiNotify(Global.Player.gold));n.genZhu(),o.gameMessageNotify(r.userStakeNotify(a));break;case"addStake":if(this.addStakeWidgetCtrl.node.active)this.addStakeWidgetCtrl.node.active=!1;else{this.addStakeWidgetCtrl.node.active=!0;var c=this.operationWidgetCtrl.currentStakeLevel,l=this.operationWidgetCtrl.currentMultiple;this.addStakeWidgetCtrl.startSelectStake(c,l,this.onSelfStake.bind(this))}break;case"autoStake":this.autoStake=!this.autoStake,this.autoStake?this.operationWidgetCtrl.showAutoEff():this.operationWidgetCtrl.hideAutoEff();break;case"compare":if(this.selectChairWidgetCtrl.node.active)return;this.selectChairWidgetCtrl.node.active=!0;for(var d=[],h=!1,u=0;u<5;++u)if(u!==this.myChairID){var g=this.getUserChairIndex(u),C=this.chairCtrlArr[g];C&&(C.canCompare()&&(this.selectChairWidgetCtrl.addSelectEff(g,this.chairPos[g].position,u,function(e){this.selectChairWidgetCtrl.clearWidget(),o.gameMessageNotify(r.userCompareNotify(e)),this.operationWidgetCtrl.node.active=!1}.bind(this)),h=!0),C.isPlayingGame()&&d.push(u))}if(1===d.length)for(var p=0;p<d.length;p++)if(d[p]!==this.myChairID){var f=this.getUserChairIndex(d[p]);this.selectChairWidgetCtrl.addSelectEff(f,this.chairPos[f].position,d[p],function(e){this.selectChairWidgetCtrl.clearWidget(),o.gameMessageNotify(r.userCompareNotify(e)),this.operationWidgetCtrl.node.active=!1}.bind(this)),h=!0}h?this.addStakeWidgetCtrl.node.active=!1:(this.selectChairWidgetCtrl.node.active=!1,Global.DialogManager.addTipDialog("\u73a9\u5bb6\u4eba\u6570\u8d85\u8fc7\u4e24\u4eba\uff0c\u53ea\u80fd\u8ddf\u5df2\u770b\u724c\u7684\u73a9\u5bb6\u6bd4\u724c"));break;case"endCompare":this.selectChairWidgetCtrl.clearWidget()}},messageCallbackHandler:function(e,t){if("RoomMessagePush"===e){if(t.type===i.USER_LEAVE_ROOM_RESPONSE)t.data.chairId===this.myChairID&&Global.DialogManager.removeLoadingCircle();else if(t.type===i.OTHER_USER_ENTRY_ROOM_PUSH){if(!this.gameInited)return;this.onUserEntryRoom(t.data.roomUserInfo)}else if(t.type===i.USER_LEAVE_ROOM_PUSH){if(!this.gameInited)return;this.onUserLeaveRoom(t.data.roomUserInfo)}else if(t.type===i.USER_READY_PUSH){if(!this.gameInited)return;this.onUserReady(t.data.chairId)}else if(t.type===i.GET_ROOM_SCENE_INFO_PUSH)this.gameInit(t.data.roomUserInfoArr,t.data.gameData);else if(t.type===i.ROOM_USER_INFO_CHANGE_PUSH){if(!this.gameInited)return;for(var a=0;a<this.roomUserInfoArr.length;++a)if(this.roomUserInfoArr[a].userInfo.uid===t.data.changeInfo.uid){this.roomUserInfoArr[a].userInfo=t.data.changeInfo;break}}}else if("ReConnectSuccess"===e)Global.Player.isInRoom()?Global.API.hall.joinRoomRequest(Global.Player.roomID,function(){o.roomMessageNotify(i.getRoomSceneInfoNotify())},function(){this.exitGame()}.bind(this)):this.exitGame();else if("GameMessagePush"===e){if(!this.gameInited)return;switch(t.type){case r.GAME_START_PUSH:this.onGameStart(t.data.stakeLevel,t.data.firstXiaZhu,t.data.goldSumAmount,t.data.round,t.data.userStakeCountArr);break;case r.GAME_OPERATE_STAKE_PUSH:this.onUserStake(t.data.chairId,t.data.stakeLevel,t.data.multiple,t.data.userStakeCount,t.data.goldSumAmount,t.data.round);break;case r.GAME_OPERATE_GIVEUP_PUSH:this.onUserGiveUp(t.data.chairId);break;case r.GAME_OPERATE_LOOK_PUSH:this.onUserLookCard(t.data.chairId,"look",t.data.cardType,t.data.cardDataArr);break;case r.GAME_OPERATE_COMPARE_PUSH:this.onUserCompare(t.data.chairId,t.data.loserchairId,t.data.comparechairId);break;case r.GAME_OPERATE_SHOWDOWN_PUSH:this.onUserShowdown();break;case r.GAME_CHAIR_TURN_PUSH:this.operationWidgetCtrl.updateStakeLevel(t.data.currentStakeLevel,t.data.currentMultiple),t.data.chairId===this.myChairID?this.operationWidgetCtrl.showSpecialOperationUI():this.chairCtrlArr[0].isPlayingGame()&&this.operationWidgetCtrl.showNormalOperationUI();break;case r.GAME_END_PUSH:if(this.giveUping)return void(this.endMsg=t.data);this.checkCompareEnd(t.data)}}},gameInit:function(e,t){this.gameInited=!0,this.gameTypeInfo=t.gameTypeInfo,this.profitPercentage=t.profitPercentage;for(var a=0;a<e.length;++a){var n=e[a];if(n.userInfo.uid===Global.Player.getPy("uid")){this.myChairID=n.chairId;break}}for(var s=0;s<e.length;++s)this.onUserEntryRoom(e[s]);if(t.gameStatus===r.gameStatus.NONE)o.roomMessageNotify(i.userReadyNotify(!0));else if(t.gameStatus===r.gameStatus.PLAYING){this.operationWidgetCtrl.updateStakeLevel(t.currentStakeLevel);for(var c=0;c<this.chairCtrlArr.length;c++){var l=this.getUserChairIndex(c);if(this.chairCtrlArr[l]){var d=t.userStatus[c];d!==r.LOOK_CARD&&d!==r.GIVE_UP&&d!==r.LOSE||this.chairCtrlArr[l].showStatus(d),c===this.myChairID&&(this.myChairID===t.currentUserchairId?this.operationWidgetCtrl.showSpecialOperationUI():this.operationWidgetCtrl.showNormalOperationUI()),0!==d&&d!==r.LEAVE?c===this.myChairID&&d===r.LOOK_CARD?(this.createCard(l,t.userCardsArr,!1),this.operationWidgetCtrl.updateStakeLevel(null,2)):this.createCard(l,null,!1):c===this.myChairID&&(this.operationWidgetCtrl.node.active=!1),this.chairCtrlArr[l].onUserStake(t.userStakeCountArr[c],t.userStakeCountArr[c])}}this.chipPool.setChips(t.goldSumAmount,t.round,t.stakeArr),this.chipPool.showPoolInfoGroup(),this.chairCtrlArr[this.getUserChairIndex(t.firstXiaZhu)].showFirstXiaZhu()}},resetGame:function(){this.node.stopAllActions(),this.unscheduleAllCallbacks();for(var e=0;e<this.cardCtrlArr.length;++e)this.cardCtrlArr[e]&&this.cardCtrlArr[e].node.destroy();this.cardCtrlArr=[null,null,null,null,null];for(var t=0;t<this.chairCtrlArr.length;++t)this.chairCtrlArr[t]&&this.chairCtrlArr[t].node.destroy();this.chairCtrlArr=[null,null,null,null,null],this.chipPool.removeAllChips(),this.operationWidgetCtrl.node.active=!1,this.addStakeWidgetCtrl.node.active=!1,this.compareUI&&(this.compareUI.node.destroy(),this.compareUI=null),this.selectChairWidgetCtrl.clearWidget()},onReconnection:function(){this.resetGame(),o.roomMessageNotify(i.getRoomSceneInfoNotify())},onUserEntryRoom:function(e){var t=cc.instantiate(this.chairPrefab),a=this.getUserChairIndex(e.chairId);t.parent=this.chairPos[a];var r=t.getComponent("ZJHChair");this.chairCtrlArr[a]=r,r.updateUI(e.userInfo,a,this.profitPercentage,this.node),this.roomUserInfoArr[e.chairId]=e},onUserLeaveRoom:function(e){if(e.chairId===this.myChairID)Global.DialogManager.removeLoadingCircle(),this.reMatchGame?(this.reMatchGame=!1,Global.DialogManager.createDialog("Match/MatchGameDialog",{gameTypeID:this.gameTypeInfo.gameTypeID})):this.exitGame();else{var t=this.getUserChairIndex(e.chairId);this.chairCtrlArr[t].node.destroy(),this.chairCtrlArr[t]=null,this.roomUserInfoArr[e.chairId]=null}},onUserReady:function(e){},updateUserInfo:function(){for(var e=0;e<5;++e){var t=this.roomUserInfoArr[e];if(t){var a=this.getUserChairIndex(e);this.chairCtrlArr[a].updateUserInfo(t.userInfo)}}},onGameStart:function(e,t,a,r,i){for(var o=0;o<5;o++){var s=this.getUserChairIndex(o);this.chairCtrlArr[s]&&(this.chipPool.addChip(e,1,a,r,this.chairCtrlArr[s].node.position),this.chairCtrlArr[s].onUserStake(i[o],i[o]),n.chip())}this.chipPool.showPoolInfoGroup(),this.createCards(),this.scheduleOnce(function(){this.chairCtrlArr[this.getUserChairIndex(t)].showFirstXiaZhu(t),this.operationWidgetCtrl.node.active=!0,this.operationWidgetCtrl.updateStakeLevel(0,1),t===this.myChairID?this.operationWidgetCtrl.showSpecialOperationUI():this.operationWidgetCtrl.showNormalOperationUI()},1)},onSelfStake:function(e){o.gameMessageNotify(r.userStakeNotify(e)),this.operationWidgetCtrl.node.active=!1,this.addStakeWidgetCtrl.node.active=!1},onUserStake:function(e,t,a,i,o,n){var s=this.getUserChairIndex(e);this.chipPool.addChip(t,a,o,n,this.chairPos[s].position),this.chairCtrlArr[s].onUserStake(r.STAKE_LEVEL[t]*a,i)},onUserGiveUp:function(e){this.giveUping=!0;var t=this.getUserChairIndex(e);this.chairCtrlArr[t].showStatus(r.GIVE_UP),this.cardCtrlArr[t]?this.cardCtrlArr[t].giveUpCards(e===this.myChairID,function(){this.giveUping=!1,this.endMsg?this.showGameEnd(this.endMsg):e===this.myChairID&&(this.continueNode.active=!0)}.bind(this)):this.scheduleOnce(function(){this.cardCtrlArr[t].giveUpCards(e===this.myChairID,function(){this.giveUping=!1,this.endMsg?this.showGameEnd(this.endMsg):e===this.myChairID&&(this.continueNode.active=!0)}.bind(this))}.bind(this),.7)},onUserLookCard:function(e,t,a,i){var o=this.getUserChairIndex(e);this.chairCtrlArr[o].showStatus(r.LOOK_CARD),this.cardCtrlArr[o].showCards(t,a,i)},onUserCompare:function(e,t,a){var r=function(){t===this.myChairID?n.compareFailure():e!==this.myChairID&&a!==this.myChairID||n.compareVictory(),this.compareUI&&(this.compareUI.destroy(),this.compareUI=null);var r=this.getUserChairIndex(t);this.chairCtrlArr[r].showResult(!1,null),t===this.myChairID&&(this.operationWidgetCtrl.node.active=!1,this.continueNode.active=!0),this.chairCtrlArr[this.getUserChairIndex(e)].showOther(),this.chairCtrlArr[this.getUserChairIndex(a)].showOther()}.bind(this);this.operationWidgetCtrl.node.active=!1,this.chairCtrlArr[this.getUserChairIndex(e)].hideOther(),this.chairCtrlArr[this.getUserChairIndex(a)].hideOther();var i=cc.instantiate(this.comparePrefab);i.parent=this.node,i.getComponent("ZJHCompare").startCompare(this.chairCtrlArr[this.getUserChairIndex(e)],this.chairCtrlArr[this.getUserChairIndex(a)],r,t===e),this.compareUI=i},onUserShowdown:function(e,t,a){var r=this.getUserChairIndex(e);this.chairCtrlArr[r].showCardGroup(),this.cardCtrlArr[r]&&this.cardCtrlArr[r].showCards("showdown",t,a)},createCard:function(e,t,a){var r=cc.instantiate(this.cardsPrefab);r.parent=this.chairPos[e],r.zIndex=1;var i=r.getComponent("ZJHCards");i.setPos(e,t,this.chairPos[e].position,a),this.cardCtrlArr[e]&&this.cardCtrlArr[e].node.destroy(),this.cardCtrlArr[e]=i},createCards:function(){for(var e=0;e<this.chairCtrlArr.length;++e){var t=this.getUserChairIndex(e);this.chairCtrlArr[t]&&this.createCard(t,null,!0)}},leaveRoom:function(){Global.DialogManager.addPopDialog("\u786e\u8ba4\u9000\u51fa\u6e38\u620f?",function(){Global.Player.getPy("roomID")?(Global.API.room.roomMessageNotify(i.userLeaveRoomNotify()),Global.DialogManager.addLoadingCircle()):this.exitGame()}.bind(this),function(){})},exitGame:function(){Global.DialogManager.createDialog("Hall/HallDialog",null,function(){Global.DialogManager.destroyDialog(this,!0),Global.CCHelper.releaseRes(["Game/ZhaJinHua"])}.bind(this))},checkCompareEnd:function(e){this.compareUI?this.scheduleOnce(function(){this.checkCompareEnd(e)},1.5):this.showGameEnd(e)},showGameEnd:function(e){for(var t=0;t<this.chairCtrlArr.length;++t){var a=this.getUserChairIndex(t);this.chairCtrlArr[a]&&this.chairCtrlArr[a].showGoldChangeEff(e.scoreChangeArr[t])}this.operationWidgetCtrl.node.active=!1;var r=this.getUserChairIndex(e.winnerchairId);this.chairCtrlArr[r].showCardGroup(!0),this.cardCtrlArr[r].showCards("showdown",e.userCardTypeArr[e.winnerchairId],e.userCardIndexArr[e.winnerchairId]),this.cardCtrlArr[0]&&(this.cardCtrlArr[0].showShowBtn(),e.winnerchairId===this.myChairID?this.cardCtrlArr[0].hideAllBtns():this.cardCtrlArr[0].showCards("",e.userCardTypeArr[this.myChairID],e.userCardIndexArr[this.myChairID])),this.chipPool.collectChips(this.chairPos[r]),this.scheduleOnce(function(){this.continueNode.active=!0}.bind(this),3)},getUserChairIndex:function(e){return(e-this.myChairID+5)%5}}),cc._RF.pop()},{"../../API/RoomAPI":"RoomAPI","../../API/RoomProto":"RoomProto","./GameProtoZJH":"GameProtoZJH","./ZJHAudio":"ZJHAudio",ZJHAddStake:"ZJHAddStake",ZJHChipPool:"ZJHChipPool",ZJHOperation:"ZJHOperation",ZJHSelectChair:"ZJHSelectChair"}],code:[function(e,t,a){"use strict";cc._RF.push(t,"94eccbpl4JPAJdM5oAMEQMf","code");t.exports=new function(){this.OK=0,this.FAIL=1,this.REQUEST_DATA_ERROR=2,this.MYSQL_ERROR=3,this.INVALID_UERS=4,this.INVALID_PARAM=5,this.PERMISSION_NOT_ENOUGH=6,this.SMS_CODE_ERROR=7,this.IMG_CODE_ERROR=8,this.SMS_AUTH_CONFIG_ERROR=9,this.SMS_SEND_FAILED=10,this.LOGIN={ACCOUNT_OR_PASSWORD_ERROR:103,GET_HALL_SERVERS_FAIL:104,ACCOUNT_EXIST:105,ACCOUNT_NOT_EXIST:106,ANSWER_ERROR:107,PASSWORD_ERROR:108},this.HALL={TOKEN_INFO_ERROR:201,TOKEN_INVALID:202,TODAY_ALREADY_SIGNED:203,TODAY_ALREADY_SHARED:204,NOT_SPREAD_REWARDS:205,NOT_ENOUGH_GOLD:206,NOT_ENOUGH_DIAMOND:207,ALREADY_IN_FRIEND_LIST:208,ALREADY_IN_REQUEST_LIST:209,NOT_IN_FRIEND_LIST:210,NOT_IN_REQUEST_LIST:211,NOT_FIND:212,CAN_NOT_EVALUATE_TODAY:213,SPREAD_ID_ALREADY_SET:214,NOT_FIND_TRADE_ORDER:215,BROADCAST_STRING_TOO_LONG:216,BIND_PHONE_ALREADY:217,BIND_WX_ALREADY:218,TRADE_INFO_NOT_FIND:219,NOT_ENOUGH_VIP_LEVEL:220,INVITED_FRIEND_OFFLINE:221,CAN_NOT_CHANGE_USER_INFO_BECAUSE_INTERVAL_TIME:222,NICKNAME_TO_LONG:223,NO_LOGIN:224,TODAY_ALREADY_WITHDRAW_CASH:225,NOT_SPREADER:226,NOT_ENOUGH_COUPON:227,ALREADY_SPREADER:228,GOLD_LOCKED:229,SAFE_PASSWORD_ERROR:230,NOT_BIND_ALI_PAY:231,NOT_BIND_BANK_CARD:232},this.GAME_CENTER={ENTERING_ROOM_CANT_MATCH:301,GAME_SERVER_PARAMETER_ERROR:302,MATCHING:303,ENTERING_ROOM:304,NOT_IN_MATCH_LIST:305,ALREADY_IN_ROOM:306,CREATE_ROOM_ERROR:307,ROOM_NOT_EXIST:308,ROOM_PLAYER_COUNT_FULL:309,JOIN_ROOM_ERROR:310,ENTRY_ROOM_FAIL_GOLD_NOT_ENOUGH:311,ENTRY_ROOM_FAIL_GOLD_TOO_MANY:312,ALREADY_IN_MATCH_LIST:313},this.GAME={ROOM_COUNT_REACH_LIMIT:401,LEAVE_ROOM_GOLD_NOT_ENOUGH_LIMIT:402,LEAVE_ROOM_GOLD_EXCEED_LIMIT:403,ROOM_EXPENSE_NOT_ENOUGH:404,ROOM_HAS_DISMISS:405,ROOM_HAS_DISMISS_SHOULD_EXIT:406,CAN_NOT_LEAVE_ROOM:407},this.RECHARGE={RECHARGE_FAIL:501,RECHARGE_SUCCESS:502,USER_NOT_FIND:503,ITEM_NOT_FIND:504,SIGN_CHECK_ERR:505,MONEY_COUNT_ERR:506,ITEM_INFO_ERR:507,USER_PAYMENT_FAILED:508},this[1]="\u6570\u636e\u8bf7\u6c42\u5931\u8d25",this[2]="\u8bf7\u6c42\u6570\u636e\u9519\u8bef",this[3]="\u6570\u636e\u5e93\u64cd\u4f5c\u9519\u8bef",this[4]="\u65e0\u6548\u7528\u6237",this[5]="\u53d1\u9001\u53c2\u6570\u9519\u8bef",this[6]="\u6743\u9650\u4e0d\u8db3",this[7]="\u77ed\u4fe1\u9a8c\u8bc1\u7801\u9519\u8bef",this[8]="\u56fe\u5f62\u9a8c\u8bc1\u7801\u9519\u8bef",this[9]="\u77ed\u4fe1\u9a8c\u8bc1\u914d\u7f6e\u4fe1\u606f\u9519\u8bef",this[10]="\u77ed\u4fe1\u53d1\u9001\u5931\u8d25",this[103]="\u8d26\u53f7\u6216\u5bc6\u7801\u9519\u8bef",this[104]="\u83b7\u53d6\u5927\u5385\u670d\u52a1\u5668\u5931\u8d25",this[105]="\u8d26\u53f7\u5df2\u5b58\u5728",this[106]="\u5e10\u53f7\u4e0d\u5b58\u5728",this[107]="\u5bc6\u4fdd\u95ee\u9898\u7b54\u6848\u9519\u8bef",this[108]="\u5bc6\u7801\u9519\u8bef",this[201]="token\u4fe1\u606f\u9519\u8bef",this[202]="token\u5931\u6548",this[203]="\u4eca\u65e5\u5df2\u7b7e\u5230",this[204]="\u4eca\u65e5\u5df2\u5206\u4eab",this[205]="\u6ca1\u6709\u53ef\u9886\u53d6\u7684\u63a8\u5e7f\u5956\u52b1",this[206]="\u91d1\u5e01\u4e0d\u8db3",this[207]="\u94bb\u77f3\u4e0d\u8db3",this[208]="\u5df2\u7ecf\u5728\u597d\u53cb\u5217\u8868\u4e2d",this[209]="\u5df2\u7ecf\u5728\u8bf7\u6c42\u5217\u8868\u4e2d",this[210]="\u4e0d\u5728\u597d\u53cb\u5217\u8868\u4e2d",this[211]="\u4e0d\u518d\u8bf7\u6c42\u5217\u8868\u4e2d",this[212]="\u7528\u6237\u4e0d\u5b58\u5728",this[213]="\u6bcf\u65e5\u6700\u591a\u70b9\u8e29\u3001\u8d5e\u540410\u6b21",this[214]="\u5df2\u8bbe\u7f6e\u8fc7\u63a8\u5e7fID\uff0c\u65e0\u6cd5\u91cd\u590d\u8bbe\u7f6e",this[215]="\u672a\u67e5\u8be2\u5230\u8ba2\u5355\u4fe1\u606f",this[216]="\u53d1\u9001\u5185\u5bb9\u8fc7\u957f\uff0c\u4e0d\u80fd\u8d85\u8fc750\u4e2a\u5b57\u7b26",this[217]="\u8be5\u624b\u673a\u53f7\u5df2\u7ecf\u7ed1\u5b9a\uff0c\u4e0d\u80fd\u91cd\u590d\u7ed1\u5b9a",this[218]="\u8be5\u5fae\u4fe1\u53f7\u5df2\u7ecf\u7ed1\u5b9a\uff0c\u4e0d\u80fd\u91cd\u590d\u7ed1\u5b9a",this[219]="\u8ba2\u5355\u4e0d\u5b58\u5728",this[220]="\u4f1a\u5458\u7b49\u7ea7\u4e0d\u8db3",this[221]="\u9080\u8bf7\u7684\u597d\u53cb\u4e0d\u5728\u7ebf",this[222]="\u65e0\u6cd5\u4fee\u6539\u4e2a\u4eba\u4fe1\u606f\uff0c\u4fee\u6539\u95f4\u9694\u4e0d\u5f97\u5c11\u4e8e30\u5929",this[223]="\u6635\u79f0\u957f\u5ea6\u4e0d\u80fd\u8d85\u8fc7\u4e94\u4e2a\u5b57\u7b26",this[224]="\u5e10\u53f7\u88ab\u51bb\u7ed3\uff0c\u7981\u6b62\u767b\u5f55",this[225]="\u6bcf\u5929\u53ea\u80fd\u63d0\u4ea4\u4e00\u6b21\u9000\u6b3e\u7533\u8bf7\uff0c\u4e0d\u80fd\u518d\u6b21\u63d0\u4ea4",this[226]="\u8bf7\u8f93\u5165\u6b63\u786e\u7684\u9080\u8bf7\u7801",this[227]="\u79ef\u5206\u4e0d\u8db3",this[228]="\u8be5\u7528\u6237\u5df2\u7ecf\u4e3a\u63a8\u5e7f\u5458\uff0c\u65e0\u6cd5\u91cd\u590d\u8bbe\u7f6e",this[229]="\u5f53\u524d\u6b63\u5728\u6e38\u620f\u4e2d\uff0c\u65e0\u6cd5\u8fdb\u884c\u91d1\u5e01\u64cd\u4f5c\uff0c\u8bf7\u9000\u51fa\u6e38\u620f\u6216\u7b49\u5f85\u6e38\u620f\u7ed3\u675f",this[230]="\u4fdd\u9669\u67dc\u5bc6\u7801\u9519\u8bef",this[231]="\u672a\u7ed1\u5b9a\u652f\u4ed8\u5b9d",this[232]="\u672a\u7ed1\u5b9a\u94f6\u884c\u5361",this[301]="\u6b63\u5728\u8fdb\u5165\u623f\u95f4\u65e0\u6cd5\u91cd\u65b0\u5339\u914d",this[302]="\u6e38\u620f\u670d\u52a1\u5668\u53c2\u6570\u9519\u8bef",this[303]="\u6b63\u5728\u5339\u914d",this[304]="\u6b63\u5728\u8fdb\u5165\u623f\u95f4",this[305]="\u6ca1\u6709\u5728\u5339\u914d\u961f\u5217\u4e2d",this[306]="\u5df2\u7ecf\u5728\u623f\u95f4\u4e2d\uff0c\u65e0\u6cd5\u521b\u5efa\u65b0\u7684\u623f\u95f4",this[307]="\u521b\u5efa\u623f\u95f4\u5931\u8d25",this[308]="\u623f\u95f4\u4e0d\u5b58\u5728",this[309]="\u623f\u95f4\u4eba\u6570\u5df2\u6ee1",this[310]="\u52a0\u5165\u623f\u95f4\u5931\u8d25",this[311]="\u91d1\u5e01\u4e0d\u8db3\u65e0\u6cd5\u8fdb\u5165\u623f\u95f4",this[312]="\u91d1\u5e01\u8d85\u8fc7\u4e0a\u7ebf\uff0c\u65e0\u6cd5\u8fdb\u5165\u623f\u95f4",this[313]="\u5df2\u7ecf\u5728\u5339\u914d\u5217\u8868\u4e2d\uff0c\u65e0\u6cd5\u91cd\u590d\u5339\u914d",this[401]="\u623f\u95f4\u6570\u91cf\u5230\u8fbe\u4e0a\u7ebf",this[402]="\u91d1\u5e01\u4f4e\u4e8e\u623f\u95f4\u7684\u91d1\u5e01\u4e0b\u9650",this[403]="\u91d1\u5e01\u8d85\u8fc7\u623f\u95f4\u7684\u91d1\u5e01\u4e0a\u9650",this[404]="\u623f\u5361\u4e0d\u8db3",this[405]="\u623f\u95f4\u5df2\u89e3\u6563",this[406]="\u623f\u95f4\u5df2\u89e3\u6563\uff0c\u8bf7\u79bb\u5f00\u623f\u95f4",this[407]="\u5f53\u524d\u6b63\u5728\u6e38\u620f\u4e2d\uff0c\u65e0\u6cd5\u79bb\u5f00\u623f\u95f4",this[500]="\u8bf7\u6c42\u8d85\u65f6",this[501]="\u5145\u503c\u5931\u8d25",this[502]="\u5145\u503c\u6210\u529f"},cc._RF.pop()},{}],enumeration:[function(e,t,a){"use strict";cc._RF.push(t,"a4d00jcWPtAyqFgIb3ee/d8","enumeration");var r=t.exports;r.gameType={ZJH:1,NN:10,BRNN:11,SSS:20,TTZ:30,HHDZ:40,BJL:50,LHD:60,FISH:70,DDZ:80,BJ:90,DZ:100,PDK:110},r.broadcastType={NONE:0,LOOP:1,SYSTEM:2,BIG_WIN:3},r.roomSettlementMethod={NONE:0,GOLD:1,SCORE:2,LIMIT_GOLD:3},r.roomType={NONE:0,NORMAL:1,PRIVATE:2,HUNDRED:3},r.updateDataType={NONE:0,ADD:1,REMOVE:2,UPDATE:3},r.PlayerSex={MAN:0,WOMAN:1},r.loginPlatform={NONE:0,ACCOUNT:1,WEI_XIN:2,MOBILE_PHONE:3},r.userRoomState={NONE:0,ENTERING:1,IN_ROOM:2},r.gameRoomStatus={NONE:0,FREE:1,PLAYING:2},r.gameRoomStartType={NONE:0,ALL_READY:1,AUTO_START:2},r.userOnlineStatus={NONE:0,OFF_LINE:1,ON_LINE:2},r.gameRoomChatContentType={NONE:0,EMOTION:1,QUICK_TEXT:2,TEXT:3,VOICE:4},r.VOICE={PU_TONG_HUA:"putonghua",GAN_ZHOU_HUA:"ganzhouhua"},r.ShopType={NONE:0,SHOP_GOLD:1,SHOP_DIAMOND:2},r.RoomUserStatus={NONE:0,ONLINE:1,OFFLINE:2},r.PAY_TYPE={NONE:0,ALI_PAY:1,WE_CHAT:2,QQ_PAY:3,UNION_PAY:4},r.RechargePlatform={NONE:0,ALI:1,WX:2,ANXEN_PAY:3},r.SystemPlatform={NONE:0,ANDROID:1,IOS:2,WEB:3},r.userPermissionType={NONE:0,LOGIN_CLIENT:1,LOGIN_MT:2,USER_MANAGER:4,USER_SYSTEM_MANAGER:8,EXCHANGE_MANAGER:16,SPREAD_MANAGER:32,GAME_MANAGER:64,DATA_MANAGER:128,GAME_CONTROL:256},r.emailStatus={NONE:0,NOT_RECEIVE:1,RECEIVED:2},r.exchangeRecordStatus={NONE:0,WAIT_DELIVERY:1,ALREADY_DELIVERY:2},r.orderStatus={WAIT_HANDLE:0,ALREADY_HANDLE:1},r.recordType={NONE:0,RECHARGE:1,WITHDRAWALS:2,GAME:3,LOGIN:4,EXTRACT_COMMISSION:5,GAME_PROFIT:6,EXTRACT_INVENTORY:7,ADMIN_GRANT:8},r.withdrawCashType={NONE:0,ALI_PAY:1,BANK_CARD:2},cc._RF.pop()},{}],fishConfig:[function(e,t,a){"use strict";cc._RF.push(t,"0a908F7tqxAG5RMxQ/KgAke","fishConfig");var r=t.exports;r.fishType=[{resIndex:1,probability:.5,rewardTimes:2,frameCount:10,moveSpeed:1.5},{resIndex:2,probability:.333,rewardTimes:3,frameCount:12,moveSpeed:1.5},{resIndex:3,probability:.25,rewardTimes:4,frameCount:10,moveSpeed:1.5},{resIndex:4,probability:.2,rewardTimes:5,frameCount:9,moveSpeed:1.3},{resIndex:5,probability:.166,rewardTimes:6,frameCount:12,moveSpeed:1.3},{resIndex:6,probability:.142,rewardTimes:7,frameCount:12,moveSpeed:1.2},{resIndex:7,probability:.125,rewardTimes:8,frameCount:13,moveSpeed:1.2},{resIndex:8,probability:.1,rewardTimes:10,frameCount:12,moveSpeed:1.2},{resIndex:9,probability:.083,rewardTimes:12,frameCount:14,moveSpeed:1.1},{resIndex:10,probability:.066,rewardTimes:15,frameCount:12,moveSpeed:1.1},{resIndex:11,probability:.055,rewardTimes:18,frameCount:16,moveSpeed:1},{resIndex:33,probability:.05,rewardTimes:20,frameCount:13,moveSpeed:1},{resIndex:13,probability:.05,rewardTimes:20,frameCount:10,moveSpeed:1},{resIndex:19,probability:.05,rewardTimes:20,frameCount:12,moveSpeed:.9},{resIndex:37,probability:.033,rewardTimes:30,frameCount:10,moveSpeed:.9},{resIndex:14,probability:.033,rewardTimes:30,frameCount:12,moveSpeed:.9},{resIndex:15,probability:.033,rewardTimes:30,frameCount:12,moveSpeed:.9},{resIndex:41,probability:.025,rewardTimes:40,frameCount:16,moveSpeed:.8,fixedRotation:!0,fixedDir:!1},{resIndex:16,probability:.022,rewardTimes:45,frameCount:15,moveSpeed:.8},{resIndex:17,probability:.02,rewardTimes:50,frameCount:13,moveSpeed:.8},{resIndex:38,probability:.02,rewardTimes:50,frameCount:15,moveSpeed:.8},{resIndex:39,probability:.014,rewardTimes:70,frameCount:12,moveSpeed:.8},{resIndex:18,probability:.009,rewardTimes:110,frameCount:12,moveSpeed:.8},{resIndex:20,probability:.008,rewardTimes:120,frameCount:12,moveSpeed:.7},{resIndex:21,probability:.007,rewardTimes:130,frameCount:12,moveSpeed:.7},{resIndex:22,probability:.007,rewardTimes:140,frameCount:12,moveSpeed:.7},{resIndex:12,probability:.006,rewardTimes:150,frameCount:15,moveSpeed:.7},{resIndex:30,probability:.003,rewardTimes:300,frameCount:12,moveSpeed:.5,boss:!0,fixedRotation:!0,fixedDir:!0}],r.createFishRange={x:900,y:500},cc._RF.pop()},{}],gameCommon:[function(e,t,a){"use strict";cc._RF.push(t,"770cfJxVm1B473ZrbX8zkcs","gameCommon");var r=t.exports={};r.INVALID_CHAIR=-1,r.INVALID_CARD_DATA=-1,r.INVALID_CARD_INDEX=-1,r.userStatus={US_NULL:0,US_FREE:1,US_READY:2,US_PLAYING:3,US_OFFLINE:4},r.gameEndReason={GER_NORMAL:0,GER_DISMISS:1,GER_USER_LEAVE:2,GER_NETWORK_ERROR:3},r.scoreInfo=function(e,t){return{type:e=e||0,score:t=t||0}},r.roomUserInfo=function(e,t){return{userInfo:e,chairId:t}},cc._RF.pop()},{}],gameLogic:[function(e,t,a){"use strict";cc._RF.push(t,"8cf136fMIRI05BYAhvd84sm","gameLogic");var r=t.exports,i=e("./DDZProto");r.CARD_DATA_ARRAY=[1,2,3,4,5,6,7,8,9,10,11,12,13,17,18,19,20,21,22,23,24,25,26,27,28,29,33,34,35,36,37,38,39,40,41,42,43,44,45,49,50,51,52,53,54,55,56,57,58,59,60,61,78,79];r.getCardValue=function(e){return 15&e},r.getCardColor=function(e){return 240&e},r.getCardLogicValue=function(e){var t=this.getCardColor(e),a=this.getCardValue(e);return a<=0||a>15?0:64===t?a+2:a<=2?a+13:a},r.getCardLogicValueArr=function(e){for(var t=[],a=0;a<e.length;++a)t.push(r.getCardLogicValue(e[a]));return t},r.getRandCardList=function(){var e=this.CARD_DATA_ARRAY.slice(),t=[],a=e.length,r=0,i=0;do{i=Math.floor(Math.random()*(a-r)),t[r++]=e[i],e[i]=e[a-r]}while(r<a);return t},r.sortCardList=function(e,t){if(!e||e.length<=1)return e;for(var a=e.length,r=[],i=0;i<e.length;i++)r[i]=this.getCardLogicValue(e[i]);for(var o=0;o<a;++o)for(var n=r[o],s=e[o],c=o+1;c<a;++c)(r[c]>n||n===r[c]&&e[c]>s)&&(r[o]=r[c],r[c]=n,n=r[o],e[o]=e[c],e[c]=s,s=e[o]);if(t){var l=this.analyseCardDataArr(e);e=(e=(e=(e=(e=[]).concat(l.fourCardData)).concat(l.threeCardData)).concat(l.doubleCardData)).concat(l.singleCardData)}return e},r.getCardType=function(e){var t=e.length;switch(t){case 0:return i.cardType.ERROR;case 1:return i.cardType.SINGLE;case 2:return 79===e[0]&&78===e[1]?i.cardType.MISSILE_CARD:this.getCardLogicValue(e[0])===this.getCardLogicValue(e[1])?i.cardType.DOUBLE:i.cardType.ERROR}var a=this.analyseCardDataArr(e);if(!a)return i.cardType.ERROR;if(a.fourCardData.length>0)return 4===a.fourCardData.length&&4===t?i.cardType.BOMB_CARD:4===a.fourCardData.length&&2===a.singleCardData.length&&6===t?i.cardType.FOUR_LINE_TAKE_ONE:4===a.fourCardData.length&&a.doubleCardData.length/2==2&&8===t?i.cardType.FOUR_LINE_TAKE_TWO:i.cardType.ERROR;if(a.threeCardData.length>0){var r=a.threeCardData.length/3;if(1===r&&3===t)return i.cardType.THREE;if(r>1){var o=a.threeCardData[0],n=this.getCardLogicValue(o);if(n>=15)return i.cardType.ERROR;for(var s=1;s<r;s++){var c=a.threeCardData[3*s];if(n!==this.getCardLogicValue(c)+s)return i.cardType.ERROR}}return 3*r===t?i.cardType.THREE_LINE:4*r===t?i.cardType.THREE_LINE_TAKE_ONE:5*r===t&&a.doubleCardData.length/2===r?i.cardType.THREE_LINE_TAKE_TWO:i.cardType.ERROR}if(a.doubleCardData.length/2>=3){var l=a.doubleCardData.length/2,d=a.doubleCardData[0],h=this.getCardLogicValue(d);if(h>=15)return i.cardType.ERROR;for(var u=1;u<l;u++){var g=a.doubleCardData[2*u];if(h!==this.getCardLogicValue(g)+u)return i.cardType.ERROR}return 2*l===t?i.cardType.DOUBLE_LINE:i.cardType.ERROR}if(a.singleCardData.length>=5&&a.singleCardData.length===t){var C=a.singleCardData[0],p=this.getCardLogicValue(C);if(p>=15)return i.cardType.ERROR;for(var f=1;f<a.singleCardData.length;f++){var m=a.singleCardData[f];if(p!==this.getCardLogicValue(m)+f)return i.cardType.ERROR}return i.cardType.SINGLE_LINE}return i.cardType.ERROR},r.analyseCardDataArr=function(e){for(var t=e.length,a={fourCardData:[],threeCardData:[],doubleCardData:[],singleCardData:[]},r=0;r<t;r++){var i=1,o=this.getCardLogicValue(e[r]);if(o<=0)return null;for(var n=r+1;n<t&&this.getCardLogicValue(e[n])===o;n++)i++;switch(i){case 1:a.singleCardData.push(e[r]);break;case 2:a.doubleCardData.push(e[r]),a.doubleCardData.push(e[r+1]);break;case 3:a.threeCardData.push(e[r]),a.threeCardData.push(e[r+1]),a.threeCardData.push(e[r+2]);break;case 4:a.fourCardData.push(e[r]),a.fourCardData.push(e[r+1]),a.fourCardData.push(e[r+2]),a.fourCardData.push(e[r+3])}r+=i-1}return a},r.compareCard=function(e,t){var a=this.getCardType(t);if(a===i.cardType.ERROR)return!1;if(a===i.cardType.MISSILE_CARD)return!0;var r=this.getCardType(e);if(r===i.cardType.MISSILE_CARD)return!1;if(r!==i.cardType.BOMB_CARD&&a===i.cardType.BOMB_CARD)return!0;if(r===i.cardType.BOMB_CARD&&a!==i.cardType.BOMB_CARD)return!1;if(r!==a||e.length!==t.length)return!1;switch(a){case i.cardType.SINGLE:case i.cardType.DOUBLE:case i.cardType.THREE:case i.cardType.SINGLE_LINE:case i.cardType.DOUBLE_LINE:case i.cardType.THREE_LINE:case i.cardType.BOMB_CARD:return this.getCardLogicValue(t[0])>this.getCardLogicValue(e[0]);case i.cardType.THREE_LINE_TAKE_ONE:case i.cardType.THREE_LINE_TAKE_TWO:var o=this.analyseCardDataArr(t),n=this.analyseCardDataArr(e);return this.getCardLogicValue(o.threeCardData[0])>this.getCardLogicValue(n.threeCardData[0]);case i.cardType.FOUR_LINE_TAKE_ONE:case i.cardType.FOUR_LINE_TAKE_TWO:var s=this.analyseCardDataArr(t),c=this.analyseCardDataArr(e);return this.getCardLogicValue(s.fourCardData[0])>this.getCardLogicValue(c.fourCardData[0])}return!1},r.removeCard=function(e,t){if(e.length>t.length)return!1;for(var a=t.slice(),r=0,i=0;i<e.length;i++)for(var o=0;o<t.length;o++)if(e[i]===a[o]){a[o]=0,r++;break}if(r!==e.length)return!1;for(var n=0,s=0;s<a.length;++s)0!==a[s]&&(t[n++]=a[s]);return t.splice(n,t.length-n),!0},r.removeCardByValue=function(e,t){if(e.length>t.length)return!1;for(var a=t.slice(),r=0,i=0;i<e.length;i++){for(var o=!1,n=0;n<t.length;n++)e[i]===this.getCardLogicValue(a[n])&&(a[n]=0,o=!0);o&&r++}if(r!==e.length)return!1;for(var s=0,c=0;c<a.length;++c)0!==a[c]&&(t[s++]=a[c]);return t.splice(s,t.length-s),!0},r.searchOutCard=function(e,t){var a=[],r=e.slice(),o=e.length;r=this.sortCardList(r);var n=t.length,s=this.getCardType(t);switch(s){case i.cardType.ERROR:return a;case i.cardType.SINGLE:case i.cardType.DOUBLE:case i.cardType.THREE:var c=this.getCardLogicValue(t[0]),l=this.analyseCardDataArr(r);if(n<=1)for(var d=0;d<l.singleCardData.length;d++){var h=l.singleCardData.length-d-1;if(this.getCardLogicValue(l.singleCardData[h])>c)return a.push(l.singleCardData[h]),a}if(n<=2)for(var u=0;u<l.doubleCardData.length;u++){var g=2*(l.doubleCardData.length/2-u-1);if(this.getCardLogicValue(l.doubleCardData[g])>c)return a=l.doubleCardData.slice(g,g+n)}if(n<=3)for(var C=0;C<l.threeCardData.length;C++){var p=3*(l.threeCardData.length/3-C-1);if(this.getCardLogicValue(l.threeCardData[p])>c)return a=l.threeCardData.slice(p,p+n)}break;case i.cardType.SINGLE_LINE:if(o<n)break;for(var f=this.getCardLogicValue(t[0]),m=n-1;m<o;m++){var A=this.getCardLogicValue(r[o-m-1]);if(A>=15)break;if(!(A<=f))for(var b=0,y=o-m-1;y<o;y++)if(this.getCardLogicValue(r[y])+b===A&&(a[b++]=r[y],b===n))return a}break;case i.cardType.DOUBLE_LINE:if(o<n)break;for(var T=this.getCardLogicValue(t[0]),S=n-1;S<o;S++){var v=this.getCardLogicValue(r[o-S-1]);if(!(v<=T)){if(v>=15)break;for(var N=0,D=o-S-1;D<o-1;D++)if(this.getCardLogicValue(r[D])+N===v&&this.getCardLogicValue(r[D+1])+N===v&&(a[2*N]=r[D],a[2*N+1]=r[D+1],2*++N===n))return a}}break;case i.cardType.THREE_LINE:case i.cardType.THREE_LINE_TAKE_ONE:case i.cardType.THREE_LINE_TAKE_TWO:if(o<n)break;for(var I=0,R=0;R<n-2&&(I=this.getCardLogicValue(t[R]),this.getCardLogicValue(t[R+1])!==I||this.getCardLogicValue(t[R+2])!==I);R++);for(var _=0,G=3*(_=s===i.cardType.THREE_LINE_TAKE_ONE?n/4:s===i.cardType.THREE_LINE_TAKE_TWO?n/5:n/3)-1;G<o;G++){var P=this.getCardLogicValue(r[o-G-1]);if(!(P<=I)){if(_>1&&P>=15)break;for(var L=0,E=o-G-1;E<o-2;E++)if(this.getCardLogicValue(r[E])+L===P&&this.getCardLogicValue(r[E+1])+L===P&&this.getCardLogicValue(r[E+2])+L===P&&(a[3*L]=r[E],a[3*L+1]=r[E+1],a[3*L+2]=r[E+2],++L===_)){var M=r.slice();this.removeCard(a,M);var U=this.analyseCardDataArr(M);if(s===i.cardType.THREE_LINE_TAKE_ONE){for(var B=0;B<U.singleCardData.length&&a.length!==n;B++){var O=U.singleCardData.length-B-1,k=U.singleCardData[O];a.push(k)}for(var H=0;H<U.doubleCardData.length&&a.length!==n;H++){var w=U.doubleCardData.length-H-1,x=U.doubleCardData[w];a.push(x)}for(var F=0;F<U.threeCardData.length&&a.length!==n;F++){var W=U.threeCardData.length-F-1,Z=U.threeCardData[W];a.push(Z)}for(var V=0;V<U.fourCardData.length&&a.length!==n;V++){var J=U.fourCardData.length-V-1,K=U.fourCardData[J];a.push(K)}}if(s===i.cardType.THREE_LINE_TAKE_TWO){for(var Y=0;Y<U.doubleCardData.length&&a.length!==n;Y++){var z=2*(U.doubleCardData.length/2-Y-1),q=U.doubleCardData[z],X=U.doubleCardData[z+1];a.push(q),a.push(X)}for(var j=0;j<U.threeCardData.length&&a.length!==n;j++){var Q=3*(U.threeCardData.length/3-j-1),$=U.threeCardData[Q],ee=U.threeCardData[Q+1];a.push($),a.push(ee)}for(var te=0;te<U.fourCardData.length&&a.length!==n;te++){var ae=4*(U.fourCardData.length/4-te-1),re=U.fourCardData[ae],ie=U.fourCardData[ae+1];a.push(re),a.push(ie)}}if(a.length===n)return a}}}}if(o>=4&&s!==i.cardType.MISSILE_CARD){var oe=0;s===i.cardType.BOMB_CARD&&(oe=this.getCardLogicValue(t[0]));for(var ne=3;ne<o;ne++){var se=this.getCardLogicValue(r[o-ne-1]);if(!(se<=oe)){var ce=1;for(ce=1;ce<4&&this.getCardLogicValue(r[o+ce-ne-1])===se;ce++);if(4===ce)return(a=[])[0]=r[o-ne-1],a[1]=r[o-ne],a[2]=r[o-ne+1],a[3]=r[o-ne+2],a}}}return o>=2&&79===r[0]&&78===r[1]?((a=[])[0]=r[0],a[1]=r[1],a):[]},r.getAllSingleCard=function(e){for(var t=r.sortCardList(e.slice()),a=e.length,i=[],o=0;o<a;o++){for(var n=1,s=r.getCardLogicValue(t[o]),c=o+1;c<a&&r.getCardLogicValue(t[c])===s&&!(++n>1);c++);1===n&&i.push(t[o]),o+=n-1}return i},r.getAllDoubleCard=function(e){for(var t=r.sortCardList(e.slice()),a=e.length,i=[],o=0;o<a;o++){for(var n=1,s=r.getCardLogicValue(t[o]),c=o+1;c<a&&r.getCardLogicValue(t[c])===s;++c)n++;n>=2&&(i.push(t[o]),i.push(t[o+1])),o+=n-1}return i},r.getAllThreeCard=function(e){for(var t=r.sortCardList(e.slice()),a=e.length,i=[],o=0;o<a-2;o++){for(var n=1,s=r.getCardLogicValue(t[o]),c=o+1;c<=o+3&&c<a&&r.getCardLogicValue(t[c])===s;c++)n++;n>=3&&(i.push(t[o]),i.push(t[o+1]),i.push(t[o+2])),o+=n-1}return i},r.getAllLineCard=function(e){var t=e.length,a=r.sortCardList(e.slice()),i=[];if(t<5)return i;for(var o=0,n=0;n<t;++n)if(r.getCardLogicValue(a[n])<15){o=n;break}for(var s=[],c=!0;a.length+o>=5&&c;){c=!1,s=[a[o]];for(var l=a[o],d=o+1;d<a.length;d++){var h=a[d],u=r.getCardLogicValue(l)-r.getCardLogicValue(h);if(u>0)if(l=h,u>1){if(!(s.length<5))break;s=[l]}else s.push(l)}s.length>=5&&(r.removeCard(s,a),i=i.concat(s),c=!0)}return i},r.getAllBombCard=function(e){var t=e.length,a=r.sortCardList(e.slice()),i=[];if(e.length<2)return i;if(79===a[0]&&78===a[1]&&(i.push(a[0]),i.push(a[1])),t>=4)for(var o=0;o<t-3;o++){for(var n=1,s=r.getCardLogicValue(a[o]),c=o+1;c<=o+3&&c<t&&r.getCardLogicValue(a[c])===s;c++)n++;4===n&&(i.push(a[o]),i.push(a[o+1]),i.push(a[o+2]),i.push(a[o+3]))}return i},r.getAllSingleCardType=function(e,t){for(var a={cardType:i.cardType.SINGLE,cardTypeCount:0,cardDataArr:[],eachHandCardCount:[]},o=e.length,n=0;n<o;++n)if(!(t&&t.length>0&&r.getCardLogicValue(e[n])<=r.getCardLogicValue(t[0]))){var s=a.cardTypeCount;a.cardDataArr[s]=[],a.cardType=i.cardType.SINGLE,a.cardDataArr[s][0]=e[n],a.eachHandCardCount[s]=1,a.cardTypeCount++}return a},r.getAllDoubleCardType=function(e,t){for(var a={cardType:i.cardType.DOUBLE,cardTypeCount:0,cardDataArr:[],eachHandCardCount:[]},o=this.getAllDoubleCard(e),n=0;n<o.length;n+=2)if(!(t&&t.length>0&&r.getCardLogicValue(o[n])<=r.getCardLogicValue(t[0]))){var s=a.cardTypeCount;a.cardDataArr[s]=[],a.cardType=i.cardType.DOUBLE,a.cardDataArr[s][0]=o[n],a.cardDataArr[s][1]=o[n+1],a.eachHandCardCount[s]=2,a.cardTypeCount++}return a},r.getAllThreeCardType=function(e,t){for(var a={cardType:i.cardType.THREE,cardTypeCount:0,cardDataArr:[],eachHandCardCount:[]},o=this.getAllThreeCard(e),n=0;n<o.length;n+=3)if(!(t&&t.length>0&&r.getCardLogicValue(o[n])<=r.getCardLogicValue(t[0]))){var s=a.cardTypeCount;a.cardDataArr[s]=[],a.cardType=i.cardType.THREE,a.cardDataArr[s][0]=o[n],a.cardDataArr[s][1]=o[n+1],a.cardDataArr[s][2]=o[n+2],a.eachHandCardCount[s]=3,a.cardTypeCount++}return a},r.getAllLineCardType=function(e,t){for(var a={cardType:i.cardType.SINGLE_LINE,cardTypeCount:0,cardDataArr:[],eachHandCardCount:[]},o=t?r.getCardLogicValue(t[0]):0,n=e.slice(),s=n.length,c=0,l=0;l<s;++l)if(r.getCardLogicValue(n[l])<15){c=l;break}for(var d=[],h=s,u=!0;h+c>=5&&u;){u=!1;var g=n[c];d=[g];for(var C=c+1;C<h;C++){var p=n[C],f=r.getCardLogicValue(g)-r.getCardLogicValue(p);if(0!==f)if(g=n[C],1!==f){if(!(d.length<5))break;d=[g]}else d.push(g)}if(d.length>=5&&(!t||t.length<=d.length)){for(var m=void 0,A=5,b=0;A<=d.length;){if(t&&t.length>0){if(A!==t.length){++b+A>d.length&&(b=0,A++);continue}if(r.getCardLogicValue(d[b])<=o){b=0,A++;continue}}m=a.cardTypeCount,a.cardDataArr[m]||(a.cardDataArr[m]=[]),a.cardType=i.cardType.SINGLE_LINE,a.cardDataArr[m]=d.slice(b,b+A),a.eachHandCardCount[m]=A,a.cardTypeCount++,++b+A>d.length&&(b=0,A++)}r.removeCard(d,n),h-=d.length,u=!0}}return a},r.getAllDoubleLineCardType=function(e,t){for(var a={cardType:i.cardType.DOUBLE_LINE,cardTypeCount:0,cardDataArr:[],eachHandCardCount:[]},o=t?r.getCardLogicValue(t[0]):0,n=e.slice(),s=n.length,c=0,l=0;l<s;++l)if(r.getCardLogicValue(n[l])<15){c=l;break}for(var d=s-c,h=!0,u=0,g=[];d>=6&&h;){var C=n[c],p=1;u=0,h=!1;for(var f=c+1;f<d+c;++f){for(;r.getCardLogicValue(C)===r.getCardLogicValue(n[f])&&f<d+c;)++p,++f;var m=0;if(u>0&&(m=r.getCardLogicValue(g[u-1])),(p<2||u>0&&m-r.getCardLogicValue(C)!=1)&&f<=d+c){if(u>=6)break;p>=2&&(f-=p),C=n[f],u=0}else if(p>=2&&(g[u]=n[f-p],g[u+1]=n[f-p+1],u+=2,f===d+c-2&&r.getCardLogicValue(C)-r.getCardLogicValue(n[f])==1&&r.getCardLogicValue(n[f])===r.getCardLogicValue(n[f+1]))){g[u]=n[f],g[u+1]=n[f+1],u+=2;break}C=n[f],p=1}if(u>=6){for(var A=void 0,b=6,y=0;b<=u;){if(t&&t.length>0){if(b!==t.length){(y+=2)+b>u&&(y=0,b+=2);continue}if(r.getCardLogicValue(g[y])<=o){y=0,b+=2;continue}}A=a.cardTypeCount,a.cardDataArr[A]||(a.cardDataArr[A]=[]),a.cardType=i.cardType.DOUBLE_LINE,a.cardDataArr[A]=g.slice(y,y+b),a.eachHandCardCount[A]=b,a.cardTypeCount++,(y+=2)+b>u&&(y=0,b+=2)}r.removeCard(g,n),h=!0,d-=u}}return a},r.getAllThreeLineCardType=function(e,t){for(var a={cardType:i.cardType.THREE_LINE,cardTypeCount:0,cardDataArr:[],eachHandCardCount:[]},o=t?r.getCardLogicValue(t[0]):0,n=e.slice(),s=n.length,c=0,l=0;l<s;++l)if(r.getCardLogicValue(n[l])<15){c=l;break}for(var d=s-c,h=!0,u=0,g=[];d>=6&&h;){var C=n[c],p=1;u=0,h=!1;for(var f=c+1;f<d+c;++f){for(;r.getCardLogicValue(C)===r.getCardLogicValue(n[f])&&f<d+c;)++p,++f;var m=void 0;if(u>0&&(m=r.getCardLogicValue(g[u-1])),(p<3||u>0&&m-r.getCardLogicValue(C)!=1)&&f<=d+c){if(u>=6)break;p>=3&&(f-=p),C=n[f],u=0}else if(p>=3&&(g[u]=n[f-p],g[u+1]=n[f-p+1],g[u+2]=n[f-p+2],u+=3,f===d+c-3&&r.getCardLogicValue(C)-r.getCardLogicValue(n[f])==1&&r.getCardLogicValue(n[f])===r.getCardLogicValue(n[f+1])&&r.getCardLogicValue(n[f])===r.getCardLogicValue(n[f+2]))){g[u]=n[f],g[u+1]=n[f+1],g[u+2]=n[f+2],u+=3;break}C=n[f],p=1}if(u>=6){for(var A=void 0,b=6,y=0;b<=u;){if(t&&t.length>0){if(b!==t.length){(y+=3)+b>u&&(y=0,b+=3);continue}if(r.getCardLogicValue(g[y])<=o){y=0,b+=3;continue}}A=a.cardTypeCount,a.cardDataArr[A]||(a.cardDataArr[A]=[]),a.cardType=i.cardType.THREE_LINE,a.cardDataArr[A]=g.slice(y,y+b),a.eachHandCardCount[A]=b,a.cardTypeCount++,(y+=3)+b>u&&(y=0,b+=3)}r.removeCard(g,n),h=!0,d-=u}}return a},r.getAllThreeLineTakeOneCardType=function(e,t){var a={cardType:i.cardType.THREE_LINE_TAKE_ONE,cardTypeCount:0,cardDataArr:[],eachHandCardCount:[]},o=0,n=void 0;t&&(n=this.getAllThreeCard(t),o=r.getCardLogicValue(n[0]));var s=e.slice(),c=this.getAllBombCard(s);r.removeCard(c,s);var l=this.getAllThreeCard(s),d=l.length;if(!t||4===t.length){var h=void 0,u=s.slice();r.removeCard(l,u);for(var g=u.length,C=0;C<d;C+=3)if(!(t&&r.getCardLogicValue(l[C])<=o))for(var p=0;p<g;++p)h=a.cardTypeCount,a.cardDataArr[h]||(a.cardDataArr[h]=[]),a.cbCardType=i.cardType.THREE_LINE_TAKE_ONE,a.cardDataArr[h][0]=l[C],a.cardDataArr[h][1]=l[C+1],a.cardDataArr[h][2]=l[C+2],a.cardDataArr[h][3]=u[p],a.eachHandCardCount[h]=4,a.cardTypeCount++}var f=d,m=!0,A=0;for(15===r.getCardLogicValue(l[0])&&(A=3);f+A>=6&&m;){var b=r.getCardLogicValue(l[A]),y=[],T=3;y[0]=l[A],y[1]=l[A+1],y[2]=l[A+2],m=!1;for(var S=3+A;S<f;S+=3){if(1!=b-r.getCardLogicValue(l[S])){A=S,f-S>=6&&(m=!0);break}b=r.getCardLogicValue(l[S]),y[T]=l[S],y[T+1]=l[S+1],y[T+2]=l[S+2],T+=3}if(T>3){var v=void 0,N=s.slice();r.removeCard(l,N);for(var D=N.length,I=0;I<T-3;I+=3){var R=T-I;if(!n||!(R!==n.length||r.getCardLogicValue(y[0])<=o)){var _=R/3;if(!(D<_)){var G=[];this.combination([],0,G,N,_,_);for(var P=G.length,L=0;L<P;++L){v=a.cardTypeCount,a.cardDataArr[v]||(a.cardDataArr[v]=[]),a.cardType=i.cardType.THREE_LINE_TAKE_ONE;var E=y.slice(I,T);a.cardDataArr[v]=E,a.cardDataArr[v]=E.concat(G[L].slice(0,_)),a.eachHandCardCount[v]=R+_,a.cardTypeCount++}}}}m=!0,r.removeCard(y,l),f-=T}}return a},r.getAllThreeLineTakeTwoCardType=function(e,t){var a={cardType:i.cardType.THREE_LINE_TAKE_TWO,cardTypeCount:0,cardDataArr:[],eachHandCardCount:[]},o=e.slice(),n=0,s=void 0;t&&(s=this.getAllThreeCard(t),n=r.getCardLogicValue(s[0]));var c=this.getAllThreeCard(o),l=c.length,d=o.slice();r.removeCard(c,d);var h=d.length,u=this.getAllDoubleCard(d),g=u.length;if(!t||5===t.length)for(var C=0;C<l;C+=3){var p=void 0;if(!t||!r.getCardLogicValue(c[C]<=n))for(var f=0;f<g;f+=2)p=a.cardTypeCount,a.cardDataArr[p]||(a.cardDataArr[p]=[]),a.cardType=i.cardType.THREE_LINE_TAKE_TWO,a.cardDataArr[p][0]=c[C],a.cardDataArr[p][1]=c[C+1],a.cardDataArr[p][2]=c[C+2],a.cardDataArr[p][3]=u[f],a.cardDataArr[p][4]=u[f+1],a.eachHandCardCount[p]=5,a.cardTypeCount++}var m=l,A=!0,b=0;for(15===r.getCardLogicValue(c[0])&&(b=3);m>=6&&A;){var y=r.getCardLogicValue(c[b]),T=[],S=3;T[0]=c[b],T[1]=c[b+1],T[2]=c[b+2],A=!1;for(var v=3+b;v<m;v+=3){if(1!=y-r.getCardLogicValue(c[v])){b=v,m-v>=6&&(A=!0);break}y=r.getCardLogicValue(c[v]),T[S]=c[v],T[S+1]=c[v+1],T[S+2]=c[v+2],S+=3}if(S>3){for(var N=void 0,D=0;D<S-3;D+=3){var I=S-D;if(t){if(I!==s.length)continue;if(r.getCardLogicValue(T[D])<=n)break}var R=I/3;if(!(h<R)){for(var _=[],G=0,P=0;G<g;G+=2,++P)_[P]=G;var L=[];this.combination([],0,L,_,R,R);for(var E=L.length,M=0;M<E;++M){N=a.cardTypeCount,a.cardDataArr[N]||(a.cardDataArr[N]=[]),a.cardType=i.cardType.THREE_LINE_TAKE_TWO,a.cardDataArr[N]=T.slice(D,S);for(var U=0,B=0;U<R;++U,B+=2)a.cardDataArr[N][I+B]=u[L[M][U]],a.cardDataArr[N][I+B+1]=u[L[M][U]+1];a.eachHandCardCount[N]=I+2*R,a.cardTypeCount++}}}A=!0,r.removeCard(T,c),m-=S}}return a},r.getAllFourLineTakeOneCardType=function(e,t){var a={cardType:i.cardType.FOUR_LINE_TAKE_ONE,cardTypeCount:0,cardDataArr:[],eachHandCardCount:[]};if(e.length<6)return a;for(var o=e.slice(),n=o.length,s=0,c=0;c<n&&c<3;++c)if(64!==r.getCardColor(o[c])){s=c;break}var l=this.getAllBombCard(o.slice(s)),d=e.length;if(d<=0)return a;var h=[],u=0;if(t&&(h=this.getAllBombCard(t),u=r.getCardLogicValue(h[0])),t&&r.getCardLogicValue(l[0])<=u)return a;var g=[],C=0;if(t){for(var p=0;p<d;p+=4)r.getCardLogicValue(l[p])>u&&(g[C]=l[p],g[C+1]=l[p+1],g[C+2]=l[p+2],g[C+3]=l[p+3],C+=4);if(n-C<t.length-h.length)return a}else g=l,C=e.length;var f=o.slice();r.removeCard(g,f);for(var m=0;m<C;m+=4){var A=void 0,b=[];this.combination([],0,b,f,2,2);for(var y=0;y<b.length;++y)r.getCardValue(b[y][0])!==r.getCardValue(b[y][1])&&(A=a.cardTypeCount,a.cardDataArr[A]=g.slice(m,m+4),a.cardDataArr[A][4]=b[y][0],a.cardDataArr[A][5]=b[y][1],a.eachHandCardCount[A]=6,a.cardTypeCount++)}return a},r.getAllFourLineTakeTwoCardType=function(e,t){var a={cardType:i.cardType.FOUR_LINE_TAKE_TWO,cardTypeCount:0,cardDataArr:[],eachHandCardCount:[]};if(e.length<8)return a;for(var o=e.slice(),n=o.length,s=0,c=0;c<n&&c<3;++c)if(64!==r.getCardColor(o[c])){s=c;break}var l=this.getAllBombCard(o.slice(s)),d=e.length;if(d<=0)return a;var h=[],u=0;if(t&&(h=this.getAllBombCard(t),u=r.getCardLogicValue(h[0])),t&&r.getCardLogicValue(l[0])<u)return a;var g=[],C=0;if(t){for(var p=0;p<d;p+=4)r.getCardLogicValue(l[p])>u&&(g[C]=l[p],g[C+1]=l[p+1],g[C+2]=l[p+2],g[C+3]=l[p+3],C+=4);if(n-C<t.length-h.length)return a}else g=l,C=n;var f=o.slice();r.removeCard(g,f);for(var m=0;m<C;m+=4){for(var A=this.getAllDoubleCard(f),b=A.length,y=[],T=0,S=0;T<b;T+=2,++S)y[S]=T;var v=[];this.combination([],0,v,y,2,2);for(var N=0;N<v.length;++N){var D=a.cardTypeCount;a.cardDataArr[D]=g.slice(m,m+4);for(var I=0,R=0;I<2;++I,R+=2)a.cardDataArr[D][4+R]=A[v[N][I]],a.cardDataArr[D][4+R+1]=A[v[N][I]+1];a.eachHandCardCount[D]=8,a.cardTypeCount++}}return a},r.getAllBombCardType=function(e,t){var a={cardType:i.cardType.BOMB_CARD,cardTypeCount:0,cardDataArr:[],eachHandCardCount:[]},o=[];if(e.length>=2&&79===e[0]&&78===e[1]){var n=a.cardTypeCount;a.cardDataArr[n]=[],a.cardType=i.cardType.BOMB_CARD,a.cardDataArr[n][0]=e[0],a.cardDataArr[n][1]=e[1],a.eachHandCardCount[n]=2,a.cardTypeCount++,o=this.getAllBombCard(e.slice(2,e.length))}else o=this.getAllBombCard(e);for(var s=0;s<o.length;s+=4)if(!(t&&t.length>0&&r.getCardLogicValue(o[s])<=r.getCardLogicValue(t[0]))){var c=a.cardTypeCount;a.cardDataArr[c]||(a.cardDataArr[c]=[]),a.cardType=i.cardType.BOMB_CARD,a.cardDataArr[c][0]=o[s],a.cardDataArr[c][1]=o[s+1],a.cardDataArr[c][2]=o[s+2],a.cardDataArr[c][3]=o[s+3],a.eachHandCardCount[c]=4,a.cardTypeCount++}return a},r.analyseOutCardTypeActive=function(e,t){for(var a=0;a<=12;++a)t.push({cardTypeCount:0,cardDataArr:[],eachHandCardCount:[],cardType:a});t[i.cardType.SINGLE]=this.getAllSingleCardType(e),t[i.cardType.DOUBLE]=this.getAllDoubleCardType(e),t[i.cardType.THREE]=this.getAllThreeCardType(e),t[i.cardType.BOMB_CARD]=this.getAllBombCardType(e),t[i.cardType.SINGLE_LINE]=this.getAllLineCardType(e),t[i.cardType.DOUBLE_LINE]=this.getAllDoubleLineCardType(e),t[i.cardType.THREE_LINE]=this.getAllThreeLineCardType(e),t[i.cardType.THREE_LINE_TAKE_ONE]=this.getAllThreeLineTakeOneCardType(e),t[i.cardType.THREE_LINE_TAKE_TWO]=this.getAllThreeLineTakeTwoCardType(e)},cc._RF.pop()},{"./DDZProto":"DDZProto"}],gameProto:[function(e,t,a){"use strict";cc._RF.push(t,"42227Yo7cBCoZLmL81XBR4+","gameProto");var r=t.exports;r.GAME_FIRE_NOTIFY=301,r.GAME_FIRE_PUSH=401,r.GAME_CHANGE_CANNON_NOTIFY=302,r.GAME_CHANGE_CANNON_PUSH=402,r.GAME_CAPTURE_NOTIFY=303,r.GAME_CAPTURE_PUSH=403,r.GAME_LOCK_FISH_NOTIFY=304,r.GAME_LOCK_FISH_PUSH=404,r.GAME_ROBOT_FIRE_NOTIFY=305,r.GAME_ROBOT_FIRE_PUSH=405,r.GAME_ROBOT_CAPTURE_NOTIFY=306,r.GAME_ROBOT_CAPTURE_PUSH=406,r.GAME_ADD_FISH_PUSH=305,r.gameFireNotify=function(e){return{type:this.GAME_FIRE_NOTIFY,data:{rote:e}}},r.gameFirePush=function(e,t){return{type:this.GAME_FIRE_PUSH,data:{rote:t,chairID:e}}},r.gameChangeCannonNotify=function(e){return{type:this.GAME_CHANGE_CANNON_NOTIFY,data:{powerIndex:e}}},r.gameChangeCannonPush=function(e,t){return{type:this.GAME_CHANGE_CANNON_PUSH,data:{chairID:e,powerIndex:t}}},r.gameCaptureNotify=function(e){return{type:this.GAME_CAPTURE_NOTIFY,data:{fishID:e}}},r.gameCapturePush=function(e,t,a,r){return{type:this.GAME_CAPTURE_PUSH,data:{fishID:t,chairID:e,gainGold:a,curWinGold:r}}},r.gameAddFishPush=function(e){return{type:this.GAME_ADD_FISH_PUSH,data:{fishArr:e}}},r.gameLockFishNotify=function(e){return{type:this.GAME_LOCK_FISH_NOTIFY,data:{fishID:e}}},r.gameLockFishPush=function(e,t){return{type:this.GAME_LOCK_FISH_PUSH,data:{chairID:e,fishID:t}}},r.gameRobotFireNotify=function(e,t){return{type:this.GAME_ROBOT_FIRE_NOTIFY,data:{chairIDArr:e,roteArr:t}}},r.gameRobotCaptureNotify=function(e,t){return{type:this.GAME_ROBOT_CAPTURE_NOTIFY,data:{chairID:e,fishID:t}}},cc._RF.pop()},{}],utils:[function(e,t,a){"use strict";cc._RF.push(t,"9bef9gtSWlBgKT3swHg1KNV","utils");var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o=t.exports;o.invokeCallback=function(e){e&&"function"==typeof e&&e.apply(null,Array.prototype.slice.call(arguments,1))},o.clone=function(e){if(e){var t={};for(var a in e)e.hasOwnProperty(a)&&(t[a]=e[a]);return t}},o.size=function(e){if(!e)return 0;var t=0;for(var a in e)e.hasOwnProperty(a)&&t++;return t},o.myPrint=function(){},o.getProperties=function(e,t){var a={};return t.forEach(function(t){e.hasOwnProperty(t)&&(a[t]=e[t])}),a},o.setProperties=function(e,t){for(var a in t)e[a]=t[a]},o.multiplyProperties=function(e,t){var a={};for(var r in e)a[r]=Math.floor(e[r]*t);return a},o.addProperties=function(e,t){for(var a in t)e[a]?e[a]+=t[a]:e[a]=t[a]},o.isEmptyObject=function(e){for(var t in e)return!1;return!0},o.getLength=function(e){var t=0;for(var a in e)t++;return t},o.getDist=function(e,t){var a=t.x-e.x,r=t.y-e.y;return Math.sqrt(a*a+r*r)},o.isPositiveInteger=function(e){return/^[1-9][0-9]*$/.test(e)},o.ipToInt=function(e){var t=e.split(".");return 4!=t.length?0:(parseInt(t[0],10)<<24|parseInt(t[1],10)<<16|parseInt(t[2],10)<<8|parseInt(t[3],10))>>>0},o.getRandomNum=function(e,t){var a=t-e,r=Math.random();return e+Math.round(r*a)},o.userId2Number=function(e){for(var t=5381,a=e.length;a;)t=33*t^e.charCodeAt(--a);return Number(t>>>0)},o.createJoinRoomID=function(e,t){var a=parseInt(e.split("-")[1]);return a?1e3*a+t:0},o.parseJoinRoomID=function(e){return(e=parseInt(e))?{gameServerID:"game-"+Math.floor(e/1e3),roomID:e%1e3}:null};o.getIntervalDay=function(e,t){return Math.abs(Math.floor(e/864e5)-Math.floor(t/864e5))},o.numToFixed=function(e,t){var a=t||2;return parseFloat(parseFloat(e).toFixed(a))},Date.prototype.format=function(e){var t={"M+":this.getMonth()+1,"d+":this.getDate(),"h+":this.getHours(),"m+":this.getMinutes(),"s+":this.getSeconds(),"q+":Math.floor((this.getMonth()+3)/3),"S+":this.getMilliseconds()};for(var a in/(y+)/i.test(e)&&(e=e.replace(RegExp.$1,(this.getFullYear()+"").substr(4-RegExp.$1.length))),t)new RegExp("("+a+")").test(e)&&(e=e.replace(RegExp.$1,1===RegExp.$1.length?t[a]:("00"+t[a]).substr((""+t[a]).length)));return e},String.prototype.format=function(e){var t=this;if(arguments.length>0)if(1===arguments.length&&"object"===(void 0===e?"undefined":r(e))){for(var a in e)if(void 0!==e[a]){var i=new RegExp("({"+a+"})","g");t=t.replace(i,e[a])}}else for(var o=0;o<arguments.length;o++)if(void 0!==arguments[o]){i=new RegExp("({["+o+"]})","g");t=t.replace(i,arguments[o])}return t},o.randomString=function(e){e=e||16;var t="ABCDEFGHJKMNPQRSTWXYZabcdefhijkmnprstwxyz2345678",a=t.length,r="";for(i=0;i<e;i++)r+=t.charAt(Math.floor(Math.random()*a));return r},o.getUnitVector=function(e,t){var a=cc.v2(0,0),r=void 0;return r=Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2),0===(r=Math.sqrt(r))?a:(a.x=(t.x-e.x)/r,a.y=(t.y-e.y)/r,a)},o.stringFormat=function(){if(0===arguments.length)return null;for(var e=arguments[0],t=1;t<arguments.length;t++){var a=new RegExp("\\{"+(t-1)+"\\}","gm");e=e.replace(a,arguments[t])}return e},o.getStringByRealLength=function(e,t){for(var a=0,r=0;r<e.length;++r){var o=e.charCodeAt(r);if(o>=0&&o<=128?++a:a+=2,a>=t)break}return e.substring(0,i+1)},o.getStringRealLength=function(e){for(var t=0,a=0;a<e.length;++a){var r=e.charCodeAt(a);r>=0&&r<=128?++t:t+=2}return t},o.formatNumberToString=function(e,t){return parseFloat(e.toFixed(t)).toString()},o.keepNumberPoint=function(e,t){for(var a=1,r=0;r<t;++r)a*=10;return Math.floor(e*a)/a},o.getCombinationFlagArrs=function(e,t){if(!t||t<1||e<t)return[];if(e===t)return[[1,1]];var a=[],r=[],i=!1,o=void 0,n=void 0,s=void 0;for(o=0;o<e;o++)r[o]=o<t?1:0;for(a.push(r.concat());!i;)for(s=0,o=0;o<e-1;o++){if(1===r[o]&&0===r[o+1]){for(n=0;n<o;n++)r[n]=n<s?1:0;r[o]=0,r[o+1]=1;var c=r.concat();a.push(c),-1===c.slice(-t).join("").indexOf("0")&&(i=!0);break}1===r[o]&&s++}return a},cc._RF.pop()},{}]},{},["AccountAPI","HallAPI","HttpAPI","RoomAPI","RoomProto","BJLEnterGameDialog","BJLGameItem","BJLLogic","BJLMainDialog","BJLModel","BJLProto","BJLResoutItem","BJLRoadItem","BJLTickItem","Lu","BRNNCardWidgetCtrl","BRNNClockWidgetCtrl","BRNNGameCommonCtrl","BRNNGameRecordDialog","BRNNMainDialog","BRNNProto","BRNNRecordWidgetCtrl","BJBetWidgetCtrl","BJCardsWidgetCtrl","BJClockWidgetCtrl","BJGameLogic","BJHandCardWidgetCtrl","BJMainDialog","BJOperationWidgetCtrl","BJProto","BJShowBetWidgetCtrl","DDZClockWidgetCtrl","DDZHandCradWidgetCtrl","DDZMainDialog","DDZOperationBtnWdigetCtrl","DDZProto","DDZResultDialog","DDZShowHandCardWidgetCtrl","DDZShowOutCardWidgetCtrl","gameLogic","DZGameLogic","DZGameRecordDialog","DZGameRuleDialog","DZHandCardWidgetCtrl","DZMainDialog","DZOperationWidgetCtrl","DZPreBetRuleDialog","DZProto","DZPublicCardWidgetCtrl","DZRoomLayerDialog","DZUserHeadWidgetCtrl","fishConfig","gameProto","BulletWidgetCtrl","CannonWidgetCtrl","EffectCtrl","FireControlWidget","FishHelpDialog","FishMainDialog","FishWidgetCtrl","LockLineWidgetCtrl","GameCommonController","GameHeadController","GameOnlineUserDialog","GameRuleDialog","TrendHelper","HHDZAPI","HHDZGameProto","HHDZCards","HHDZDirRecordDialog","HHDZMainDialog","HHDZModel","LHDMainDialog","LHDModel","LHDProto","LHDTrendDialog","LHDTrendItem","NNAudioNode","NNCardItem","NNGameRuleDialog","NNGameRuleItem","NNHeadItem","NNLogic","NNMainDialog","NNModel","NNProto","NNStateItem","NNWatchCardNode","PDKAnalyseOutCard","PDKClockWidgetCtrl","PDKGameLogic","PDKHandCradWidgetCtrl","PDKMainDialog","PDKOperationBtnWdigetCtrl","PDKProto","PDKResultDialog","PDKShowHandCardWidgetCtrl","PDKShowOutCardWidgetCtrl","TWCardItem","TWCommonFunction","TWGuaipaiTipWidgetCtrl","TWHeadItem","TWLogic","TWMainDialog","TWModel","TWProto","TWSortCardWidgetCtrl","TTZAudioNode","TTZBankerItem","TTZBankerList","TTZBankerOpNode","TTZCards","TTZCoinButtons","TTZDirItem","TTZDirection","TTZHead","TTZLogic","TTZMainDialog","TTZModel","TTZOnLine","TTZOnLineItem","TTZProto","TTZResoutDialog","TTZRuleDialog","TTZStatus","TTZTouzi","GameProtoZJH","ZJHAddStake","ZJHAudio","ZJHCard","ZJHCards","ZJHChair","ZJHChip","ZJHChipPool","ZJHCompare","ZJHModel","ZJHOperation","ZJHResultUI","ZJHSelectChair","ZhaJinHuaDialog","gameCommon","AgentProfit","Data","GameTypes","Player","PlayerWechat","Animation","Api","AudioManager","CCHelper","Constant","DialogManager","MessageCallback","NetworkLogic","NetworkManager","SceneInit","SpriteFrameAnimationWidgetCtrl","WeChatHelper","code","enumeration","utils","BankDialog","BindDialog","TiXianDialog","TiXianRecordDialog","TiXianRecordItem","CommissionDialog","DaiLiDetailDialog","HuiYuanDetailDialog","HuiYuanItem","TiXianDetailDialog","TiXianDetailItem","BroadcastWidgetCtrl","LoadingCircleDialog","PopDialog","TipDialog","GameBtnItem","HallDialog","NoticeDialog","RechargeDialog","RoomItem","SettingDialog","ShowItem","LoginDialog","LoginPhoneDialog","RegisterDialog","ResetPwdDialog","MatchGameDialog","NoticeDetailDialog","NoticeListDialog","NoticeListItem","RankDialog","RankItem","UpdateDialog","AvatarItem","ChangeAvatarDialog","UserInfoDialog","DialogActionWidgetCtrl","ShowQRWidgetCtrl","SpriteAtlasAnimationWidgetCtrl"]);